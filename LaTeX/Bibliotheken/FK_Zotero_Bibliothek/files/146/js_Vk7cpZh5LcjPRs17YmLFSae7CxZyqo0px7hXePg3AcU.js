"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,h,g=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,h=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)h[c]=str(c,i)||"null";return e=0===h.length?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=0===h.length?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","  ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();
;
(function(){function C(){var a="{}";if("userDataBehavior"==h){d.load("jStorage");try{a=d.getAttribute("jStorage")}catch(b){}try{q=d.getAttribute("jStorage_update")}catch(c){}l.jStorage=a}D();w();E()}function t(){var a;clearTimeout(F);F=setTimeout(function(){if("localStorage"==h||"globalStorage"==h)a=l.jStorage_update;else if("userDataBehavior"==h){d.load("jStorage");try{a=d.getAttribute("jStorage_update")}catch(b){}}if(a&&a!=q){q=a;var m=n.parse(n.stringify(c.__jstorage_meta.CRC32)),k;C();k=n.parse(n.stringify(c.__jstorage_meta.CRC32));
var e,y=[],g=[];for(e in m)m.hasOwnProperty(e)&&(k[e]?m[e]!=k[e]&&"2."==String(m[e]).substr(0,2)&&y.push(e):g.push(e));for(e in k)k.hasOwnProperty(e)&&(m[e]||y.push(e));r(y,"updated");r(g,"deleted")}},25)}function r(a,b){a=[].concat(a||[]);var c,k,e,d;if("flushed"==b){a=[];for(c in f)f.hasOwnProperty(c)&&a.push(c);b="deleted"}c=0;for(e=a.length;c<e;c++){if(f[a[c]])for(k=0,d=f[a[c]].length;k<d;k++)f[a[c]][k](a[c],b);if(f["*"])for(k=0,d=f["*"].length;k<d;k++)f["*"][k](a[c],b)}}function u(){var a=(+new Date).toString();
if("localStorage"==h||"globalStorage"==h)try{l.jStorage_update=a}catch(b){h=!1}else"userDataBehavior"==h&&(d.setAttribute("jStorage_update",a),d.save("jStorage"));t()}function D(){if(l.jStorage)try{c=n.parse(String(l.jStorage))}catch(a){l.jStorage="{}"}else l.jStorage="{}";z=l.jStorage?String(l.jStorage).length:0;c.__jstorage_meta||(c.__jstorage_meta={});c.__jstorage_meta.CRC32||(c.__jstorage_meta.CRC32={})}function v(){if(c.__jstorage_meta.PubSub){for(var a=+new Date-2E3,b=0,m=c.__jstorage_meta.PubSub.length;b<
m;b++)if(c.__jstorage_meta.PubSub[b][0]<=a){c.__jstorage_meta.PubSub.splice(b,c.__jstorage_meta.PubSub.length-b);break}c.__jstorage_meta.PubSub.length||delete c.__jstorage_meta.PubSub}try{l.jStorage=n.stringify(c),d&&(d.setAttribute("jStorage",l.jStorage),d.save("jStorage")),z=l.jStorage?String(l.jStorage).length:0}catch(k){}}function p(a){if("string"!=typeof a&&"number"!=typeof a)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==a)throw new TypeError("Reserved key name");
return!0}function w(){var a,b,m,k,e=Infinity,d=!1,g=[];clearTimeout(G);if(c.__jstorage_meta&&"object"==typeof c.__jstorage_meta.TTL){a=+new Date;m=c.__jstorage_meta.TTL;k=c.__jstorage_meta.CRC32;for(b in m)m.hasOwnProperty(b)&&(m[b]<=a?(delete m[b],delete k[b],delete c[b],d=!0,g.push(b)):m[b]<e&&(e=m[b]));Infinity!=e&&(G=setTimeout(w,Math.min(e-a,2147483647)));d&&(v(),u(),r(g,"deleted"))}}function E(){var a;if(c.__jstorage_meta.PubSub){var b,m=A;for(a=c.__jstorage_meta.PubSub.length-1;0<=a;a--)if(b=
c.__jstorage_meta.PubSub[a],b[0]>A){var m=b[0],k=b[1];b=b[2];if(s[k])for(var e=0,d=s[k].length;e<d;e++)try{s[k][e](k,n.parse(n.stringify(b)))}catch(g){}}A=m}}var x=window.jQuery||window.$||(window.$={}),n={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(a){return String(a).evalJSON()}||x.parseJSON||x.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||x.toJSON};if("function"!==typeof n.parse||"function"!==typeof n.stringify)throw Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");
var c={__jstorage_meta:{CRC32:{}}},l={jStorage:"{}"},d=null,z=0,h=!1,f={},F=!1,q=0,s={},A=+new Date,G,B={isXML:function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?"HTML"!==a.nodeName:!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");b.async=
"false";b.loadXML(a);return b};if(!b)return!1;a=b.call("DOMParser"in window&&new DOMParser||window,a,"text/xml");return this.isXML(a)?a:!1}};x.jStorage={version:"0.4.11",set:function(a,b,d){p(a);d=d||{};if("undefined"==typeof b)return this.deleteKey(a),b;if(B.isXML(b))b={_is_xml:!0,xml:B.encode(b)};else{if("function"==typeof b)return;b&&"object"==typeof b&&(b=n.parse(n.stringify(b)))}c[a]=b;for(var k=c.__jstorage_meta.CRC32,e=n.stringify(b),l=e.length,g=2538058380^l,h=0,f;4<=l;)f=e.charCodeAt(h)&
255|(e.charCodeAt(++h)&255)<<8|(e.charCodeAt(++h)&255)<<16|(e.charCodeAt(++h)&255)<<24,f=1540483477*(f&65535)+((1540483477*(f>>>16)&65535)<<16),f^=f>>>24,f=1540483477*(f&65535)+((1540483477*(f>>>16)&65535)<<16),g=1540483477*(g&65535)+((1540483477*(g>>>16)&65535)<<16)^f,l-=4,++h;switch(l){case 3:g^=(e.charCodeAt(h+2)&255)<<16;case 2:g^=(e.charCodeAt(h+1)&255)<<8;case 1:g^=e.charCodeAt(h)&255,g=1540483477*(g&65535)+((1540483477*(g>>>16)&65535)<<16)}g^=g>>>13;g=1540483477*(g&65535)+((1540483477*(g>>>
16)&65535)<<16);k[a]="2."+((g^g>>>15)>>>0);this.setTTL(a,d.TTL||0);r(a,"updated");return b},get:function(a,b){p(a);return a in c?c[a]&&"object"==typeof c[a]&&c[a]._is_xml?B.decode(c[a].xml):c[a]:"undefined"==typeof b?null:b},deleteKey:function(a){p(a);return a in c?(delete c[a],"object"==typeof c.__jstorage_meta.TTL&&a in c.__jstorage_meta.TTL&&delete c.__jstorage_meta.TTL[a],delete c.__jstorage_meta.CRC32[a],v(),u(),r(a,"deleted"),!0):!1},setTTL:function(a,b){var d=+new Date;p(a);b=Number(b)||0;
return a in c?(c.__jstorage_meta.TTL||(c.__jstorage_meta.TTL={}),0<b?c.__jstorage_meta.TTL[a]=d+b:delete c.__jstorage_meta.TTL[a],v(),w(),u(),!0):!1},getTTL:function(a){var b=+new Date;p(a);return a in c&&c.__jstorage_meta.TTL&&c.__jstorage_meta.TTL[a]?(a=c.__jstorage_meta.TTL[a]-b)||0:0},flush:function(){c={__jstorage_meta:{CRC32:{}}};v();u();r(null,"flushed");return!0},storageObj:function(){function a(){}a.prototype=c;return new a},index:function(){var a=[],b;for(b in c)c.hasOwnProperty(b)&&"__jstorage_meta"!=
b&&a.push(b);return a},storageSize:function(){return z},currentBackend:function(){return h},storageAvailable:function(){return!!h},listenKeyChange:function(a,b){p(a);f[a]||(f[a]=[]);f[a].push(b)},stopListening:function(a,b){p(a);if(f[a])if(b)for(var c=f[a].length-1;0<=c;c--)f[a][c]==b&&f[a].splice(c,1);else delete f[a]},subscribe:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");s[a]||(s[a]=[]);s[a].push(b)},publish:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");
c.__jstorage_meta||(c.__jstorage_meta={});c.__jstorage_meta.PubSub||(c.__jstorage_meta.PubSub=[]);c.__jstorage_meta.PubSub.unshift([+new Date,a,b]);v();u()},reInit:function(){C()},noConflict:function(a){delete window.$.jStorage;a&&(window.jStorage=this);return this}};(function(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(l=window.localStorage,h="localStorage",q=l.jStorage_update)}catch(c){}else if("globalStorage"in
window)try{window.globalStorage&&(l="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],h="globalStorage",q=l.jStorage_update)}catch(f){}else if(d=document.createElement("link"),d.addBehavior){d.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(d);try{d.load("jStorage")}catch(e){d.setAttribute("jStorage","{}"),d.save("jStorage"),d.load("jStorage")}a="{}";try{a=d.getAttribute("jStorage")}catch(n){}try{q=
d.getAttribute("jStorage_update")}catch(g){}l.jStorage=a;h="userDataBehavior"}else{d=null;return}D();w();"localStorage"==h||"globalStorage"==h?"addEventListener"in window?window.addEventListener("storage",t,!1):document.attachEvent("onstorage",t):"userDataBehavior"==h&&setInterval(t,1E3);E();"addEventListener"in window&&window.addEventListener("pageshow",function(a){a.persisted&&t()},!1)})()})();
;
/*! Groucho - v0.2.3 - 2017-05-07
* https://github.com/tableau-mkt/groucho
* Copyright (c) 2017 Josh Lind; Licensed MIT */
var groucho=window.groucho||{};!function($,groucho){groucho.getFavoriteTerms=function(vocab,returnAll,threshold){function collectTerms(vocName,i){for(var tid in results[i][termProp][vocName])returnTerms.hasOwnProperty(vocName)||(returnTerms[vocName]={}),returnTerms[vocName].hasOwnProperty(tid)?returnTerms[vocName][tid].count++:returnTerms[vocName][tid]={name:results[i][termProp][vocName][tid],count:1}}function makeArray(obj){var arr=[];for(var i in obj)obj[i].id=i,arr.push(obj[i]);return arr}function isEmpty(obj){for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}var vocName,results=groucho.getActivities("browsing"),termProp=groucho.config.taxonomyProperty,pages=[],returnTerms={};if(vocab=vocab||"*",returnAll=returnAll||!1,threshold=threshold||groucho.config.favThreshold,void 0!==termProp){for(var i in results)if(results.hasOwnProperty(i)&&"undefined"==typeof pages[results[i].url]&&results[i].hasOwnProperty(termProp))if(pages[results[i].url]=!0,"*"===vocab)for(vocName in results[i][termProp])collectTerms(vocName,i);else results[i][termProp].hasOwnProperty(vocab)&&collectTerms(vocab,i);if(!returnAll)for(vocName in returnTerms)!function(vocName){var topCount=threshold;for(var tid in returnTerms[vocName])returnTerms[vocName][tid].count>=topCount&&(topCount=returnTerms[vocName][tid].count);for(tid in returnTerms[vocName])returnTerms[vocName][tid].count<topCount&&delete returnTerms[vocName][tid];isEmpty(returnTerms[vocName])&&delete returnTerms[vocName]}(vocName);if("*"===vocab){for(vocName in returnTerms)returnTerms[vocName]=makeArray(returnTerms[vocName]);!1===returnAll&&(groucho.favoriteTerms=returnTerms)}else returnTerms=makeArray(returnTerms[vocab])}return returnTerms}}(window.jQuery||window.Zepto||window.$,groucho);var groucho=window.groucho||{};!function($,groucho){var defaults={taxonomyProperty:"tags",trackExtent:50,favThreshold:1,trackProperties:["title","type","tags"],lastClicked:"a",ttl:0,addons:{}};for(var config in defaults)groucho.config.hasOwnProperty(config)||(groucho.config[config]=defaults[config]);groucho.userDeferred=groucho.userDeferred||$.Deferred(),groucho.favoriteTerms=!1,$(document).ready(function(){groucho.schema(),groucho.trackOrigins(),groucho.trackHit(),groucho.trackClicks()})}(window.jQuery||window.Zepto||window.$,groucho);var groucho=window.groucho||{};!function($,groucho){var defaultStorage,error;error=function(){return console.log("No localStorage backend libary"),!1},groucho.storage||(defaultStorage=$.hasOwnProperty("jStorage")&&"object"==typeof $.jStorage,groucho.storage={set:defaultStorage?function(id,value,ttl){return ttl=ttl||groucho.config.ttl||0,$.jStorage.set(id,value,{TTL:ttl})}:error,get:defaultStorage?function(id){return $.jStorage.get(id)}:error,remove:defaultStorage?function(id){return $.jStorage.deleteKey(id)}:error,index:defaultStorage?function(){return $.jStorage.index()}:error,available:defaultStorage?function(){return $.jStorage.storageAvailable()}:error,clear:defaultStorage?function(){return $.jStorage.flush()}:error})}(window.jQuery||window.Zepto||window.$,groucho);var groucho=window.groucho||{};!function($,groucho){groucho.trackOrigins=function(){var n=(new Date).getTime(),hit={timestamp:n,url:window.location.href};groucho.storage.get("user.sessionOrigin")&&document.referrer||groucho.storage.set("user.sessionOrigin",hit),groucho.storage.get("user.origin")||(hit.referrer=document.referrer,groucho.storage.set("user.origin",hit)),groucho.userDeferred.resolve()},groucho.trackHit=function(){var dlHelper=new DataLayerHelper(dataLayer),trackIds=groucho.config.trackProperties,trackVals={url:window.location.href};if("undefined"!=typeof dataLayer)for(var i in trackIds)trackIds.hasOwnProperty(i)&&void 0!==dlHelper.get(trackIds[i])&&(trackVals[trackIds[i]]=dlHelper.get(trackIds[i]));groucho.createActivity("browsing",trackVals)},groucho.trackClicks=function(){groucho.config.lastClicked&&"function"==typeof $.fn.on&&($(document).on("click.groucho",groucho.config.lastClicked,function(){groucho.storage.set("user.lastClicked",$(this).text())}),$(groucho.config.lastClicked).on("click.groucho",function(){groucho.storage.set("user.lastClicked",$(this).text())}))}}(window.jQuery||window.Zepto||window.$,groucho);var groucho=window.groucho||{};!function($,groucho){groucho.userSet=function(data,keepExisting,ttl){var userProperty;for(var property in data)data.hasOwnProperty(property)&&"string"==typeof property&&(keepExisting&&null!==(userProperty=groucho.storage.get("user."+property))&&userProperty!==undefined||groucho.storage.set("user."+property,data[property],ttl))},groucho.userGet=function(property){var propertyName,index=groucho.storage.index(),userProperties={};if(void 0!==property)return groucho.storage.get("user."+property);for(var i in index)"string"==typeof index[i]&&0===index[i].indexOf("user.")&&(propertyName=index[i].replace("user.",""),userProperties[propertyName]=groucho.storage.get(index[i]));return userProperties},groucho.createActivity=function(group,data,ttl){var results=groucho.getActivities(group),n=(new Date).getTime(),diff=0;if(groucho.storage.set("track."+group+"."+n,data,ttl),results.length>=groucho.config.trackExtent){diff=results.length-groucho.config.trackExtent;for(var i=0;i<=diff;i++)groucho.storage.remove(results[i]._key)}},groucho.getActivities=function(group){var record,results=groucho.storage.index(),returnVals=[],matchable=!!group&&new RegExp("^track."+group+".","g");for(var i in results)results.hasOwnProperty(i)&&(group?null!==results[i].match(matchable)&&(record=groucho.storage.get(results[i]),record._key=results[i],returnVals.push(record)):(record=groucho.storage.get(results[i]),record._key=results[i],returnVals.push(record)));return returnVals.sort(function(a,b){return a.hasOwnProperty("_key")&&a._key.match(/\./)&&b.hasOwnProperty("_key")&&b._key.match(/\./)?parseInt(b._key.split(".")[2],10)>parseInt(a._key.split(".")[2],10)?-1:1:0}),returnVals},groucho.schema=function(){var keys={"user.sessionOrigin":{oldKey:"user.session_origin",version:"0.2.0"}};for(var newKey in keys)null===groucho.storage.get(newKey)&&null!==groucho.storage.get(keys[newKey].oldKey)&&(groucho.storage.set(newKey,groucho.storage.set(keys[newKey].oldKey)),groucho.storage.remove(keys[newKey].oldKey))}}(window.jQuery||window.Zepto||window.$,groucho);;
var Tabia=window.Tabia||{};!function($,Drupal,Tabia,window,_,groucho){Drupal.behaviors.tableauSiteWarnings={attach:function(context,settings){context===document&&(function(){"number"==typeof(new Image).naturalHeight&&$("img").one("error",function(){var imgUrlParsed=Tabia.util.parseUrl(this.src);_.contains(settings.tableauSite.imgFailWhitelist,imgUrlParsed.host)||Tabia.warning("Image load error",{type:"imgFail",data:{host:imgUrlParsed.host,src:this.src,url:window.location.href,elClass:this.className}})}).each(function(){!this.complete||this.naturalHeight||this.naturalWidth||$(this).triggerHandler("error")})}(),function(){var priorLang,dlHelper=new DataLayerHelper(dataLayer),referrer=Tabia.util.parseUrl(document.referrer),isPageType="page"===dlHelper.get("entityBundle"),isAnon=0===dlHelper.get("userUid"),isEnglish=""===settings.pathPrefix;Drupal.behaviors.dataLayer&&"function"==typeof Drupal.behaviors.dataLayer.langPrefixes&&(priorLang=_.contains(Drupal.behaviors.dataLayer.langPrefixes(),referrer.segments[0])),priorLang&&isEnglish&&isAnon&&isPageType&&(referrer.path.replace("/"+referrer.segments[0],"")===window.location.pathname||Tabia.warning("Language was lost via link",{type:"langLost",data:{text:groucho.storage.get("user.lastClicked"),referrerPath:referrer.path,langSourcePrefix:referrer.segments[0]}}))}())}}}(jQuery,Drupal,Tabia,window,_,groucho);;
var Tabia=window.Tabia||{};!function($){var $element=$(".autofocus:visible").last();$.fn.focusWithoutScrolling=function(){var x=window.scrollX!==undefined?window.scrollX:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y=window.scrollY!==undefined?window.scrollY:(document.documentElement||document.body.parentNode||document.body).scrollTop;this.focus(),setTimeout(function(){window.scrollTo(x,y)},1)},$(function(){Tabia.util.isElementInViewPort($element)&&("undefined"!=typeof window.tableau?setTimeout(function(){$element.focusWithoutScrolling()},3e3):$element.focusWithoutScrolling())})}(jQuery);;
!function($,window,Tabia,groucho,_){function processItem(item){var callback=item.hasOwnProperty("callback")?Tabia.util.stringProperty(window,item.callback):$.jQueue.test;if(item.meta.status="processing",$.jStorage.set(item._key,item),Tabia.debug("Item callback attempt",{type:nameSpace}),"function"!=typeof callback)return"callback not a function: "+item.callback;$.when(callback(item)).done(function(){var callbackName=callback.hasOwnProperty("name")?callback.name:"not available";return $.jStorage.deleteKey(item._key),Tabia.notice("Callback complete",{type:nameSpace,data:{callback:callbackName}}),!1}).fail(function(){return item.meta.status="ready",$.jStorage.set(item._key,item),Tabia.debug("Item callback rejected",{type:nameSpace}),!1})}function queueCheck(item,queue){var stillExists=$.jStorage.get(item._key,!1),checkSubmitInterval=500;queue.length&&(Drupal.settings.tableauPremium&&Drupal.settings.tableauPremium.checkSubmitInterval&&(checkSubmitInterval=Drupal.settings.tableauPremium.checkSubmitInterval),stillExists?(Tabia.debug("Formframe not posted yet. Item: "+item._key,{type:nameSpace}),setTimeout(queueCheck,checkSubmitInterval,item,queue)):(Tabia.debug("Process next item on queue.",{type:nameSpace}),nextItem(queue)))}function nextItem(queue){var error,item=queue.shift();if(item===undefined)return void $(document).trigger("jQueue:empty");if("object"==typeof item&&item.meta&&item.meta.status){if("processing"===item.meta.status)return;"new"===item.meta.status||"ready"===item.meta.status?(error=processItem(item),Tabia.debug("Waiting to process next item on queue.",{type:nameSpace}),queueCheck(item,queue)):error="unknown item status: "+item.meta.status}else $.jStorage.setTTL(item._key,1e4),error="bad item type or missing required properties";error&&Tabia.error("Item error: "+error,{type:nameSpace,data:{error:error}})}var nameSpace="jQueue",dlHelper=new DataLayerHelper(dataLayer);$.jQueue={push:function(data,callbackName,options){var queueAddCheck,initLength,attempts;options=options||{},options.processNow&&(initLength=groucho.getActivities(nameSpace).length,attempts=0,Tabia.debug("Monitoring for pushes to attempt immediate processing. Length: "+initLength,{type:nameSpace}),queueAddCheck=window.setInterval(function(){var queue=groucho.getActivities(nameSpace);Tabia.debug("Checking for item addition. Length: "+queue.length,{type:nameSpace}),6===attempts&&clearInterval(queueAddCheck),queue.length>initLength&&(clearInterval(queueAddCheck),nextItem(queue)),attempts++},500)),groucho.createActivity(nameSpace,{callback:callbackName,data:data,meta:{status:"new",url:window.location.href,entityBundle:dlHelper.get("entityBundle"),entityId:dlHelper.get("entityId"),entityTnid:dlHelper.get("entityTnid")}}),Tabia.debug("Item added",{type:nameSpace,data:_.extend(data,{callback:callbackName})})},test:function(item){var completed=$.Deferred();return Tabia.warning("Test function used",{type:nameSpace,data:_.extend(item.data,{_meta:item.meta})}),window.setTimeout(completed.resolve,5e3),completed.promise()},restart:function(){nextItem(groucho.getActivities(nameSpace))}},$(window).load(function(){groucho.getActivities(nameSpace).length&&0!==dlHelper.get("userUid")&&(Tabia.debug("Queue Started.",{type:nameSpace}),nextItem(groucho.getActivities(nameSpace)))})}(window.jQuery||window.Zepto||window.$,window,Tabia,groucho,_);;
