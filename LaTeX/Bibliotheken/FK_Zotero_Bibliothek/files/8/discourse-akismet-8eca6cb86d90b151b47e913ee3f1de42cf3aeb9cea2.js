define("discourse/plugins/discourse-akismet/admin/models/akismet-queue",["exports","discourse/lib/ajax"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={confirmSpam:function(e){return(0,t.ajax)("/admin/plugins/akismet/confirm_spam",{type:"POST",data:{post_id:e.get("id")}})},allow:function(e){return(0,t.ajax)("/admin/plugins/akismet/allow",{type:"POST",data:{post_id:e.get("id")}})},dismiss:function(e){return(0,t.ajax)("/admin/plugins/akismet/dismiss",{type:"POST",data:{post_id:e.get("id")}})},deleteUser:function(e){return(0,t.ajax)("/admin/plugins/akismet/delete_user",{type:"DELETE",data:{user_id:e.get("user_id"),post_id:e.get("id")}})},findAll:function(){return(0,t.ajax)("/admin/plugins/akismet/index.json").then(function(e){return e.posts=e.posts.map(function(e){return Discourse.Post.create(e)}),e})}}}),define("discourse/plugins/discourse-akismet/discourse/routes/admin-plugins-akismet",["exports","discourse/plugins/discourse-akismet/admin/models/akismet-queue"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=Discourse.Route.extend({_enabled:!1,_stats:null,model:function(){var e=this;return t.default.findAll().then(function(t){return e._enabled=t.enabled,e._stats=t.stats,t.posts})},setupController:function(e,t){e.setProperties({model:t,enabled:this._enabled,stats:this._stats})}})}),define("discourse/plugins/discourse-akismet/discourse/controllers/admin-plugins-akismet",["exports","discourse/plugins/discourse-akismet/admin/models/akismet-queue"],function(e,t){"use strict";function s(){bootbox.alert(I18n.t("generic_error"))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=Ember.Controller.extend({sortedPosts:Ember.computed.sort("model","postSorting"),postSorting:["id:asc"],enabled:!1,performingAction:!1,actions:{refresh:function(){var e=this;this.set("performingAction",!0),t.default.findAll().then(function(t){e.set("stats",t.stats),e.set("model",t.posts)}).catch(s).finally(function(){e.set("performingAction",!1)})},confirmSpamPost:function(e){var n=this;this.set("performingAction",!0),t.default.confirmSpam(e).then(function(){n.get("model").removeObject(e),n.incrementProperty("stats.confirmed_spam"),n.decrementProperty("stats.needs_review")}).catch(s).finally(function(){n.set("performingAction",!1)})},allowPost:function(e){var n=this;this.set("performingAction",!0),t.default.allow(e).then(function(){n.incrementProperty("stats.confirmed_ham"),n.decrementProperty("stats.needs_review"),n.get("model").removeObject(e)}).catch(s).finally(function(){n.set("performingAction",!1)})},deleteUser:function(e){var n=this;bootbox.confirm(I18n.t("akismet.delete_prompt",{username:e.get("username")}),function(a){!0===a&&(n.set("performingAction",!0),t.default.deleteUser(e).then(function(){n.get("model").removeObject(e),n.incrementProperty("stats.confirmed_spam"),n.decrementProperty("stats.needs_review")}).catch(s).finally(function(){n.set("performingAction",!1)}))})},dismiss:function(e){var n=this;this.set("performingAction",!0),t.default.dismiss(e).then(function(){n.get("model").removeObject(e)}).catch(s).finally(function(){n.set("performingAction",!1)})}}})}),Ember.TEMPLATES["javascripts/components/reviewable-akismet-post"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["&default"],"statements":[[1,[29,"reviewable-topic-link",null,[["reviewable","tagName"],[[25,["reviewable"]],""]]],false],[0,"\\n"],[7,"div"],[11,"class","post-contents-wrapper"],[9],[0,"\\n"],[1,[29,"reviewable-created-by",null,[["user","tagName"],[[25,["reviewable","target_created_by"]],""]]],false],[0,"\\n"],[7,"div"],[11,"class","post-contents"],[9],[0,"\\n  "],[1,[29,"reviewable-created-by-name",null,[["user","tagName"],[[25,["reviewable","target_created_by"]],""]]],false],[0,"\\n  "],[7,"div"],[11,"class","post-body"],[9],[0,"\\n    "],[1,[25,["reviewable","payload","post_cooked"]],true],[0,"\\n  "],[10],[0,"\\n  "],[15,1],[0,"\\n"],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/reviewable-akismet-post"}}),Ember.TEMPLATES["javascripts/components/reviewable-akismet-user"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["&default"],"statements":[[7,"div"],[11,"class","reviewable-user-info"],[9],[0,"\\n  "],[7,"div"],[11,"class","reviewable-user-fields"],[9],[0,"\\n    "],[7,"div"],[11,"class","reviewable-user-details username"],[9],[0,"\\n      "],[7,"div"],[11,"class","name"],[9],[1,[29,"i18n",["review.user.username"],null],false],[10],[0,"\\n      "],[7,"div"],[11,"class","value"],[9],[0,"\\n        "],[1,[25,["reviewable","payload","username"]],false],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n    "],[1,[29,"reviewable-field",null,[["classes","name","value"],["reviewable-user-details name",[29,"i18n",["review.user.name"],null],[25,["reviewable","payload","name"]]]]],false],[0,"\\n    \\n    "],[1,[29,"reviewable-field",null,[["classes","name","value"],["reviewable-user-details email",[29,"i18n",["review.user.email"],null],[25,["reviewable","payload","email"]]]]],false],[0,"\\n\\n    "],[1,[29,"reviewable-field",null,[["classes","name","value"],["reviewable-user-details bio",[29,"i18n",["review.user.bio"],null],[25,["reviewable","payload","bio"]]]]],false],[0,"\\n  "],[10],[0,"\\n  \\n  "],[15,1],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/reviewable-akismet-user"}}),Ember.TEMPLATES["javascripts/admin/plugins-akismet"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["post"],"statements":[[4,"if",[[25,["enabled"]]],null,{"statements":[[4,"if",[[25,["stats"]]],null,{"statements":[[0,"    "],[7,"table"],[11,"class","tbl spam-stats"],[9],[0,"\\n      "],[7,"tr"],[9],[0,"\\n        "],[7,"th"],[9],[1,[29,"i18n",["akismet.stats.scanned"],null],false],[10],[0,"\\n        "],[7,"th"],[9],[1,[29,"i18n",["akismet.stats.needs_review"],null],false],[10],[0,"\\n        "],[7,"th"],[9],[1,[29,"i18n",["akismet.stats.confirmed_spam"],null],false],[10],[0,"\\n        "],[7,"th"],[9],[1,[29,"i18n",["akismet.stats.confirmed_ham"],null],false],[10],[0,"\\n      "],[10],[0,"\\n      "],[7,"tr"],[9],[0,"\\n        "],[7,"td"],[9],[1,[25,["stats","scanned"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[25,["stats","needs_review"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[25,["stats","confirmed_spam"]],false],[10],[0,"\\n        "],[7,"td"],[9],[1,[25,["stats","confirmed_ham"]],false],[10],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"if",[[25,["currentUser","admin"]]],null,{"statements":[[0,"    "],[1,[29,"d-button",null,[["label","icon","class","action"],["admin.plugins.change_settings","cog","settings-button",[29,"route-action",["showSettings"],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"\\n  "],[1,[29,"d-button",null,[["action","icon","class","label","disabled"],[[29,"action",[[24,0,[]],"refresh"],null],"refresh","btn-primary","akismet.refresh",[25,["performingAction"]]]]],false],[0,"\\n\\n"],[4,"if",[[25,["model","length"]]],null,{"statements":[[0,"    "],[7,"h3"],[11,"class","review-queue"],[9],[1,[29,"i18n",["akismet.posts_to_review"],null],false],[10],[0,"\\n\\n    "],[7,"div"],[11,"class","row"],[9],[0,"\\n      "],[7,"table"],[11,"class","akismet-queue"],[9],[0,"\\n        "],[7,"tbody"],[9],[0,"\\n"],[4,"each",[[25,["sortedPosts"]]],null,{"statements":[[0,"          "],[7,"tr"],[9],[0,"\\n            "],[7,"td"],[11,"class","cooked"],[9],[0,"\\n\\n              "],[7,"div"],[11,"class","post-info"],[9],[0,"\\n                "],[4,"link-to",null,[["route","models"],["adminUser",[29,"array",[[24,1,["user_id"]],[24,1,["username"]]],null]]],{"statements":[[1,[29,"avatar",[[24,1,[]]],[["imageSize"],["small"]]],false],[0," "],[1,[24,1,["username"]],false]],"parameters":[]},null],[0,"\\n                "],[7,"a"],[12,"href",[24,1,["url"]]],[11,"target","_blank"],[11,"class","post-link"],[9],[0,"#"],[1,[24,1,["id"]],false],[10],[0,"\\n              "],[10],[0,"\\n              "],[1,[24,1,["excerpt"]],true],[0,"\\n              "],[7,"div"],[11,"class","queue-actions"],[9],[0,"\\n                "],[1,[29,"d-button",null,[["action","actionParam","icon","class","label","disabled"],[[29,"action",[[24,0,[]],"confirmSpamPost"],null],[24,1,[]],"check","btn-primary","akismet.confirm_spam",[25,["performingAction"]]]]],false],[0,"\\n\\n                "],[1,[29,"d-button",null,[["action","actionParam","icon","label","disabled"],[[29,"action",[[24,0,[]],"allowPost"],null],[24,1,[]],"far-thumbs-up","akismet.not_spam",[25,["performingAction"]]]]],false],[0,"\\n\\n                "],[1,[29,"d-button",null,[["action","actionParam","icon","label","disabled"],[[29,"action",[[24,0,[]],"dismiss"],null],[24,1,[]],"times","akismet.dismiss",[25,["performingAction"]]]]],false],[0,"\\n\\n\\n"],[4,"if",[[24,1,["user_id"]]],null,{"statements":[[0,"                  "],[1,[29,"d-button",null,[["action","actionParam","icon","class","label","disabled"],[[29,"action",[[24,0,[]],"deleteUser"],null],[24,1,[]],"far-trash-alt","btn-danger","akismet.confirm_delete",[25,["performingAction"]]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"              "],[10],[0,"\\n            "],[10],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[1]},null],[0,"        "],[10],[0,"\\n      "],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},{"statements":[[4,"if",[[25,["currentUser","admin"]]],null,{"statements":[[0,"    "],[1,[29,"d-button",null,[["label","icon","class","action"],["akismet.change_settings","cog","settings-button",[29,"route-action",["showSettings"],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"  "],[1,[29,"i18n",["akismet.not_enabled"],null],true],[0,"\\n"]],"parameters":[]}]],"hasEval":false}',meta:{moduleName:"javascripts/admin/plugins-akismet"}}),Ember.TEMPLATES["javascripts/connectors/site-map-links/akismet-review"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[25,["currentUser","staff"]]],null,{"statements":[[0,"  "],[7,"li"],[9],[0,"\\n"],[4,"link-to",null,[["route"],["adminPlugins.akismet"]],{"statements":[[0,"      "],[1,[29,"i18n",["akismet.title"],null],false],[0,"\\n"],[4,"if",[[25,["currentUser","akismet_review_count"]]],null,{"statements":[[0,"        "],[7,"span"],[11,"class","badge-notification flagged-posts"],[9],[1,[25,["currentUser","akismet_review_count"]],false],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"  "],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/site-map-links/akismet-review"}}),define("discourse/plugins/discourse-akismet/discourse/akismet-route-map",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={resource:"admin.adminPlugins",path:"/plugins",map:function(){this.route("akismet")}}}),define("discourse/plugins/discourse-akismet/discourse/initializers/add-akismet-count",["exports","discourse/lib/plugin-api"],function(e,t){"use strict";function s(e){e.addFlagProperty("currentUser.akismet_review_count"),e.decorateWidget("hamburger-menu:admin-links",function(e){return e.attach("link",{route:"adminPlugins.akismet",label:"akismet.title",badgeCount:"akismet_review_count",badgeClass:"flagged-posts"})})}function n(e,t){e.subscribe("/akismet_counts",function(e){e&&t.set("akismet_review_count",e.akismet_review_count||0)})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"add-akismet-count",before:"register-discourse-location",after:"inject-objects",initialize:function(e){if(!e.lookup("site:main").get("reviewable_api_enabled")){var a=e.lookup("current-user:main");a&&a.get("staff")&&((0,t.withPluginApi)("0.4",s),n(e.lookup("message-bus:main"),a))}}}});
//# sourceMappingURL=https://sjc5.discourse-cdn.com/elastic/assets/plugins/discourse-akismet-8eca6cb86d90b151b47e913ee3f1de42cf3aeb9cea280413f47a015b1c783dbd.js.map