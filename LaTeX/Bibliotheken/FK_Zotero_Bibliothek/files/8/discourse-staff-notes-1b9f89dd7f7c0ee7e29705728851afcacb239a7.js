define("discourse/plugins/discourse-staff-notes/discourse/adapters/staff-note",["exports","discourse/adapters/rest","discourse/lib/ajax"],function(e,t,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.default.extend({destroyRecord:function(e,t,o){var n=this.pathFor(e,t,o.get("id")),a=o.get("user_id");return(0,s.ajax)(n+"?user_id="+a,{method:"DELETE"})}})}),define("discourse/plugins/discourse-staff-notes/discourse/components/show-staff-notes",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,o,n;e.default=Ember.Component.extend((s=(0,t.default)("count"),o={tagName:"",showCount:function(e){return e&&e>0},actions:{show:function(){this.sendAction("show")}}},function(e,t,s,o,n){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=s.slice().reverse().reduce(function(s,o){return o(e,t,s)||s},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(o,"showCount",[s],(n=Object.getOwnPropertyDescriptor(o,"showCount"),n=n?n.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return n}}),o),o))}),define("discourse/plugins/discourse-staff-notes/discourse/controllers/staff-notes",["exports","ember-addons/ember-computed-decorators","discourse/lib/ajax-error"],function(e,t,s){"use strict";function o(e,t,s,o,n){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=s.slice().reverse().reduce(function(s,o){return o(e,t,s)||s},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0});var n,a,i;e.default=Ember.Controller.extend((n=(0,t.on)("init"),a=(0,t.default)("newNote","saving"),i={newNote:null,saving:!1,user:null,reset:function(){this.setProperties({newNote:null,saving:!1,callback:null})},attachDisabled:function(e,t){return t||!e||0===e.length},_refreshCount:function(){var e=this.get("callback");e&&e(this.get("model.length"))},actions:{attachNote:function(){var e=this,t=this.store.createRecord("staff-note"),o=parseInt(this.get("userId"));this.set("saving",!0);var n={raw:this.get("newNote"),user_id:o},a=this.get("postId");a&&(n.post_id=parseInt(a)),t.save(n).then(function(){e.set("newNote",""),e.get("model").insertAt(0,t),e._refreshCount()}).catch(s.popupAjaxError).finally(function(){return e.set("saving",!1)})},removeNote:function(e){var t=this;bootbox.confirm(I18n.t("staff_notes.delete_confirm"),I18n.t("no_value"),I18n.t("yes_value"),function(o){o&&e.destroyRecord().then(function(){t.get("model").removeObject(e),t._refreshCount()}).catch(s.popupAjaxError)})}}},o(i,"reset",[n],Object.getOwnPropertyDescriptor(i,"reset"),i),o(i,"attachDisabled",[a],Object.getOwnPropertyDescriptor(i,"attachDisabled"),i),i))}),Ember.TEMPLATES["javascripts/components/show-staff-notes"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"a"],[11,"href",""],[11,"class","btn"],[9],[0,"\\n  "],[1,[29,"d-icon",["pencil-alt"],null],false],[0,"\\n"],[4,"if",[[25,["showCount"]]],null,{"statements":[[0,"    "],[1,[29,"i18n",["staff_notes.show"],[["count"],[[25,["count"]]]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"    "],[1,[29,"i18n",["staff_notes.title"],null],false],[0,"\\n"]],"parameters":[]}],[3,"action",[[24,0,[]],"show"]],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/show-staff-notes"}}),Ember.TEMPLATES["javascripts/modal/staff-notes"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["n"],"statements":[[4,"d-modal-body",null,[["class"],["staff-notes-modal"]],{"statements":[[0,"  "],[1,[29,"textarea",null,[["value"],[[25,["newNote"]]]]],false],[0,"\\n  "],[1,[29,"d-button",null,[["action","label","class","disabled"],["attachNote","staff_notes.attach","btn-primary",[25,["attachDisabled"]]]]],false],[0,"\\n\\n"],[4,"each",[[25,["model"]]],null,{"statements":[[0,"    "],[7,"div"],[11,"class","staff-note"],[9],[0,"\\n      "],[7,"div"],[11,"class","posted-by"],[9],[0,"\\n"],[4,"user-link",null,[["user"],[[24,1,["created_by"]]]],{"statements":[[0,"          "],[1,[29,"avatar",[[24,1,["created_by"]]],[["imageSize"],["small"]]],false],[0,"\\n"]],"parameters":[]},null],[0,"      "],[10],[0,"\\n      "],[7,"div"],[11,"class","note-contents"],[9],[0,"\\n        "],[7,"div"],[11,"class","note-info"],[9],[0,"\\n          "],[7,"span"],[11,"class","username"],[9],[1,[24,1,["created_by","username"]],false],[10],[0,"\\n          "],[7,"span"],[11,"class","post-date"],[9],[1,[29,"age-with-tooltip",[[24,1,["created_at"]]],null],false],[10],[0,"\\n\\n"],[4,"if",[[24,1,["can_delete"]]],null,{"statements":[[0,"            "],[7,"span"],[11,"class","controls"],[9],[0,"\\n              "],[1,[29,"d-button",null,[["action","icon","class","title"],[[29,"action",[[24,0,[]],"removeNote",[24,1,[]]],null],"far-trash-alt","btn-small btn-danger","staff_notes.remove"]]],false],[0,"\\n            "],[10],[0,"\\n"]],"parameters":[]},null],[0,"        "],[10],[0,"\\n\\n        "],[7,"div"],[11,"class","cooked"],[9],[0,"\\n          "],[1,[29,"cook-text",[[24,1,["raw"]]],null],false],[0,"\\n        "],[10],[0,"\\n\\n"],[4,"if",[[24,1,["post_id"]]],null,{"statements":[[0,"          "],[7,"a"],[11,"class","btn btn-small"],[12,"href",[24,1,["post_url"]]],[9],[0,"\\n            "],[1,[29,"i18n",["staff_notes.show_post"],null],false],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[]},null],[0,"      "],[10],[0,"\\n\\n      "],[7,"div"],[11,"class","clearfix"],[9],[10],[0,"\\n    "],[10],[0,"\\n"]],"parameters":[1]},null]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/modal/staff-notes"}}),Ember.TEMPLATES["javascripts/connectors/admin-dashboard-moderation-bottom/recent-staff-notes-report-table"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[25,["siteSettings","staff_notes_enabled"]]],null,{"statements":[[0,"  "],[1,[29,"admin-report",null,[["dataSourceName","startDate","endDate"],["staff_notes",[25,["lastWeek"]],[25,["endDate"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/connectors/admin-dashboard-moderation-bottom/recent-staff-notes-report-table"}}),define("discourse/plugins/discourse-staff-notes/discourse/initializers/enable-staff-notes",["exports","discourse/lib/plugin-api","discourse-common/lib/icon-library","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes"],function(e,t,s,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"enable-staff-notes",initialize:function(e){var n=e.lookup("site-settings:main"),a=e.lookup("current-user:main");if(n.staff_notes_enabled&&a&&a.staff){var i=e.lookup("store:main");(0,t.withPluginApi)("0.8.15",function(e){function t(){var e=this;(0,o.showStaffNotes)(i,this.attrs.user_id,function(t){e.sendWidgetAction("refreshStaffNotes",t)},{postId:this.attrs.id})}e.attachWidgetAction("post","refreshStaffNotes",function(e){var t=this.model.get("user_custom_fields")||{};t.staff_notes_count=e,this.model.set("user_custom_fields",t)}),e.modifyClass("controller:user",{staffNotesCount:null,_modelChanged:function(){this.set("staffNotesCount",this.get("model.custom_fields.staff_notes_count")||0)}.observes("model").on("init"),actions:{showStaffNotes:function(){var e=this,t=this.get("model");(0,o.showStaffNotes)(i,t.get("id"),function(t){return e.set("staffNotesCount",t)})}}});var a=e.container.lookup("site:main").mobileView,r=a?"before":"after";e.decorateWidget("poster-name:"+r,function(e){if(!e.widget.settings.hideNotes){return(e.attrs.userCustomFields||{}).staff_notes_count>0?e.attach("staff-notes-icon"):void 0}}),e.decorateWidget("post-avatar:after",function(e){if(e.widget.settings.showNotes){return(e.attrs.userCustomFields||{}).staff_notes_count>0?e.attach("staff-notes-icon"):void 0}}),e.decorateWidget("post-admin-menu:after",function(e){return e.attach("post-admin-menu-button",{icon:"pencil",label:"staff_notes.attach",action:"showStaffNotes"})}),e.attachWidgetAction("post","showStaffNotes",t),e.createWidget("staff-notes-icon",{tagName:"span.staff-notes-icon",click:t,html:function(){return n.enable_emoji?this.attach("emoji",{name:"pencil"}):(0,s.iconNode)("sticky-note")}})})}}}}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes",["exports","discourse/lib/show-modal","discourse/lib/load-script"],function(e,t,s){"use strict";function o(e,o,n,a){return a=a||{},(0,s.default)("defer/html-sanitizer-bundle").then(function(){return e.find("staff-note",{user_id:o}).then(function(e){var s=(0,t.default)("staff-notes",{model:e,title:"staff_notes.title",addModalBodyView:!0});return s.reset(),s.set("userId",o),s.set("callback",n),s.set("postId",a.postId),s})})}Object.defineProperty(e,"__esModule",{value:!0}),e.showStaffNotes=o}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/admin-user-controls-after/add-staff-notes-button",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/user-profile-controls/show-notes-on-profile"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.default}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/user-profile-controls/show-notes-on-profile",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes","discourse-common/lib/get-owner"],function(e,t,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){var s=t.siteSettings,o=t.currentUser;return s.staff_notes_enabled&&o&&o.staff},setupComponent:function(e,t){var s=e.model;t.set("staffNotesCount",s.get("staff_notes_count")||s.get("custom_fields.staff_notes_count")||0)},actions:{showStaffNotes:function(){var e=this,o=(0,s.getOwner)(this).lookup("store:main"),n=this.get("args.model");(0,t.showStaffNotes)(o,n.get("id"),function(t){return e.set("staffNotesCount",t)})}}}}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/flagged-post-controls/show-staff-notes-on-flags",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes","discourse-common/lib/get-owner"],function(e,t,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){return t.siteSettings.staff_notes_enabled},setupComponent:function(e,t){var s=e.flaggedPost.get("user");t.set("staffNotesCount",s.get("custom_fields.staff_notes_count")||0)},actions:{showStaffNotes:function(){var e=this,o=(0,s.getOwner)(this).lookup("store:main"),n=this.get("args.flaggedPost.user");(0,t.showStaffNotes)(o,n.get("id"),function(t){return e.set("staffNotesCount",t)})}}}}),define("discourse/plugins/discourse-staff-notes/discourse-staff-notes/connectors/user-card-post-names/show-staff-notes-on-card",["exports","discourse/plugins/discourse-staff-notes/discourse-staff-notes/lib/staff-notes","discourse-common/lib/get-owner","discourse/lib/text"],function(e,t,s,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={shouldRender:function(e,t){var s=t.siteSettings,o=t.currentUser;return s.staff_notes_enabled&&o&&o.staff},setupComponent:function(e,t){var s=e.user,n=s.get("staff_notes_count")||s.get("custom_fields.staff_notes_count")||0;t.set("staffNotesCount",n),t.set("emojiEnabled",t.siteSettings.enable_emoji),t.set("emojiUrl",(0,o.emojiUrlFor)("pencil")),t.set("user",s),t.set("staffNotesTitle",I18n.t("staff_notes.show",{count:n}))},actions:{showStaffNotes:function(){var e=this;this.parentView.parentView._close();var o=(0,s.getOwner)(this).lookup("store:main"),n=this.get("args.user");(0,t.showStaffNotes)(o,n.get("id"),function(t){return e.set("staffNotesCount",t)})}}}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/admin-user-controls-after/add-staff-notes-button"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[29,"show-staff-notes",null,[["show","count"],["showStaffNotes",[25,["staffNotesCount"]]]]],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/admin-user-controls-after/add-staff-notes-button"}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/user-profile-controls/show-notes-on-profile"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"li"],[9],[1,[29,"show-staff-notes",null,[["show","count"],["showStaffNotes",[25,["staffNotesCount"]]]]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/user-profile-controls/show-notes-on-profile"}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/flagged-post-controls/show-staff-notes-on-flags"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[25,["staffNotesCount"]]],null,{"statements":[[0,"  "],[1,[29,"show-staff-notes",null,[["show","count"],["showStaffNotes",[25,["staffNotesCount"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/flagged-post-controls/show-staff-notes-on-flags"}}),Ember.TEMPLATES["javascripts/discourse-staff-notes/templates/connectors/user-card-post-names/show-staff-notes-on-card"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[25,["staffNotesCount"]]],null,{"statements":[[0,"  "],[7,"a"],[11,"href",""],[12,"title",[30,[[23,"staffNotesTitle"]]]],[9],[0,"\\n"],[4,"if",[[25,["emojiEnabled"]]],null,{"statements":[[0,"      "],[7,"img"],[12,"src",[23,"emojiUrl"]],[12,"title",[23,"staffNotesTitle"]],[11,"alt","pencil"],[11,"class","emoji"],[9],[10],[0,"\\n"]],"parameters":[]},{"statements":[[0,"      "],[1,[29,"d-icon",["sticky-note"],null],false],[0,"\\n"]],"parameters":[]}],[0,"  "],[3,"action",[[24,0,[]],"showStaffNotes"]],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-staff-notes/templates/connectors/user-card-post-names/show-staff-notes-on-card"}});
//# sourceMappingURL=https://sjc5.discourse-cdn.com/elastic/assets/plugins/discourse-staff-notes-1b9f89dd7f7c0ee7e29705728851afcacb239a795a8f4012c1c97e3d9a33d7c2.js.map