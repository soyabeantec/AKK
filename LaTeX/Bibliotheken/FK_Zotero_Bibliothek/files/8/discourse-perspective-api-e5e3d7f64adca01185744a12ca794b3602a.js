Ember.TEMPLATES["javascripts/composer/perspective-message"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"a"],[11,"href",""],[11,"class","close"],[9],[1,[29,"d-icon",["close"],null],false],[3,"action",[[24,0,[]],"closeMessage"]],[10],[0,"\\n"],[7,"h3"],[9],[1,[29,"i18n",["perspective.perspective_messages"],null],false],[10],[0,"\\n\\n"],[7,"div"],[11,"class","messages"],[9],[0,"\\n  "],[7,"p"],[9],[1,[29,"i18n",["perspective.perspective_warning"],null],false],[10],[0,"\\n"],[10],[0,"\\n\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/composer/perspective-message"}}),define("discourse/plugins/discourse-perspective/initializers/discourse-perspective",["exports","discourse/lib/plugin-api","discourse/lib/ajax"],function(e,s,t){"use strict";function i(e){var s=e.container.lookup("site-settings:main");e.modifyClass("controller:composer",{_perspective_checked:null,perspectiveSave:function(e){var s=this;this.set("_perspective_checked",!0),this.save(e).finally(function(){s.set("_perspective_checked",!1)})},save:function(e){var i=this;if(!this.get("disableSubmit")){this.get("showWarning")||this.set("model.isWarning",!1);var c=this.get("model");if(c.get("cantSubmitPost"))return void this.set("lastValidatedAt",Date.now());var r=!s.perspective_check_private_message&&this.get("topic.isPrivateMessage"),a=!s.perspective_check_secured_categories&&this.get("model.category.read_restricted");if(r||a||this.get("_perspective_checked"))return this._super(e);var n="";["title","raw","reply"].forEach(function(e){var s=c.get(e);s&&(n+=s+" ")}),n.trim(),(0,t.ajax)("/perspective/post_toxicity?concat="+encodeURIComponent(n)).then(function(s){if(s&&void 0!==s.score){var t=I18n.t("perspective.perspective_message"),c=[{label:I18n.t("perspective.composer_continue"),class:"btn",callback:function(){return i.perspectiveSave(e)}},{label:I18n.t("perspective.composer_edit"),class:"btn-primary"}];return void bootbox.dialog(t,c)}i.perspectiveSave(e)}).catch(function(){i.perspectiveSave(e)})}}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"discourse-perspective-api",initialize:function(e){var t=e.lookup("site-settings:main");t.perspective_enabled&&t.perspective_notify_posting_min_toxicity_enable&&(0,s.withPluginApi)("0.8.17",i)}}});
//# sourceMappingURL=https://sjc5.discourse-cdn.com/elastic/assets/plugins/discourse-perspective-api-e5e3d7f64adca01185744a12ca794b3602a933e47df2a05afe586aeffa0f4104.js.map