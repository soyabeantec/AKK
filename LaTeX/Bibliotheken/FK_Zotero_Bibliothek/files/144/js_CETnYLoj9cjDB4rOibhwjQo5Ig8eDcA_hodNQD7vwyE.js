Drupal.locale = { 'pluralFormula': function ($n) { return Number(($n!=1)); }, 'strings': {"":{"Unspecified error":"Unbekannter Fehler","An error occurred. \\n@uri\\n@text":"Es ist ein Fehler aufgetreten. \\n@uri\\n@text","An error occurred. \\n@uri\\n(no information available).":"Es ist ein Fehler aufgetreten. \\n@uri\\n(no information available).","An HTTP error @status occurred. \\n@uri":"Es ist ein HTTP-Fehler @status aufgetreten. \\n@uri","Automatic alias":"Automatischer Alias","Alias: @alias":"Alias: @alias","No alias":"Kein Alias","Not published":"Nicht ver\u00f6ffentlicht","Anonymous":"Gast","By @name on @date":"Von @name am @date","By @name":"Von @name","Published":"Ver\u00f6ffentlicht","Promoted to front page":"Auf der Startseite","Sticky on top of lists":"Oben in Listen","None":"Keine","Not in menu":"Nicht im Men\u00fc","1 attachment":"1 Anhang","@count attachments":"@count Anh\u00e4nge","No attachments":"Keine Anh\u00e4nge","Your search yielded no results":"Die Suche lieferte keine Ergebnisse.","This field is required.":"Dieses Feld ist ein Pflichtfeld.","Configure":"Konfigurieren","Continue":"Fortfahren","Cancel":"Abbrechen","This action cannot be undone.":"Dieser Vorgang kann nicht r\u00fcckg\u00e4ngig gemacht werden.","none":"Keine","Add":"Hinzuf\u00fcgen","Select":"Auswahl","Disabled":"Deaktiviert","Enabled":"Aktiviert","The selected file %filename cannot be uploaded. Only files with the following extensions are allowed: %extensions.":"Die ausgew\u00e4hlte Datei %filename konnte nicht hochgeladen werden. Nur Dateien mit den folgenden Erweiterungen sind zul\u00e4ssig: %extensions.","Yes":"Ja","No":"Nein","Edit":"Bearbeiten","Query":"Abfrage","Next":"Weiter","Hide":"Ausblenden","Second":"Sekunde","Minute":"Minute","Hour":"Stunde","Day":"Tag","Month":"Monat","Year":"Jahr","jQuery UI Tabs: Not enough arguments to add tab.":"jQuery UI-Reiter: Nicht genug Argumente, um einen Reiter hinzuzuf\u00fcgen.","view":"Anzeigen","No title":"Kein Titel","No name":"Kein Name","Submit":"Einsenden","Sunday":"Sonntag","Monday":"Montag","Tuesday":"Dienstag","Wednesday":"Mittwoch","Thursday":"Donnerstag","Friday":"Freitag","Saturday":"Samstag","Location":"Standort","Mon":"Mo.","Tue":"Di.","Wed":"Mi.","Thu":"Do.","Fri":"Fr.","Sat":"Sa.","Sun":"So.","May":"Mai","Other":"Andere","Blog":"Blog","Jan":"Jan","Feb":"Feb","Mar":"M\u00e4r","Apr":"Apr","Jun":"Jun","Jul":"Jul","Aug":"Aug","Sep":"Sep","Oct":"Okt","Nov":"Nov","Dec":"Dez","Please wait...":"Bitte warten Sie...","Translate Text":"Text \u00fcbersetzen","An HTTP error @status occured.":"Ein HTTP Fehler @status ist aufgetreten.","Close":"Schlie\u00dfen","No terms":"Keine Begriffe","No style":"Kein Stil","Loading":"Laden","An error occurred at @path.":"Ein Fehler ist auf @path aufgetreten.","Select All":"Alle ausw\u00e4hlen","Select None":"Keinen ausw\u00e4hlen","Loading...":"Wird geladen\u2026","City":"Stadt","Show more":"Mehr anzeigen","view more":"mehr","Unselect all children":"Unselect all children","Select all children":"Select all children","@count days":"@count Tage","Seconds":"Sekunden","Minutes":"Minuten","Hours":"Stunden","Days":"Tage","Weeks":"Wochen","Default values":"Standardwerte","Show":"Anzeigen","No terms selected.":"No terms selected.","Select one term per tree to add a new translation.":"Select one term per tree to add a new translation.","Not in book":"Nicht im Buch","New book":"Neues Buch","Don\u0027t create new revision":"Keine neue Version erstellen","No flags":"Keine Markierungen","page":"Seite","Prev":"Vorheriges","Today":"Heute","An AJAX HTTP error occurred.":"Es ist ein AJAX-HTTP-Fehler aufgetreten.","HTTP Result Code: !status":"HTTP-Ergebniscode: !status","An AJAX HTTP request terminated abnormally.":"Eine AJAX-HTTP-Anfrage ist anomal beendet worden.","Debugging information follows.":"Im Folgenden finden Sie Debugging-Informationen.","Path: !uri":"Pfad: !uri","StatusText: !statusText":"StatusText: !statusText","ResponseText: !responseText":"ResponseText: !responseText","ReadyState: !readyState":"ReadyState: !readyState","Autocomplete popup":"Popup zur automatischen Vervollst\u00e4ndigung","Searching for matches...":"Suche \u2026","@count year from now":"@count Jahr von heute an","@count years from now":"@count Jahre von heute an","November":"November","October":"Oktober","December":"Dezember","September":"September","April":"April","August":"August","June":"Juni","March":"M\u00e4rz","January":"Januar","July":"Juli","February":"Februar","Content limited to @limit characters, remaining: \u003Cstrong\u003E@remaining\u003C\/strong\u003E":"Der Inhalt ist auf @limit Zeichen beschr\u00e4nkt, noch verbleibende Zeichen: \u003Cstrong\u003E@remaining\u003C\/strong\u003E","Done":"Fertig","Su":"So.","Mo":"Mo.","Tu":"Di.","We":"Mi.","Th":"Do.","Fr":"Fr.","Sa":"Sa.","mm\/dd\/yy":"mm\/tt\/jj","School":"Schule","all":"Alle","Please enter a valid email address.":"Geben Sie eine g\u00fcltige E-Mail-Adresse ein.","This field can only include letters and basic characters.":"Dieses Feld darf nur Buchstaben und Basiszeichen enthalten.","This field can only be numbers or + - x . ( ) characters.":"Dieses Feld darf nur aus Zahlen oder den Zeichen + - x . ( ) bestehen.","Full Search Results":"Vollst\u00e4ndige Suchergebnisse","Product Details":"Produktdetails","Week":"Woche","Need the !bit version? Click \u003Ca href=\u0022!url\u0022 id=\u0022secondary-download\u0022\u003Ehere\u003C\/a\u003E.":"Ben\u00f6tigen Sie die !bit Version? Klicken \u003Ca href=\u0022!url\u0022 id=\u0022secondary-download\u0022\u003ESie hier\u003C\/a\u003E.","64-bit":"64 Bit","32-bit":"32 Bit","The e-mail addresses do not match.":"Die E-Mail-Adressen stimmen nicht \u00fcberein.","Need a different version? !versions":"Ben\u00f6tigen Sie eine andere Version? !versions","Need a different version? \u003Cbr\u003E !versions":"Ben\u00f6tigen Sie eine andere Version? \u003Cbr\u003E !versions","Please fill out the form or !signin  to access more content. It only takes 30 seconds.":"Bitte f\u00fcllen Sie das Formular aus oder melden Sie sich an, um auf weitere Inhalte zuzugreifen. Das dauert nur 30\u00a0Sekunden.","view less":"weniger","Hide Options":"Optionen ausblenden","Unsubscribed - Show Options":"Abbestellt\u00a0\u2013 Optionen anzeigen","e.g. @example":"z.\u00a0B. @example","Please check your formatting.":"Pr\u00fcfen Sie die Formatierung.","Please enter a valid phone number.":"Geben Sie eine g\u00fcltige Telefonnummer ein.","32-bit Windows":"32-Bit Windows","Mac":"Mac","Need a different version?":"Ben\u00f6tigen Sie eine andere Version?","This is not me.":"Das bin ich nicht.","Looking up details, one moment...":"Einen Moment, die Details werden aufgerufen...","CustomMessage: !customMessage":"CustomMessage: !customMessage","The response failed verification so will not be processed.":"Die Verifizierung der Antwort ist fehlgeschlagen, sie wird nicht durchgef\u00fchrt.","The callback URL is not local and not trusted: !url":"Die Callback-URL ist nicht lokal und nicht vertrauensw\u00fcrdig: !url","This field must be 12-digits.":"Das Feld muss 12\u00a0Ziffern enthalten.","Stories":"Kundenberichte","Problem processing liftIgniter data":"Problem mit der Verarbeitung von liftIgniter-Daten","Your request is taking longer than expected.":"Ihre Anforderung dauert l\u00e4nger als erwartet.","Please fill out the form or !signin to access more content. It only takes 15 seconds.":"Bitte f\u00fcllen Sie das Formular aus oder melden Sie sich an, um auf weitere Inhalte zuzugreifen. Das dauert nur 15\u00a0Sekunden.","You must be 13 years or older.":"Sie m\u00fcssen mindestens 13\u00a0Jahre alt sein.","Cancel Registration":"Anmeldung stornieren","Registered":"Registriert","Download will start in a separate tab.":"Der Download erfolgt auf einer neuen Registerkarte.","Phone (e.g. !countryPlaceholder)":"Telefonnummer (z.\u00a0B. !countryPlaceholder)","Control when the browser\u0027s internal cache of the current page should expire. The date must to be an \u003Ca href=\u0022http:\/\/www.csgnetwork.com\/timerfc1123calc.html\u0022\u003ERFC-1123\u003C\/a\u003E-compliant date string that is represented in Greenwich Mean Time (GMT), e.g. \u0027Fri, 03 Jun 2016 09:18:09 GMT\u0027. Set to \u00270\u0027 to stop the page being cached entirely.":"\u00dcberpr\u00fcfen Sie, wann der interne Cache der aktuellen Seite des Browsers ablaufen sollte. Das Datum muss eine \u003Ca href=\u0022http:\/\/www.csgnetwork.com\/timerfc1123calc.html\u0022\u003ERFC-1123\u003C\/a\u003E-konforme Datumszeichenfolge sein, die in Greenwich Mean Time (GMT) angegeben wird, z.\u00a0B. \u201aFr., 03. Jun. 2016 09:18:09 GMT\u0027. Stellen Sie den Wert \u201e0\u201c ein, um zu verhindern, dass die Seite komplett im Cache gespeichert wird.","Business Postal Code":"Postleitzahl des Unternehmens","End date must be after start date":"Das Enddatum muss nach dem Startdatum liegen.","You must check at least one":"Sie m\u00fcssen mindestens eine Option ausw\u00e4hlen.","This field is required":"Dieses Feld ist erforderlich.","This looks like a new email address, please tell us a bit about yourself.":"Dies scheint eine neue E-Mail-Adresse zu sein, erz\u00e4hlen Sie uns etwas \u00fcber sich.","Expand all":"Alle erweitern","Collapse all":"Alle reduzieren","Windows":"Windows","This product version is not available on this operating system. \u003Ca href=\u0022\/products\/desktop\/download\u0022\u003EDownload the latest version\u003C\/a\u003E":"Diese Produktversion ist f\u00fcr dieses Betriebssystem nicht verf\u00fcgbar. \u003Ca href=\u0022\/products\/desktop\/download\u0022\u003ELaden Sie die aktuelle Version herunter\u003C\/a\u003E.","Primary Networked Server":"Vernetzter Prim\u00e4rserver","This product version is not available. \u003Ca href=\u0022\/products\/server\/download\u0022\u003EDownload the latest version\u003C\/a\u003E":"Diese Produktversion ist nicht verf\u00fcgbar. \u003Ca href=\u0022\/products\/server\/download\u0022\u003ELaden Sie die aktuelle Version herunter\u003C\/a\u003E.","Worker Networked Server":"Vernetzter Arbeitsserver","This e-mail address is not eligible for a trial.":"Diese E-Mail-Adresse ist nicht zu einer Testversion berechtigt.","\u003Cbr\u003EThis site name is already taken.\u003C\/br\u003E Suggestions: ":"\u003Cbr\u003EDer Name dieser Site ist leider schon vergeben.\u003C\/br\u003E Vorschl\u00e4ge: ","For Students and Instructors":"F\u00fcr Studenten und Dozenten","* Date and time according to your timezone is: @local_time @local_date":"* Datum und Uhrzeit gem\u00e4\u00df Ihrer Zeitzone: @local_time @local_date","Control when the browser\u0027s internal cache of the current page should expire. The date must to be an \u003Ca href=\u0022http:\/\/www.csgnetwork.com\/timerfc1123calc.html\u0022\u003ERFC-1123\u003C\/a\u003E-compliant date string that is represented in Greenwich Mean Time (GMT), e.g. \u0027Thu, 07 Dec 2017 01:03:24 GMT\u0027. Set to \u00270\u0027 to stop the page being cached entirely.":"\u00dcberpr\u00fcfen Sie, wann der interne Cache der aktuellen Seite des Browsers ablaufen soll. Das Datum muss eine \u003Ca href=\u0022http:\/\/www.csgnetwork.com\/timerfc1123calc.html\u0022\u003ERFC-1123\u003C\/a\u003E-konforme Datumszeichenfolge sein, die in Greenwich Mean Time (GMT) angegeben wird, z.\u00a0B. \u201aDo., 07. Dez. 2017 01:03:24 GMT\u0027. Stellen Sie den Wert \u201e0\u201c ein, um zu verhindern, dass die Seite komplett im Cache gespeichert wird..","This product version is not available on this operating system. \u003Ca href=\u0022\/products\/desktop\/download\u0022\u003EDownload the latest version\u003C\/a\u003E.":"Diese Produktversion ist f\u00fcr dieses Betriebssystem nicht verf\u00fcgbar. \u003Ca href=\u0022\/products\/desktop\/download\u0022\u003ELaden Sie sich die aktuelle Version herunter\u003C\/a\u003E.","This product is not available for this version. \u003Ca href=\u0022\/products\/server\/download\u0022\u003EDownload the latest version\u003C\/a\u003E.":"Dieses Produkt ist f\u00fcr diese Version nicht verf\u00fcgbar. \u003Ca href=\u0022\/products\/server\/download\u0022\u003ELaden Sie die aktuelle Version herunter\u003C\/a\u003E.","Tabcmd For Server":"Tabcmd f\u00fcr Server","Linux":"Linux","Loading available trainings.":"Verf\u00fcgbare Schulungen werden geladen.","Must be a number greater than 0":"Muss eine Zahl gr\u00f6\u00dfer als 0 sein","Must be a number less than 1,001":"Muss eine Zahl kleiner als 1.001 sein","Unable to request an individual student license. If you\u0027re a student, request your own key at tableau.com\/students":"Es k\u00f6nnen keine einzelnen Lizenzen f\u00fcr Studierende angefordert werden. Studierende m\u00fcssen ihren eigenen Lizenzschl\u00fcssel auf tableau.com\/students anfordern.","Unable to request more than 1,000 student licenses. For large deployments, students can individually request their key at tableau.com\/students":"Es k\u00f6nnen nicht mehr als 1.000 Lizenzen f\u00fcr Studierende angefordert werden. Bei gr\u00f6\u00dferen Bereitstellungen k\u00f6nnen die Studierenden ihren eigenen Lizenzschl\u00fcssel auf tableau.com\/students anfordern.","Date cannot be in the past":"Das Datum darf nicht in der Vergangenheit liegen.","Date range cannot exceed one year":"Der Datumsbereich darf ein Jahr nicht \u00fcberschreiten.","This product version is not available on this operating system. \u003Ca href=\u0022\/products\/prep\/download\u0022\u003EDownload the latest version\u003C\/a\u003E.":"Diese Produktversion ist f\u00fcr dieses Betriebssystem nicht verf\u00fcgbar. \u003Ca href=\u0022\/products\/prep\/download\u0022\u003ELaden Sie die aktuelle Version herunter\u003C\/a\u003E.","This product version is not available on this operating system. \u003Ca href=\u0022@download\u0022\u003EDownload the latest version\u003C\/a\u003E.":"Diese Produktversion ist f\u00fcr dieses Betriebssystem nicht verf\u00fcgbar. \u003Ca href=\u0022@download\u0022\u003ELaden Sie sich die aktuelle Version herunter\u003C\/a\u003E.","This product is not available for this version. \u003Ca href=\u0022@download\u0022\u003EDownload the latest version\u003C\/a\u003E.":"Dieses Produkt ist f\u00fcr diese Version nicht verf\u00fcgbar. \u003Ca href=\u0022@download\u0022\u003ELaden Sie die aktuelle Version herunter\u003C\/a\u003E.","This field can only be numbers or + - x \/ . ( ) characters.":"In dieses Feld k\u00f6nnen nur Zahlen oder die Zeichen + - x \/ . ( ) eingegeben werden.","Date must be of the format MM\/DD\/YYYY":"Das Datum muss das Format MM\/TT\/JJJJ haben","Content limitedd to @limit characters, remaining: \u003Cstrong\u003E@remaining\u003C\/strong\u003E":"Der Inhalt ist auf @limit Zeichen beschr\u00e4nkt, noch verbleibende Zeichen: \u003Cstrong\u003E@remaining\u003C\/strong\u003E"},"Coveo search results":{"Version: ":"Version: ","Answered":"Beantwortet","Not Answered":"Nicht beantwortet"}} };;
/**
 * @file Add/process queue activites that should be posted to Eloqua.
 *
 * EXMAPLE:
 * $.jQueue.push({
 *     leadSource: 'Faux Trial',
 *     leadSourceDetail: 'Amazing Trial Download',
 *     campaignId: '01123581321345589144'
 *   },
 *   'Drupal.behaviors.tableauEloquaQueue.eloquaPost',
 *   {processNow: true}
 * );
 */


/* global videojs:false */

(function ($, Drupal, window, Tabia, _) {
  var nameSpace = 'jQueue';

  /**
   * Publish events and listen for queue items.
   */
  Drupal.behaviors.tableauEloquaQueue = {
    /**
     * Use the queue to later process lead activities.
     */
    attach: function(context, settings) {
      if (context !== document) { return; }

      // Users with GUID are posted server-side.
      var elqDetails = groucho.storage.get('elqDetails'),
          hasGuid = (elqDetails && typeof elqDetails === 'object' && elqDetails.status !== 'Open');

      // Track activities.
      if (settings.tableauEloqua.queueForms.length && !hasGuid) {
        leadActivityForms();
      }
    },


    /**
     * Queue-item callback for submitting Eloqua CRM activities (public).
     *
     * @param {object} data
     *   Data from the form to help process.
     *
     * @return {Promise}
     */
    eloquaPost: function eloquaPost(item) {
      var completed = $.Deferred(),
          dlHelper = new DataLayerHelper(dataLayer);

      if (item.data && item.data.leadSource && item.data.campaignId && dlHelper.get('userUid') !== 0) {
        // Process data via FormFrame.
        formFramePost(item.data, completed);
      }
      else {
        completed.reject();
      }

      return completed.promise();
    }
  };


  /**
   * Lead activity: configured forms (anon premium).
   */
  function leadActivityForms() {
    $('form').submit(function anonFormActivity() {
      var $this = $(this),
          formId = $this.find('input[name="form_id"]').val(),
          data = {
            nid: $this.find('input[name="nid"]').val(),
            keyword: Tabia.util.getUrlParameter('kw'),
            leadSource: $this.find('input[name="lead_source"]').val(),
            leadSourceDetail: $this.find('input[name="lead_source_detail"]').val(),
            campaignId: $this.find('input[name="campaign_id"]').val()
          };

      // Admin configured forms.
      if (($.inArray(formId, Drupal.settings.tableauEloqua.queueForms) >= 0) &&
          data.leadSource !== null && data.campaignId !== null) {
        // Add submit event to a localStorage queue.
        $.jQueue.push(data, 'Drupal.behaviors.tableauEloquaQueue.eloquaPost');
      }
    });
  }

  /**
   * Post via FormFrame in item callbacks (private).
   *
   * @param {object} data
   * @param {Deferred} completed (reference)
   */
  function formFramePost(data, completed) {
    var params = {},
        expectedParams = {
          nid: 'baseId',
          keyword: 'kw',
          leadSource: 'ls',
          leadSourceDetail: 'lsd',
          campaignId: 'cid'
        },
        frameSrc,
        $iframe;

    // Add data as frame params.
    for (var i in data) {
      if (expectedParams.hasOwnProperty(i)) {
        // Map to param name from passed data (if valid).
        params[expectedParams[i]] = data[i];
      }
    }
    // Respect language on the form/frame URL.
    frameSrc = '/' + Drupal.settings.pathPrefix + 'form/frame/post-queue?' + $.param(params);

    // Build a FormFrame.
    $iframe = $('<iframe>', {
      src: frameSrc,
      width: 0, height: 0, frameborder: 0,
      marginwidth: 0, marginheight: 0, scrolling: 'no'
    }).load(function () {
      var _thisFrame = this;

      Tabia.debug('Form frame iframe loaded', {type: nameSpace});

      /**
       * Check if frame has been submitted.
       *
       * @return {Boolean}
       */
      function isSubmitted() {
        var parsedFrameUrl;

        // Safety in-case frame still exists without a window object anymore.
        if (!_thisFrame.contentWindow) {
          return false;
        }
        // Normal check for signin param.
        parsedFrameUrl = Tabia.util.parseUrl(_thisFrame.contentWindow.location.href);
        return parsedFrameUrl.params.hasOwnProperty('signin');
      }

      // Submit the form.
      if (!isSubmitted()) {
        //this.contentWindow.postMessage(JSON.stringify({actionPremiumSubmit: 1}), this.src);
        $iframe.contents().find('[id^=tableau-premium-access-button-form]').submit();
        Tabia.debug('Queue item submit attempted via FormFrame', {
          type: nameSpace,
          data: _.extend(data, {url: _thisFrame.contentWindow.location.href})
        });
      }

      // Keep checking for frame submitted and update queue.
      Tabia.util.waitFor(
        function submittedTest() {
          return isSubmitted();
        },
        function submittedThen() {
          $(_thisFrame).remove();
          Tabia.notice('Successful Eloqua post via iframe', {type: nameSpace});
          completed.resolve();
        },
        function timeoutSubmitted() {
          $(_thisFrame).remove();
          Tabia.warning('Queue form frame post timeout. Destroying iframe', {type: nameSpace});
        },
        {waitInterval: 1000, waitTimeout: 45000}
      );
    });

    // Create a form frame.
    $('body').append($iframe);
    Tabia.debug('Building iframe', {type: nameSpace, data: {
      postedFromUrl: window.location.href,
      iframe: frameSrc
    }});

    // Send the promise.
    return completed.promise();
  }

})(jQuery, Drupal, window, Tabia, _);
;
/**
 * @file Manage initialization and logic for the standalone SearchBox.
 */
(function ($) {
  Drupal.behaviors.initCoveoSearchBox = {
    attach: function (context, settings) {
      var $searchBlocks = $('.coveo-search-block'),
          coveoDrupalSettings = settings.coveo,
          drupalSearchPath;

      if (typeof window.Coveo !== 'object' || typeof coveoDrupalSettings === 'undefined') {
        return;
      }

      // Grab the search page path. This is the redirect point when a search query is submitted
      // via any search block.
      drupalSearchPath = coveoDrupalSettings.searchPagePath;

      // Set up endpoints to query against.
      Coveo.SearchEndpoint.endpoints['default'] = new Coveo.SearchEndpoint({
        restUri: coveoDrupalSettings.searchEndpoint,
        accessToken: coveoDrupalSettings.searchToken
      });

      $searchBlocks.each(function setupCoveoSearchbox() {
        var $this = $(this),
            coveoDefaultQuery = $this.data('defaultQuery'),
            coveoTabGroup = $this.data('tabGroup') || '',
            blockSearchPath = drupalSearchPath;

        // If we find a defined tab group, append a '#t' hash param to default the state of the
        // search page to have that group selected and active by default. This corresponds to the
        // data-id attribute on the CoveoTab element.
        if (coveoTabGroup) {
          $this.on('newQuery', function (e, data) {
           $this.coveo('state').attributes.t = coveoTabGroup;
          });
        }

        // Provide a default query on initialization if no query exists.
        if (coveoDefaultQuery) {
          $this.on('afterInitialization', function () {
            var q = $this.coveo('state', 'q');

            if (!q) {
              $this.coveo('state', 'q', coveoDefaultQuery);
            }
          });
        }

        $this.coveo('initSearchbox', blockSearchPath);

      });
    }
  };
})(jQuery);
;

(function($) {

/**
 * Drupal FieldGroup object.
 */
Drupal.FieldGroup = Drupal.FieldGroup || {};
Drupal.FieldGroup.Effects = Drupal.FieldGroup.Effects || {};
Drupal.FieldGroup.groupWithfocus = null;

Drupal.FieldGroup.setGroupWithfocus = function(element) {
  element.css({display: 'block'});
  Drupal.FieldGroup.groupWithfocus = element;
}

/**
 * Implements Drupal.FieldGroup.processHook().
 */
Drupal.FieldGroup.Effects.processFieldset = {
  execute: function (context, settings, type) {
    if (type == 'form') {
      // Add required fields mark to any fieldsets containing required fields
      $('fieldset.fieldset', context).once('fieldgroup-effects', function(i) {
        if ($(this).is('.required-fields') && $(this).find('.form-required').length > 0) {
          $('legend span.fieldset-legend', $(this)).eq(0).append(' ').append($('.form-required').eq(0).clone());
        }
        if ($('.error', $(this)).length) {
          $('legend span.fieldset-legend', $(this)).eq(0).addClass('error');
          Drupal.FieldGroup.setGroupWithfocus($(this));
        }
      });
    }
  }
}

/**
 * Implements Drupal.FieldGroup.processHook().
 */
Drupal.FieldGroup.Effects.processAccordion = {
  execute: function (context, settings, type) {
    $('div.field-group-accordion-wrapper', context).once('fieldgroup-effects', function () {
      var wrapper = $(this);

      // Get the index to set active.
      var active_index = false;
      wrapper.find('.accordion-item').each(function(i) {
        if ($(this).hasClass('field-group-accordion-active')) {
          active_index = i;
        }
      });

      wrapper.accordion({
        heightStyle: "content",
        active: active_index,
        collapsible: true,
        changestart: function(event, ui) {
          if ($(this).hasClass('effect-none')) {
            ui.options.animated = false;
          }
          else {
            ui.options.animated = 'slide';
          }
        }
      });

      if (type == 'form') {

        var $firstErrorItem = false;

        // Add required fields mark to any element containing required fields
        wrapper.find('div.field-group-accordion-item').each(function(i) {

          if ($(this).is('.required-fields') && $(this).find('.form-required').length > 0) {
            $('h3.ui-accordion-header a').eq(i).append(' ').append($('.form-required').eq(0).clone());
          }
          if ($('.error', $(this)).length) {
            // Save first error item, for focussing it.
            if (!$firstErrorItem) {
              $firstErrorItem = $(this).parent().accordion("activate" , i);
            }
            $('h3.ui-accordion-header').eq(i).addClass('error');
          }
        });

        // Save first error item, for focussing it.
        if (!$firstErrorItem) {
          $('.ui-accordion-content-active', $firstErrorItem).css({height: 'auto', width: 'auto', display: 'block'});
        }

      }
    });
  }
}

/**
 * Implements Drupal.FieldGroup.processHook().
 */
Drupal.FieldGroup.Effects.processHtabs = {
  execute: function (context, settings, type) {
    if (type == 'form') {
      // Add required fields mark to any element containing required fields
      $('fieldset.horizontal-tabs-pane', context).once('fieldgroup-effects', function(i) {
        if ($(this).is('.required-fields') && $(this).find('.form-required').length > 0) {
          $(this).data('horizontalTab').link.find('strong:first').after($('.form-required').eq(0).clone()).after(' ');
        }
        if ($('.error', $(this)).length) {
          $(this).data('horizontalTab').link.parent().addClass('error');
          Drupal.FieldGroup.setGroupWithfocus($(this));
          $(this).data('horizontalTab').focus();
        }
      });
    }
  }
}

/**
 * Implements Drupal.FieldGroup.processHook().
 */
Drupal.FieldGroup.Effects.processTabs = {
  execute: function (context, settings, type) {
    if (type == 'form') {

      var errorFocussed = false;

      // Add required fields mark to any fieldsets containing required fields
      $('fieldset.vertical-tabs-pane', context).once('fieldgroup-effects', function(i) {
        if ($(this).is('.required-fields') && $(this).find('.form-required').length > 0) {
          $(this).data('verticalTab').link.find('strong:first').after($('.form-required').eq(0).clone()).after(' ');
        }
        if ($('.error', $(this)).length) {
          $(this).data('verticalTab').link.parent().addClass('error');
          // Focus the first tab with error.
          if (!errorFocussed) {
            Drupal.FieldGroup.setGroupWithfocus($(this));
            $(this).data('verticalTab').focus();
            errorFocussed = true;
          }
        }
      });
    }
  }
}

/**
 * Implements Drupal.FieldGroup.processHook().
 *
 * TODO clean this up meaning check if this is really
 *      necessary.
 */
Drupal.FieldGroup.Effects.processDiv = {
  execute: function (context, settings, type) {

    $('div.collapsible', context).once('fieldgroup-effects', function() {
      var $wrapper = $(this);

      // Turn the legend into a clickable link, but retain span.field-group-format-toggler
      // for CSS positioning.

      var $toggler = $('span.field-group-format-toggler:first', $wrapper);
      var $link = $('<a class="field-group-format-title" href="#"></a>');
      $link.prepend($toggler.contents());

      // Add required field markers if needed
      if ($(this).is('.required-fields') && $(this).find('.form-required').length > 0) {
        $link.append(' ').append($('.form-required').eq(0).clone());
      }

      $link.appendTo($toggler);

      // .wrapInner() does not retain bound events.
      $link.click(function () {
        var wrapper = $wrapper.get(0);
        // Don't animate multiple times.
        if (!wrapper.animating) {
          wrapper.animating = true;
          var speed = $wrapper.hasClass('speed-fast') ? 300 : 1000;
          if ($wrapper.hasClass('effect-none') && $wrapper.hasClass('speed-none')) {
            $('> .field-group-format-wrapper', wrapper).toggle();
          }
          else if ($wrapper.hasClass('effect-blind')) {
            $('> .field-group-format-wrapper', wrapper).toggle('blind', {}, speed);
          }
          else {
            $('> .field-group-format-wrapper', wrapper).toggle(speed);
          }
          wrapper.animating = false;
        }
        $wrapper.toggleClass('collapsed');
        return false;
      });

    });
  }
};

/**
 * Behaviors.
 */
Drupal.behaviors.fieldGroup = {
  attach: function (context, settings) {
    settings.field_group = settings.field_group || Drupal.settings.field_group;
    if (settings.field_group == undefined) {
      return;
    }

    // Execute all of them.
    $.each(Drupal.FieldGroup.Effects, function (func) {
      // We check for a wrapper function in Drupal.field_group as
      // alternative for dynamic string function calls.
      var type = func.toLowerCase().replace("process", "");
      if (settings.field_group[type] != undefined && $.isFunction(this.execute)) {
        this.execute(context, settings, settings.field_group[type]);
      }
    });

    // Fixes css for fieldgroups under vertical tabs.
    $('.fieldset-wrapper .fieldset > legend').css({display: 'block'});
    $('.vertical-tabs fieldset.fieldset').addClass('default-fallback');

    // Add a new ID to each fieldset.
    $('.group-wrapper .horizontal-tabs-panes > fieldset', context).once('group-wrapper-panes-processed', function() {
      // Tats bad, but we have to keep the actual id to prevent layouts to break.
      var fieldgroupID = 'field_group-' + $(this).attr('id');
      $(this).attr('id', fieldgroupID);
    });
    // Set the hash in url to remember last userselection.
    $('.group-wrapper ul li').once('group-wrapper-ul-processed', function() {
      var fieldGroupNavigationListIndex = $(this).index();
      $(this).children('a').click(function() {
        var fieldset = $(this).closest('.group-wrapper').find('fieldset.fieldgroup-effects-processed').get(fieldGroupNavigationListIndex);
        // Grab the first id, holding the wanted hashurl.
        var hashUrl = $(fieldset).attr('id').replace(/^field_group-/, '').split(' ')[0];
        if (hashUrl) {
          window.location.hash = hashUrl;
        }
      });
    });

  }
};

})(jQuery);
;
/**
 * Display a message highlighting the language drop down when the browser's
 * language preference does not match the current page and a translation exists.
 */
(function($) {
  $(document).ready(function() {
    var maxRepeats = parseInt(Drupal.settings.lang_dropdown_remind.repeat),
        repeated = parseInt($.cookie('langDropdownReminded')) || 0;

    // Ensure we only show the message as many times as specified.
    if (repeated < maxRepeats) {
      Drupal.getLanguagePreference(function(langPref) {
        // Support XHTML and HTML5 language identification methods.
        var docLang = $('html').attr('xml:lang') || $('html').attr('lang'),
            langOnly = langPref.substr(0, 2);

        // We care if the language preference and document language don't match.
        if (langOnly.length === 2 && docLang.indexOf(langOnly) === -1) {
          // Support the following language selectors:
          // 1) Core Language Switcher
          // 2) Language Switcher Dropdown (lang_dropdown 1.x)
          // 3) Language Switcher Dropdown (lang_dropdown 2.x)
          var $langLink = $('.language-switcher-locale-url li[class~="' + langOnly + '"] a,' +
                            '#lang-dropdown-form input[name^="' + langOnly + '"],' +
                            '#lang_dropdown_form_language input[name^="' + langOnly + '"]'),
              translationExists = false;

          if ($langLink.length) {
            // Core language switcher.
            if ($langLink.attr('href') !== undefined && $langLink.attr('href').indexOf('node') === -1) {
              translationExists = true;
            }
            // Language switcher dropdown (lang_dropdown).
            else if ($langLink.attr('value') !== undefined && $langLink.attr('value').indexOf('node') === -1) {
              translationExists = true;
            }
          }

          // Furthermore, we only care if an appropriate translation exists.
          if (translationExists) {
            // Create, insert, and display the message.
            var message = Drupal.settings.lang_dropdown_remind.messages[langOnly] || Drupal.settings.lang_dropdown_remind.messages['default'];
            var closeMsg = Drupal.settings.lang_dropdown_remind.close[langOnly] || Drupal.settings.lang_dropdown_remind.close['default'];
            var close = '<a id="langdropdown-reminder-close">' + closeMsg + '</a>';
            var $markup = $('<div id="langdropdown-reminder">' +
              Drupal.settings.lang_dropdown_remind.markup.replace('!message', message).replace('!close_button', close) +
              '</div>');
            $markup.hide();
            $(Drupal.settings.lang_dropdown_remind.prependto).prepend($markup);
            // Triggering a custom event that can be used for custom interaction
            // in a theme.
            $(Drupal.settings.lang_dropdown_remind.prependto).trigger('lang_dropdown_remind_ready');

            $('#langdropdown-reminder').slideDown();

            // Allow something to trigger opening of the language dropdown.
            $('#trigger-langdropdown').click(function() {$('#edit-lang-dropdown-select_child').toggle();});

            // Behavior for the "close" button.
            $('#langdropdown-reminder-close').click(function() {
              // Trigger a custom event when the language bar is about to be closed. Useful for styling in a theme.
              $(Drupal.settings.lang_dropdown_remind.prependto).trigger('lang_dropdown_remind_close');

              $('#langdropdown-reminder').slideUp();

              // Ensure the language switcher dropdown is also gone (otherwise,
              // it would be awkwardly stuck open with no way to close it).
              $('#edit-lang-dropdown-select_child').css('display', '');

              // If a user physically clicked the "close" button, don't ever
              // display the reminder again (for this session).
              $.cookie('langDropdownReminded', maxRepeats, {path: '/'});
            });

            // Increment the repeated value in the cookie.
            $.cookie('langDropdownReminded', ++repeated, {path: '/'});
          }
        }
      });
    }
  });
})(jQuery);
;
/**
 * @file Common data layer helper.
 */

(function ($) {
  Drupal.behaviors.dataLayer = {

    /**
     * The language prefix list (no blank).
     *
     * @return {array}
     */
    langPrefixes: function langPrefixes() {
      var languages = Drupal.settings.dataLayer.languages,
          langList = [];

      for (var lang in languages) {
        if (languages[lang].prefix !== '') {
          langList.push(languages[lang].prefix);
        }
      }
      return langList;

      // With Underscore.js dependency.
      //var list = _.pluck(Drupal.settings.datalayer.languages, 'prefix');
      //return _.filter(list, function(lang) { return lang });
    },

    /**
     * Drupal behavior.
     */
    attach: function() { return }

  };
})(jQuery);
;
// Load the 6Sense script (code from 6Sense provided sample). Uses the authentication (epsilon) key from the admin UI.
Drupal.behaviors.tableau6SenseLoad = {
  attach: function (context, settings) {
    window._6si = window._6si || [];
    window._6si.push(['enableCompanyDetails', true]);
    window._6si.push(['setEpsilonKey', settings.tableau6Sense.epsilon_key]);
    var gd = document.createElement('script');
    gd.type = 'text/javascript';
    gd.async = true;
    gd.src = '//j.6sc.co/6si.min.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gd, s);

    // Wait and parse the company details
    Tabia.util.waitFor(
      function testFor6Sense() {
        // If/when the 6Sense script is loaded and ready it will provide TRUE in the following variable.
        return window._storagePopulated;
      },
      function sixSenseLoaded() {
        // If there are values in localStorage then push them into the appropriate form fields.
        // Annoyingly, if 6Sense has no data it returns {} in window.localStorage._6enseCompanyDetails.
        var sixSenseCompanyDetails = JSON.parse(window.localStorage.getItem('_6senseCompanyDetails'));
        if (typeof sixSenseCompanyDetails === 'object' && sixSenseCompanyDetails.company) {
          // Trigger a custom event with the company details object.
          $(document).trigger('sixSenseCompanyDetailsLoaded', sixSenseCompanyDetails);
        }
        else {
          // Log a warning message as a clue that something is broken.
          Tabia.warning('6Sense company data object not found or missing company data.', {type: 'tableau6Sense', data: {companyDetails: sixSenseCompanyDetails}});
        }
      },
      function sixSenseTimedOut() {
        // Log a warning message as a clue that something is broken.
        Tabia.warning('6Sense data did not load within the configured timeout.', {type: 'tableau6Sense', data: {'sixSenseTimeout': settings.tableau6Sense.time_out}});
      },
      {
        waitTimeout: settings.tableau6Sense.time_out
      }
    );

  }
};
;
/**
 * If 6Sense is enabled, and the company details are loaded successfully from localStorage,
 * then push relevant values to dataLayer `DB` object.
 *
 * See: https://github.com/tableau-mkt/www7/issues/7227
 */
Drupal.behaviors.tableau6SenseDataLayer = {
  attach: function (context, settings) {
    // Only run on DOM-ready.
    if (context !== document) {
      return;
    }

    // Listen for the custom event with the company details object.
    $(document).on('sixSenseCompanyDetailsLoaded', function (e, sixSenseCompanyDetails) {
      // Use the details object as is, on the dataLayer property named sixSense.
      var dataLayerSixSense = {sixSense: sixSenseCompanyDetails};

      // Push to dataLayer.
      dataLayer.push(dataLayerSixSense);

      // Log at debug level for local/multidev testing.
      Tabia.debug('Pushed 6Sense company details to the dataLayer', {type: 'tableau6Sense', data: dataLayerSixSense});
    });
  }
};
;
/**
 * @file Asynchronous tracking for Eloqua.
 */

var _elqQ = _elqQ || [];

Drupal.behaviors.eloquaApiTracking = {
  attach: function (context, settings) {
    if (context === document) {

      if (typeof settings.eloqua_api.siteId !== 'undefined') {
        _elqQ.push(['elqSetSiteId', settings.eloqua_api.siteId]);

        // Support for 1st party cookies.
        if (typeof settings.eloqua_api.firstPartyCookieHost !== 'undefined') {
          _elqQ.push(['elqUseFirstPartyCookie', settings.eloqua_api.firstPartyCookieHost]);
        }

        _elqQ.push(['elqTrackPageView']);
      }

      function async_load() {
        if (typeof settings.eloqua_api.trackingRemoteUrl !== 'undefined') {
          var s = document.createElement('script'),
              x = document.getElementsByTagName('script')[0];
          s.src = settings.eloqua_api.trackingRemoteUrl;
          s.type = 'text/javascript';
          s.async = true;
          x.parentNode.insertBefore(s, x);
        }
      }
      if (window.addEventListener) window.addEventListener('load', async_load, false);
      else if (window.attachEvent) window.attachEvent('onload', async_load);

    }
  }
};

/**
 * Passes a visitor's GUID, to the provided callback method. If first-party
 * cookie support is enabled, it will use the value from the cookie. Otherwise,
 * the GUID will be retrieved asynchronously from Eloqua.
 *
 * @param {function} callback
 *   Called with the visitor GUID upon successful retrieval. May be an empty
 *   string if one could not be found.
 */
Drupal.behaviors.eloquaApiTracking.getGuid = function getGuid(callback) {
  if (Drupal.settings.eloqua_api && typeof Drupal.settings.eloqua_api.firstPartyCookieHost !== 'undefined') {
    Drupal.behaviors.eloquaApiTracking._getGuidFromCookie(callback);
  }
  else {
    Drupal.behaviors.eloquaApiTracking._getGuidFromEloqua(callback);
  }
};

/**
 * Private method to pull GUID from first-party cookie. Pulled directly from
 * Eloqua documentation.
 *
 * @param {function} callback
 *   Callback method called with a single argument (the GUID) when the GUID is
 *   found.
 *
 * @private
 */
Drupal.behaviors.eloquaApiTracking._getGuidFromCookie = function cookieGuid(callback) {
  // HACK. @todo Implement this in a non-Tableau specific way. We have to wait
  // for the cookie to be set because it happens after a convoluted process of:
  // Configure tracking script, load it async, which fires AJAX command to an
  // Eloqua domain, which responds with a 302 to a first-party domain, which
  // sets a cookie.
  Tabia.util.waitFor(function eloquaCookieIsSet() {
    return document.cookie.indexOf('ELOQUA') !== -1;
  }, function readEloquaCookie() {
    var cookies = document.cookie.split(';'),
        subCookies,
        subCookie,
        name,
        value,
        index,
        i,
        l;

    for (i = 0; i < cookies.length; i++) {
      index = cookies[i].indexOf('=');

      if (index > 0 && cookies[i].length > index + 1) {
        name = cookies[i].substr(0, index).trim();

        if (name === 'ELOQUA') {
          value = cookies[i].substr(index + 1);
          subCookies = value.split('&');

          for (l = 0; l < subCookies.length; l++) {
            subCookie = subCookies[l].split('=');

            if (subCookie.length == 2 && subCookie[0] === 'GUID') {
              callback(Drupal.behaviors.eloquaApiTracking._formatGuid(subCookie[1]));
            }
          }
        }
      }
    }
  }, function couldNotReadEloquaCookie() {
    callback('');
  }, {
    waitTimeout: 20000
  });
};

/**
 * Private method to pull GUID from Eloqua asynchronously.
 *
 * GetElqCustomerGUID() is defined globally in the external Eloqua tracking script
 * and is available once that has loaded
 *
 * @param {function} callback
 *   Callback method called with a single arugment (the GUID) when the GUID is
 *   found.
 *
 * @private
 */
Drupal.behaviors.eloquaApiTracking._getGuidFromEloqua = function eloquaGuid(callback) {
  // Poll to see if the function to get the ELQ customer GUID is available.
  var elqCustomerLoaded = setInterval(function () {
    // If the function is not available, attempt to load the function.
    if (typeof GetElqCustomerGUID !== 'function') {
      // Poll to see if the _elqQ variable is available every 1/2 second.
      // Once it is, push elqGetCustomerGUID to load the global function.
      var elqLoaded = setInterval(function() {
        if (typeof _elqQ !== 'undefined') {
          _elqQ.push(['elqGetCustomerGUID']);
          clearInterval(elqLoaded);
        }
      }, 500);
    }
    // Once the Eloqua global scope function is available, use it to get a GUID and pass
    // the GUID to the provided callback.
    else {
      var guidFromGlobal = GetElqCustomerGUID();
      callback(Drupal.behaviors.eloquaApiTracking._formatGuid(guidFromGlobal));
      clearInterval(elqCustomerLoaded);
    }
  }, 500);
};

/**
 * Private method to format and return a "proper" 8-4-4-4-12 UUID for use in querying Eloqua by external ID.
 *
 * @param {String} SuspectGuid
 *    String that *should* contain a UUID. Might be in 8-4-4-4-12 format, might just be 32 char.
 *
 * @returns {String}
 *    String formatted as 8-4-4-4-12 UUID OR the original string (if not 32 char long).
 *
 * @private
 */
Drupal.behaviors.eloquaApiTracking._formatGuid = function formatGuid(suspectGuid) {
  if(suspectGuid.length === 32 && suspectGuid.indexOf('-') === -1) {
    return suspectGuid.substr(0, 8) + '-' + suspectGuid.substr(8, 4) + '-' + suspectGuid.substr(12, 4) + '-' + suspectGuid.substr(16, 4) + '-' + suspectGuid.substr(20);
  }
  return suspectGuid;
};
;
