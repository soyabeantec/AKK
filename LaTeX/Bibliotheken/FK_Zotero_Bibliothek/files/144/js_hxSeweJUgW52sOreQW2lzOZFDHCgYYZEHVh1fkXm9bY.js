!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Coveo__temporary=e():t.Coveo__temporary=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="/js/",e(0)}([function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(2)),i(n(30)),i(n(36)),i(n(39)),i(n(54)),i(n(74)),i(n(100)),i(n(104)),i(n(170));var o=n(122);e.Analytics=o.Analytics;var r=n(238);e.AnalyticsSuggestions=r.AnalyticsSuggestions;var s=n(239);e.FieldSuggestions=s.FieldSuggestions;var a=n(184);e.Omnibox=a.Omnibox;var u=n(180);e.Querybox=u.Querybox;var l=n(182);e.SearchButton=l.SearchButton;var c=n(183);e.Searchbox=c.Searchbox;var h=n(392);h.swapVar(this)},,function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var o=n(3);o.shim();var r=n(7);r.customEventPolyfill();var s=n(8);e.version=s.version;var a=n(9);e.SearchEndpoint=a.SearchEndpoint,i(n(23));var u=n(27);u.defaultLanguage();var l=n(27);e.setLanguageAfterPageLoaded=l.setLanguageAfterPageLoaded},function(t,e,n){"use strict";function i(){o.Promise.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){throw n})})};var t=function(t){t.then(null,function(t){setTimeout(function(){throw t},0)})};"function"!=typeof o.Promise.prototype.done&&(o.Promise.prototype.done=function(e,n){var i=arguments.length?this.then.apply(this,arguments):this;return t(i),this}),"function"!=typeof o.Promise.prototype.fail&&(o.Promise.prototype.fail=function(e,n){var i=arguments.length?this.catch.apply(this,arguments):this;return t(i),this})}var o=n(4);e.shim=i},function(t,e,n){(function(e,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   3.3.1
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function r(t){G=t}function s(t){K=t}function a(){return function(){return e.nextTick(p)}}function u(){return function(){Y(p)}}function l(){var t=0,e=new Z(p),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=p,function(){return t.port2.postMessage(0)}}function h(){var t=setTimeout;return function(){return t(p,1)}}function p(){for(var t=0;t<W;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}W=0}function d(){try{var t=n(6);return Y=t.runOnLoop||t.runOnContext,u()}catch(t){return h()}}function f(t,e){var n=arguments,i=this,o=new this.constructor(m);void 0===o[ot]&&k(o);var r=i._state;return r?!function(){var t=n[r-1];K(function(){return D(r,o,t,i._result)})}():_(i,o,t,e),o}function g(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(m);return w(n,t),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(t){try{return t.then}catch(t){return ut.error=t,ut}}function S(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}function x(t,e,n){K(function(t){var i=!1,o=S(n,e,function(n){i||(i=!0,e!==n?w(t,n):T(t,n))},function(e){i||(i=!0,O(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&o&&(i=!0,O(t,o))},t)}function C(t,e){e._state===st?T(t,e._result):e._state===at?O(t,e._result):_(e,void 0,function(e){return w(t,e)},function(e){return O(t,e)})}function E(t,e,n){e.constructor===t.constructor&&n===f&&e.constructor.resolve===g?C(t,e):n===ut?O(t,ut.error):void 0===n?T(t,e):o(n)?x(t,e,n):T(t,e)}function w(e,n){e===n?O(e,v()):t(n)?E(e,n,b(n)):T(e,n)}function A(t){t._onerror&&t._onerror(t._result),M(t)}function T(t,e){t._state===rt&&(t._result=e,t._state=st,0!==t._subscribers.length&&K(M,t))}function O(t,e){t._state===rt&&(t._state=at,t._result=e,K(A,t))}function _(t,e,n,i){var o=t._subscribers,r=o.length;t._onerror=null,o[r]=e,o[r+st]=n,o[r+at]=i,0===r&&t._state&&K(M,t)}function M(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,o=void 0,r=t._result,s=0;s<e.length;s+=3)i=e[s],o=e[s+n],i?D(n,i,o,r):o(r);t._subscribers.length=0}}function N(){this.error=null}function R(t,e){try{return t(e)}catch(t){return lt.error=t,lt}}function D(t,e,n,i){var r=o(n),s=void 0,a=void 0,u=void 0,l=void 0;if(r){if(s=R(n,i),s===lt?(l=!0,a=s.error,s=null):u=!0,e===s)return void O(e,y())}else s=i,u=!0;e._state!==rt||(r&&u?w(e,s):l?O(e,a):t===st?T(e,s):t===at&&O(e,s))}function I(t,e){try{e(function(e){w(t,e)},function(e){O(t,e)})}catch(e){O(t,e)}}function F(){return ct++}function k(t){t[ot]=ct++,t._state=void 0,t._result=void 0,t._subscribers=[]}function $(t,e){this._instanceConstructor=t,this.promise=new t(m),this.promise[ot]||k(this.promise),z(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&T(this.promise,this._result))):O(this.promise,L())}function L(){return new Error("Array Methods must be provided an Array")}function U(t){return new $(this,t).promise}function B(t){var e=this;return new e(z(t)?function(n,i){for(var o=t.length,r=0;r<o;r++)e.resolve(t[r]).then(n,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function P(t){var e=this,n=new e(m);return O(n,t),n}function Q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(t){this[ot]=F(),this._result=this._state=void 0,this._subscribers=[],m!==t&&("function"!=typeof t&&Q(),this instanceof H?I(this,t):V())}function q(){var t=void 0;if("undefined"!=typeof i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=H}var j=void 0;j=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var z=j,W=0,Y=void 0,G=void 0,K=function(t,e){nt[W]=t,nt[W+1]=e,W+=2,2===W&&(G?G(p):it())},X="undefined"!=typeof window?window:void 0,J=X||{},Z=J.MutationObserver||J.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),it=void 0;it=tt?a():Z?l():et?c():void 0===X?d():h();var ot=Math.random().toString(36).substring(16),rt=void 0,st=1,at=2,ut=new N,lt=new N,ct=0;return $.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===rt&&n<t;n++)this._eachEntry(e[n],n)},$.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===g){var o=b(t);if(o===f&&t._state!==rt)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===H){var r=new n(m);E(r,t,o),this._willSettleAt(r,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},$.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===rt&&(this._remaining--,t===at?O(i,n):this._result[e]=n),0===this._remaining&&T(i,this._result)},$.prototype._willSettleAt=function(t,e){var n=this;_(t,void 0,function(t){return n._settledAt(st,e,t)},function(t){return n._settledAt(at,e,t)})},H.all=U,H.race=B,H.resolve=g,H.reject=P,H._setScheduler=r,H._setAsap=s,H._asap=K,H.prototype={constructor:H,then:f,catch:function(t){return this.then(null,t)}},q(),H.polyfill=q,H.Promise=H,H})}).call(e,n(5),function(){return this}())},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function r(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){g&&d&&(g=!1,d.length?f=d.concat(f):m=-1,f.length&&a())}function a(){if(!g){var t=o(s);g=!0;for(var e=f.length;e;){for(d=f,f=[];++m<e;)d&&d[m].run();m=-1,e=f.length}d=null,g=!1,r(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,h,p=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var d,f=[],g=!1,m=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new u(t,e)),1!==f.length||g||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e){},function(t,e){"use strict";function n(){if("function"!=typeof window.CustomEvent){var t=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n};t.prototype=window.Event.prototype,window.CustomEvent=t}}e.customEventPolyfill=n},function(t,e){"use strict";e.version={lib:"1.1865.16",product:"1.1865.16",supportedApiVersion:2}},function(t,e,n){(function(t){"use strict";function i(t){return function(e,n,i){var o=i.value,r=e[n].prototype.constructor.length;return i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var i=this.buildBaseUri(t);if(e[r-1])e[r-1].url=i;else{var s={url:i,queryString:[],requestData:{},method:"",responseType:"",errorsAsSuccess:!1};e[r-1]=s}var a=o.apply(this,e);return a},i}}function o(t){return function(e,n,i){var o=i.value,r=e[n].prototype.constructor.length;return i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var i=this.buildSearchAlertsUri(t);if(e[r-1])e[r-1].url=i;else{var s={url:i,queryString:[],requestData:{},method:"",responseType:"",errorsAsSuccess:!1};e[r-1]=s}var a=o.apply(this,e);return a},i}}function r(t){return function(e,n,i){var o=i.value,r=e[n].prototype.constructor.length;return i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];if(e[r-1])e[r-1].requestDataType=t;else{var i={url:"",queryString:[],requestData:{},requestDataType:t,method:"",responseType:"",errorsAsSuccess:!1};e[r-1]=i}var s=o.apply(this,e);return s},i}}function s(t){return function(e,n,i){var o=i.value,r=e[n].prototype.constructor.length;return i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];if(e[r-1])e[r-1].method=t;else{var i={url:"",queryString:[],requestData:{},method:t,responseType:"",errorsAsSuccess:!1};e[r-1]=i}var s=o.apply(this,e);return s},i}}function a(t){return function(e,n,i){var o=i.value,r=e[n].prototype.constructor.length;return i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];if(e[r-1])e[r-1].responseType=t;else{var i={url:"",queryString:[],requestData:{},method:"",responseType:t,errorsAsSuccess:!1};e[r-1]=i}var s=o.apply(this,e);return s},i}}function u(t){return void 0===t&&(t="access_token"),function(e,n,i){var o=i.value,r=e[n].prototype.constructor.length;return i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var i=this.buildAccessToken(t);if(e[r-1])e[r-1].queryString=e[r-1].queryString.concat(i);else{var s={url:"",queryString:i,requestData:{},method:"",responseType:"",errorsAsSuccess:!1};e[r-1]=s}var a=o.apply(this,e);return a},i}}var l=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},c=n(12),h=n(13),p=n(14),d=n(8),f=n(19),g=n(20),m=n(21),v=n(22),y=n(15),b=n(4),S=n(3);S.shim();var x=function(){function t(){this.version="v2",this.queryStringArguments={},this.anonymous=!1,this.isGuestUser=!1}return t}();e.DefaultSearchEndpointOptions=x;var C=function(){function e(n){var i=this;this.options=n,p.Assert.exists(n),p.Assert.exists(n.restUri);var o=new x;o.anonymous=0==window.location.href.indexOf("file://")&&y.Utils.isNonEmptyString(n.accessToken),this.options=t.extend({},o,n),e.isDebugArgumentPresent()&&(this.options.queryStringArguments.debug=1),this.onUnload=function(){i.handleUnload()},window.addEventListener("beforeunload",this.onUnload),this.logger=new h.Logger(this),this.createEndpointCaller()}return e.configureSampleEndpoint=function(n){e.isUseLocalArgumentPresent()?e.endpoints.default=new e(t.extend({restUri:"http://localhost:8100/rest/search",searchAlertsUri:"http://localhost:8088/rest/search/alerts/"},n)):e.endpoints.default=new e(t.extend({restUri:"https://cloudplatform.coveo.com/rest/search",accessToken:"52d806a2-0f64-4390-a3f2-e0f41a4a73ec"},n))},e.configureSampleEndpointV2=function(n){e.endpoints.default=new e(t.extend({restUri:"https://platform.cloud.coveo.com/rest/search",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",queryStringArguments:{organizationID:"searchuisamples"}}))},e.configureCloudEndpoint=function(t,n,i,o){void 0===i&&(i="https://cloudplatform.coveo.com/rest/search");var r={restUri:i,accessToken:n,queryStringArguments:{organizationId:t}},s=e.mergeConfigOptions(r,o);e.endpoints.default=new e(e.removeUndefinedConfigOption(s))},e.configureCloudV2Endpoint=function(t,n,i,o){return void 0===i&&(i="https://platform.cloud.coveo.com/rest/search"),e.configureCloudEndpoint(t,n,i,o)},e.configureOnPremiseEndpoint=function(t,n,i){var o=e.mergeConfigOptions({restUri:t,accessToken:n},i);e.endpoints.default=new e(e.removeUndefinedConfigOption(o))},e.removeUndefinedConfigOption=function(e){return t.each(t.keys(e),function(t){void 0==e[t]&&delete e[t]}),e},e.mergeConfigOptions=function(n,i){return n=e.removeUndefinedConfigOption(n),i=e.removeUndefinedConfigOption(i),t.extend({},n,i)},e.prototype.reset=function(){this.createEndpointCaller()},e.prototype.setRequestModifier=function(t){this.caller.options.requestModifier=t},e.prototype.getBaseUri=function(){return this.buildBaseUri("")},e.prototype.getBaseAlertsUri=function(){return this.buildSearchAlertsUri("")},e.prototype.getAuthenticationProviderUri=function(t,e,n,i,o){var r=this.buildBaseQueryString(i);return o.queryString=o.queryString.concat(r),o.url+=t+"?",y.Utils.isNonEmptyString(e)?o.url+="redirectUri="+encodeURIComponent(e)+"&":y.Utils.isNonEmptyString(n)&&(o.url+="message="+encodeURIComponent(n)+"&"),o.url+=o.queryString.join("&"),o.url},e.prototype.isJsonp=function(){return this.caller.useJsonp},e.prototype.search=function(t,e,n){var i=this;return p.Assert.exists(t),n.requestData=t,this.logger.info("Performing REST query",t),this.performOneCall(n,e).then(function(e){return i.logger.info("REST query successful",e,t),null==e.apiVersion&&(e.apiVersion=1),e.apiVersion<d.version.supportedApiVersion&&i.logger.error("Please update your REST Search API"),y.Utils.isNullOrEmptyString(e.searchUid)&&(e.searchUid=m.QueryUtils.createGuid()),m.QueryUtils.setIndexAndUidOnQueryResults(t,e,e.searchUid,e.pipeline,e.splitTestRun),m.QueryUtils.setTermsToHighlightOnQueryResults(t,e),e})},e.prototype.getExportToExcelLink=function(t,e,n,i){var o=this.buildBaseQueryString(n);return i.queryString=i.queryString.concat(o),o=this.buildCompleteQueryString(null,t),i.queryString=i.queryString.concat(o),null!=e&&i.queryString.push("numberOfResults="+e),i.queryString.push("format=xlsx"),i.url+"?"+i.queryString.join("&")},e.prototype.getRawDataStream=function(t,e,n,i){var o=this;p.Assert.exists(t);var r=this.buildViewAsHtmlQueryString(t,n);return i.queryString=i.queryString.concat(r),this.logger.info("Performing REST query for datastream "+e+" on document uniqueID"+t),i.queryString.push("dataStream="+e),this.performOneCall(i).then(function(e){return o.logger.info("REST query successful",e,t),e})},e.prototype.getViewAsDatastreamUri=function(e,n,i,o){i=t.extend({},i);var r=this.buildBaseQueryString(i);return o.queryString=o.queryString.concat(r),r=this.buildViewAsHtmlQueryString(e,i),o.queryString=o.queryString.concat(r),r=this.buildCompleteQueryString(i.query,i.queryObject),o.queryString=o.queryString.concat(r),o.url+"?"+o.queryString.join("&")+"&dataStream="+encodeURIComponent(n)},e.prototype.getDocument=function(t,e,n){var i=this.buildViewAsHtmlQueryString(t,e);return n.queryString=n.queryString.concat(i),this.performOneCall(n)},e.prototype.getDocumentText=function(t,e,n){var i=this.buildViewAsHtmlQueryString(t,e);return n.queryString=n.queryString.concat(i),this.performOneCall(n).then(function(t){return t.content})},e.prototype.getDocumentHtml=function(e,n,i){n=t.extend({},n);var o=this.buildViewAsHtmlQueryString(e,n);return i.queryString=i.queryString.concat(o),i.requestData=n.queryObject||{q:n.query},this.performOneCall(i)},e.prototype.getViewAsHtmlUri=function(e,n,i){var o=this.buildBaseQueryString(n);return i.queryString=i.queryString.concat(o),o=this.buildViewAsHtmlQueryString(e,n),i.queryString=i.queryString.concat(o),i.queryString=t.uniq(i.queryString),i.url+"?"+i.queryString.join("&")},e.prototype.batchFieldValues=function(t,e,n){var i=this;return p.Assert.exists(t),this.performOneCall(n).then(function(e){return i.logger.info("REST list field values successful",e.values,t),e.values})},e.prototype.listFieldValues=function(t,e,n){var i=this;return p.Assert.exists(t),n.requestData=t,this.logger.info("Listing field values",t),this.performOneCall(n).then(function(e){return i.logger.info("REST list field values successful",e.values,t),e.values})},e.prototype.listFields=function(t,e){return this.logger.info("Listing fields"),this.performOneCall(e).then(function(t){return t.fields})},e.prototype.extensions=function(t,e){return this.logger.info("Listing extensions"),this.performOneCall(e)},e.prototype.rateDocument=function(t,e,n){return this.logger.info("Rating a document",t),n.requestData=t,this.performOneCall(n).then(function(){return!0})},e.prototype.tagDocument=function(t,e,n){return this.logger.info("Tagging a document",t),n.requestData=t,this.performOneCall(n).then(function(){return!0})},e.prototype.getRevealQuerySuggest=function(t,e,n){return this.logger.info("Get Reveal Query Suggest",t),n.requestData=t,this.performOneCall(n)},e.prototype.follow=function(t,e,n){return n.requestData=t,this.logger.info("Following a document or a query",t),this.performOneCall(n)},e.prototype.listSubscriptions=function(t,e,n){var i=this;return this.options.isGuestUser?new b.Promise(function(t,e){e()}):(null==this.currentListSubscriptions&&(n.queryString.push("page="+(t||0)),this.currentListSubscriptions=this.performOneCall(n),this.currentListSubscriptions.then(function(t){return i.currentListSubscriptions=null,t}).catch(function(t){if(503!=t.status)throw t})),this.currentListSubscriptions)},e.prototype.updateSubscription=function(t,e,n){return n.requestData=t,this.logger.info("Updating a subscription",t),n.url+=t.id,this.performOneCall(n)},e.prototype.deleteSubscription=function(t,e,n){return n.url+=t.id,this.performOneCall(n)},e.prototype.logError=function(t,e,n){return n.requestData=t,this.performOneCall(n,e).then(function(){return!0}).catch(function(){return!1})},e.prototype.nuke=function(){window.removeEventListener("beforeunload",this.onUnload)},e.prototype.createEndpointCaller=function(){this.caller=new c.EndpointCaller(this.options)},e.isDebugArgumentPresent=function(){return/[?&]debug=1([&]|$)/.test(window.location.search)},e.isUseLocalArgumentPresent=function(){return/[?&]useLocal=1([&]|$)/.test(window.location.search)},e.prototype.handleUnload=function(){this.isRedirecting=!0},e.prototype.buildBaseUri=function(t){p.Assert.isString(t);var e=this.options.restUri;return e=this.removeTrailingSlash(e),y.Utils.isNonEmptyString(this.options.version)&&(e+="/"+this.options.version),e+=t},e.prototype.buildSearchAlertsUri=function(t){p.Assert.isString(t);var e=this.options.searchAlertsUri||this.options.restUri+"/alerts";return null==e?null:(e=this.removeTrailingSlash(e),e+=t)},e.prototype.buildAccessToken=function(t){var e=[];return y.Utils.isNonEmptyString(this.options.accessToken)&&e.push(t+"="+encodeURIComponent(this.options.accessToken)),e},e.prototype.buildBaseQueryString=function(e){e=t.extend({},e);var n=[];for(var i in this.options.queryStringArguments)n.push(i+"="+encodeURIComponent(this.options.queryStringArguments[i]));return e&&t.isArray(e.authentication)&&0!=e.authentication.length&&n.push("authentication="+e.authentication.join(",")),n},e.prototype.buildCompleteQueryString=function(e,n){var i=[];return n?(t.each(["q","aq","cq","dq","searchHub","tab","language","pipeline","lowercaseOperators"],function(t){n[t]&&i.push(t+"="+encodeURIComponent(n[t]))}),t.each(n.context,function(t,e){i.push("context["+e+"]="+encodeURIComponent(t))})):e&&i.push("q="+encodeURIComponent(e)),i},e.prototype.buildViewAsHtmlQueryString=function(e,n){n=t.extend({},n);var i=this.buildBaseQueryString(n);return i.push("uniqueId="+encodeURIComponent(e)),(n.query||n.queryObject)&&i.push("enableNavigation=true"),n.requestedOutputSize&&i.push("requestedOutputSize="+encodeURIComponent(n.requestedOutputSize.toString())),n.contentType&&i.push("contentType="+encodeURIComponent(n.contentType)),i},e.prototype.performOneCall=function(e,n,i){var o=this;void 0===i&&(i=!0);var r=this.buildBaseQueryString(n);return e.queryString=e.queryString.concat(r),e.queryString=t.uniq(e.queryString),this.caller.call(e).then(function(t){return t.data&&t.data.clientDuration&&(t.data.clientDuration=t.duration),t.data}).catch(function(r){if(i&&o.canRenewAccessToken()&&o.isAccessTokenExpiredStatus(r.statusCode))o.renewAccessToken().then(function(){return o.performOneCall(e,n,i)}).catch(function(){return b.Promise.reject(o.handleErrorResponse(r))});else{if(0!=r.statusCode||!o.isRedirecting)return b.Promise.reject(o.handleErrorResponse(r));t.defer(function(){return""})}})},e.prototype.handleErrorResponse=function(t){return this.isMissingAuthenticationProviderStatus(t.statusCode)?new g.MissingAuthenticationError(t.data.provider):t.data&&t.data.message&&t.data.type?new v.QueryError(t):t.data&&t.data.message?new f.AjaxError("Request Error : "+t.data.message,t.statusCode):new f.AjaxError("Request Error",t.statusCode)},e.prototype.canRenewAccessToken=function(){return y.Utils.isNonEmptyString(this.options.accessToken)&&t.isFunction(this.options.renewAccessToken)},e.prototype.renewAccessToken=function(){var t=this;return this.logger.info("Renewing expired access token"),this.options.renewAccessToken().then(function(e){return p.Assert.isNonEmptyString(e),t.options.accessToken=e,t.createEndpointCaller(),e}).catch(function(e){return t.logger.error("Failed to renew access token",e),e})},e.prototype.removeTrailingSlash=function(t){return this.hasTrailingSlash(t)&&(t=t.substr(0,t.length-1)),t},e.prototype.hasTrailingSlash=function(t){return"/"==t.charAt(t.length-1)},e.prototype.isMissingAuthenticationProviderStatus=function(t){return 402==t},e.prototype.isAccessTokenExpiredStatus=function(t){return 419==t},e.endpoints={},l([i("/login/"),u()],e.prototype,"getAuthenticationProviderUri",null),l([i("/"),s("POST"),a("text")],e.prototype,"search",null),l([i("/"),u()],e.prototype,"getExportToExcelLink",null),l([i("/datastream"),u(),s("GET"),a("arraybuffer")],e.prototype,"getRawDataStream",null),l([i("/datastream"),u()],e.prototype,"getViewAsDatastreamUri",null),l([i("/document"),s("GET"),a("text")],e.prototype,"getDocument",null),l([i("/text"),s("GET"),a("text")],e.prototype,"getDocumentText",null),l([i("/html"),s("POST"),a("document")],e.prototype,"getDocumentHtml",null),l([i("/html"),u()],e.prototype,"getViewAsHtmlUri",null),l([i("/values"),s("POST"),a("text")],e.prototype,"batchFieldValues",null),l([i("/values"),s("POST"),a("text")],e.prototype,"listFieldValues",null),l([i("/fields"),s("GET"),a("text")],e.prototype,"listFields",null),l([i("/extensions"),s("GET"),a("text")],e.prototype,"extensions",null),l([i("/rating"),s("POST"),a("text")],e.prototype,"rateDocument",null),l([i("/tag"),s("POST"),a("text")],e.prototype,"tagDocument",null),l([i("/querySuggest"),s("GET"),a("text")],e.prototype,"getRevealQuerySuggest",null),l([o("/subscriptions"),u("accessToken"),s("POST"),r("application/json"),a("text")],e.prototype,"follow",null),l([o("/subscriptions"),u("accessToken"),s("GET"),r("application/json"),a("text")],e.prototype,"listSubscriptions",null),l([o("/subscriptions/"),u("accessToken"),s("PUT"),r("application/json"),a("text")],e.prototype,"updateSubscription",null),l([o("/subscriptions/"),u("accessToken"),s("DELETE"),r("application/json"),a("text")],e.prototype,"deleteSubscription",null),l([i("/log"),s("POST")],e.prototype,"logError",null),e}();e.SearchEndpoint=C}).call(e,n(10))},function(t,e,n){var i,o;(function(){function r(t){function e(e,n,i,o,r,s){for(;r>=0&&s>r;r+=t){var a=o?o[r]:r;i=n(i,e[a],a,e)}return i}return function(n,i,o,r){i=w(i,r,4);var s=!R(n)&&E.keys(n),a=(s||n).length,u=t>0?0:a-1;return arguments.length<3&&(o=n[s?s[u]:u],u+=t),e(n,i,o,s,u,a)}}function s(t){return function(e,n,i){n=A(n,i);for(var o=N(e),r=t>0?0:o-1;r>=0&&o>r;r+=t)if(n(e[r],r,e))return r;return-1}}function a(t,e,n){return function(i,o,r){var s=0,a=N(i);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(n&&r&&a)return r=n(i,o),i[r]===o?r:-1;if(o!==o)return r=e(g.call(i,s,a),E.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&a>r;r+=t)if(i[r]===o)return r;return-1}}function u(t,e){var n=$.length,i=t.constructor,o=E.isFunction(i)&&i.prototype||p,r="constructor";for(E.has(t,r)&&!E.contains(e,r)&&e.push(r);n--;)r=$[n],r in t&&t[r]!==o[r]&&!E.contains(e,r)&&e.push(r)}var l=this,c=l._,h=Array.prototype,p=Object.prototype,d=Function.prototype,f=h.push,g=h.slice,m=p.toString,v=p.hasOwnProperty,y=Array.isArray,b=Object.keys,S=d.bind,x=Object.create,C=function(){},E=function(t){return t instanceof E?t:this instanceof E?void(this._wrapped=t):new E(t)};"undefined"!=typeof t&&t.exports&&(e=t.exports=E),e._=E,E.VERSION="1.8.3";var w=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)};case 4:return function(n,i,o,r){return t.call(e,n,i,o,r)}}return function(){return t.apply(e,arguments)}},A=function(t,e,n){return null==t?E.identity:E.isFunction(t)?w(t,e,n):E.isObject(t)?E.matcher(t):E.property(t)};E.iteratee=function(t,e){return A(t,e,1/0)};var T=function(t,e){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var o=1;i>o;o++)for(var r=arguments[o],s=t(r),a=s.length,u=0;a>u;u++){var l=s[u];e&&void 0!==n[l]||(n[l]=r[l])}return n}},O=function(t){if(!E.isObject(t))return{};if(x)return x(t);C.prototype=t;var e=new C;return C.prototype=null,e},_=function(t){return function(e){return null==e?void 0:e[t]}},M=Math.pow(2,53)-1,N=_("length"),R=function(t){var e=N(t);return"number"==typeof e&&e>=0&&M>=e};E.each=E.forEach=function(t,e,n){e=w(e,n);var i,o;if(R(t))for(i=0,o=t.length;o>i;i++)e(t[i],i,t);else{var r=E.keys(t);for(i=0,o=r.length;o>i;i++)e(t[r[i]],r[i],t)}return t},E.map=E.collect=function(t,e,n){e=A(e,n);for(var i=!R(t)&&E.keys(t),o=(i||t).length,r=Array(o),s=0;o>s;s++){var a=i?i[s]:s;r[s]=e(t[a],a,t)}return r},E.reduce=E.foldl=E.inject=r(1),E.reduceRight=E.foldr=r(-1),E.find=E.detect=function(t,e,n){var i;return i=R(t)?E.findIndex(t,e,n):E.findKey(t,e,n),void 0!==i&&i!==-1?t[i]:void 0},E.filter=E.select=function(t,e,n){var i=[];return e=A(e,n),E.each(t,function(t,n,o){e(t,n,o)&&i.push(t)}),i},E.reject=function(t,e,n){return E.filter(t,E.negate(A(e)),n)},E.every=E.all=function(t,e,n){e=A(e,n);for(var i=!R(t)&&E.keys(t),o=(i||t).length,r=0;o>r;r++){var s=i?i[r]:r;if(!e(t[s],s,t))return!1}return!0},E.some=E.any=function(t,e,n){e=A(e,n);for(var i=!R(t)&&E.keys(t),o=(i||t).length,r=0;o>r;r++){var s=i?i[r]:r;if(e(t[s],s,t))return!0}return!1},E.contains=E.includes=E.include=function(t,e,n,i){return R(t)||(t=E.values(t)),("number"!=typeof n||i)&&(n=0),E.indexOf(t,e,n)>=0},E.invoke=function(t,e){var n=g.call(arguments,2),i=E.isFunction(e);return E.map(t,function(t){var o=i?e:t[e];return null==o?o:o.apply(t,n)})},E.pluck=function(t,e){return E.map(t,E.property(e))},E.where=function(t,e){return E.filter(t,E.matcher(e))},E.findWhere=function(t,e){return E.find(t,E.matcher(e))},E.max=function(t,e,n){var i,o,r=-1/0,s=-1/0;if(null==e&&null!=t){t=R(t)?t:E.values(t);for(var a=0,u=t.length;u>a;a++)i=t[a],i>r&&(r=i)}else e=A(e,n),E.each(t,function(t,n,i){o=e(t,n,i),(o>s||o===-1/0&&r===-1/0)&&(r=t,s=o)});return r},E.min=function(t,e,n){var i,o,r=1/0,s=1/0;if(null==e&&null!=t){t=R(t)?t:E.values(t);for(var a=0,u=t.length;u>a;a++)i=t[a],r>i&&(r=i)}else e=A(e,n),E.each(t,function(t,n,i){o=e(t,n,i),(s>o||1/0===o&&1/0===r)&&(r=t,s=o)});return r},E.shuffle=function(t){for(var e,n=R(t)?t:E.values(t),i=n.length,o=Array(i),r=0;i>r;r++)e=E.random(0,r),e!==r&&(o[r]=o[e]),o[e]=n[r];return o},E.sample=function(t,e,n){return null==e||n?(R(t)||(t=E.values(t)),t[E.random(t.length-1)]):E.shuffle(t).slice(0,Math.max(0,e))},E.sortBy=function(t,e,n){return e=A(e,n),E.pluck(E.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var D=function(t){return function(e,n,i){var o={};return n=A(n,i),E.each(e,function(i,r){var s=n(i,r,e);t(o,i,s)}),o}};E.groupBy=D(function(t,e,n){E.has(t,n)?t[n].push(e):t[n]=[e]}),E.indexBy=D(function(t,e,n){t[n]=e}),E.countBy=D(function(t,e,n){E.has(t,n)?t[n]++:t[n]=1}),E.toArray=function(t){return t?E.isArray(t)?g.call(t):R(t)?E.map(t,E.identity):E.values(t):[]},E.size=function(t){return null==t?0:R(t)?t.length:E.keys(t).length},E.partition=function(t,e,n){e=A(e,n);var i=[],o=[];return E.each(t,function(t,n,r){(e(t,n,r)?i:o).push(t)}),[i,o]},E.first=E.head=E.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:E.initial(t,t.length-e)},E.initial=function(t,e,n){return g.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},E.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:E.rest(t,Math.max(0,t.length-e))},E.rest=E.tail=E.drop=function(t,e,n){return g.call(t,null==e||n?1:e)},E.compact=function(t){return E.filter(t,E.identity)};var I=function(t,e,n,i){for(var o=[],r=0,s=i||0,a=N(t);a>s;s++){var u=t[s];if(R(u)&&(E.isArray(u)||E.isArguments(u))){e||(u=I(u,e,n));var l=0,c=u.length;for(o.length+=c;c>l;)o[r++]=u[l++]}else n||(o[r++]=u)}return o};E.flatten=function(t,e){return I(t,e,!1)},E.without=function(t){return E.difference(t,g.call(arguments,1))},E.uniq=E.unique=function(t,e,n,i){E.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=A(n,i));for(var o=[],r=[],s=0,a=N(t);a>s;s++){var u=t[s],l=n?n(u,s,t):u;e?(s&&r===l||o.push(u),r=l):n?E.contains(r,l)||(r.push(l),o.push(u)):E.contains(o,u)||o.push(u)}return o},E.union=function(){return E.uniq(I(arguments,!0,!0))},E.intersection=function(t){for(var e=[],n=arguments.length,i=0,o=N(t);o>i;i++){var r=t[i];if(!E.contains(e,r)){for(var s=1;n>s&&E.contains(arguments[s],r);s++);s===n&&e.push(r)}}return e},E.difference=function(t){var e=I(arguments,!0,!0,1);return E.filter(t,function(t){return!E.contains(e,t)})},E.zip=function(){return E.unzip(arguments)},E.unzip=function(t){for(var e=t&&E.max(t,N).length||0,n=Array(e),i=0;e>i;i++)n[i]=E.pluck(t,i);return n},E.object=function(t,e){for(var n={},i=0,o=N(t);o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},E.findIndex=s(1),E.findLastIndex=s(-1),E.sortedIndex=function(t,e,n,i){n=A(n,i,1);for(var o=n(e),r=0,s=N(t);s>r;){var a=Math.floor((r+s)/2);n(t[a])<o?r=a+1:s=a}return r},E.indexOf=a(1,E.findIndex,E.sortedIndex),E.lastIndexOf=a(-1,E.findLastIndex),E.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=Array(i),r=0;i>r;r++,t+=n)o[r]=t;return o};var F=function(t,e,n,i,o){if(!(i instanceof e))return t.apply(n,o);var r=O(t.prototype),s=t.apply(r,o);return E.isObject(s)?s:r};E.bind=function(t,e){if(S&&t.bind===S)return S.apply(t,g.call(arguments,1));if(!E.isFunction(t))throw new TypeError("Bind must be called on a function");var n=g.call(arguments,2),i=function(){return F(t,i,e,this,n.concat(g.call(arguments)))};return i},E.partial=function(t){var e=g.call(arguments,1),n=function(){for(var i=0,o=e.length,r=Array(o),s=0;o>s;s++)r[s]=e[s]===E?arguments[i++]:e[s];for(;i<arguments.length;)r.push(arguments[i++]);return F(t,n,this,this,r)};return n},E.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=E.bind(t[n],t);return t},E.memoize=function(t,e){var n=function(i){var o=n.cache,r=""+(e?e.apply(this,arguments):i);return E.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return n.cache={},n},E.delay=function(t,e){var n=g.call(arguments,2);return setTimeout(function(){
return t.apply(null,n)},e)},E.defer=E.partial(E.delay,E,1),E.throttle=function(t,e,n){var i,o,r,s=null,a=0;n||(n={});var u=function(){a=n.leading===!1?0:E.now(),s=null,r=t.apply(i,o),s||(i=o=null)};return function(){var l=E.now();a||n.leading!==!1||(a=l);var c=e-(l-a);return i=this,o=arguments,0>=c||c>e?(s&&(clearTimeout(s),s=null),a=l,r=t.apply(i,o),s||(i=o=null)):s||n.trailing===!1||(s=setTimeout(u,c)),r}},E.debounce=function(t,e,n){var i,o,r,s,a,u=function(){var l=E.now()-s;e>l&&l>=0?i=setTimeout(u,e-l):(i=null,n||(a=t.apply(r,o),i||(r=o=null)))};return function(){r=this,o=arguments,s=E.now();var l=n&&!i;return i||(i=setTimeout(u,e)),l&&(a=t.apply(r,o),r=o=null),a}},E.wrap=function(t,e){return E.partial(e,t)},E.negate=function(t){return function(){return!t.apply(this,arguments)}},E.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},E.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},E.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},E.once=E.partial(E.before,2);var k=!{toString:null}.propertyIsEnumerable("toString"),$=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];E.keys=function(t){if(!E.isObject(t))return[];if(b)return b(t);var e=[];for(var n in t)E.has(t,n)&&e.push(n);return k&&u(t,e),e},E.allKeys=function(t){if(!E.isObject(t))return[];var e=[];for(var n in t)e.push(n);return k&&u(t,e),e},E.values=function(t){for(var e=E.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},E.mapObject=function(t,e,n){e=A(e,n);for(var i,o=E.keys(t),r=o.length,s={},a=0;r>a;a++)i=o[a],s[i]=e(t[i],i,t);return s},E.pairs=function(t){for(var e=E.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},E.invert=function(t){for(var e={},n=E.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},E.functions=E.methods=function(t){var e=[];for(var n in t)E.isFunction(t[n])&&e.push(n);return e.sort()},E.extend=T(E.allKeys),E.extendOwn=E.assign=T(E.keys),E.findKey=function(t,e,n){e=A(e,n);for(var i,o=E.keys(t),r=0,s=o.length;s>r;r++)if(i=o[r],e(t[i],i,t))return i},E.pick=function(t,e,n){var i,o,r={},s=t;if(null==s)return r;E.isFunction(e)?(o=E.allKeys(s),i=w(e,n)):(o=I(arguments,!1,!1,1),i=function(t,e,n){return e in n},s=Object(s));for(var a=0,u=o.length;u>a;a++){var l=o[a],c=s[l];i(c,l,s)&&(r[l]=c)}return r},E.omit=function(t,e,n){if(E.isFunction(e))e=E.negate(e);else{var i=E.map(I(arguments,!1,!1,1),String);e=function(t,e){return!E.contains(i,e)}}return E.pick(t,e,n)},E.defaults=T(E.allKeys,!0),E.create=function(t,e){var n=O(t);return e&&E.extendOwn(n,e),n},E.clone=function(t){return E.isObject(t)?E.isArray(t)?t.slice():E.extend({},t):t},E.tap=function(t,e){return e(t),t},E.isMatch=function(t,e){var n=E.keys(e),i=n.length;if(null==t)return!i;for(var o=Object(t),r=0;i>r;r++){var s=n[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var L=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof E&&(t=t._wrapped),e instanceof E&&(e=e._wrapped);var o=m.call(t);if(o!==m.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(E.isFunction(s)&&s instanceof s&&E.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),r){if(u=t.length,u!==e.length)return!1;for(;u--;)if(!L(t[u],e[u],n,i))return!1}else{var l,c=E.keys(t);if(u=c.length,E.keys(e).length!==u)return!1;for(;u--;)if(l=c[u],!E.has(e,l)||!L(t[l],e[l],n,i))return!1}return n.pop(),i.pop(),!0};E.isEqual=function(t,e){return L(t,e)},E.isEmpty=function(t){return null==t||(R(t)&&(E.isArray(t)||E.isString(t)||E.isArguments(t))?0===t.length:0===E.keys(t).length)},E.isElement=function(t){return!(!t||1!==t.nodeType)},E.isArray=y||function(t){return"[object Array]"===m.call(t)},E.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},E.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){E["is"+t]=function(e){return m.call(e)==="[object "+t+"]"}}),E.isArguments(arguments)||(E.isArguments=function(t){return E.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(E.isFunction=function(t){return"function"==typeof t||!1}),E.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},E.isNaN=function(t){return E.isNumber(t)&&t!==+t},E.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===m.call(t)},E.isNull=function(t){return null===t},E.isUndefined=function(t){return void 0===t},E.has=function(t,e){return null!=t&&v.call(t,e)},E.noConflict=function(){return l._=c,this},E.identity=function(t){return t},E.constant=function(t){return function(){return t}},E.noop=function(){},E.property=_,E.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},E.matcher=E.matches=function(t){return t=E.extendOwn({},t),function(e){return E.isMatch(e,t)}},E.times=function(t,e,n){var i=Array(Math.max(0,t));e=w(e,n,1);for(var o=0;t>o;o++)i[o]=e(o);return i},E.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},E.now=Date.now||function(){return(new Date).getTime()};var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},B=E.invert(U),P=function(t){var e=function(e){return t[e]},n="(?:"+E.keys(t).join("|")+")",i=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(o,e):t}};E.escape=P(U),E.unescape=P(B),E.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),E.isFunction(i)?i.call(t):i};var Q=0;E.uniqueId=function(t){var e=++Q+"";return t?t+e:e},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+H[t]};E.template=function(t,e,n){!e&&n&&(e=n),e=E.defaults({},e,E.templateSettings);var i=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(i,function(e,n,i,s,a){return r+=t.slice(o,a).replace(q,j),o=a+e.length,n?r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(t){throw t.source=r,t}var a=function(t){return s.call(this,t,E)},u=e.variable||"obj";return a.source="function("+u+"){\n"+r+"}",a},E.chain=function(t){var e=E(t);return e._chain=!0,e};var z=function(t,e){return t._chain?E(e).chain():e};E.mixin=function(t){E.each(E.functions(t),function(e){var n=E[e]=t[e];E.prototype[e]=function(){var t=[this._wrapped];return f.apply(t,arguments),z(this,n.apply(E,t))}})},E.mixin(E),E.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=h[t];E.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],z(this,n)}}),E.each(["concat","join","slice"],function(t){var e=h[t];E.prototype[t]=function(){return z(this,e.apply(this._wrapped,arguments))}}),E.prototype.value=function(){return this._wrapped},E.prototype.valueOf=E.prototype.toJSON=E.prototype.value,E.prototype.toString=function(){return""+this._wrapped},n(11)&&(i=[],o=function(){return E}.apply(e,i),!(void 0!==o&&(t.exports=o)))}).call(this)},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){(function(t){"use strict";var i,o=n(13),r=n(14),s=n(16),a=n(17),u=n(15),l=n(4),c=n(18);!function(t){t[t.OPENED=XMLHttpRequest.OPENED||1]="OPENED",t[t.HEADERS_RECEIVED=XMLHttpRequest.HEADERS_RECEIVED||2]="HEADERS_RECEIVED",t[t.DONE=XMLHttpRequest.DONE||4]="DONE"}(i||(i={}));var h=function(){function e(t){void 0===t&&(t={}),this.options=t,this.useJsonp=!1,this.logger=new o.Logger(this)}return e.prototype.call=function(e){var n={url:e.url,queryString:e.errorsAsSuccess?e.queryString.concat(["errorsAsSuccess=1"]):e.queryString,requestData:e.requestData,requestDataType:e.requestDataType||'application/x-www-form-urlencoded; charset="UTF-8"',begun:new Date,method:e.method};n.headers=this.buildRequestHeaders(n),t.isFunction(this.options.requestModifier)&&(n=this.options.requestModifier(n)),this.logger.trace("Performing REST request",n);var i=this.parseURL(n.url),o=window.location.hostname===i.hostname||""===i.hostname,r=""!=window.location.port?window.location.port:"https:"==window.location.protocol?"443":"80",s=r==i.port,a=!(o&&s);return this.useJsonp?this.callUsingAjaxJsonP(n):this.isCORSSupported()||!a?this.callUsingXMLHttpRequest(n,e.responseType):this.isXDomainRequestSupported()?this.callUsingXDomainRequest(n):this.callUsingAjaxJsonP(n)},e.prototype.callUsingXMLHttpRequest=function(e,n){var o=this;return void 0===n&&(n="text"),new l.Promise(function(r,s){var u=new XMLHttpRequest,l=!1;u.onreadystatechange=function(c){if(u.readyState!=i.OPENED||l){if(u.readyState==i.HEADERS_RECEIVED){var h=u.status;o.isSuccessHttpStatus(h)?u.responseType=n:u.responseType="text"}else if(u.readyState==i.DONE){var p,h=u.status;switch(n){case"json":if(p=u.response,"json"==n&&"IE"==a.DeviceUtils.getDeviceName())try{p=JSON.parse(p)}catch(t){}break;case"text":p=o.tryParseResponseText(u.responseText,u.getResponseHeader("Content-Type"));break;default:p=u.response}void 0==p&&(p=o.tryParseResponseText(u.responseText,u.getResponseHeader("Content-Type"))),o.isSuccessHttpStatus(h)?o.handleSuccessfulResponseThatMightBeAnError(e,p,r,s):o.handleError(e,u.status,p,s)}}else l=!0,u.withCredentials=!0,t.each(e.headers,function(t,e){u.setRequestHeader(e,t)}),"GET"==e.method?u.send():0===e.requestDataType.indexOf("application/json")?u.send(JSON.stringify(e.requestData)):u.send(o.convertJsonToFormBody(e.requestData))};var c=e.queryString;"GET"==e.method&&(c=c.concat(o.convertJsonToQueryString(e.requestData))),u.open(e.method,o.combineUrlAndQueryString(e.url,c))})},e.prototype.callUsingXDomainRequest=function(e){var n=this;return new l.Promise(function(i,o){var r=e.queryString.concat([]);n.options.accessToken&&r.push("access_token="+encodeURIComponent(n.options.accessToken));var s=new XDomainRequest;"GET"==e.method&&(r=r.concat(n.convertJsonToQueryString(e.requestData))),s.open(e.method,n.combineUrlAndQueryString(e.url,r)),s.onload=function(){var t=n.tryParseResponseText(s.responseText,s.contentType);n.handleSuccessfulResponseThatMightBeAnError(e,t,i,o)},s.onerror=function(){var t=n.tryParseResponseText(s.responseText,s.contentType);n.handleError(e,0,t,o)},s.ontimeout=function(){return n.logger.error("Request timeout",s,e.requestData)},s.onprogress=function(){return n.logger.trace("Request progress",s,e.requestData)},t.defer(function(){"GET"==e.method?s.send():s.send(n.convertJsonToFormBody(e.requestData))})})},e.prototype.callUsingAjaxJsonP=function(t){var n=this,i=c.JQueryUtils.getJQuery();return r.Assert.check(i,"Using jsonp without having included jQuery is not supported."),new l.Promise(function(o,r){var s=t.queryString.concat(n.convertJsonToQueryString(t.requestData));n.options.accessToken&&s.push("access_token="+encodeURIComponent(n.options.accessToken)),s.push("callback=?"),i.ajax({url:n.combineUrlAndQueryString(t.url,s),dataType:"jsonp",success:function(e){return n.handleSuccessfulResponseThatMightBeAnError(t,e,o,r)},timeout:e.JSONP_ERROR_TIMEOUT,error:function(){return n.handleError(t,0,void 0,r)}})})},e.prototype.parseURL=function(t){var e=document.createElement("a");return e.href=t,e},e.prototype.convertJsonToQueryString=function(e){r.Assert.exists(e);var n=[];return t.each(e,function(e,i){null!=e&&(t.isObject(e)?n.push(i+"="+encodeURIComponent(JSON.stringify(e))):n.push(i+"="+encodeURIComponent(e.toString())))}),n},e.prototype.convertJsonToFormBody=function(t){return this.convertJsonToQueryString(t).join("&")},e.prototype.handleSuccessfulResponseThatMightBeAnError=function(t,e,n,i){this.isErrorResponseBody(e)?this.handleError(t,e.statusCode,e,i):this.handleSuccess(t,e,n)},e.prototype.handleSuccess=function(t,e,n){var i={duration:s.TimeSpan.fromDates(t.begun,new Date).getMilliseconds(),data:e};this.logger.trace("REST request successful",e,t),n(i)},e.prototype.handleError=function(t,e,n,i){var o={statusCode:e,data:n};this.logger.error("REST request failed",e,n,t),i(o)},e.prototype.combineUrlAndQueryString=function(t,e){var n="?";return t.match(/\?$/)&&(n=""),t+(e.length>0?n+e.join("&"):"")},e.prototype.isXDomainRequestSupported=function(){return"XDomainRequest"in window},e.prototype.isCORSSupported=function(){return"withCredentials"in new XMLHttpRequest},e.prototype.isSuccessHttpStatus=function(t){return t>=200&&t<300||304===t},e.prototype.tryParseResponseText=function(t,e){if(null==e||e.indexOf("application/json")==-1)return t;if(u.Utils.isNonEmptyString(t))try{return JSON.parse(t)}catch(t){return}},e.prototype.isErrorResponseBody=function(t){return!(!t||!t.statusCode)&&!this.isSuccessHttpStatus(t.statusCode)},e.prototype.buildRequestHeaders=function(t){var e={};return this.options.accessToken?e.Authorization="Bearer "+this.options.accessToken:this.options.username&&this.options.password&&(e.Authorization="Basic "+btoa(this.options.username+":"+this.options.password)),"GET"==t.method?e:(0===t.requestDataType.indexOf("application/json")?e["Content-Type"]='application/json; charset="UTF-8"':e["Content-Type"]='application/x-www-form-urlencoded; charset="UTF-8"',e)},e.JSONP_ERROR_TIMEOUT=1e4,e}();e.EndpointCaller=h}).call(e,n(10))},function(t,e){"use strict";window.console||(console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},assert:function(){},clear:function(){},count:function(){},dir:function(){},dirxml:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},msIsIndependentlyComposed:function(t){},profile:function(){},profileEnd:function(){},select:function(){},time:function(){},timeEnd:function(){},trace:function(){}});var n=function(){function t(t){this.owner=t}return t.prototype.trace=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.level<=t.TRACE&&this.log("TRACE",e)},t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.level<=t.DEBUG&&this.log("DEBUG",e)},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.level<=t.INFO&&this.log("INFO",e)},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.level<=t.WARN&&this.log("WARN",e)},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.level<=t.ERROR&&this.log("ERROR",e)},t.prototype.log=function(e,n){window.console&&console.log&&(console.log([e,this.owner].concat(n)),t.executionTime&&(console.timeEnd("Execution time"),console.time("Execution time")))},t.enable=function(){t.level=t.TRACE},t.disable=function(){t.level=t.NOTHING},t.TRACE=1,t.DEBUG=2,t.INFO=3,t.WARN=4,t.ERROR=5,t.NOTHING=6,t.level=t.INFO,t.executionTime=!1,t}();e.Logger=n},function(t,e,n){(function(t){"use strict";var i=n(13),o=n(15),r=function(){function e(){}return e.fail=function(t){e.failureHandler(t)},e.check=function(t,n){t||e.fail(n)},e.isUndefined=function(t){e.check(o.Utils.isUndefined(t),"Value should be undefined.")},e.isNotUndefined=function(t){e.check(!o.Utils.isUndefined(t),"Value should not be undefined.")},e.isNull=function(t){e.check(o.Utils.isNull(t),"Value should be null.")},e.isNotNull=function(t){e.check(!o.Utils.isNull(t),"Value should not be null.")},e.exists=function(t){e.check(!o.Utils.isNullOrUndefined(t),"Value should not be null or undefined")},e.doesNotExists=function(t){e.check(o.Utils.isNullOrUndefined(t),"Value should be null or undefined")},e.isString=function(n){e.check(t.isString(n),"Value should be a string.")},e.stringStartsWith=function(t,n){e.isNonEmptyString(t),e.isNonEmptyString(n),e.check(0==t.indexOf(n),"Value should start with "+n)},e.isNonEmptyString=function(t){e.check(o.Utils.isNonEmptyString(t),"Value should be a non-empty string.")},e.isNumber=function(n){e.check(t.isNumber(n),"Value should be a number.")},e.isLargerThan=function(t,n){e.check(n>t,"Value "+n+" should be larger than "+t)},e.isLargerOrEqualsThan=function(t,n){e.check(n>=t,"Value "+n+" should be larger or equal than "+t)},e.isSmallerThan=function(t,n){e.check(n<t,"Value "+n+" should be smaller than "+t)},e.isSmallerOrEqualsThan=function(t,n){e.check(n<=t,"Value "+n+" should be smaller or equal than "+t)},e.logger=new i.Logger("Assert"),e.failureHandler=function(t){throw e.logger.error("Assertion Failed!",t),window.console&&console.trace&&console.trace(),new s(o.Utils.isNonEmptyString(t)?t:"Assertion Failed!")},e}();e.Assert=r;var s=function(){function t(t){this.message=t}return t.prototype.toString=function(){return this.message},t}();e.PreconditionFailedException=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var n=/^@[a-zA-Z0-9_\.]+$/,i=function(){function e(){}return e.isUndefined=function(t){return"undefined"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return e.isUndefined(t)||e.isNull(t)},e.exists=function(t){return!e.isNullOrUndefined(t)},e.toNotNullString=function(e){return t.isString(e)?e:""},e.anyTypeToString=function(t){return t?t.toString():""},e.isNullOrEmptyString=function(t){return e.isNullOrUndefined(t)||!e.isNonEmptyString(t)},e.isNonEmptyString=function(e){return t.isString(e)&&""!==e},e.isEmptyString=function(t){return!e.isNonEmptyString(t)},e.stringStartsWith=function(t,e){return t.slice(0,e.length)==e},e.isNonEmptyArray=function(e){return t.isArray(e)&&e.length>0},e.isEmptyArray=function(t){return!e.isNonEmptyArray(t)},e.isHtmlElement=function(t){return void 0!=window.HTMLElement?t instanceof HTMLElement:t&&t.nodeType&&1==t.nodeType},e.parseIntIfNotUndefined=function(t){return e.isNonEmptyString(t)?parseInt(t,10):void 0},e.parseFloatIfNotUndefined=function(t){return e.isNonEmptyString(t)?parseFloat(t):void 0},e.round=function(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)},e.parseBooleanIfNotUndefined=function(t){if(e.isNonEmptyString(t))switch(t.toLowerCase()){case"true":case"1":case"yes":return!0;case"false":case"0":case"no":return!1;default:return}},e.trim=function(t){return null==t?null:t.replace(/^\s+|\s+$/g,"")},e.encodeHTMLEntities=function(t){for(var e=[],n=t.length-1;n>=0;n--)/^[a-z0-9]/i.test(t[n])?e.unshift(t[n]):e.unshift(["&#",t.charCodeAt(n),";"].join(""));return e.join("")},e.decodeHTMLEntities=function(t){return t.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(e)})},e.arrayEqual=function(e,n,i){if(void 0===i&&(i=!0),i)return t.isEqual(e,n);var o=[e,n];return t.all(o,function(e){return e.length==o[0].length&&0==t.difference(e,o[0]).length})},e.objectEqual=function(e,n){return t.isEqual(e,n)},e.isCoveoField=function(t){return n.test(t)},e.escapeRegexCharacter=function(t){var e=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");return e},e.getCaseInsensitiveProperty=function(e,n){var i=e[n];if(null==i){var o=n.toLowerCase();if(i=e[o],null==i){var r=t.find(t.keys(e),function(t){return t.toLowerCase()==o});null!=r&&(i=e[r])}}return i},e.getFieldValue=function(t,n){if(null!=n&&(n=e.trim(n),"@"==n[0]&&(n=n.substr(1)),""!=n)){if(!e.isCoveoField("@"+n))throw"Not a valid field : "+n;for(var i=n.split(".").reverse(),o=t.raw;i.length>1;)if(o=e.getCaseInsensitiveProperty(o,i.pop()),e.isUndefined(o))return;var r=e.getCaseInsensitiveProperty(o,i[0]);return null==r&&(r=e.getCaseInsensitiveProperty(t,n)),r}},e.throttle=function(t,e,n,i,o){void 0===n&&(n={});var r,s=null,a=0,u=function(){a=n.leading===!1?0:(new Date).getTime(),s=null,r=t.apply(i,o)};return function(){var l=(new Date).getTime();a||n.leading!==!1||(a=l);var c=e-(l-a);return i=this,o=arguments,c<=0?(clearTimeout(s),s=null,a=l,r=t.apply(i,o)):s||n.trailing===!1||(s=setTimeout(u,c)),r}},e.extendDeep=function(n,i){n||(n={});var o=t.isArray(i),r=o&&[]||{};return o?(n=n||[],r=r.concat(n),t.each(i,function(t,i,o){"undefined"==typeof n[i]?r[i]=t:"object"==typeof t?r[i]=e.extendDeep(n[i],t):n.indexOf(t)===-1&&r.push(t)})):(n&&"object"==typeof n&&t.each(t.keys(n),function(t){r[t]=n[t]}),t.each(t.keys(i),function(t){"object"==typeof i[t]&&i[t]&&n[t]?r[t]=e.extendDeep(n[t],i[t]):r[t]=i[t]})),r},e.getQueryStringValue=function(t,e){return void 0===e&&(e=window.location.search),e.replace(new RegExp("^(?:.*[&\\?]"+t.replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")},e.isValidUrl=function(t){var e=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return e.test(t)},e.debounce=function(t,e){var n,i;return function(){for(var o=this,r=[],s=0;s<arguments.length;s++)r[s-0]=arguments[s];null==n?(n=setTimeout(function(){n=null},e),i=setTimeout(function(){t.apply(o,r),i=null})):null==i&&(clearTimeout(n),n=setTimeout(function(){t.apply(o,r),n=null},e))}},e.readCookie=function(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null},e.toDashCase=function(t){return t.replace(/([a-z][A-Z])/g,function(t){return t[0]+"-"+t[1].toLowerCase()})},e.parseXml=function(t){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(t,"text/xml");if("undefined"!=typeof ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")){var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}throw new Error("No XML parser found")},e.copyObject=function(e,n){var i=this;t.each(t.keys(n),function(t){"object"==typeof n[t]&&n[t]&&e[t]?i.copyObject(e[t],n[t]):e[t]=n[t]})},e.copyObjectAttributes=function(e,n,i){var o=this;t.each(t.keys(n),function(r){t.contains(i,r)&&("object"==typeof n[r]&&n[r]&&e[r]?o.copyObject(e[r],n[r]):e[r]=n[r])})},e}();e.Utils=i}).call(e,n(10))},function(t,e,n){"use strict";var i=n(14),o=function(){function t(t,e){void 0===e&&(e=!0),e?this.milliseconds=t:this.milliseconds=1e3*t}return t.prototype.getMilliseconds=function(){return this.milliseconds},t.prototype.getSeconds=function(){return this.getMilliseconds()/1e3},t.prototype.getMinutes=function(){return this.getSeconds()/60},t.prototype.getHours=function(){return this.getMinutes()/60},t.prototype.getDays=function(){return this.getHours()/24},t.prototype.getWeeks=function(){return this.getDays()/7},t.prototype.getHHMMSS=function(){var t,e,n,i=Math.floor(this.getHours()),o=Math.floor(this.getMinutes())%60,r=Math.floor(this.getSeconds())%60;t=0==i?"":i<10?"0"+i.toString():i.toString(),e=o<10?"0"+o.toString():o.toString(),n=r<10?"0"+r.toString():r.toString();var s=(""!=t?t+":":"")+e+":"+n;return s},t.fromDates=function(e,n){return i.Assert.exists(e),i.Assert.exists(n),new t(n.valueOf()-e.valueOf())},t}();e.TimeSpan=o},function(t,e){"use strict";var n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),i=function(){function t(){}return t.getDeviceName=function(){var t=navigator.userAgent;return t.match(/Android/i)?"Android":t.match(/BlackBerry/i)?"BlackBerry":t.match(/iPhone/i)?"iPhone":t.match(/iPad/i)?"iPad":t.match(/iPod/i)?"iPod":t.match(/Opera Mini/i)?"Opera Mini":t.match(/IEMobile/i)?"IE Mobile":t.match(/Chrome/i)?"Chrome":t.match(/MSIE/i)||t.match(/Trident/i)?"IE":t.match(/Opera/i)?"Opera":t.match(/Firefox/i)?"Firefox":t.match(/Safari/i)?"Safari":"Others"},t.isAndroid=function(){return"Android"==t.getDeviceName()},t.isIos=function(){var e=t.getDeviceName();return"iPhone"==e||"iPad"==e||"iPod"==e},t.isIE8or9=function(){var t=navigator.userAgent.toLowerCase();return t.indexOf("msie")!=-1&&parseInt(t.split("msie")[1])<10},t.isMobileDevice=function(){return n},t.isSmallScreenWidth=function(){return null!=window.clientWidth&&window.clientWidth<=480||document.body.clientWidth<=480},t.isSmallScreenHeight=function(){return document.body.clientHeight<=640},t}();e.DeviceUtils=i},function(t,e){"use strict";var n=function(){function t(){}return t.getJQuery=function(){return!!(window&&window.Coveo&&window.Coveo.$)&&window.Coveo.$},t.isInstanceOfJQuery=function(t){var e=this.getJQuery();return!!e&&t instanceof e},t.isInstanceOfJqueryEvent=function(t){var e=this.getJQuery();return!!e&&t instanceof e.Event},t}();e.JQueryUtils=n},function(t,e,n){"use strict";var i=n(14),o=function(){function t(t,e){this.message=t,this.status=e,i.Assert.exists(t),i.Assert.exists(e),this.name=this.type="Ajax Error (status: "+e+")"}return t}();e.AjaxError=o},function(t,e){"use strict";var n=function(){function t(t){this.provider=t,this.isMissingAuthentication=!0,this.name=this.type=this.message="Missing Authentication (provider: "+t+")"}return t}();e.MissingAuthenticationError=n},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(15),r=function(){function e(){}return e.createGuid=function(){return"undefined"!=typeof crypto&&"undefined"!=typeof crypto.getRandomValues?e.generateWithCrypto():e.generateWithRandom()},e.generateWithRandom=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},e.generateWithCrypto=function(){var t=new Uint16Array(8);crypto.getRandomValues(t);var e=function(t){for(var e=t.toString(16);e.length<4;)e="0"+e;return e};return e(t[0])+e(t[1])+"-"+e(t[2])+"-"+e(t[3])+"-"+e(t[4])+"-"+e(t[5])+e(t[6])+e(t[7])},e.setStateObjectOnQueryResults=function(t,n){e.setPropertyOnResults(n,"state",t)},e.setStateObjectOnQueryResult=function(t,n){e.setPropertyOnResult(n,"state",t)},e.setIndexAndUidOnQueryResults=function(t,n,o,r,s){i.Assert.exists(t),i.Assert.exists(n);var a=t.firstResult;e.setPropertyOnResults(n,"queryUid",o),e.setPropertyOnResults(n,"pipeline",r),e.setPropertyOnResults(n,"splitTestRun",s),e.setPropertyOnResults(n,"index",a,function(){return++a})},e.setTermsToHighlightOnQueryResults=function(t,n){e.setPropertyOnResults(n,"termsToHighlight",n.termsToHighlight),e.setPropertyOnResults(n,"phrasesToHighlight",n.phrasesToHighlight)},e.splitFlags=function(t,e){return void 0===e&&(e=";"),i.Assert.exists(t),t.split(e)},e.isAttachment=function(n){return t.contains(e.splitFlags(n.flags),"IsAttachment")},e.containsAttachment=function(n){return t.contains(e.splitFlags(n.flags),"ContainsAttachment")},e.hasHTMLVersion=function(n){return t.contains(e.splitFlags(n.flags),"HasHtmlVersion")},e.hasThumbnail=function(n){return t.contains(e.splitFlags(n.flags),"HasThumbnail")},e.hasExcerpt=function(t){return void 0!=t.excerpt&&""!=t.excerpt},e.quoteAndEscapeIfNeeded=function(t){return i.Assert.isString(t),e.isAtomicString(t)||e.isRangeString(t)||e.isRangeWithoutOuterBoundsString(t)?t:e.quoteAndEscape(t)},e.quoteAndEscape=function(t){return i.Assert.isString(t),'"'+e.escapeString(t)+'"'},e.escapeString=function(t){return i.Assert.isString(t),t.replace(/"/g," ")},e.isAtomicString=function(t){return i.Assert.isString(t),/^\d+(\.\d+)?$|^[\d\w]+$/.test(t)},e.isRangeString=function(t){return i.Assert.isString(t),/^\d+(\.\d+)?\.\.\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}\.\.\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},e.isRangeWithoutOuterBoundsString=function(t){return i.Assert.isString(t),/^\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},e.buildFieldExpression=function(n,o,r){return i.Assert.isNonEmptyString(n),i.Assert.stringStartsWith(n,"@"),i.Assert.isNonEmptyString(o),i.Assert.isLargerOrEqualsThan(1,r.length),1==r.length?n+o+e.quoteAndEscapeIfNeeded(r[0]):n+o+"("+t.map(r,function(t){return e.quoteAndEscapeIfNeeded(t)}).join(",")+")"},e.buildFieldNotEqualExpression=function(n,o){i.Assert.isNonEmptyString(n),i.Assert.stringStartsWith(n,"@"),i.Assert.isLargerOrEqualsThan(1,o.length);var r;return r=1==o.length?n+"=="+e.quoteAndEscapeIfNeeded(o[0]):n+"==("+t.map(o,function(t){return e.quoteAndEscapeIfNeeded(t)}).join(",")+")","(NOT "+r+")"},e.mergeQueryString=function(t,e){var n=t.indexOf("?");return t+=n!=-1?"&"+e:"?"+e},e.mergePath=function(t,e){var n=t.split("?");return n[0]+e+"?"+(n[1]||"")},e.setPropertyOnResults=function(n,i,o,r){t.each(n.results,function(t){e.setPropertyOnResult(t,i,o),o=r?r():o})},e.setPropertyOnResult=function(e,n,i){e[n]=i,t.each(e.childResults,function(t){t[n]=i}),o.Utils.isNullOrUndefined(e.parentResult)||(e.parentResult[n]=i)},e.getUrlParameter=function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},e.isStratusAgnosticField=function(t,e){var n=/^(@?)(sys)?(.*)/i,i=n.exec(t),o=n.exec(e);return!(!i||!o)&&(i[1]+i[3]).toLowerCase()==(o[1]+o[3]).toLowerCase()},e}();e.QueryUtils=r}).call(e,n(10))},function(t,e,n){"use strict";var i=n(14),o=function(){function t(t){this.status=t.statusCode,this.message=t.data.message,this.name=this.type=t.data.type,this.queryExecutionReport=t.data.executionReport,i.Assert.isNumber(this.status),i.Assert.isNonEmptyString(this.message),i.Assert.isNonEmptyString(this.type)}return t}();e.QueryError=o},function(t,e,n){"use strict";e.ModalBox=n(24),e.MagicBox=n(25),e.LocaleString=n(26)},function(t,e){var n;!function(t){var e;!function(t){function e(t,e){void 0===e&&(e={});var n=e.body||document.body;n.className?n.className.indexOf("coveo-modalBox-opened")==-1&&(n.className+=" coveo-modalBox-opened"):n.className="coveo-modalBox-opened";var s=document.createElement("div");s.className="coveo-modalBox",n.appendChild(s),e.fullscreen===!0&&(s.className+=" coveo-fullscreen");var a=document.createElement("div");a.className="coveo-overlay",s.appendChild(a);var u=document.createElement("div");if(u.className="coveo-wrapper",s.appendChild(u),null!=e.title){var l=document.createElement("div");l.className="coveo-title",u.appendChild(l),l.innerHTML=e.title,e.titleClose===!0&&l.addEventListener("click",function(){return h()})}t.className+=" coveo-body",u.appendChild(t);var c,h=function(t,o){void 0===t&&(t=0),void 0===o&&(o=!1);var a=null==e.validation||e.validation(t);if(a!==!1||o){s.parentElement&&s.parentElement.removeChild(s);var u=r.indexOf(h);return u>=0&&r.splice(u,1),null==n.querySelector(".coveo-modalBox")&&i(n,"coveo-modalBox-opened"),!0}return!1},p=function(t,e){var n=document.createElement("div");n.className="coveo-button",n.textContent=t,n.addEventListener("click",function(){return h(e)}),c.appendChild(n)};return null!=e.buttons&&(c=document.createElement("div"),c.className="coveo-buttons",u.appendChild(c),e.buttons&o.OK&&p("Ok",o.OK),e.buttons&o.APPLY&&p("Apply",o.APPLY),e.buttons&o.YES&&p("Yes",o.YES),e.buttons&o.NO&&p("No",o.NO),e.buttons&o.CANCEL&&p("Cancel",o.CANCEL)),r.push(h),e.overlayClose===!0&&a.addEventListener("click",function(t){return h()}),null!=e.className&&(s.className+=" "+e.className),{modalBox:s,overlay:a,wrapper:u,buttons:c,content:t,close:h}}function n(t){void 0===t&&(t=!1);for(var e=0;r.length>e;){var n=r[e](0,t);n||e++}}function i(t,e){t.className=t.className.replace(new RegExp("(^|\\s)"+e+"(\\s|\\b)","g"),"$1")}!function(t){t[t.OK=1]="OK",t[t.APPLY=2]="APPLY",t[t.YES=4]="YES",t[t.NO=8]="NO",t[t.CANCEL=16]="CANCEL"}(t.BUTTON||(t.BUTTON={}));var o=t.BUTTON,r=[];t.open=e,t.close=n}(e=t.ModalBox||(t.ModalBox={}))}(n||(n={})),t.exports=n.ModalBox},function(t,e,n){(function(e){var n,i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};!function(t){var n;!function(t){var n=function(){
function n(t,n,i){var o=this;this.expression=n,this.input=i,e.isString(t)?this.value=t:e.isArray(t)&&(this.subResults=t,e.forEach(this.subResults,function(t){t.parent=o}))}return n.prototype.isSuccess=function(){return null!=this.value||null!=this.subResults&&e.all(this.subResults,function(t){return t.isSuccess()})},n.prototype.path=function(t){var e=null!=this.parent&&this.parent!=t?this.parent.path(t):[];return e.push(this),e},n.prototype.findParent=function(t){for(var n=this,i=e.isString(t)?function(e){return t==e.expression.id}:t;null!=n&&!i(n);)n=n.parent;return n},n.prototype.find=function(t){var n=e.isString(t)?function(e){return t==e.expression.id}:t;if(n(this))return this;if(this.subResults)for(var i=0;i<this.subResults.length;i++){var o=this.subResults[i].find(n);if(o)return o}return null},n.prototype.findAll=function(t){var n=[],i=e.isString(t)?function(e){return t==e.expression.id}:t;return i(this)&&n.push(this),this.subResults&&(n=e.reduce(this.subResults,function(t,e){return t.concat(e.findAll(i))},n)),n},n.prototype.resultAt=function(t,n){if(t<0||t>this.getLength())return[];if(null!=n){if(e.isString(n)){if(n==this.expression.id)return[this]}else if(n(this))return[this]}else{var i=null==this.value&&null==this.subResults?this.input:this.value;if(null!=i)return[this]}if(null!=this.subResults){for(var o=[],r=0;r<this.subResults.length;r++){var s=this.subResults[r];if(o=o.concat(s.resultAt(t,n)),t-=s.getLength(),t<0)break}return o}return[]},n.prototype.getExpect=function(){return null==this.value&&null==this.subResults?[this]:null!=this.subResults?e.reduce(this.subResults,function(t,e){return t.concat(e.getExpect())},[]):[]},n.prototype.getBestExpect=function(){var t=this.getExpect(),n=e.groupBy(t,function(t){return t.input}),i=e.last(e.keys(n).sort(function(t,e){return e.length-t.length})),o=n[i],n=e.groupBy(o,function(t){return t.expression.id});return e.map(n,function(t){return e.chain(t).map(function(t){return{path:t.path().length,result:t}}).sortBy("path").pluck("result").first().value()})},n.prototype.getHumanReadableExpect=function(){var t=this.getBestExpect(),n=t.length>0?e.last(t).input:"";return"Expected "+e.map(t,function(t){return t.getHumanReadable()}).join(" or ")+" but "+(n.length>0?JSON.stringify(n[0]):"end of input")+" found."},n.prototype.before=function(){if(null==this.parent)return"";var t=e.indexOf(this.parent.subResults,this);return this.parent.before()+e.chain(this.parent.subResults).first(t).map(function(t){return t.toString()}).join("").value()},n.prototype.after=function(){if(null==this.parent)return"";var t=e.indexOf(this.parent.subResults,this);return e.chain(this.parent.subResults).last(this.parent.subResults.length-t-1).map(function(t){return t.toString()}).join("").value()+this.parent.after()},n.prototype.getLength=function(){return null!=this.value?this.value.length:null!=this.subResults?e.reduce(this.subResults,function(t,e){return t+e.getLength()},0):this.input.length},n.prototype.toHtmlElement=function(){var t=document.createElement("span"),n=null!=this.expression?this.expression.id:null;if(null!=n){var i=document.createAttribute("data-id");i.value=n,t.setAttributeNode(i)}var o=document.createAttribute("data-success");if(o.value=this.isSuccess().toString(),t.setAttributeNode(o),null!=this.value){t.appendChild(document.createTextNode(this.value));var r=document.createAttribute("data-value");r.value=this.value,t.setAttributeNode(r)}else if(null!=this.subResults)e.each(this.subResults,function(e){t.appendChild(e.toHtmlElement())});else{t.appendChild(document.createTextNode(this.input));var s=document.createAttribute("data-input");s.value=this.input,t.setAttributeNode(s),t.className="magic-box-error"+(this.input.length>0?"":" magic-box-error-empty")}return t.result=this,t},n.prototype.clean=function(t){if(null!=t||!this.isSuccess()){t=t||e.last(this.getBestExpect()).path(this);var i=e.first(t);if(null!=i){var o=e.indexOf(this.subResults,i),r=o==-1?[]:e.map(e.first(this.subResults,o),function(t){return t.clean()});return r.push(i.clean(e.rest(t))),new n(r,this.expression,this.input)}return new n(null,this.expression,this.input)}return null!=this.value?new n(this.value,this.expression,this.input):null!=this.subResults?new n(e.map(this.subResults,function(t){return t.clean()}),this.expression,this.input):void 0},n.prototype.clone=function(){return null!=this.value?new n(this.value,this.expression,this.input):null!=this.subResults?new n(e.map(this.subResults,function(t){return t.clone()}),this.expression,this.input):new n(null,this.expression,this.input)},n.prototype.toString=function(){return null!=this.value?this.value:null!=this.subResults?e.map(this.subResults,function(t){return t.toString()}).join(""):this.input},n.prototype.getHumanReadable=function(){return this.expression instanceof t.ExpressionConstant?JSON.stringify(this.expression.value):this.expression.id},n}();t.Result=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e=function(e){function n(n){e.call(this,[n],t.ExpressionEndOfInput,n.input);var i=new t.Result(null,t.ExpressionEndOfInput,n.input.substr(n.getLength()));i.parent=this,this.subResults.push(i)}return i(n,e),n}(t.Result);t.EndOfInputResult=e}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n=function(n){function o(t,i,o,r){var s=this;n.call(this,null!=t?[t]:null,i,o),this.result=t,this.expression=i,this.input=o,this.failAttempt=r,e.forEach(this.failAttempt,function(t){t.parent=s})}return i(o,n),o.prototype.getExpect=function(){var t=this,n=[];return null!=this.result&&(n=this.result.getExpect()),n=e.reduce(this.failAttempt,function(t,e){return t.concat(e.getExpect())},n),n.length>0&&e.all(n,function(e){return e.input==t.input})?[this]:n},o.prototype.clean=function(n){if(null!=n||!this.isSuccess()){n=e.rest(n||e.last(this.getBestExpect()).path(this));var i=e.first(n);return null==i?new t.Result(null,this.expression,this.input):new t.Result([i.clean(e.rest(n))],this.expression,this.input)}return new t.Result(e.map(this.result.subResults,function(t){return t.clean()}),this.expression,this.input)},o}(t.Result);t.OptionResult=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n=function(n){function o(t,i,o,r){n.call(this,t,i,o),this.results=t,this.expression=i,this.input=o,e.last(t)!=r&&(this.failAttempt=r,null!=this.failAttempt&&(this.failAttempt.parent=this))}return i(o,n),o.prototype.getExpect=function(){var t=n.prototype.getExpect.call(this);return null!=this.failAttempt?t.concat(this.failAttempt.getExpect()):t},o.prototype.clean=function(i){if(null!=this.failAttempt&&(null!=i||!this.isSuccess())){i=i||e.last(this.getBestExpect()).path(this);var o=e.first(i);if(null!=o&&o==this.failAttempt){var r=e.last(this.subResults),s=e.map(null!=r&&r.isSuccess()?this.subResults:e.initial(this.subResults),function(t){return t.clean()});return s.push(o.clean(e.rest(i))),new t.Result(s,this.expression,this.input)}}return n.prototype.clean.call(this,i)},o}(t.Result);t.RefResult=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e=function(){function e(t,e){this.value=t,this.id=e}return e.prototype.parse=function(e,n){var i=0==e.indexOf(this.value),o=new t.Result(i?this.value:null,this,e);return i&&n&&e.length>this.value.length?new t.EndOfInputResult(o):o},e.prototype.toString=function(){return this.value},e}();t.ExpressionConstant=e}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){t.ExpressionEndOfInput={id:"end of input",parse:null}}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e=function(){function t(t,e,n){this.func=t,this.id=e,this.grammar=n}return t.prototype.parse=function(t,e){return this.func(t,e,this)},t.prototype.toString=function(){return this.id},t}();t.ExpressionFunction=e}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e=function(){function e(t,e){if(this.parts=t,this.id=e,0==t.length)throw JSON.stringify(e)+" should have at least 1 parts"}return e.prototype.parse=function(e,n){for(var i,o=[],r=e,s=0;s<this.parts.length;s++){var a=this.parts[s];if(i=a.parse(r,n&&s==this.parts.length-1),o.push(i),!i.isSuccess())break;r=r.substr(i.getLength())}return new t.Result(o,this,e)},e.prototype.toString=function(){return this.id},e}();t.ExpressionList=e}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e=function(){function e(t,e){this.parts=t,this.id=e}return e.prototype.parse=function(e,n){for(var i=[],o=0;o<this.parts.length;o++){var r=this.parts[o].parse(e,n);if(r.isSuccess())return new t.OptionResult(r,this,e,i);i.push(r)}return new t.OptionResult(null,this,e,i)},e.prototype.toString=function(){return this.id},e}();t.ExpressionOptions=e}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n=function(){function n(t,e,n,i){this.ref=t,this.occurrence=e,this.id=n,this.grammar=i}return n.prototype.parse=function(t,e){var n=this.grammar.getExpression(this.ref);if(null==n)throw"Expression not found:"+this.ref;return"?"==this.occurrence||null==this.occurrence?this.parseOnce(t,e,n):this.parseMany(t,e,n)},n.prototype.parseOnce=function(n,i,o){var r=o.parse(n,i),s=r.isSuccess();return s||"?"!=this.occurrence?new t.RefResult([r],this,n,s?null:r):i?0==n.length?new t.RefResult([],this,n,r):e.all(r.getBestExpect(),function(e){return e.expression==t.ExpressionEndOfInput})?new t.RefResult([new t.Result(null,t.ExpressionEndOfInput,n)],this,n,r):r:new t.RefResult([],this,n,null)},n.prototype.parseMany=function(n,i,o){var r,s,a=[],u=n;do r=o.parse(u,!1),s=r.isSuccess(),s&&(a.push(r),u=u.substr(r.getLength()));while(s&&r.input!=u);var l=e.isNumber(this.occurrence)?this.occurrence:"+"==this.occurrence?1:0;if(a.length<l)a.push(r);else if(i)if(a.length>0){var c=e.last(a);r=o.parse(c.input,!0),r.isSuccess()?a[a.length-1]=r:(a.push(new t.Result(null,t.ExpressionEndOfInput,c.input.substr(c.getLength()))),r=o.parse(c.input.substr(c.getLength()),!0))}else if(0!=n.length){var h=new t.Result(null,t.ExpressionEndOfInput,n);return new t.RefResult([h],this,n,r)}return new t.RefResult(a,this,n,r)},n.prototype.toString=function(){return this.id},n}();t.ExpressionRef=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e=function(){function e(t,e,n){this.value=t,this.id=e}return e.prototype.parse=function(e,n){var i=e.match(this.value);null!=i&&0!=i.index&&(i=null);var o=new t.Result(null!=i?i[0]:null,this,e);return o.isSuccess()&&n&&e.length>o.value.length?new t.EndOfInputResult(o):o},e.prototype.toString=function(){return this.id},e}();t.ExpressionRegExp=e}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n=function(){function n(e,n){void 0===n&&(n={}),this.expressions={},this.start=new t.ExpressionRef(e,null,"start",this),this.addExpressions(n)}return n.prototype.addExpressions=function(t){var n=this;e.each(t,function(t,e){n.addExpression(e,t)})},n.prototype.addExpression=function(t,e){if(t in this.expressions)throw"Grammar already contain the id:"+t;this.expressions[t]=n.buildExpression(e,t,this)},n.prototype.getExpression=function(t){return this.expressions[t]},n.prototype.parse=function(t){return this.start.parse(t,!0)},n.buildExpression=function(n,i,o){var r=typeof n;if("undefined"==r)throw"Invalid Expression: "+n;if(e.isString(n))return this.buildStringExpression(n,i,o);if(e.isArray(n))return new t.ExpressionOptions(e.map(n,function(e,n){return new t.ExpressionRef(e,null,i+"_"+n,o)}),i);if(e.isRegExp(n))return new t.ExpressionRegExp(n,i,o);if(e.isFunction(n))return new t.ExpressionFunction(n,i,o);throw"Invalid Expression: "+n},n.buildStringExpression=function(i,o,r){var s=n.stringMatch(i,n.spliter),a=e.map(s,function(e,n){if(e[1]){var i=e[1],s=e[3]?Number(e[3]):e[2]||null;return new t.ExpressionRef(i,s,o+"_"+n,r)}return new t.ExpressionConstant(e[4],o+"_"+n)});if(1==a.length){var u=a[0];return u.id=o,u}return new t.ExpressionList(a,o)},n.stringMatch=function(t,e){for(var n,i=[],o=new RegExp(e.source,"g");null!==(n=o.exec(t));)i.push(n);return i},n.spliter=/\[(\w+)(\*|\+|\?|\{([1-9][0-9]*)\})?\]|(.[^\[]*)/,n}();t.Grammar=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n=function(){function n(t,e,n){this.element=t,this.onchange=e,this.magicBox=n,this.hasFocus=!1,this.justPressedTab=!1,this.underlay=document.createElement("div"),this.underlay.className="magic-box-underlay",t.appendChild(this.underlay),this.highlightContainer=document.createElement("span"),this.highlightContainer.className="magic-box-highlight-container",this.underlay.appendChild(this.highlightContainer),this.ghostTextContainer=document.createElement("span"),this.ghostTextContainer.className="magic-box-ghost-text",this.underlay.appendChild(this.ghostTextContainer),this.input=document.createElement("input"),this.input.spellcheck=!1,this.input.setAttribute("form","coveo-dummy-form"),this.input.setAttribute("autocomplete","off"),t.appendChild(this.input),this.setupHandler()}return n.prototype.updateInput=function(){this.input.value!=this.result.input&&(this.input.value=this.result.input,this.hasFocus&&this.setCursor(this.getValue().length))},n.prototype.updateHighlight=function(){this.highlightContainer.innerHTML="",this.highlightContainer.appendChild(this.result.toHtmlElement())},n.prototype.updateWordCompletion=function(){this.ghostTextContainer.innerHTML="",null!=this.wordCompletion&&this.ghostTextContainer.appendChild(document.createTextNode(this.wordCompletion.substr(this.result.input.length)))},n.prototype.updateScroll=function(e){var n=this;void 0===e&&(e=!0);var i=function(){n.underlay.clientWidth<n.underlay.scrollWidth&&(n.underlay.style.visibility="hidden",n.underlay.scrollLeft=n.input.scrollLeft,n.underlay.scrollTop=n.input.scrollTop,n.underlay.style.visibility="visible"),n.updateScrollDefer=null,n.hasFocus&&n.updateScroll()};e?null==this.updateScrollDefer&&(this.updateScrollDefer=t.requestAnimationFrame(i)):i()},n.prototype.setResult=function(t,n){this.result=t,this.updateInput(),this.updateHighlight(),e.isUndefined(n)&&null!=this.wordCompletion&&0==this.wordCompletion.indexOf(this.result.input)?this.updateWordCompletion():this.setWordCompletion(n),this.updateScroll()},n.prototype.setWordCompletion=function(t){null!=t&&0!=t.toLowerCase().indexOf(this.result.input.toLowerCase())&&(t=null),this.wordCompletion=t,this.updateWordCompletion(),this.updateScroll()},n.prototype.setCursor=function(t){if(this.input.focus(),this.input.createTextRange){var e=this.input.createTextRange();e.move("character",t),e.select()}else null!=this.input.selectionStart&&(this.input.focus(),this.input.setSelectionRange(t,t))},n.prototype.getCursor=function(){return this.input.selectionStart},n.prototype.setupHandler=function(){var t=this;this.input.onblur=function(){t.hasFocus=!1,setTimeout(function(){t.hasFocus||t.onblur&&t.onblur()},300),t.updateScroll()},this.input.onfocus=function(){t.hasFocus||(t.hasFocus=!0,t.updateScroll(),t.onfocus&&t.onfocus())},this.input.onkeydown=function(e){t.keydown(e)},this.input.onkeyup=function(e){t.keyup(e)},this.input.onclick=function(){t.onchangecursor()},this.input.select=function(){t.onchangecursor()},this.input.oncut=function(){setTimeout(function(){t.onInputChange()})},this.input.onpaste=function(){setTimeout(function(){t.onInputChange()})}},n.prototype.focus=function(){var t=this;this.hasFocus=!0,setTimeout(function(){t.input.focus(),t.setCursor(t.getValue().length)})},n.prototype.blur=function(){this.hasFocus&&this.input.blur()},n.prototype.keydown=function(e){var n=this;switch(e.keyCode||e.which){case 9:this.justPressedTab?this.blur():this.magicBox.hasSuggestions()&&e.preventDefault(),this.justPressedTab=!0;break;default:e.stopPropagation(),this.justPressedTab=!1,null==this.onkeydown||this.onkeydown(e.keyCode||e.which)?t.requestAnimationFrame(function(){n.onInputChange()}):e.preventDefault()}},n.prototype.keyup=function(t){switch(t.keyCode||t.which){case 9:this.tabPress();break;case 37:case 39:this.onchangecursor();break;default:null==this.onkeydown||this.onkeyup(t.keyCode||t.which)?this.onInputChange():t.preventDefault()}},n.prototype.tabPress=function(){null!=this.wordCompletion&&(this.input.value=this.wordCompletion),this.ontabpress&&this.ontabpress(),this.magicBox.showSuggestion()},n.prototype.onInputChange=function(){this.result.input!=this.input.value&&this.onchange(this.input.value,!1)},n.prototype.getValue=function(){return this.input.value},n.prototype.getWordCompletion=function(){return this.wordCompletion},n}();t.InputManager=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n=function(){function n(n,i){var o=this;this.element=n,this.options=e.defaults(i,{selectableClass:"magic-box-suggestion",selectedClass:"magic-box-selected"}),void 0==this.options.timeout&&(this.options.timeout=500),this.hasSuggestions=!1,this.element.onmouseover=function(e){if(t.$$(e.target).hasClass(o.options.selectableClass)){for(var n=o.element.getElementsByClassName(o.options.selectedClass),i=0;i<n.length;i++){var r=n.item(i);t.$$(r).removeClass(o.options.selectedClass)}t.$$(e.target).addClass(o.options.selectedClass)}},this.element.onmouseout=function(e){t.$$(e.target).hasClass(o.options.selectableClass)&&t.$$(e.target).removeClass(o.options.selectedClass)}}return n.prototype.moveDown=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0),n=this.element.getElementsByClassName(this.options.selectableClass),i=-1;if(null!=e){t.$$(e).removeClass(this.options.selectedClass);for(var o=0;o<n.length;o++)if(e==n.item(o)){i=o;break}i=i==-1?0:i+1}else i=0;return e=n.item(i),null!=e&&t.$$(e).addClass(this.options.selectedClass),this.returnMoved(e)},n.prototype.moveUp=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0),n=this.element.getElementsByClassName(this.options.selectableClass),i=-1;if(null!=e){t.$$(e).removeClass(this.options.selectedClass);for(var o=0;o<n.length;o++)if(e==n.item(o)){i=o;break}i=i==-1?n.length-1:i-1}else i=n.length-1;return e=n.item(i),null!=e&&t.$$(e).addClass(this.options.selectedClass),this.returnMoved(e)},n.prototype.returnMoved=function(e){if(null!=e){if(e.suggestion)return e.suggestion;if(e instanceof HTMLElement)return{text:t.$$(e).text()}}return null},n.prototype.select=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0);return null!=e&&t.$$(e).trigger("keyboardSelect"),e},n.prototype.mergeSuggestions=function(t,n){var i,o=this,r=[];t=e.compact(t);var s=this.pendingSuggestion=new Promise(function(n,a){e.each(t,function(t){var e=!1;setTimeout(function(){e=!0},o.options.timeout),t.then(function(t){!e&&t&&(r=r.concat(t))})});var u=function(){i&&clearTimeout(i),0==r.length?n([]):s==o.pendingSuggestion||null==o.pendingSuggestion?n(r.sort(function(t,e){return e.index-t.index})):a("new request queued")};0==t.length&&u(),void 0==t&&u(),i=setTimeout(function(){u()},o.options.timeout),Promise.all(t).then(function(){return u()})});s.then(function(t){return n&&n(t),o.updateSuggestions(t),t}).catch(function(){return null})},n.prototype.updateSuggestions=function(n){var i=this;this.element.innerHTML="",this.element.className="magic-box-suggestions",e.each(n,function(e){var n=e.dom;if(n){t.$$(n).removeClass(i.options.selectedClass);var o=t.$$(n).find("."+i.options.selectableClass);t.$$(o).removeClass(i.options.selectedClass)}else{if(n=document.createElement("div"),n.className="magic-box-suggestion",null!=e.html)n.innerHTML=e.html;else if(null!=e.text)n.appendChild(document.createTextNode(e.text));else if(null!=e.separator){n.className="magic-box-suggestion-seperator";var r=document.createElement("div");r.className="magic-box-suggestion-seperator-label",r.appendChild(document.createTextNode(e.separator)),n.appendChild(r)}t.$$(n).on("click",function(){e.onSelect()}),t.$$(n).on("keyboardSelect",function(){e.onSelect()}),t.$$(n).addClass(i.options.selectableClass)}n.suggestion=e,i.element.appendChild(n)}),n.length>0?(t.$$(this.element).addClass("magic-box-hasSuggestion"),this.hasSuggestions=!0):(t.$$(this.element).removeClass("magic-box-hasSuggestion"),this.hasSuggestions=!1)},n}();t.SuggestionsManager=n}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n;!function(n){function i(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function o(t,e,n,o,s){if(void 0===n&&(n=!1),void 0===o&&(o="magic-box-hightlight"),void 0===s&&(s=""),0==e.length)return t;var a=i(e),u="("+a+")|(.*?(?="+a+")|.+)",l=new RegExp(u,n?"gi":"g");return t.replace(l,function(t,e,n){return r(null!=e?o:s,t)})}var r=function(t,n){return'<span class="'+t+'">'+e.escape(n)+"</span>"};n.highlightText=o;var s=function(){function n(t){this.el=t}return n.prototype.text=function(t){return t?void(void 0!=this.el.innerText?this.el.innerText=t:void 0!=this.el.textContent&&(this.el.textContent=t)):this.el.innerText||this.el.textContent},n.prototype.nodeListToArray=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t.item(e);return n},n.prototype.empty=function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)},n.prototype.show=function(){this.el.style.display="visible"},n.prototype.hide=function(){this.el.style.display="none"},n.prototype.toggle=function(t){void 0===t?"visible"==this.el.style.display?this.hide():this.show():t?this.show():this.hide()},n.prototype.find=function(t){return this.el.querySelector(t)},n.prototype.is=function(t){return this.el.tagName.toLowerCase()==t.toLowerCase()||!("."!=t[0]||!this.hasClass(t.substr(1)))||"#"==t[0]&&this.el.getAttribute("id")==t.substr(1)},n.prototype.closest=function(e){for(var n=this.el,i=!1;!i&&(t.$$(n).hasClass(e)&&(i=!0),"body"!=n.tagName.toLowerCase())&&null!=n.parentElement;)i||(n=n.parentElement);if(i)return n},n.prototype.findAll=function(t){return this.nodeListToArray(this.el.querySelectorAll(t))},n.prototype.findClass=function(t){return"getElementsByClassName"in this.el?this.nodeListToArray(this.el.getElementsByClassName(t)):this.nodeListToArray(this.el.querySelectorAll("."+t))},n.prototype.findId=function(t){return document.getElementById(t)},n.prototype.addClass=function(t){this.hasClass(t)||(this.el.className?this.el.className+=" "+t:this.el.className=t)},n.prototype.removeClass=function(t){this.el.className=this.el.className.replace(new RegExp("(^|\\s)"+t+"(\\s|\\b)","g"),"$1")},n.prototype.toggleClass=function(t,e){e?this.addClass(t):this.removeClass(t)},n.prototype.getClass=function(){return this.el.className.match(n.CLASS_NAME_REGEX)||[]},n.prototype.hasClass=function(t){return e.contains(this.getClass(),t)},n.prototype.detach=function(){this.el.parentElement&&this.el.parentElement.removeChild(this.el)},n.prototype.on=function(t,i){var o=this;if(e.isArray(t))e.each(t,function(t){o.on(t,i)});else{var r=this.getJQuery();if(r)r(this.el).on(t,i);else if(this.el.addEventListener){var s=function(t){i(t,t.detail)};n.handlers.push({eventHandle:i,fn:s}),this.el.addEventListener(t,s,!1)}else this.el.on&&this.el.on("on"+t,i)}},n.prototype.one=function(t,n){var i=this;if(e.isArray(t))e.each(t,function(t){i.one(t,n)});else{var o=function(e){return i.off(t,o),n(e)};this.on(t,o)}},n.prototype.off=function(t,i){var o=this;if(e.isArray(t))e.each(t,function(t){o.off(t,i)});else{var r=this.getJQuery();if(r)r(this.el).off(t,i);else if(this.el.removeEventListener){var s=0,a=e.find(n.handlers,function(t,e){if(t.eventHandle==i)return s=e,!0});a&&(this.el.removeEventListener(t,a.fn,!1),n.handlers.splice(s,1))}else this.el.off&&this.el.off("on"+t,i)}},n.prototype.trigger=function(t,e){var n=this.getJQuery();if(n)n(this.el).trigger(t,e);else if(void 0!==CustomEvent){var i=new CustomEvent(t,{detail:e,bubbles:!0});this.el.dispatchEvent(i)}},n.prototype.isEmpty=function(){return n.ONLY_WHITE_SPACE_REGEX.test(this.el.innerHTML)},n.prototype.isDescendant=function(t){for(var e=this.el.parentNode;null!=e;){if(e==t)return!0;e=e.parentNode}return!1},n.prototype.getJQuery=function(){return void 0!=window.jQuery&&window.jQuery},n.CLASS_NAME_REGEX=/-?[_a-zA-Z]+[_a-zA-Z0-9-]*/g,n.ONLY_WHITE_SPACE_REGEX=/^\s*$/,n.handlers=[],n}();n.Dom=s}(n=t.Utils||(t.Utils={}))}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){t.$$=function(e){return window.Coveo&&window.Coveo.$$?window.Coveo.$$(e):new t.Utils.Dom(e)}}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){var n;!function(n){function i(t,n,i,o){e.each(o.expressions,function(n){e.contains(t,n)||t.push(n)}),e.each(o.basicExpressions,function(t){e.contains(n,t)||n.push(t)}),e.each(o.grammars,function(t,n){if(n in i){if(!e.isArray(i[n])||!e.isArray(t))throw e.each(t,function(t){i[n].push(t)}),"Can not merge "+n+"("+new String(t)+" => "+new String(i[n])+")";e.each(t,function(t){i[n].push(t)})}else i[n]=t})}function o(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];for(var o=[],r=[],s={Start:["Expressions","Empty"],Expressions:"[OptionalSpaces][Expression][ExpressionsList*][OptionalSpaces]",ExpressionsList:"[Spaces][Expression]",Expression:o,BasicExpression:r,OptionalSpaces:/ */,Spaces:/ +/,Empty:/(?!.)/},a=0;a<t.length;a++)i(o,r,s,t[a]),e.each(t[a].include,function(n){e.contains(t,n)||t.push(n)});return o.push("BasicExpression"),{start:"Start",expressions:s}}function r(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var i=o.apply(this,e);return new t.Grammar(i.start,i.expressions)}n.Expressions=o,n.ExpressionsGrammar=r}(n=t.Grammars||(t.Grammars={}))}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(e){e.notWordStart=" ()[],$@'\"",e.notInWord=" ()[],:",e.Basic={basicExpressions:["Word","DoubleQuoted"],grammars:{DoubleQuoted:'"[NotDoubleQuote]"',NotDoubleQuote:/[^"]*/,SingleQuoted:"'[NotSingleQuote]'",NotSingleQuote:/[^']*/,Number:/[0-9]+/,Word:function(n,i,o){var r=new RegExp("[^"+e.notWordStart.replace(/(.)/g,"\\$1")+"][^"+e.notInWord.replace(/(.)/g,"\\$1")+"]*"),s=n.match(r);null!=s&&0!=s.index&&(s=null);var a=new t.Result(null!=s?s[0]:null,o,n);return a.isSuccess()&&i&&n.length>a.value.length?new t.EndOfInputResult(a):a}}}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(t){t.SubExpression={basicExpressions:["SubExpression"],grammars:{SubExpression:"([Expressions])"}}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(t){t.Date={grammars:{Date:"[DateYear]/[DateMonth]/[DateDay]",DateYear:/([0-9]{4})/,DateMonth:/(1[0-2]|0?[1-9])/,DateDay:/([1-2][0-9]|3[0-1]|0?[1-9])/,DateRange:"[Date][Spaces?]..[Spaces?][Date]",DateRelative:["DateRelativeNegative","DateRelativeTerm"],DateRelativeTerm:/now|today|yesterday/,DateRelativeNegative:"[DateRelativeTerm][DateRelativeNegativeRef]",DateRelativeNegativeRef:/([\-\+][0-9]+(s|m|h|d|mo|y))/},include:[t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(t){t.Field={basicExpressions:["FieldSimpleQuery","FieldQuery","Field"],grammars:{FieldQuery:"[Field][OptionalSpaces][FieldQueryOperation]",FieldQueryOperation:["FieldQueryValue","FieldQueryNumeric"],FieldQueryValue:"[FieldOperator][OptionalSpaces][FieldValue]",FieldQueryNumeric:"[FieldOperatorNumeric][OptionalSpaces][FieldValueNumeric]",FieldSimpleQuery:"[FieldName]:[OptionalSpaces][FieldValue]",Field:"@[FieldName]",FieldName:/[a-zA-Z][a-zA-Z0-9\.\_]*/,FieldOperator:/==|=|<>/,FieldOperatorNumeric:/<=|>=|<|>/,FieldValue:["DateRange","NumberRange","DateRelative","Date","Number","FieldValueList","FieldValueString"],FieldValueNumeric:["DateRelative","Date","Number"],FieldValueString:["DoubleQuoted","FieldValueNotQuoted"],FieldValueList:"([FieldValueString][FieldValueStringList*])",FieldValueStringList:"[FieldValueSeparator][FieldValueString]",FieldValueSeparator:/ *, */,FieldValueNotQuoted:/[^ \(\),]+/,NumberRange:"[Number][Spaces?]..[Spaces?][Number]"},include:[t.Date,t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(t){t.QueryExtension={basicExpressions:["QueryExtension"],grammars:{QueryExtension:"$[QueryExtensionName]([QueryExtensionArguments])",QueryExtensionName:/\w+/,QueryExtensionArguments:"[QueryExtensionArgumentList*][QueryExtensionArgument]",QueryExtensionArgumentList:"[QueryExtensionArgument][Spaces?],[Spaces?]",QueryExtensionArgument:"[QueryExtensionArgumentName]:[Spaces?][QueryExtensionArgumentValue]",QueryExtensionArgumentName:/\w+/,QueryExtensionArgumentValue:["SingleQuoted","Expressions"]},include:[t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(t){t.NestedQuery={basicExpressions:["NestedQuery"],grammars:{NestedQuery:"[[NestedField][OptionalSpaces][Expressions]]",NestedField:"[[Field]]",FieldValue:["NestedQuery"]},include:[t.Field]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var e;!function(t){var e;!function(t){t.Complete={include:[t.NestedQuery,t.QueryExtension,t.SubExpression,t.Field,t.Basic]}}(e=t.Grammars||(t.Grammars={}))}(e=t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){var n;!function(t){function n(t,e,n){return new o(t,e,n)}function i(t){return"requestAnimationFrame"in window?window.requestAnimationFrame(t):setTimeout(t)}var o=function(){function n(n,i,o){var r=this;void 0===o&&(o={}),this.element=n,this.grammar=i,this.options=o,this.lastSuggestions=[],e.isUndefined(this.options.inline)&&(this.options.inline=!1),t.$$(n).addClass("magic-box"),this.options.inline&&t.$$(n).addClass("magic-box-inline"),this.result=this.grammar.parse(""),this.displayedResult=this.result.clean(),this.clearDom=document.createElement("div"),this.clearDom.className="magic-box-clear",this.element.appendChild(this.clearDom);var s=document.createElement("div");s.className="magic-box-icon",this.clearDom.appendChild(s);var a=document.createElement("div");a.className="magic-box-input",n.appendChild(a),this.inputManager=new t.InputManager(a,function(t,e){e?(r.setText(t),r.onselect&&r.onselect(r.getFirstSuggestionText())):(r.setText(t),r.showSuggestion(),r.onchange&&r.onchange())},this),this.inputManager.ontabpress=function(){r.ontabpress&&r.ontabpress()},this.inputManager.setResult(this.displayedResult);var u=document.createElement("div");u.className="magic-box-suggestions",this.element.appendChild(u),this.suggestionsManager=new t.SuggestionsManager(u,{selectableClass:this.options.selectableSuggestionClass,selectedClass:this.options.selectedSuggestionClass,timeout:this.options.suggestionTimeout}),this.setupHandler()}return n.prototype.getResult=function(){return this.result},n.prototype.getDisplayedResult=function(){return this.displayedResult},n.prototype.setText=function(e){t.$$(this.element).toggleClass("magic-box-notEmpty",e.length>0),this.result=this.grammar.parse(e),this.displayedResult=this.result.clean(),this.inputManager.setResult(this.displayedResult)},n.prototype.setCursor=function(t){this.inputManager.setCursor(t)},n.prototype.getCursor=function(){return this.inputManager.getCursor()},n.prototype.resultAtCursor=function(t){return this.displayedResult.resultAt(this.getCursor(),t)},n.prototype.setupHandler=function(){var e=this;this.inputManager.onblur=function(){t.$$(e.element).removeClass("magic-box-hasFocus"),e.onblur&&e.onblur(),e.options.inline||e.clearSuggestion()},this.inputManager.onfocus=function(){t.$$(e.element).addClass("magic-box-hasFocus"),e.showSuggestion(),e.onfocus&&e.onfocus()},this.inputManager.onkeydown=function(t){if(38==t||40==t)return!1;if(13==t){var n=e.suggestionsManager.select();return null==n&&e.onsubmit&&e.onsubmit(),
!1}return 27==t&&(e.clearSuggestion(),e.blur()),!0},this.inputManager.onchangecursor=function(){e.showSuggestion()},this.inputManager.onkeyup=function(t){if(38==t)e.onmove&&e.onmove(),e.focusOnSuggestion(e.suggestionsManager.moveUp()),e.onchange&&e.onchange();else{if(40!=t)return!0;e.onmove&&e.onmove(),e.focusOnSuggestion(e.suggestionsManager.moveDown()),e.onchange&&e.onchange()}return!1},this.clearDom.onclick=function(){e.clear()}},n.prototype.showSuggestion=function(){var t=this;this.suggestionsManager.mergeSuggestions(null!=this.getSuggestions?this.getSuggestions():[],function(e){t.updateSuggestion(e)})},n.prototype.updateSuggestion=function(t){var n=this;this.lastSuggestions=t;var i=this.getFirstSuggestionText();this.inputManager.setWordCompletion(i&&i.text),this.onsuggestions&&this.onsuggestions(t),e.each(t,function(t){null==t.onSelect&&null!=t.text&&(t.onSelect=function(){n.setText(t.text),n.onselect&&n.onselect(t)})})},n.prototype.focus=function(){t.$$(this.element).addClass("magic-box-hasFocus"),this.inputManager.focus()},n.prototype.blur=function(){this.inputManager.blur()},n.prototype.clearSuggestion=function(){var t=this;this.suggestionsManager.mergeSuggestions([],function(e){t.updateSuggestion(e)}),this.inputManager.setWordCompletion(null)},n.prototype.focusOnSuggestion=function(t){null==t||null==t.text?(t=this.getFirstSuggestionText(),this.inputManager.setResult(this.displayedResult,t&&t.text)):this.inputManager.setResult(this.grammar.parse(t.text).clean(),t.text)},n.prototype.getFirstSuggestionText=function(){return e.find(this.lastSuggestions,function(t){return null!=t.text})},n.prototype.getText=function(){return this.inputManager.getValue()},n.prototype.getWordCompletion=function(){return this.inputManager.getWordCompletion()},n.prototype.clear=function(){this.setText(""),this.showSuggestion(),this.focus(),this.onclear&&this.onclear()},n.prototype.hasSuggestions=function(){return this.suggestionsManager.hasSuggestions},n}();t.Instance=o,t.create=n,t.requestAnimationFrame=i}(n=t.MagicBox||(t.MagicBox={}))}(n||(n={})),t.exports=n.MagicBox}).call(e,n(10))},function(t,e){!function(){"use strict";var t,e,n="undefined",i="string",o=self.navigator,r=String,s=Object.prototype.hasOwnProperty,a={},u={},l=!1,c=!0,h=/^\s*application\/(?:vnd\.oftn\.|x-)?l10n\+json\s*(?:$|;)/i,p="locale",d="defaultLocale",f="toLocaleString",g="toLowerCase",m=Array.prototype.indexOf||function(t){for(var e=this.length,n=0;e>n;n++)if(n in this&&this[n]===t)return n;return-1},v=function(e){var n=new t;return n.open("GET",e,l),n.send(null),200!==n.status?(setTimeout(function(){var t=new Error("Unable to load localization data: "+e);throw t.name="Localization Error",t},0),{}):JSON.parse(n.responseText)},y=r[f]=function(t){if(arguments.length>0&&"number"!=typeof t)if(typeof t===i)y(v(t));else if(t===l)u={};else{var e,n,o;for(e in t)if(s.call(t,e)){if(n=t[e],e=e[g](),e in u&&n!==l||(u[e]={}),n===l)continue;if(typeof n===i){if(0!==r[p][g]().indexOf(e)){e in a||(a[e]=[]),a[e].push(n);continue}n=v(n)}for(o in n)s.call(n,o)&&(u[e][o]=n[o])}}return Function.prototype[f].apply(r,arguments)},b=function(t){for(var e,n=a[t],i=0,o=n.length;o>i;i++)e={},e[t]=v(n[i]),y(e);delete a[t]},S=r.prototype[f]=function(){var t,n=e,i=r[n?d:p],o=i[g]().split("-"),s=o.length,h=this.valueOf();e=l;do if(t=o.slice(0,s).join("-"),t in a&&b(t),t in u&&h in u[t])return u[t][h];while(s-- >1);return!n&&r[d]?(e=c,S.call(h)):h};if(typeof XMLHttpRequest===n&&typeof ActiveXObject!==n){var x=ActiveXObject;t=function(){try{return new x("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new x("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new x("Msxml2.XMLHTTP")}catch(t){}throw new Error("XMLHttpRequest not supported by this browser.")}}else t=XMLHttpRequest;if(r[d]=r[d]||"",r[p]=o&&(o.language||o.userLanguage)||"",typeof document!==n)for(var C,E=document.getElementsByTagName("link"),w=E.length;w--;){var A=E[w],T=(A.getAttribute("rel")||"")[g]().split(/\s+/);h.test(A.type)&&(-1!==m.call(T,"localizations")?y(A.getAttribute("href")):-1!==m.call(T,"localization")&&(C={},C[(A.getAttribute("hreflang")||"")[g]()]=A.getAttribute("href"),y(C)))}}(),t.exports=window.String.toLocaleString},function(t,e,n){"use strict";function i(){var t=String.locales||(String.locales={});t.en=s(t.en,a),String.toLocaleString.call(this,{en:a}),String.locale="en",String.defaultLocale="en",r.culture("en")}function o(){var t=String.locales||(String.locales={});t.en=s(t.en,a),String.toLocaleString.call(this,{en:a}),String.locale="en",String.defaultLocale="en",r.culture("en")}var r=n(28),s=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},a={Unknown:"Unknown",And:"AND",Authenticating:"Authenticating {0}...",Clear:"Clear {0}",CompleteQuery:"Complete Query",Exclude:"Exclude {0}",EnterTag:"Add Tag",Next:"Next",Last:"Last",Link:"Link",Or:"OR",Previous:"Previous",QueryDidntMatchAnyDocuments:"Your query did not match any documents.",QueryException:"Your query has an error: {0}.",Me:"Me",Remove:"Remove",Search:"Search",SearchFor:"Search for {0}",ShareQuery:"Share Query",Preferences:"Preferences",LinkOpeningSettings:"Link Opening Settings",Reauthenticate:"Reauthenticate {0}",ResultsFilteringExpression:"Results Filtering Expressions",FiltersInYourPreferences:"Filters in your preferences",Create:"Create",SearchIn:"Search in {0}",Seconds:"in {0} second<pl>s</pl>",ShowingResultsOf:"Result<pl>s</pl> {0}<pl>-{1}</pl> of {2}",SwitchTo:"Switch to {0}",Unexclude:"Unexclude {0}",ClearAllFilters:"Clear All Filters",SkipLogin:"Skip login",LoginInProgress:"Login in progress, please wait ...",Login:"Log In",GetStarted:"Get Started",More:"More",NMore:"{0} more...",Less:"Fewer",Settings:"Settings",Score:"Score",ScoreDescription:"The score is computed from the number of occurrences as well as from the position in the result set.",Occurrences:"Occurrences",OccurrencesDescription:"Sort by number of occurrences, with values having the highest number appearing first.",Label:"Label",Of:"of",LabelDescription:"Sort alphabetically on the field values.",Value:"Value",ValueDescription:"Sort on the values of the first computed field",AlphaAscending:"Value Ascending",AlphaDescending:"Value Descending",ChiSquare:"Chi Square",Nosort:"No Sort",RelativeFrequency:"Relative Frequency",RelativeFrequencyDescription:"Sort based on the relative frequency of values. Less common values will appear higher.",DateDistribution:"Date distribution",Custom:"Custom",CustomDescription:"Sort based on a custom order",ComputedField:"Computed Field",Ascending:"Ascending",Descending:"Descending",noResultFor:"No results for {0}",autoCorrectedQueryTo:"Query was automatically corrected to {0}",didYouMean:"Did you mean: {0}",SuggestedResults:"Suggested Results",SuggestedQueries:"Suggested Queries",MostRelevantItems:"Most relevant items:",AllItems:"All items:",ShowLess:"Show less",ShowMore:"Show more",HideFacet:"Hide Facet",ShowFacet:"Show Facet",AndOthers:"and {0} other<pl>s</pl>",Others:"{0} other<pl>s</pl>",MostRelevantPosts:"Most Relevant Posts:",CompleteThread:"Complete Thread:",ShowCompleteThread:"Show Complete Thread",ShowOnlyTopMatchingPosts:"Show Only Top Matching Posts",MostRelevantReplies:"Most Relevant Replies:",AllConversation:"All Conversation:",ShowAllConversation:"Show All Conversation",ShowAllReplies:"Show All Replies",ShowOnlyMostRelevantReplies:"Show Only Most Relevant Replies",Close:"Close",Open:"Open",OpenInOutlookWhenPossible:"Open in Outlook (when possible)",AlwaysOpenInNewWindow:"Always open results in new window",Quickview:"Quick View",NoQuickview:"The Quick View for this document is unavailable",ErrorReport:"Error Report",OopsError:"Something went wrong.",ProblemPersists:"If the problem persists contact the administrator.",GoBack:"Go Back",Reset:"Reset",Retry:"Retry",MoreInfo:"More Information",Username:"Username",Password:"Password",PostedBy:"Posted by",CannotConnect:"Cannot connect to the server address.",BadUserPass:"Password does not match with username.",PleaseEnterYourCredentials:"Please enter your credentials for {0}.",PleaseEnterYourSearchPage:"Please enter your search page URL",Collapse:"Collapse",Collapsable:"Collapsible",Expand:"Expand",Today:"Today",Yesterday:"Yesterday",Tomorrow:"Tomorrow",Duration:"Duration: {0}",IndexDuration:"Index Duration: {0}",ProxyDuration:"Proxy Duration: {0}",ClientDuration:"Client Duration: {0}",Unavailable:"Unavailable",Reply:"Reply",ReplyAll:"Reply All",Forward:"Forward",From:"From",Caption:"Caption",Expression:"Expression",Tab:"Tab",Tabs:"Tabs",EnterExpressionName:"Enter expression name",EnterExpressionToFilterWith:"Enter expression to filter results with",SelectTab:"Select Tab",SelectAll:"Select All",PageUrl:"Search page URL",ErrorSavingToDevice:"Error while saving the information to your device",ErrorReadingFromDevice:"Error while reading the information from your device",AppIntro:"Speak with a product specialist who can answer your questions about Coveo and help you decide which Coveo solution is right for you. Or, try a live demo !",TryDemo:"Try the demo",ContactUs:"Contact us",NewToCoveo:"New to Coveo?",LetUsHelpGetStarted:"Let us help you get started",LikesThis:"{0} like<sn>s</sn> this.",CannotConnectSearchPage:"Cannot connect to your search page",AreYouSureDeleteFilter:"Are you sure you want to delete the filter {0} with the expression {1}",OnlineHelp:"Online Help",Done:"Done",SaveFacetState:"Save this facet state",ClearFacetState:"Clear facet state",DisplayingTheOnlyMessage:"Displaying the only message in this conversation",NoNetworkConnection:"No network connection",UnknownConnection:"Unknown connection",EthernetConnection:"Ethernet connection",WiFi:"WiFi connection",CELL:"Cellular connection",CELL_2G:"Cellular 2G connection",CELL_3G:"Cellular 3G connection",CELL_4G:"Cellular 4G connection",Relevance:"Relevance",Date:"Date",Amount:"Amount",QueryExceptionNoException:"No exception",QueryExceptionInvalidSyntax:"Invalid syntax",QueryExceptionInvalidCustomField:"Invalid custom field",QueryExceptionInvalidDate:"Invalid date",QueryExceptionInvalidExactPhrase:"Invalid exact phrase",QueryExceptionInvalidDateOp:"Invalid date operator",QueryExceptionInvalidNear:"Invalid NEAR operator",QueryExceptionInvalidWeightedNear:"Invalid weighted NEAR",QueryExceptionInvalidTerm:"Invalid term",QueryExceptionTooManyTerms:"Too many terms",QueryExceptionWildcardTooGeneral:"Wildcard too general",QueryExceptionInvalidSortField:"Invalid sort field",QueryExceptionInvalidSmallStringOp:"Invalid small string operator",QueryExceptionRequestedResultsMax:"Requested results maximum",QueryExceptionAggregatedMirrorDead:"Aggregated mirror is offline",QueryExceptionAggregatedMirrorQueryTimeOut:"Aggregated mirror query timeout",QueryExceptionAggregatedMirrorInvalidBuildNumber:"Aggregated mirror invalid build number",QueryExceptionAggregatedMirrorCannotConnect:"Aggregated mirror cannot connect",QueryExceptionNotEnoughLeadingCharsWildcard:"Not enough leading character wildcard",QueryExceptionSecurityInverterNotFound:"Security inverter not found",QueryExceptionSecurityInverterAccessDenied:"Security inverter access denied",QueryExceptionAggregatedMirrorCannotImpersonate:"Aggregated mirror cannot impersonate",QueryExceptionUnexpected:"Unexpected",QueryExceptionAccessDenied:"Access denied",QueryExceptionSuperUserTokenInvalid:"Super user token invalid",QueryExceptionSuperUserTokenExpired:"Super user token is expired",QueryExceptionLicenseQueriesExpired:"Queries license expired",QueryExceptionLicenseSuperUserTokenNotSupported:"License super user token not supported",QueryExceptionInvalidSession:"Invalid session",QueryExceptionInvalidDocument:"Invalid document",QueryExceptionSearchDisabled:"Search disabled",FileType:"File type",ShowAttachment:"Show attachment",OnFeed:"on {0}'s feed.",Author:"Author",NoTitle:"No title",CurrentSelections:"Current selections",AllContent:"All content",CancelLastAction:"Cancel last action",SearchTips:"Search tips",CheckSpelling:"Check the spelling of your keywords.",TryUsingFewerKeywords:"Try using fewer, different or more general keywords.",SelectFewerFilters:"Select fewer filters to broaden your search.",Document:"Document",Time:"Time",StartDate:"Start Date",StartTime:"Start Time",DurationTitle:"Duration",UserQuery:"User query",ShowUserActions:"Show User Actions",NoData:"No data available",EventType:"Event type",GoToFullSearch:"Full search",GoToEdition:"Customize Panel",RemoveContext:"Remove context",BoxAttachToCase:"Attach to case",AttachToCase:"Attach to case",Attach:"Attach",Attached:"Attached",Detach:"Detach",Details:"Details",AdditionalFilters:"Additional filters",SelectNonContextualSearch:"Remove the context from the current record to broaden your search",CopyPasteToSupport:"Copy paste this message to Coveo Support team for more information.",FollowQueryDescription:"Alert me for changes to the search results of this query.",SearchAlerts_Panel:"Manage Alerts",SearchAlerts_PanelDescription:"View and manage your search alerts.",SearchAlerts_PanelNoSearchAlerts:"You have no subscriptions.",SearchAlerts_Fail:"The Search Alerts service is currently unavailable.",SearchAlerts_Type:"Type",SearchAlerts_Content:"Content",SearchAlerts_Actions:"Action",EmptyQuery:"&lt;empty&gt;",SearchAlerts_Type_followQuery:"Query",SearchAlerts_Type_followDocument:"Item",SearchAlerts_unFollowing:"Stop Following",SearchAlerts_follow:"Follow",SearchAlerts_followed:"Followed",SearchAlerts_followQuery:"Follow Query",Subscription_StopFollowingQuery:"Stop Following Query",SearchAlerts_Frequency:"When",SubscriptionsManageSubscriptions:"Manage Alerts",SubscriptionsMessageFollowQuery:"You will receive alerts when the query <b>{0}</b> returns new or updated items.",SubscriptionsMessageFollow:"You will receive alerts for changes to the item <b>{0}</b>.",Expiration:"Expiration",Monthly:"Monthly",Daily:"Daily",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sunday:"Sunday",StartTypingCaseForSuggestions:"Describe your problem to see possible solutions",ExportToExcel:"Export to Excel",ExportToExcelDescription:"Export search results to Excel",CaseCreationNoResults:"No recommended solutions were found",SortBy:"Sort by",BoxCreateArticle:"Create Article",Facets:"Facets",AdvancedSearch:"Advanced Search",Keywords:"Keywords",AllTheseWords:"All these words",ExactPhrase:"This exact phrase",AnyOfTheseWords:"Any of these words",NoneOfTheseWords:"None of these words",Anytime:"Anytime",InTheLast:"In the last",Days:"days",Months:"months",Between:"Between",Language:"Language",Size:"Size",AtLeast:"at least",AtMost:"at most",Contains:"contains",DoesNotContain:"does not contain",Matches:"matches",Bytes:"bytes",objecttype_people:"People",objecttype_message:"Message",objecttype_feed:"RSS Feed",objecttype_thread:"Thread",objecttype_file:"File",objecttype_board:"",objecttype_category:"",objecttype_account:"Account",objecttype_annotation:"Note",objecttype_campaign:"Campaign",objecttype_case:"Case",objecttype_contact:"Contact",objecttype_contract:"Contract",objecttype_event:"Event",objecttype_email:"Email",objecttype_goal:"Goal",objecttype_incident:"Case",objecttype_invoice:"Invoice",objecttype_lead:"Lead",objecttype_list:"Marketing List",objecttype_solution:"Solution",objecttype_task:"Task",objecttype_user:"User",objecttype_attachment:"Attachment",objecttype_casecomment:"Case Comment",objecttype_opportunity:"Opportunity",objecttype_opportunityproduct:"Opportunity Product",objecttype_feeditem:"Chatter",objecttype_feedcomment:"Chatter",objecttype_note:"Note",objecttype_product:"Product",objecttype_partner:"Partner",objecttype_queueitem:"Queue Item",objecttype_quote:"Quote",objecttype_salesliterature:"Sales Literature",objecttype_salesorder:"Sales Order",objecttype_service:"Service",objecttype_socialprofile:"Social Profile",objecttype_kbdocumentation:"Documentation",objecttype_kbtechnicalarticle:"Documentation",objecttype_kbsolution:"Solution",objecttype_kbknowledgearticle:"Knowledge Article",objecttype_kbattachment:"Attachment",objecttype_kbarticle:"Article",objecttype_kbarticlecomment:"Article Comment",objecttype_knowledgearticle:"Knowledge Article",filetype_html:"HTML File",filetype_wiki:"Wiki",filetype_webscraperwebpage:"Web page",filetype_image:"Image",filetype_folder:"Folder",filetype_txt:"Text",filetype_zip:"Zip File",filetype_pdf:"PDF File",filetype_xml:"XML File",filetype_doc:"Document",filetype_xls:"Spreadsheet Document",filetype_ppt:"Presentation Document",filetype_video:"Video",filetype_youtube:"YouTube video",filetype_saleforceitem:"Salesforce",filetype_dynamicscrmitem:"Dynamics CRM",filetype_exchangemessage:"Message",filetype_exchangeappointment:"Appointment",filetype_exchangenote:"Note",filetype_exchangetask:"Task",filetype_exchangeperson:"Exchange user",filetype_activedirperson:"Active Directory user",filetype_exchangeactivity:"Activity",filetype_exchangecalendarmessage:"Calendar message",filetype_exchangedocument:"Exchange document",filetype_exchangerssfeed:"RSS Feed",filetype_exchangejunkmessage:"Junk email",filetype_exchangeofficecom:"Communications",filetype_lithiummessage:"Message",filetype_lithiumthread:"Thread",filetype_lithiumboard:"Board",filetype_lithiumcategory:"Category",filetype_lithiumcommunity:"Community",filetype_spportal:"Portal",filetype_spsite:"Site",filetype_spuserprofile:"SharePoint User",filetype_sparea:"Area",filetype_spannouncement:"Announcement",filetype_spannouncementlist:"Announcements",filetype_spcontact:"Contact",filetype_spcontactlist:"Contacts",filetype_spcustomlist:"Custom Lists",filetype_spdiscussionboard:"Discussion Board",filetype_spdiscussionboardlist:"Discussion Boards",filetype_spdocumentlibrarylist:"Document Library",filetype_spevent:"Event",filetype_speventlist:"Events",filetype_spformlibrarylist:"Form Library",filetype_spissue:"Issue",filetype_spissuelist:"Issues",filetype_splink:"Link",filetype_splinklist:"Links",filetype_sppicturelibrarylist:"Picture Library",filetype_spsurvey:"Survey",filetype_spsurveylist:"Surveys",filetype_sptask:"Task",filetype_sptasklist:"Tasks",filetype_spagenda:"Agenda",filetype_spagendalist:"Agendas",filetype_spattendee:"Attendee",filetype_spattendeelist:"Attendees",filetype_spcustomgridlist:"Custom Grids",filetype_spdecision:"Decision",filetype_spdecisionlist:"Decisions",filetype_spobjective:"Objective",filetype_spobjectivelist:"Objectives",filetype_sptextbox:"Textbox",filetype_sptextboxlist:"Textbox list",filetype_spthingstobring:"Thing To Bring",filetype_spthingstobringlist:"Things To Bring",filetype_sparealisting:"Area Listing",filetype_spmeetingserie:"Meeting series",filetype_spmeetingserielist:"Meeting Series List",filetype_spsitedirectory:"Site Directory Item",filetype_spsitedirectorylist:"Site Directory",filetype_spdatasource:"Data Source",filetype_spdatasourcelist:"Data Source List",filetype_splisttemplatecataloglist:"List Template Catalog List",filetype_spwebpartcataloglist:"WebPart catalog list",filetype_spwebtemplatecataloglist:"Web Template Catalog List",filetype_spworkspacepagelist:"Workspace Page List",filetype_spunknownlist:"Custom List",filetype_spadministratortask:"Administrator Task",filetype_spadministratortasklist:"Administrator Tasks",filetype_spareadocumentlibrarylist:"Area Document Library",filetype_spblogcategory:"Blog Category",filetype_spblogcategorylist:"Blog Category",filetype_spblogcomment:"Blog Comment",filetype_spblogcommentlist:"Blog Comments",filetype_spblogpost:"Blog Post",filetype_spblogpostlist:"Blog Posts",filetype_spdataconnectionlibrarylist:"Data Connection Library",filetype_spdistributiongroup:"Distribution Group",filetype_spdistributiongrouplist:"Distribution Groups",filetype_spipfslist:"InfoPath Form Servers",filetype_spkeyperformanceindicator:"Key Performance Indicator",filetype_spkeyperformanceindicatorlist:"Key Performance Indicators",filetype_splanguagesandtranslator:"Languages and Translator",filetype_splanguagesandtranslatorlist:"Languages and Translators",filetype_spmasterpagescataloglist:"Master Pages Library",filetype_spnocodeworkflowlibrarylist:"No Code Workflow Library",filetype_spprojecttask:"Project Task",filetype_spprojecttasklist:"Project Tasks",filetype_sppublishingpageslibrarylist:"Page Library",filetype_spreportdocumentlibrarylist:"Report Document Library",filetype_spreportlibrarylist:"Report Library",filetype_spslidelibrarylist:"Slide Library",filetype_sptab:"Tabs",filetype_sptablist:"Tabs List",filetype_sptranslationmanagementlibrarylist:"Translation Management Library",filetype_spuserinformation:"User Information",filetype_spuserinformationlist:"User Information List",filetype_spwikipagelibrarylist:"Wiki Page Library",filetype_spworkflowhistory:"Workflow History",filetype_spworkflowhistorylist:"Workflow Histories",filetype_spworkflowprocess:"Custom Workflow Process",filetype_spworkflowprocesslist:"Custom Workflow Processes",filetype_sppublishingimageslibrarylist:"Publishing Image Library",filetype_spcirculation:"Circulation",filetype_spcirculationlist:"Circulations",filetype_spdashboardslibrarylist:"Dashboard Library",filetype_spdataconnectionforperformancepointlibrarylist:"Data Connection for Performance Point Library",filetype_sphealthreport:"Health Report",filetype_sphealthreportlist:"Health Reports",filetype_sphealthrule:"Health Rule",filetype_sphealthrulelist:"Health Rules",filetype_spimedictionary:"IME Dictionary",filetype_spimedictionarylist:"IME Dictionaries",filetype_spperformancepointcontent:"Performance Point Content",filetype_spperformancepointcontentlist:"Performance Point Contents",filetype_spphonecallmemo:"Phone Call Memo",filetype_spphonecallmemolist:"Phone Call Memos",filetype_sprecordlibrarylist:"Record Library",filetype_spresource:"Resource",filetype_spresourcelist:"Resources",filetype_spprocessdiagramslibrarylist:"Process Diagram Library",filetype_spsitethemeslibrarylist:"Site Theme Library",filetype_spsolutionslibrarylist:"Solution Library",filetype_spwfpublibrarylist:"WFPUB Library",filetype_spwhereabout:"Whereabout",filetype_spwhereaboutlist:"Whereabouts",filetype_spdocumentlink:"Link to a Document",filetype_spdocumentset:"Document Set",filetype_spmicrofeedpost:"Microfeed Post",filetype_spmicrofeedlist:"Microfeed",filetype_splistfolder:"List Folder",filetype_youtubevideo:"YouTube video",filetype_youtubeplaylistitem:"YouTube playlist item"};e.defaultLanguage=i,e.setLanguageAfterPageLoaded=o},function(t,e,n){(function(e){t.exports=e.Globalize=n(29)}).call(e,function(){return this}())},function(t,e,n){/*! globalize - v0.1.1 - 2013-04-30
	* https://github.com/jquery/globalize
	* Copyright 2013 ; Licensed MIT */
var i=function(e,n){var o,r,s,a,u,l,c,h,p,d,f,g,m,v,y,b,S,x,C,E,w,A,T,O;return o=function(t){return new o.prototype.init(t)},t.exports=o,o.cultures={},o.prototype={constructor:o,init:function(t){return this.cultures=o.cultures,this.cultureSelector=t,this}},o.prototype.init.prototype=o.prototype,o.cultures.default={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},o.cultures.default.calendar=o.cultures.default.calendars.standard,o.cultures.en=o.cultures.default,o.cultureSelector="en",r=/^0x[a-f0-9]+$/i,s=/^[+\-]?infinity$/i,a=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,u=/^\s+|\s+$/g,l=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},c=function(t,e){return t.substr(t.length-e.length)===e},h=function(){var t,e,i,o,r,s,a=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},u=2),"object"==typeof a||d(a)||(a={});l>u;u++)if(null!=(t=arguments[u]))for(e in t)i=a[e],o=t[e],a!==o&&(c&&o&&(f(o)||(r=p(o)))?(r?(r=!1,s=i&&p(i)?i:[]):s=i&&f(i)?i:{},a[e]=h(c,s,o)):o!==n&&(a[e]=o));return a},p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},d=function(t){return"[object Function]"===Object.prototype.toString.call(t)},f=function(t){return"[object Object]"===Object.prototype.toString.call(t)},g=function(t,e){return 0===t.indexOf(e)},m=function(t){return(t+"").replace(u,"")},v=function(t){return isNaN(t)?NaN:Math[0>t?"ceil":"floor"](t)},y=function(t,e,n){var i;for(i=t.length;e>i;i+=1)t=n?"0"+t:t+"0";return t},b=function(t,e){for(var n=0,i=!1,o=0,r=t.length;r>o;o++){var s=t.charAt(o);switch(s){case"'":i?e.push("'"):n++,i=!1;break;case"\\":i&&e.push("\\"),i=!i;break;default:e.push(s),i=!1}}return n},S=function(t,e){e=e||"F";var n,i=t.patterns,o=e.length;if(1===o){if(n=i[e],!n)throw"Invalid date format string '"+e+"'.";e=n}else 2===o&&"%"===e.charAt(0)&&(e=e.charAt(1));return e},x=function(t,e,n){function i(t,e){var n,i=t+"";return e>1&&e>i.length?(n=v[e-2]+i,n.substr(n.length-e,e)):n=i}function o(){return f||g?f:(f=y.test(e),g=!0,f)}function r(t,e){if(m)return m[e];switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:throw"Invalid part value "+e}}var s,a=n.calendar,u=a.convert;if(!e||!e.length||"i"===e){if(n&&n.name.length)if(u)s=x(t,a.patterns.F,n);else{var l=new Date(t.getTime()),c=w(t,a.eras);l.setFullYear(A(t,a,c)),s=l.toLocaleString()}else s=""+t;return s}var h=a.eras,p="s"===e;e=S(a,e),s=[];var d,f,g,m,v=["0","00","000"],y=/([^d]|^)(d|dd)([^d]|$)/g,C=0,T=E();for(!p&&u&&(m=u.fromGregorian(t));;){var O=T.lastIndex,_=T.exec(e),M=e.slice(O,_?_.index:e.length);if(C+=b(M,s),!_)break;if(C%2)s.push(_[0]);else{var N=_[0],R=N.length;switch(N){case"ddd":case"dddd":var D=3===R?a.days.namesAbbr:a.days.names;s.push(D[t.getDay()]);break;case"d":case"dd":f=!0,s.push(i(r(t,2),R));break;case"MMM":case"MMMM":var I=r(t,1);s.push(a.monthsGenitive&&o()?a.monthsGenitive[3===R?"namesAbbr":"names"][I]:a.months[3===R?"namesAbbr":"names"][I]);break;case"M":case"MM":s.push(i(r(t,1)+1,R));break;case"y":case"yy":case"yyyy":I=m?m[0]:A(t,a,w(t,h),p),4>R&&(I%=100),s.push(i(I,R));break;case"h":case"hh":d=t.getHours()%12,0===d&&(d=12),s.push(i(d,R));break;case"H":case"HH":s.push(i(t.getHours(),R));break;case"m":case"mm":s.push(i(t.getMinutes(),R));break;case"s":case"ss":s.push(i(t.getSeconds(),R));break;case"t":case"tt":I=12>t.getHours()?a.AM?a.AM[0]:" ":a.PM?a.PM[0]:" ",s.push(1===R?I.charAt(0):I);break;case"f":case"ff":case"fff":s.push(i(t.getMilliseconds(),3).substr(0,R));break;case"z":case"zz":d=t.getTimezoneOffset()/60,s.push((0>=d?"+":"-")+i(Math.floor(Math.abs(d)),R));break;case"zzz":d=t.getTimezoneOffset()/60,s.push((0>=d?"+":"-")+i(Math.floor(Math.abs(d)),2)+":"+i(Math.abs(t.getTimezoneOffset()%60),2));break;case"g":case"gg":a.eras&&s.push(a.eras[w(t,h)].name);break;case"/":s.push(a["/"]);break;default:throw"Invalid date format pattern '"+N+"'."}}}return s.join("")},function(){var t;t=function(t,e,n){var i=n.groupSizes,o=i[0],r=1,s=Math.pow(10,e),a=Math.round(t*s)/s;isFinite(a)||(a=t),t=a;var u=t+"",l="",c=u.split(/e/i),h=c.length>1?parseInt(c[1],10):0;u=c[0],c=u.split("."),u=c[0],l=c.length>1?c[1]:"",h>0?(l=y(l,h,!1),u+=l.slice(0,h),l=l.substr(h)):0>h&&(h=-h,u=y(u,h+1,!0),l=u.slice(-h,u.length)+l,u=u.slice(0,-h)),l=e>0?n["."]+(l.length>e?l.slice(0,e):y(l,e)):"";for(var p=u.length-1,d=n[","],f="";p>=0;){if(0===o||o>p)return u.slice(0,p+1)+(f.length?d+f+l:l);f=u.slice(p-o+1,p+1)+(f.length?d+f:""),p-=o,i.length>r&&(o=i[r],r++)}return u.slice(0,p+1)+d+f+l},C=function(e,n,i){if(!isFinite(e))return 1/0===e?i.numberFormat.positiveInfinity:e===-1/0?i.numberFormat.negativeInfinity:i.numberFormat.NaN;if(!n||"i"===n)return i.name.length?e.toLocaleString():""+e;n=n||"D";var o,r=i.numberFormat,s=Math.abs(e),a=-1;n.length>1&&(a=parseInt(n.slice(1),10));var u,l=n.charAt(0).toUpperCase();switch(l){case"D":o="n",s=v(s),-1!==a&&(s=y(""+s,a,!0)),0>e&&(s="-"+s);break;case"N":u=r;case"C":u=u||r.currency;case"P":u=u||r.percent,o=0>e?u.pattern[0]:u.pattern[1]||"n",-1===a&&(a=u.decimals),s=t(s*("P"===l?100:1),a,u);break;default:throw"Bad number format specifier: "+l}for(var c=/n|\$|-|%/g,h="";;){var p=c.lastIndex,d=c.exec(o);if(h+=o.slice(p,d?d.index:o.length),!d)break;switch(d[0]){case"n":h+=s;break;case"$":h+=r.currency.symbol;break;case"-":/[1-9]/.test(s)&&(h+=r["-"]);break;case"%":h+=r.percent.symbol}}return h}}(),E=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},w=function(t,e){if(!e)return 0;for(var n,i=t.getTime(),o=0,r=e.length;r>o;o++)if(n=e[o].start,null===n||i>=n)return o;return 0},A=function(t,e,n,i){var o=t.getFullYear();return!i&&e.eras&&(o-=e.eras[n].offset),o},function(){var t,e,n,i,o,r,s;t=function(t,e){if(100>e){var n=new Date,i=w(n),o=A(n,t,i),r=t.twoDigitYearMax;r="string"==typeof r?(new Date).getFullYear()%100+parseInt(r,10):r,e+=o-o%100,e>r&&(e-=100)}return e},e=function(t,e,n){var i,o=t.days,a=t._upperDays;return a||(t._upperDays=a=[s(o.names),s(o.namesAbbr),s(o.namesShort)]),e=r(e),n?(i=l(a[1],e),-1===i&&(i=l(a[2],e))):i=l(a[0],e),i},n=function(t,e,n){var i=t.months,o=t.monthsGenitive||t.months,a=t._upperMonths,u=t._upperMonthsGen;a||(t._upperMonths=a=[s(i.names),s(i.namesAbbr)],t._upperMonthsGen=u=[s(o.names),s(o.namesAbbr)]),e=r(e);var c=l(n?a[1]:a[0],e);return 0>c&&(c=l(n?u[1]:u[0],e)),c},i=function(t,e){var n=t._parseRegExp;if(n){var i=n[e];if(i)return i}else t._parseRegExp=n={};for(var o,r=S(t,e).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),s=["^"],a=[],u=0,l=0,c=E();null!==(o=c.exec(r));){var h=r.slice(u,o.index);if(u=c.lastIndex,l+=b(h,s),l%2)s.push(o[0]);else{var p,d=o[0],f=d.length;switch(d){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":p="(\\D+)";break;case"tt":case"t":p="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":p="(\\d{"+f+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":p="(\\d\\d?)";break;case"zzz":p="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":p="([+-]?\\d\\d?)";break;case"/":p="(\\/)";break;default:throw"Invalid date format pattern '"+d+"'."}p&&s.push(p),a.push(o[0])}}b(r.slice(u),s),s.push("$");var g=s.join("").replace(/\s+/g,"\\s+"),m={regExp:g,groups:a};return n[e]=m},o=function(t,e,n){return e>t||t>n},r=function(t){return t.split(" ").join(" ").toUpperCase()},s=function(t){for(var e=[],n=0,i=t.length;i>n;n++)e[n]=r(t[n]);return e},T=function(r,s,a){r=m(r);var u=a.calendar,l=i(u,s),c=RegExp(l.regExp).exec(r);if(null===c)return null;for(var h,p=l.groups,d=null,f=null,v=null,y=null,b=null,S=0,x=0,C=0,E=0,w=null,A=!1,T=0,O=p.length;O>T;T++){var _=c[T+1];if(_){var M=p[T],N=M.length,R=parseInt(_,10);switch(M){case"dd":case"d":if(y=R,o(y,1,31))return null;break;case"MMM":case"MMMM":if(v=n(u,_,3===N),o(v,0,11))return null;break;case"M":case"MM":if(v=R-1,o(v,0,11))return null;break;case"y":case"yy":case"yyyy":if(f=4>N?t(u,R):R,o(f,0,9999))return null;break;case"h":case"hh":if(S=R,12===S&&(S=0),o(S,0,11))return null;break;case"H":case"HH":if(S=R,o(S,0,23))return null;break;case"m":case"mm":if(x=R,o(x,0,59))return null;break;case"s":case"ss":if(C=R,o(C,0,59))return null;break;case"tt":case"t":if(A=u.PM&&(_===u.PM[0]||_===u.PM[1]||_===u.PM[2]),!A&&(!u.AM||_!==u.AM[0]&&_!==u.AM[1]&&_!==u.AM[2]))return null;break;case"f":case"ff":case"fff":if(E=R*Math.pow(10,3-N),o(E,0,999))return null;break;case"ddd":case"dddd":if(b=e(u,_,3===N),o(b,0,6))return null;break;case"zzz":var D=_.split(/:/);if(2!==D.length)return null;if(h=parseInt(D[0],10),o(h,-12,13))return null;var I=parseInt(D[1],10);if(o(I,0,59))return null;w=60*h+(g(_,"-")?-I:I);break;case"z":case"zz":if(h=R,o(h,-12,13))return null;w=60*h;break;case"g":case"gg":var F=_;if(!F||!u.eras)return null;F=m(F.toLowerCase());for(var k=0,$=u.eras.length;$>k;k++)if(F===u.eras[k].name.toLowerCase()){d=k;break}if(null===d)return null}}}var L,U=new Date,B=u.convert;if(L=B?B.fromGregorian(U)[0]:U.getFullYear(),null===f?f=L:u.eras&&(f+=u.eras[d||0].offset),null===v&&(v=0),null===y&&(y=1),B){if(U=B.toGregorian(f,v,y),null===U)return null}else{if(U.setFullYear(f,v,y),U.getDate()!==y)return null;if(null!==b&&U.getDay()!==b)return null}if(A&&12>S&&(S+=12),U.setHours(S,x,C,E),null!==w){var P=U.getMinutes()-(w+U.getTimezoneOffset());U.setHours(U.getHours()+parseInt(P/60,10),P%60)}return U}}(),O=function(t,e,n){var i,o=e["-"],r=e["+"];switch(n){case"n -":o=" "+o,r=" "+r;case"n-":c(t,o)?i=["-",t.substr(0,t.length-o.length)]:c(t,r)&&(i=["+",t.substr(0,t.length-r.length)]);break;case"- n":o+=" ",r+=" ";case"-n":g(t,o)?i=["-",t.substr(o.length)]:g(t,r)&&(i=["+",t.substr(r.length)]);break;case"(n)":g(t,"(")&&c(t,")")&&(i=["-",t.substr(1,t.length-2)])}return i||["",t]},o.prototype.findClosestCulture=function(t){return o.findClosestCulture.call(this,t)},o.prototype.format=function(t,e,n){return o.format.call(this,t,e,n)},o.prototype.localize=function(t,e){return o.localize.call(this,t,e)},o.prototype.parseInt=function(t,e,n){return o.parseInt.call(this,t,e,n)},o.prototype.parseFloat=function(t,e,n){return o.parseFloat.call(this,t,e,n)},o.prototype.culture=function(t){return o.culture.call(this,t)},o.addCultureInfo=function(t,e,n){var i={},o=!1;"string"!=typeof t?(n=t,t=this.culture().name,i=this.cultures[t]):"string"!=typeof e?(n=e,o=null==this.cultures[t],i=this.cultures[t]||this.cultures.default):(o=!0,i=this.cultures[e]),this.cultures[t]=h(!0,{},i,n),o&&(this.cultures[t].calendar=this.cultures[t].calendars.standard)},o.findClosestCulture=function(t){var e;if(!t)return this.findClosestCulture(this.cultureSelector)||this.cultures.default;if("string"==typeof t&&(t=t.split(",")),p(t)){var n,i,o=this.cultures,r=t,s=r.length,a=[];for(i=0;s>i;i++){t=m(r[i]);var u,l=t.split(";");n=m(l[0]),1===l.length?u=1:(t=m(l[1]),0===t.indexOf("q=")?(t=t.substr(2),u=parseFloat(t),u=isNaN(u)?0:u):u=1),a.push({lang:n,pri:u})}for(a.sort(function(t,e){return t.pri<e.pri?1:t.pri>e.pri?-1:0}),i=0;s>i;i++)if(n=a[i].lang,e=o[n])return e;for(i=0;s>i;i++)for(n=a[i].lang;;){var c=n.lastIndexOf("-");if(-1===c)break;if(n=n.substr(0,c),e=o[n])return e}for(i=0;s>i;i++){n=a[i].lang;for(var h in o){var d=o[h];if(d.language===n)return d}}}else if("object"==typeof t)return t;return e||null},o.format=function(t,e,n){var i=this.findClosestCulture(n);return t instanceof Date?t=x(t,e,i):"number"==typeof t&&(t=C(t,e,i)),t},o.localize=function(t,e){return this.findClosestCulture(e).messages[t]||this.cultures.default.messages[t]},o.parseDate=function(t,e,n){n=this.findClosestCulture(n);var i,o,r;if(e){if("string"==typeof e&&(e=[e]),e.length)for(var s=0,a=e.length;a>s;s++){var u=e[s];if(u&&(i=T(t,u,n)))break}}else{r=n.calendar.patterns;for(o in r)if(i=T(t,r[o],n))break}return i||null},o.parseInt=function(t,e,n){return v(o.parseFloat(t,e,n))},o.parseFloat=function(t,e,n){"number"!=typeof e&&(n=e,e=10);var i=this.findClosestCulture(n),o=NaN,u=i.numberFormat;if(t.indexOf(i.numberFormat.currency.symbol)>-1&&(t=t.replace(i.numberFormat.currency.symbol,""),t=t.replace(i.numberFormat.currency["."],i.numberFormat["."])),t.indexOf(i.numberFormat.percent.symbol)>-1&&(t=t.replace(i.numberFormat.percent.symbol,"")),t=t.replace(/ /g,""),s.test(t))o=parseFloat(t);else if(!e&&r.test(t))o=parseInt(t,16);else{var l=O(t,u,u.pattern[0]),c=l[0],h=l[1];""===c&&"(n)"!==u.pattern[0]&&(l=O(t,u,"(n)"),c=l[0],h=l[1]),""===c&&"-n"!==u.pattern[0]&&(l=O(t,u,"-n"),c=l[0],h=l[1]),c=c||"+";var p,d,f=h.indexOf("e");0>f&&(f=h.indexOf("E")),0>f?(d=h,p=null):(d=h.substr(0,f),p=h.substr(f+1));var g,m,v=u["."],y=d.indexOf(v);0>y?(g=d,m=null):(g=d.substr(0,y),m=d.substr(y+v.length));var b=u[","];g=g.split(b).join("");var S=b.replace(/\u00A0/g," ");b!==S&&(g=g.split(S).join(""));var x=c+g;if(null!==m&&(x+="."+m),null!==p){var C=O(p,u,"-n");x+="e"+(C[0]||"+")+C[1]}a.test(x)&&(o=parseFloat(x))}return o},o.culture=function(t){return t!==n&&(this.cultureSelector=t),this.findClosestCulture(t)||this.cultures.default},i}(this)},function(t,e,n){"use strict";var i=n(14);e.Assert=i.Assert;var o=n(31);e.Cache=o.Cache;var r=n(32);e.Defer=r.Defer;var s=n(33);e.L10N=s.L10N;var a=n(13);e.Logger=a.Logger;var u=n(34);e.Options=u.Options;var l=n(35);e.l=l.l},function(t,e){"use strict";var n=function(){function t(t){this.onEmpty=t,this.cache=[]}return t.prototype.get=function(){return 0==this.cache.length?this.onEmpty():this.cache.pop()},t.prototype.push=function(t){this.cache.push(t)},t}();e.Cache=n},function(t,e,n){(function(t){"use strict";var n=function(){function e(){}return e.defer=function(t){e.functions.push(t),e.arm()},e.flush=function(){for(;e.popOne(););},e.arm=function(){t.defer(function(){e.popOne()&&e.arm()})},e.popOne=function(){if(e.functions.length>0){var n=e.functions[0];return e.functions=t.rest(e.functions),n(),e.functions.length>0}return!1},e.functions=[],e}();e.Defer=n}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(23);String.toLocaleString=i.LocaleString;var o=/<pl>(((?!<\/pl>).)*)<\/pl>/g,r=/<sn>(((?!<\/sn>).)*)<\/sn>/g;e.L10N={format:function(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var r=n.toLocaleString();if(i.length>0){var s=t.last(i);(t.isBoolean(s)||t.isNumber(s))&&(i.pop(),r=e.L10N.formatPlSn(r,s)),t.each(i,function(t,e){return r=r.replace("{"+e+"}",t)})}return r},formatPlSn:function(e,n){var i=t.isBoolean(n)?n:n>1;return e=i?e.replace(o,"$1").replace(r,""):e.replace(o,"").replace(r,"$1")}}}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(15),o=function(){function e(){}return e.prototype.merge=function(e){return t.extend({},this,e)},e.prototype.mergeDeep=function(e){return t.extend({},i.Utils.extendDeep(this,e))},e}();e.Options=o}).call(e,n(10))},function(t,e,n){"use strict";function i(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return o.L10N.format.apply(this,arguments)}var o=n(33);e.l=i},function(t,e,n){"use strict";var i=n(37);e.AnalyticsEndpoint=i.AnalyticsEndpoint;var o=n(12);e.EndpointCaller=o.EndpointCaller;var r=n(22);e.QueryError=r.QueryError},function(t,e,n){(function(t){"use strict";var i=n(13),o=n(12),r=n(14),s=n(21),a=n(38),u=n(4),l=function(){function e(t){this.options=t,this.logger=new i.Logger(this);var e={accessToken:this.options.token&&""!=this.options.token?this.options.token:null};this.endpointCaller=new o.EndpointCaller(e),this.organization=t.organization}return e.prototype.getCurrentVisitId=function(){return this.visitId},e.prototype.getCurrentVisitIdPromise=function(){var t=this;return new u.Promise(function(e,n){if(t.getCurrentVisitId())e(t.getCurrentVisitId());else{var i=t.buildAnalyticsUrl("/analytics/visit");t.getFromService(i,{}).then(function(n){t.visitId=n.id,e(t.visitId)}).catch(function(t){n(t)})}})},e.prototype.sendSearchEvents=function(t){if(t.length>0)return this.logger.info("Logging analytics search events",t),this.sendToService(t,"searches","searchEvents")},e.prototype.sendDocumentViewEvent=function(t){return r.Assert.exists(t),this.logger.info("Logging analytics document view",t),this.sendToService(t,"click","clickEvent")},e.prototype.sendCustomEvent=function(t){return r.Assert.exists(t),this.logger.info("Logging analytics custom event",t),this.sendToService(t,"custom","customEvent")},e.prototype.getTopQueries=function(t){var e=this.buildAnalyticsUrl("/stats/topQueries");return this.getFromService(e,t)},e.prototype.sendToService=function(t,n,i){var o=this,r=s.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(e.CUSTOM_ANALYTICS_VERSION||e.DEFAULT_ANALYTICS_VERSION)+"/analytics/"+n),u=[];return this.organization&&u.push("org="+this.organization),a.Cookie.get("visitorId")&&u.push("visitor="+encodeURIComponent(a.Cookie.get("visitorId"))),null==e.pendingRequest?(e.pendingRequest=this.endpointCaller.call({errorsAsSuccess:!1,method:"POST",queryString:u,requestData:t,url:r,responseType:"text",requestDataType:"application/json"}).then(function(t){return o.handleAnalyticsEventResponse(t.data)}).finally(function(){e.pendingRequest=null}),e.pendingRequest):e.pendingRequest.finally(function(){return o.sendToService(t,n,i)})},e.prototype.getFromService=function(e,n){var i=this.options.token&&""!=this.options.token?t.extend({access_token:this.options.token},n):n;return this.endpointCaller.call({errorsAsSuccess:!1,method:"GET",queryString:this.options.organization?["org="+encodeURIComponent(this.options.organization)]:[],requestData:i,responseType:"json",url:e}).then(function(t){return t.data})},e.prototype.handleAnalyticsEventResponse=function(n){var i,o;return n.visitId?(i=n.visitId,o=n.visitorId):n.searchEventResponses&&(i=t.first(n.searchEventResponses).visitId,o=t.first(n.searchEventResponses).visitorId),i&&(this.visitId=i),o&&a.Cookie.set("visitorId",o,e.VISITOR_COOKIE_TIME),n},e.prototype.buildAnalyticsUrl=function(t){return this.options.serviceUrl+"/rest/"+(e.CUSTOM_ANALYTICS_VERSION||e.DEFAULT_ANALYTICS_VERSION)+t},e.DEFAULT_ANALYTICS_URI="https://usageanalytics.coveo.com",e.DEFAULT_ANALYTICS_VERSION="v15",e.CUSTOM_ANALYTICS_VERSION=void 0,e.VISITOR_COOKIE_TIME=864e9,e}();e.AnalyticsEndpoint=l}).call(e,n(10))},function(t,e){"use strict";var n=function(){function t(){}return t.set=function(e,n,i){var o,r,s,a,u;i?(s=new Date,s.setTime(s.getTime()+i),a="; expires="+s.toGMTString()):a="",u=location.hostname,1===u.split(".").length?document.cookie=this.prefix+e+"="+n+a+"; path=/":(r=u.split("."),r.shift(),o="."+r.join("."),document.cookie=this.prefix+e+"="+n+a+"; path=/; domain="+o,null!=t.get(e)&&t.get(e)==n||(o="."+u,document.cookie=this.prefix+e+"="+n+a+"; path=/; domain="+o))},t.get=function(t){for(var e=this.prefix+t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null},t.erase=function(e){t.set(e,"",-1)},t.prefix="coveo_",t}();e.Cookie=n},function(t,e,n){"use strict";var i=n(40);e.AdvancedSearchEvents=i.AdvancedSearchEvents;var o=n(41);e.AnalyticsEvents=o.AnalyticsEvents;var r=n(42);e.BreadcrumbEvents=r.BreadcrumbEvents;var s=n(43);e.DebugEvents=s.DebugEvents;var a=n(44);e.ImageResultListEvents=a.ImageResultListEvents;var u=n(45);e.InitializationEvents=u.InitializationEvents;var l=n(46);e.OmniboxEvents=l.OmniboxEvents;var c=n(47);e.PreferencesPanelEvents=c.PreferencesPanelEvents;var h=n(48);e.QueryEvents=h.QueryEvents;var p=n(49);e.ResultListEvents=p.ResultListEvents;var d=n(50);e.SearchAlertsEvents=d.SearchAlertsEvents;var f=n(51);e.SettingsEvents=f.SettingsEvents;var g=n(52);e.SliderEvents=g.SliderEvents;var m=n(53);e.StandaloneSearchInterfaceEvents=m.StandaloneSearchInterfaceEvents},function(t,e){"use strict";var n=function(){function t(){}return t.buildingAdvancedSearch="buildingAdvancedSearch",t.executeAdvancedSearch="executeAdvancedSearch",t}();e.AdvancedSearchEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.searchEvent="analyticsSearchEvent",t.documentViewEvent="analyticsDocumentViewEvent",t.customEvent="analyticsCustomEvent",t.changeAnalyticsCustomData="changeAnalyticsCustomData",t}();e.AnalyticsEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.populateBreadcrumb="populateBreadcrumb",t.clearBreadcrumb="clearBreadcrumb",t.redrawBreadcrumb="redrawBreadcrumb",t}();e.BreadcrumbEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.showDebugPanel="showDebugPanel",t}();e.DebugEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.imageResultsLayoutComplete="imageResultsLayoutComplete",t}();e.ImageResultListEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.beforeInitialization="beforeInitialization",t.afterComponentsInitialization="afterComponentsInitialization",t.restoreHistoryState="restoreHistoryState",t.afterInitialization="afterInitialization",t.nuke="nuke",t}();e.InitializationEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.populateOmnibox="populateOmnibox",t.openOmnibox="openOmnibox",t.closeOmnibox="closeOmnibox",t.populateOmniboxSuggestions="populateOmniboxSuggestions",t.omniboxPreprocessResultForQuery="omniboxPreprocessResultForQuery",t}();e.OmniboxEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.savePreferences="savePreferences",t.exitPreferencesWithoutSave="exitPreferencesWithoutSave",t}();e.PreferencesPanelEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.newQuery="newQuery",t.buildingQuery="buildingQuery",t.doneBuildingQuery="doneBuildingQuery",t.duringQuery="duringQuery",t.duringFetchMoreQuery="duringFetchMoreQuery",t.querySuccess="querySuccess",t.fetchMoreSuccess="fetchMoreSuccess",t.deferredQuerySuccess="deferredQuerySuccess",t.queryError="queryError",t.preprocessResults="preprocessResults",t.preprocessMoreResults="preprocessMoreResults",t.noResults="noResults",t.buildingCallOptions="buildingCallOptions",t}();e.QueryEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.newResultsDisplayed="newResultsDisplayed",t.newResultDisplayed="newResultDisplayed",t.openQuickview="openQuickview",t}();e.ResultListEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.searchAlertsCreated="searchAlertsCreated",t.searchAlertsDeleted="searchAlertsDeleted",t.searchAlertsFail="searchAlertsFail",t.searchAlertsPopulateMessage="searchAlertsPopulateMessage",t}();e.SearchAlertsEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.settingsPopulateMenu="settingsPopulateMenu",t}();e.SettingsEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.startSlide="startSlide",t.duringSlide="duringSlide",t.endSlide="endSlide",t.graphValueSelected="graphValueSelected",t}();e.SliderEvents=n},function(t,e){"use strict";var n=function(){function t(){}return t.beforeRedirect="beforeRedirect",t}();e.StandaloneSearchInterfaceEvents=n},function(t,e,n){"use strict";var i=n(55);e.ColorUtils=i.ColorUtils;var o=n(38);e.Cookie=o.Cookie;var r=n(56);e.CurrencyUtils=r.CurrencyUtils;var s=n(57);e.DateUtils=s.DateUtils;var a=n(17);e.DeviceUtils=a.DeviceUtils;var u=n(58);e.Dom=u.Dom,e.$$=u.$$;var l=n(59);e.DomUtils=l.DomUtils;var c=n(63);e.EmailActionsUtils=c.EmailActionsUtils;var h=n(64);e.EmailUtils=h.EmailUtils;var p=n(65);e.FeatureDetectionUtils=p.FeatureDetectionUtils;var d=n(66);e.HashUtils=d.HashUtils;var f=n(67);e.HighlightUtils=f.HighlightUtils,e.StringAndHoles=f.StringAndHoles;var g=n(68);e.HTMLUtils=g.HTMLUtils;var m=n(69);e.KEYBOARD=m.KEYBOARD,e.KeyboardUtils=m.KeyboardUtils;var v=n(70);e.LocalStorageUtils=v.LocalStorageUtils;var y=n(71);e.OSUtils=y.OSUtils,e.OS_NAME=y.OS_NAME;var b=n(72);e.PopupUtils=b.PopupUtils;var S=n(21);e.QueryUtils=S.QueryUtils;var x=n(73);e.StreamHighlightUtils=x.StreamHighlightUtils;var C=n(61);e.StringUtils=C.StringUtils;var E=n(16);e.TimeSpan=E.TimeSpan;var w=n(15);e.Utils=w.Utils},function(t,e){"use strict";var n=function(){function t(){}return t.hsvToRgb=function(t,e,n){var i,o,r,s=Math.floor(6*t),a=6*t-s,u=n*(1-e),l=n*(1-a*e),c=n*(1-(1-a)*e);switch(s%6){case 0:i=n,o=c,r=u;break;case 1:i=l,o=n,r=u;break;case 2:i=u,o=n,r=c;break;case 3:i=u,o=l,r=n;break;case 4:i=c,o=u,r=n;break;case 5:i=n,o=u,r=l}return[Math.round(255*i),Math.round(255*o),Math.round(255*r)]},t.rgbToHsv=function(t,e,n){t/=255,e/=255,n/=255;var i,o,r=Math.max(t,e,n),s=Math.min(t,e,n),a=r,u=r-s;if(o=0==r?0:u/r,r==s)i=0;else{switch(r){case t:i=(e-n)/u+(e<n?6:0);break;case e:i=(n-t)/u+2;break;case n:i=(t-e)/u+4}i/=6}return[i,o,a]},t}();e.ColorUtils=n},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(14),r=n(34),s=n(15),a=n(28),u=function(t){function e(){t.apply(this,arguments),this.decimals=0}return i(e,t),e}(r.Options),l=function(){function t(){}return t.currencyToString=function(t,e){if(s.Utils.isNullOrUndefined(t))return"";t=Number(t),o.Assert.isNumber(t),e=(new u).merge(e);var n=a.culture().numberFormat.currency,i=n.symbol;s.Utils.isNonEmptyString(e.symbol)&&(n.symbol=e.symbol);var r=a.format(t,"c"+e.decimals.toString());return n.symbol=i,r},t}();e.CurrencyUtils=l},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(34),r=n(15),s=n(35),a=n(16),u=n(28),l=function(t){function e(){t.apply(this,arguments),this.now=new Date,this.useTodayYesterdayAndTomorrow=!0,this.useWeekdayIfThisWeek=!0,this.omitYearIfCurrentOne=!0,this.useLongDateFormat=!1,this.includeTimeIfToday=!0,this.includeTimeIfThisWeek=!0,this.alwaysIncludeTime=!1,this.predefinedFormat=void 0}return i(e,t),e}(o.Options),c=function(){function e(){}return e.convertFromJsonDateIfNeeded=function(e){return t.isDate(e)?e:null===e||isNaN(Number(e))?t.isString(e)?new Date(e.replace("@"," ")):void 0:new Date(Number(e))},e.dateForQuery=function(t){return t.getFullYear()+"/"+e.padNumber((t.getMonth()+1).toString())+"/"+e.padNumber(t.getDate().toString())},e.padNumber=function(t,e){for(void 0===e&&(e=2);t.length<e;)t="0"+t;return t},e.keepOnlyDatePart=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.offsetDateByDays=function(t,e){var n=new Date(t.valueOf());return n.setDate(n.getDate()+e),n},e.dateToString=function(t,n){if(r.Utils.isNullOrUndefined(t))return"";n=(new l).merge(n);var i=e.keepOnlyDatePart(t);if(n.predefinedFormat)return u.format(i,n.predefinedFormat);var o=e.keepOnlyDatePart(n.now);if(n.useTodayYesterdayAndTomorrow){if(i.valueOf()==o.valueOf())return s.l("Today");var c=e.offsetDateByDays(o,1);if(i.valueOf()==c.valueOf())return s.l("Tomorrow");var h=e.offsetDateByDays(o,-1);if(i.valueOf()==h.valueOf())return s.l("Yesterday")}var p=Math.abs(a.TimeSpan.fromDates(i,o).getDays())<7;return n.useWeekdayIfThisWeek&&p?i.valueOf()>o.valueOf()?s.l("Next")+" "+u.format(i,"dddd"):s.l("Last")+" "+u.format(i,"dddd"):n.omitYearIfCurrentOne&&i.getFullYear()===o.getFullYear()?u.format(i,"M"):n.useLongDateFormat?u.format(i,"D"):u.format(i,"d")},e.timeToString=function(t,e){return r.Utils.isNullOrUndefined(t)?"":u.format(t,"t")},e.dateTimeToString=function(t,n){if(r.Utils.isNullOrUndefined(t))return"";n=(new l).merge(n);var i=e.keepOnlyDatePart(n.now),o=Math.abs(a.TimeSpan.fromDates(t,i).getDays())<7,s=e.dateToString(t,n),u=e.keepOnlyDatePart(t);return n.alwaysIncludeTime||n.includeTimeIfThisWeek&&o||n.includeTimeIfToday&&u.valueOf()==i.valueOf()?s+", "+e.timeToString(t):s},e.monthToString=function(t){var e=new Date(1980,t);return u.format(e,"MMMM")},e.isValid=function(t){return t instanceof Date&&!isNaN(t.getTime())},e.timeBetween=function(t,e){return r.Utils.isNullOrUndefined(t)||r.Utils.isNullOrUndefined(e)?"":("0"+((e.getTime()-t.getTime())/36e5).toFixed()).slice(-2)+":"+("0"+((e.getTime()-t.getTime())%36e5/6e4).toFixed()).slice(-2)+":"+("0"+((e.getTime()-t.getTime())%6e4/1e3).toFixed()).slice(-2)},e}();e.DateUtils=c,Date.prototype.toISOString||!function(){function t(t){return t<10?"0"+t:t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}()}).call(e,n(10))},function(t,e,n){(function(t){"use strict";function i(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return 1===e.length&&e[0]instanceof l?e[0]:new l(1!==e.length||t.isString(e[0])?l.createElement.apply(l,e):e[0])}function o(t){var e=document.createElement("div");return e.innerHTML=t,1==e.children.length?e.children.item(0):e}var r=n(15),s=n(18),a=n(14),u=n(13),l=function(){function e(t){a.Assert.exists(t),this.el=t}return e.createElement=function(n,i){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];var a=document.createElement(n);for(var u in i)if("className"===u)a.className=i.className;else{var l=u.indexOf("-")!==-1?u:r.Utils.toDashCase(u);a.setAttribute(l,i[u])}return t.each(o,function(n){n instanceof HTMLElement?a.appendChild(n):t.isString(n)?a.innerHTML+=n:n instanceof e&&a.appendChild(n.el)}),a},e.prototype.append=function(t){this.el.appendChild(t)},e.prototype.css=function(t){return this.el.style[t]?this.el.style[t]:window.getComputedStyle(this.el).getPropertyValue(t)},e.prototype.text=function(t){return r.Utils.isUndefined(t)?this.el.innerText||this.el.textContent:void(void 0!=this.el.innerText?this.el.innerText=t:void 0!=this.el.textContent&&(this.el.textContent=t))},e.prototype.nodeListToArray=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t.item(e);return n},e.prototype.empty=function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)},e.prototype.remove=function(){this.el.parentNode.removeChild(this.el)},e.prototype.show=function(){this.el.style.display="block"},e.prototype.hide=function(){this.el.style.display="none"},e.prototype.toggle=function(t){void 0===t?"block"==this.el.style.display?this.hide():this.show():t?this.show():this.hide()},e.prototype.getAttribute=function(t){return this.el.getAttribute(t)},e.prototype.setAttribute=function(t,e){this.el.setAttribute(t,e)},e.prototype.find=function(t){return this.el.querySelector(t)},e.prototype.is=function(t){return this.el.tagName.toLowerCase()==t.toLowerCase()||(!("."!=t[0]||!this.hasClass(t.substr(1)))||"#"==t[0]&&this.el.getAttribute("id")==t.substr(1))},e.prototype.closest=function(t){return this.traverseAncestorForClass(this.el,t)},e.prototype.parent=function(t){if(void 0!=this.el.parentElement)return this.traverseAncestorForClass(this.el.parentElement,t)},e.prototype.parents=function(t){
for(var n=[],i=this.parent(t);i;)n.push(i),i=new e(i).parent(t);return n},e.prototype.children=function(){return this.nodeListToArray(this.el.children)},e.prototype.siblings=function(t){for(var e=[],n=this.el.parentNode.firstChild;n;n=n.nextSibling)n!=this.el&&(!this.matches(n,t)&&t||e.push(n));return e},e.prototype.matches=function(t,e){for(var n=document.querySelectorAll(e),i=0;i<n.length;i++)if(n[i]===t)return!0;return!1},e.prototype.findAll=function(t){return this.nodeListToArray(this.el.querySelectorAll(t))},e.prototype.findClass=function(t){return"getElementsByClassName"in this.el?this.nodeListToArray(this.el.getElementsByClassName(t)):this.nodeListToArray(this.el.querySelectorAll("."+t))},e.prototype.findId=function(t){return document.getElementById(t)},e.prototype.addClass=function(e){var n=this;t.isArray(e)?t.each(e,function(t){n.addClass(t)}):this.hasClass(e)||(this.el.className?this.el.className+=" "+e:this.el.className=e)},e.prototype.removeClass=function(t){this.el.className=this.el.className.replace(new RegExp("(^|\\s)"+t+"(\\s|\\b)","g"),"$1").trim()},e.prototype.toggleClass=function(t,e){r.Utils.isNullOrUndefined(e)?this.hasClass(t)?this.removeClass(t):this.addClass(t):e?this.addClass(t):this.removeClass(t)},e.prototype.setHtml=function(t){this.el.innerHTML=t},e.prototype.getClass=function(){return this.el.className.match(e.CLASS_NAME_REGEX)||[]},e.prototype.hasClass=function(e){return t.contains(this.getClass(),e)},e.prototype.detach=function(){this.el.parentElement&&this.el.parentElement.removeChild(this.el)},e.prototype.insertAfter=function(t){t.parentNode&&t.parentNode.insertBefore(this.el,t.nextSibling)},e.prototype.insertBefore=function(t){t.parentNode&&t.parentNode.insertBefore(this.el,t)},e.prototype.prepend=function(t){this.el.firstChild?new e(t).insertBefore(this.el.firstChild):this.el.appendChild(t)},e.prototype.on=function(n,i){var o=this;if(t.isArray(n))t.each(n,function(t){o.on(t,i)});else{var r=s.JQueryUtils.getJQuery();if(r)r(this.el).on(n,i);else if(this.el.addEventListener){var a=function(t){i(t,t.detail)};e.handlers.push({eventHandle:i,fn:a}),this.el.addEventListener(n,a,!1)}else this.el.on&&this.el.on("on"+n,i)}},e.prototype.one=function(e,n){var i=this;if(t.isArray(e))t.each(e,function(t){i.one(t,n)});else{var o=function(t,r){return i.off(e,o),n(t,r)};this.on(e,o)}},e.prototype.off=function(n,i){var o=this;if(t.isArray(n))t.each(n,function(t){o.off(t,i)});else{var r=s.JQueryUtils.getJQuery();if(r)r(this.el).off(n,i);else if(this.el.removeEventListener){var a=0,u=t.find(e.handlers,function(t,e){if(t.eventHandle==i)return a=e,!0});u&&(this.el.removeEventListener(n,u.fn,!1),e.handlers.splice(a,1))}else this.el.off&&this.el.off("on"+n,i)}},e.prototype.trigger=function(t,e){var n=s.JQueryUtils.getJQuery();if(n)n(this.el).trigger(t,e);else if(void 0!==CustomEvent){var i=new CustomEvent(t,{detail:e,bubbles:!0});this.el.dispatchEvent(i)}else new u.Logger(this).error("CANNOT TRIGGER EVENT FOR OLDER BROWSER")},e.prototype.isEmpty=function(){return e.ONLY_WHITE_SPACE_REGEX.test(this.el.innerHTML)},e.prototype.isDescendant=function(t){for(var e=this.el.parentNode;null!=e;){if(e==t)return!0;e=e.parentNode}return!1},e.prototype.replaceWith=function(t){var n=this.el.parentNode;n&&new e(t).insertAfter(this.el),this.detach()},e.prototype.position=function(){var t=this.offsetParent(),e={top:0,left:0},n=this.offset();i(t).is("html")||(e=i(t).offset());var o=parseInt(i(t).css("borderTopWidth")),r=parseInt(i(t).css("borderLeftWidth"));o=isNaN(o)?0:o,r=isNaN(r)?0:r,e={top:e.top+o,left:e.left+r};var s=parseInt(this.css("marginTop")),a=parseInt(this.css("marginLeft"));return s=isNaN(s)?0:s,a=isNaN(a)?0:a,{top:n.top-e.top-s,left:n.left-e.left-a}},e.prototype.offsetParent=function(){for(var t=this.el.offsetParent;t instanceof HTMLElement&&"static"===i(t).css("position");)t=t.offsetParent;return t instanceof HTMLElement?t:document.documentElement},e.prototype.offset=function(){if(!this.el.getClientRects().length)return{top:0,left:0};var t=this.el.getBoundingClientRect();if(t.width||t.height){var e=this.el.ownerDocument,n=e.documentElement;return{top:t.top+window.pageYOffset-n.clientTop,left:t.left+window.pageXOffset-n.clientLeft}}return t},e.prototype.width=function(){return this.el.offsetWidth},e.prototype.height=function(){return this.el.offsetHeight},e.prototype.traverseAncestorForClass=function(t,e){void 0===t&&(t=this.el),0==e.indexOf(".")&&(e=e.substr(1));for(var n=!1;!n&&(i(t).hasClass(e)&&(n=!0),"body"!=t.tagName.toLowerCase())&&null!=t.parentElement;)n||(t=t.parentElement);if(n)return t},e.CLASS_NAME_REGEX=/-?[_a-zA-Z]+[_a-zA-Z0-9-]*/g,e.ONLY_WHITE_SPACE_REGEX=/^\s*$/,e.handlers=[],e}();e.Dom=l;var c=function(){function t(t){this.win=t}return t.prototype.height=function(){return this.win.innerHeight},t.prototype.width=function(){return this.win.innerWidth},t.prototype.scrollY=function(){return this.supportPageOffset()?this.win.pageYOffset:this.isCSS1Compat()?this.win.document.documentElement.scrollTop:this.win.document.body.scrollTop},t.prototype.scrollX=function(){return this.supportPageOffset()?window.pageXOffset:this.isCSS1Compat()?document.documentElement.scrollLeft:document.body.scrollLeft},t.prototype.isCSS1Compat=function(){return"CSS1Compat"===(this.win.document.compatMode||"")},t.prototype.supportPageOffset=function(){return void 0!==this.win.pageXOffset},t}();e.Win=c;var h=function(){function t(t){this.doc=t}return t.prototype.height=function(){var t=this.doc.body;return Math.max(t.scrollHeight,t.offsetHeight)},t.prototype.width=function(){var t=this.doc.body;return Math.max(t.scrollWidth,t.offsetWidth)},t}();e.Doc=h,e.$$=i,e.htmlToDom=o}).call(e,n(10))},function(t,e,n){"use strict";var i=n(58),o=n(57),r=n(60),s=n(15),a=n(61),u=function(){function t(){}return t.getPopUpCloseButton=function(t,e){var n=document.createElement("span"),o=document.createElement("span");i.$$(o).addClass("coveo-close-button"),n.appendChild(o);var r=document.createElement("span");i.$$(r).addClass("coveo-icon"),i.$$(r).addClass("coveo-sprites-quickview-close"),o.appendChild(r),i.$$(o).text(t);var s=document.createElement("span");return i.$$(s).addClass("coveo-pop-up-reminder"),i.$$(s).text(e),n.appendChild(s),n.outerHTML},t.getBasicLoadingAnimation=function(){var t="coveo-loading-dot",e=document.createElement("div");return e.className="coveo-first-loading-animation",e.innerHTML="<div class='coveo-logo' ></div>\n    <div class='coveo-loading-container'>\n      <div class='"+t+"'></div>\n      <div class='"+t+"'></div>\n      <div class='"+t+"'></div>\n      <div class='"+t+"'></div>\n    </div>",e},t.highlightElement=function(t,e){var n=new RegExp(s.Utils.escapeRegexCharacter(a.StringUtils.latinize(e)),"i"),i=a.StringUtils.latinize(t).search(n),o=i+e.length;return a.StringUtils.htmlEncode(t.slice(0,i))+"<span class='coveo-highlight'>"+a.StringUtils.htmlEncode(t.slice(i,o))+"</span>"+a.StringUtils.htmlEncode(t.slice(o))},t.getLoadingSpinner=function(){var t=i.$$("div");return t.addClass("coveo-loading-spinner"),t.el},t.getModalBoxHeader=function(t){var e=i.$$("div");return e.el.innerHTML="<div class='coveo-modalbox-right-header'>\n        <span class='coveo-modalbox-close-button'>\n          <span class='coveo-icon coveo-sprites-common-clear'></span>\n        </span>\n      </div>\n      <div class='coveo-modalbox-left-header'>\n        <span class='coveo-modalbox-pop-up-reminder'> "+(t||"")+"</span>\n      </div>",e},t.getQuickviewHeader=function(t,e,n){var s="";e.showDate&&(s=o.DateUtils.dateTimeToString(new Date(t.raw.date)));var a=r.FileTypes.get(t),u=i.$$("div");return u.el.innerHTML="<div class='coveo-quickview-right-header'>\n        <span class='coveo-quickview-time'>"+s+"</span>\n        <span class='coveo-quickview-close-button'>\n          <span class='coveo-icon coveo-sprites-common-clear'></span>\n        </span>\n      </div>\n      <div class='coveo-quickview-left-header'>\n        <span class='coveo-quickview-icon coveo-small "+a.icon+"'></span>\n        <a class='coveo-quickview-pop-up-reminder'> "+(e.title||"")+"</a>\n      </div>",new Coveo[Coveo.Salesforce?"SalesforceResultLink":"ResultLink"](u.find(".coveo-quickview-pop-up-reminder"),void 0,n,t),u},t}();e.DomUtils=u},function(t,e,n){(function(t){"use strict";var i,o=n(15),r=n(35),s=n(14),a=function(){function e(){}return e.get=function(t){var n=t.raw.objecttype,i=t.raw.filetype;return o.Utils.isNonEmptyString(n)&&"file"!=n.toLowerCase()?e.getObjectType(n):o.Utils.isNonEmptyString(i)?e.getFileType(i):{icon:"coveo-icon filetype",caption:r.l("Unknown")}},e.getObjectType=function(t){t=t.toLowerCase();var e=r.l("objecttype_"+t);return{icon:"coveo-icon objecttype "+t,caption:e!="objecttype_"+t?e:t}},e.getFileType=function(t){t=t.toLowerCase(),"."==t[0]&&(t=t.substring(1));var e=r.l("filetype_"+t);return{icon:"coveo-icon filetype "+t,caption:e!="filetype_"+t?e:t}},e.getFileTypeCaptions=function(){if(void 0==i){i={};var e=String.locales[String.locale.toLowerCase()];s.Assert.isNotUndefined(e),t.each(t.keys(e),function(t){0==t.indexOf("filetype_")?i[t.substr("filetype_".length)]=t.toLocaleString():0==t.indexOf("objecttype_")&&(i[t.substr("objecttype_".length)]=t.toLocaleString())})}return i},e}();e.FileTypes=a}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(58),r=n(62),s=function(){function e(){}return e.javascriptEncode=function(t){return i.Assert.isString(t),t=t.replace(/\\/g,"\\\\"),t=t.replace(/'/g,"\\'"),t=t.replace(/"/g,'\\"')},e.htmlEncode=function(t){i.Assert.isString(t);var e=o.$$("div");return e.text(t),e.el.innerHTML},e.splice=function(t,e,n,i){return t.slice(0,e)+i+t.slice(e+Math.abs(n))},e.removeMiddle=function(t,n,i){if(t.length<n)return t;var o=t.length-n,r=Math.floor(n/2);return e.splice(t,r,o,i)},e.regexEncode=function(t){return i.Assert.isString(t),t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},e.stringToRegex=function(n,o){void 0===o&&(o=!1),i.Assert.isString(n);var r=e.regexEncode(n);return o?t.map(r,function(n){var i=t.find(e.accented,function(t){return null!=n.match(t)});return i?i.source:n}).join(""):r},e.wildcardsToRegex=function(t,n){void 0===n&&(n=!1),i.Assert.isString(t);var o=e.stringToRegex(t,n);return o=o.replace(/\\\*/,".*"),o=o.replace(/\\\?/,".")},e.getHighlights=function(e,n,i){for(var o,r=[];o=n.exec(e);){var s=o[2],a=o[1],u=o.index+a.length;if(r.push({offset:u,length:s.length,dataHighlightGroupTerm:i}),!n.global)break}return t.isEmpty(r)?void 0:r},e.encodeCarriageReturn=function(t){return i.Assert.isString(t),t.replace(/\n/g,"<br/>")},e.equalsCaseInsensitive=function(t,e){return t.toLowerCase()==e.toLowerCase()},e.match=function(t,e){for(var n,i=[];null!==(n=e.exec(t));)i.push(n);return i},e.hashCode=function(t){for(var e=0,n=t.length,i=0;i<n;i++){var o=t.charCodeAt(i);e=(e<<5)-e+o,e&=e}return e.toString(16)},e.latinize=function(t){return r(t)},e.accented={A:/[Aa\xaa\xc0-\xc5\xe0-\xe5\u0100-\u0105\u01cd\u01ce\u0200-\u0203\u0226\u0227\u1d2c\u1d43\u1e00\u1e01\u1e9a\u1ea0-\u1ea3\u2090\u2100\u2101\u213b\u249c\u24b6\u24d0\u3371-\u3374\u3380-\u3384\u3388\u3389\u33a9-\u33af\u33c2\u33ca\u33df\u33ff\uff21\uff41]/g,B:/[Bb\u1d2e\u1d47\u1e02-\u1e07\u212c\u249d\u24b7\u24d1\u3374\u3385-\u3387\u33c3\u33c8\u33d4\u33dd\uff22\uff42]/g,C:/[Cc\xc7\xe7\u0106-\u010d\u1d9c\u2100\u2102\u2103\u2105\u2106\u212d\u216d\u217d\u249e\u24b8\u24d2\u3376\u3388\u3389\u339d\u33a0\u33a4\u33c4-\u33c7\uff23\uff43]/g,D:/[Dd\u010e\u010f\u01c4-\u01c6\u01f1-\u01f3\u1d30\u1d48\u1e0a-\u1e13\u2145\u2146\u216e\u217e\u249f\u24b9\u24d3\u32cf\u3372\u3377-\u3379\u3397\u33ad-\u33af\u33c5\u33c8\uff24\uff44]/g,E:/[Ee\xc8-\xcb\xe8-\xeb\u0112-\u011b\u0204-\u0207\u0228\u0229\u1d31\u1d49\u1e18-\u1e1b\u1eb8-\u1ebd\u2091\u2121\u212f\u2130\u2147\u24a0\u24ba\u24d4\u3250\u32cd\u32ce\uff25\uff45]/g,F:/[Ff\u1da0\u1e1e\u1e1f\u2109\u2131\u213b\u24a1\u24bb\u24d5\u338a-\u338c\u3399\ufb00-\ufb04\uff26\uff46]/g,G:/[Gg\u011c-\u0123\u01e6\u01e7\u01f4\u01f5\u1d33\u1d4d\u1e20\u1e21\u210a\u24a2\u24bc\u24d6\u32cc\u32cd\u3387\u338d-\u338f\u3393\u33ac\u33c6\u33c9\u33d2\u33ff\uff27\uff47]/g,H:/[Hh\u0124\u0125\u021e\u021f\u02b0\u1d34\u1e22-\u1e2b\u1e96\u210b-\u210e\u24a3\u24bd\u24d7\u32cc\u3371\u3390-\u3394\u33ca\u33cb\u33d7\uff28\uff48]/g,I:/[Ii\xcc-\xcf\xec-\xef\u0128-\u0130\u0132\u0133\u01cf\u01d0\u0208-\u020b\u1d35\u1d62\u1e2c\u1e2d\u1ec8-\u1ecb\u2071\u2110\u2111\u2139\u2148\u2160-\u2163\u2165-\u2168\u216a\u216b\u2170-\u2173\u2175-\u2178\u217a\u217b\u24a4\u24be\u24d8\u337a\u33cc\u33d5\ufb01\ufb03\uff29\uff49]/g,J:/[Jj\u0132-\u0135\u01c7-\u01cc\u01f0\u02b2\u1d36\u2149\u24a5\u24bf\u24d9\u2c7c\uff2a\uff4a]/g,K:/[Kk\u0136\u0137\u01e8\u01e9\u1d37\u1d4f\u1e30-\u1e35\u212a\u24a6\u24c0\u24da\u3384\u3385\u3389\u338f\u3391\u3398\u339e\u33a2\u33a6\u33aa\u33b8\u33be\u33c0\u33c6\u33cd-\u33cf\uff2b\uff4b]/g,L:/[Ll\u0139-\u0140\u01c7-\u01c9\u02e1\u1d38\u1e36\u1e37\u1e3a-\u1e3d\u2112\u2113\u2121\u216c\u217c\u24a7\u24c1\u24db\u32cf\u3388\u3389\u33d0-\u33d3\u33d5\u33d6\u33ff\ufb02\ufb04\uff2c\uff4c]/g,M:/[Mm\u1d39\u1d50\u1e3e-\u1e43\u2120\u2122\u2133\u216f\u217f\u24a8\u24c2\u24dc\u3377-\u3379\u3383\u3386\u338e\u3392\u3396\u3399-\u33a8\u33ab\u33b3\u33b7\u33b9\u33bd\u33bf\u33c1\u33c2\u33ce\u33d0\u33d4-\u33d6\u33d8\u33d9\u33de\u33df\uff2d\uff4d]/g,N:/[Nn\xd1\xf1\u0143-\u0149\u01ca-\u01cc\u01f8\u01f9\u1d3a\u1e44-\u1e4b\u207f\u2115\u2116\u24a9\u24c3\u24dd\u3381\u338b\u339a\u33b1\u33b5\u33bb\u33cc\u33d1\uff2e\uff4e]/g,O:/[Oo\xba\xd2-\xd6\xf2-\xf6\u014c-\u0151\u01a0\u01a1\u01d1\u01d2\u01ea\u01eb\u020c-\u020f\u022e\u022f\u1d3c\u1d52\u1ecc-\u1ecf\u2092\u2105\u2116\u2134\u24aa\u24c4\u24de\u3375\u33c7\u33d2\u33d6\uff2f\uff4f]/g,P:/[Pp\u1d3e\u1d56\u1e54-\u1e57\u2119\u24ab\u24c5\u24df\u3250\u3371\u3376\u3380\u338a\u33a9-\u33ac\u33b0\u33b4\u33ba\u33cb\u33d7-\u33da\uff30\uff50]/g,Q:/[Qq\u211a\u24ac\u24c6\u24e0\u33c3\uff31\uff51]/g,R:/[Rr\u0154-\u0159\u0210-\u0213\u02b3\u1d3f\u1d63\u1e58-\u1e5b\u1e5e\u1e5f\u20a8\u211b-\u211d\u24ad\u24c7\u24e1\u32cd\u3374\u33ad-\u33af\u33da\u33db\uff32\uff52]/g,S:/[Ss\u015a-\u0161\u017f\u0218\u0219\u02e2\u1e60-\u1e63\u20a8\u2101\u2120\u24ae\u24c8\u24e2\u33a7\u33a8\u33ae-\u33b3\u33db\u33dc\ufb06\uff33\uff53]/g,T:/[Tt\u0162-\u0165\u021a\u021b\u1d40\u1d57\u1e6a-\u1e71\u1e97\u2121\u2122\u24af\u24c9\u24e3\u3250\u32cf\u3394\u33cf\ufb05\ufb06\uff34\uff54]/g,U:/[Uu\xd9-\xdc\xf9-\xfc\u0168-\u0173\u01af\u01b0\u01d3\u01d4\u0214-\u0217\u1d41\u1d58\u1d64\u1e72-\u1e77\u1ee4-\u1ee7\u2106\u24b0\u24ca\u24e4\u3373\u337a\uff35\uff55]/g,V:/[Vv\u1d5b\u1d65\u1e7c-\u1e7f\u2163-\u2167\u2173-\u2177\u24b1\u24cb\u24e5\u2c7d\u32ce\u3375\u33b4-\u33b9\u33dc\u33de\uff36\uff56]/g,W:/[Ww\u0174\u0175\u02b7\u1d42\u1e80-\u1e89\u1e98\u24b2\u24cc\u24e6\u33ba-\u33bf\u33dd\uff37\uff57]/g,X:/[Xx\u02e3\u1e8a-\u1e8d\u2093\u213b\u2168-\u216b\u2178-\u217b\u24b3\u24cd\u24e7\u33d3\uff38\uff58]/g,Y:/[Yy\xdd\xfd\xff\u0176-\u0178\u0232\u0233\u02b8\u1e8e\u1e8f\u1e99\u1ef2-\u1ef9\u24b4\u24ce\u24e8\u33c9\uff39\uff59]/g,Z:/[Zz\u0179-\u017e\u01f1-\u01f3\u1dbb\u1e90-\u1e95\u2124\u2128\u24b5\u24cf\u24e9\u3390-\u3394\uff3a\uff5a]/g},e}();e.StringUtils=s}).call(e,n(10))},function(t,e,n){var i,o;!function(r,s){i=s,o="function"==typeof i?i.call(e,n,e,t):i,!(void 0!==o&&(t.exports=o))}(this,function(){function t(e){return"string"==typeof e?e.replace(/[^A-Za-z0-9]/g,function(e){return t.characters[e]||e}):e}return t.characters={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"A","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Ö":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","ß":"ss","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"U","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"a","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"o","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x","Ё":"YO","Й":"I","Ц":"TS","У":"U","К":"K","Е":"E","Н":"N","Г":"G","Ш":"SH","Щ":"SCH","З":"Z","Х":"H","Ъ":"'","ё":"yo","й":"i","ц":"ts","у":"u","к":"k","е":"e","н":"n","г":"g","ш":"sh","щ":"sch","з":"z","х":"h","ъ":"'","Ф":"F","Ы":"I","В":"V","А":"a","П":"P","Р":"R","О":"O","Л":"L","Д":"D","Ж":"ZH","Э":"E","ф":"f","ы":"i","в":"v","а":"a","п":"p","р":"r","о":"o","л":"l","д":"d","ж":"zh","э":"e","Я":"Ya","Ч":"CH","С":"S","М":"M","И":"I","Т":"T","Ь":"'","Б":"B","Ю":"YU","я":"ya","ч":"ch","с":"s","м":"m","и":"i","т":"t","ь":"'","б":"b","ю":"yu"},t})},function(t,e,n){(function(t){"use strict";var i=n(35),o=function(){function e(){}return e.buildMailToString=function(t){var n=t.to?"mailto:"+encodeURIComponent(t.to):"mailto:",i=e.buildMailToParametersString(t.subject,t.cc,t.bcc,t.body,n);return i&&(n+="?"+i),n},e.buildMailToParametersString=function(t,n,i,o,r){var s=[];if(t&&s.push(e.buildMailToParameter("subject",t)),n&&s.push(e.buildMailToParameter("cc",n)),i&&s.push(e.buildMailToParameter("bcc",i)),o){var a=e.getShortenBody(o,r+"?"+s.join("&"));a&&s.push(e.buildMailToParameter("body",a))}return s.join("&")},e.getShortenBody=function(t,n){var i=t;if(n.length<s.maxLength){var o=s.maxLength-n.length-"&body=".length;i=e.shortenString(t,o)}return i},e.buildMailToParameter=function(t,e){return e?encodeURIComponent(t)+"="+encodeURIComponent(e):""},e.shortenString=function(t,e,n){void 0===n&&(n=!1);var i=n?encodeURIComponent(s.shortenBodyIndicator):s.shortenBodyIndicator;e-=s.shortenBodyIndicator.length;var o=t.length>e,r=t.substring(0,e);return r+=o?i:""},e.appendShortenBodyToMailToString=function(t,n){var i=e.getShortenBody(n,t);return t.indexOf("?")>=0?t+"&body="+i:t+"?body="+i},e.removeCurrentUserEmailFromString=function(e,n){return n&&e?t.filter(n.split(";"),function(t){return t.indexOf(e)==-1}).join(";"):n},e.buildReplyMailToFromResult=function(t,e){return new s({currentUserEmail:e,originalFrom:t.raw.from,to:t.raw.from,subject:t.raw.conversationsubject})},e.buildReplyAllMailToFromResult=function(t,e){return new s({currentUserEmail:e,originalFrom:t.raw.from,to:t.raw.from+";"+t.raw.to,subject:t.raw.conversationsubject,cc:t.raw.cc})},e.buildForwardMailToFromResult=function(t,e){return new s({currentUserEmail:e,originalFrom:t.raw.from,subject:t.raw.conversationsubject})},e.encodeMailToBody=function(e){var n=e.split("\n");return t.each(n,function(t,e){n[e]=encodeURIComponent(n[e])}),n.join(s.enter)},e}();e.EmailActionsUtils=o;var r=function(){function t(){this.currentUserEmail="",this.originalFrom="",this.to="",this.subject="",this.cc="",this.bcc="",this.body=""}return t}();e.DefaultMailToOptions=r;var s=function(){function e(e){this.options=e,this.bodyHeader="",this.options=t.extend(new r,e),this.removeCurrentUserFromParameters(),this.options.originalFrom&&(this.bodyHeader=this.options.bodyIsHTML?"<p><br/><br/><br/>"+i.l("From")+": "+this.options.originalFrom+"<hr></p>":"\n\n\n"+i.l("From")+": "+this.options.originalFrom+"\n_________________________________\n")}return e.prototype.removeCurrentUserFromParameters=function(){this.options.to=o.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.to),this.options.cc=o.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.cc),this.options.bcc=o.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.bcc)},e.prototype.open=function(){this.ensureValueIsSet(),window.location.href=this.value},e.prototype.ensureValueIsSet=function(){this.value?this.valueBodyIsSet()||this.setValueBody():this.setValue()},e.prototype.setValue=function(){this.value=o.buildMailToString(this.options),this.value&&!this.valueBodyIsSet()&&this.setValueBody()},e.prototype.setValueBody=function(){this.value=o.appendShortenBodyToMailToString(this.value,this.body)},e.prototype.setMailToBodyFromText=function(t){void 0===t&&(t=""),this.body=t},e.prototype.valueBodyIsSet=function(){return this.value.indexOf("body=")>=0},e.prototype.bodyIsSet=function(){return!!this.body},e.enter="%0D%0A",e.shortenBodyIndicator="\r\n\r\n...",e.maxLength=1e3,e}();e.MailTo=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(15),o=n(35),r=function(){function e(){}return e.splitSemicolonSeparatedListOfEmailAddresses=function(e){var n=e.split(/\s*;\s*/);return t.filter(n,function(t){return i.Utils.exists(t)&&i.Utils.isNonEmptyString(i.Utils.trim(t))})},e.emailAddressesToHyperlinks=function(n,r,s,a,u){void 0===a&&(a=2),void 0===u&&(u=!1),n=t.filter(n,function(t){return i.Utils.exists(t)&&i.Utils.isNonEmptyString(i.Utils.trim(t))});var l=t.map(n,function(t){var n=e.parseEmail(t),a=n[1],l=n[0];if(i.Utils.exists(s)&&a==s&&(l=o.l("Me")),u){var c=l.split(" ");i.Utils.isNullOrUndefined(c[1])||(l=c[0]+" "+c[1].substring(0,1)+".")}var h=a.indexOf("@")>=0?a.indexOf("@")+1:0,p=a.substr(h);return i.Utils.exists(r)&&p!=r&&(l+=" ("+p+")"),'<a title="'+t.replace(/'/g,"&quot;")+'href="mailto:'+encodeURI(a)+'">'+l+"</a>"}),c=l.length-a,h=c>0?e.buildEmailAddressesAndOthers(t.last(l,c)):"";return t.first(l,a).join(", ")+h},e.buildEmailAddressesAndOthers=function(t){return'<span class="coveo-emails-excess-collapsed coveo-active" onclick="Coveo.TemplateHelpers.getHelper(\'excessEmailToggle\')(this);"> '+o.l("AndOthers",t.length.toString(),t.length)+'</span><span class="coveo-emails-excess-expanded"> , '+t.join(" , ")+"</span>"},e.parseEmail=function(t){var e,n=t.match(/^\s*(.*)\s+<(.*)>$/);return null!=n?(e=n[1],/^'.*'|'.*'$/.test(e)&&(e=e.substr(1,e.length-2)),t=n[2]):(e=t,t=t),[e,t]},e}();e.EmailUtils=r}).call(e,n(10))},function(t,e){"use strict";var n=function(){function t(){}return t.supportSVG=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},t}();e.FeatureDetectionUtils=n},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(15),r=function(){function e(){}return e.getHash=function(t){void 0===t&&(t=window),i.Assert.exists(t);var n="#"+(t.location.href.split("#")[1]||"");return e.getAjaxcrawlableHash(n)},e.getValue=function(t,n){i.Assert.isNonEmptyString(t),i.Assert.exists(n),n=e.getAjaxcrawlableHash(n);var o=e.getRawValue(t,n);return void 0!=o&&(o=e.getValueDependingOnType(t,o)),o},e.encodeValues=function(n){var i=[];return t.each(n,function(n,r,s){var a="";a=o.Utils.isNonEmptyArray(n)?e.encodeArray(n):t.isObject(n)&&o.Utils.isNonEmptyArray(t.keys(n))?e.encodeObject(n):encodeURIComponent(n.toString()),""!=a&&i.push(r+"="+a)}),i.join("&")},e.getAjaxcrawlableHash=function(t){return void 0!=t[1]&&"!"==t[1]?t.substring(0,1)+t.substring(2):t},e.getRawValue=function(t,e){i.Assert.exists(t),i.Assert.exists(e),i.Assert.check(0==e.indexOf("#")||""==e);for(var n=e.substr(1).split("&"),o=0,r=!0,s=void 0;r;){var a=n[o].split("=");a[0]==t?(r=!1,s=a[1]):(o++,o>=n.length&&(o=void 0,r=!1))}return s},e.getValueDependingOnType=function(t,n){var i,o=e.getValueType(t,n);return i="object"==o?e.decodeObject(n):"array"==o?e.decodeArray(n):decodeURIComponent(n)},e.getValueType=function(t,n){return"q"==t?"other":e.isObject(n)?"object":e.isArray(n)?"array":"other"},e.isArrayStartNotEncoded=function(t){return t.substr(0,1)==e.DELIMITER.arrayStart},e.isArrayStartEncoded=function(t){return 0==t.indexOf(encodeURIComponent(e.DELIMITER.arrayStart))},e.isArrayEndNotEncoded=function(t){return t.substr(t.length-1)},e.isArrayEndEncoded=function(t){return t.indexOf(encodeURIComponent(e.DELIMITER.arrayEnd))==t.length-encodeURIComponent(e.DELIMITER.arrayEnd).length},e.isObjectStartNotEncoded=function(t){return t.substr(0,1)==e.DELIMITER.objectStart},e.isObjectStartEncoded=function(t){return 0==t.indexOf(encodeURIComponent(e.DELIMITER.objectStart))},e.isObjectEndNotEncoded=function(t){return t.substr(t.length-1)==e.DELIMITER.objectEnd},e.isObjectEndEncoded=function(t){return t.indexOf(encodeURIComponent(e.DELIMITER.objectEnd))==t.length-encodeURIComponent(e.DELIMITER.objectEnd).length},e.isObject=function(t){var n=e.isObjectStartNotEncoded(t)||e.isObjectStartEncoded(t),i=e.isObjectEndNotEncoded(t)||e.isObjectEndEncoded(t);return n&&i},e.isArray=function(t){var n=e.isArrayStartNotEncoded(t)||e.isArrayStartEncoded(t),i=e.isArrayEndNotEncoded(t)||e.isArrayEndEncoded(t);return n&&i},e.encodeArray=function(n){var i=t.map(n,function(t){return encodeURIComponent(t)});return e.DELIMITER.arrayStart+i.join(",")+e.DELIMITER.arrayEnd},e.encodeObject=function(n){var i=this,o=t.map(n,function(t,e,n){return'"'+encodeURIComponent(e)+'":'+i.encodeValue(t)});return e.DELIMITER.objectStart+o.join(" , ")+e.DELIMITER.objectEnd},e.encodeValue=function(n){var i="";return i=t.isArray(n)?e.encodeArray(n):t.isObject(n)?e.encodeObject(n):t.isNumber(n)||t.isBoolean(n)?encodeURIComponent(n):'"'+encodeURIComponent(n)+'"'},e.decodeObject=function(t){return e.isObjectStartEncoded(t)&&e.isObjectEndEncoded(t)&&(t=t.replace(/encodeURIComponent(HashUtils.Delimiter.objectStart)/,e.DELIMITER.objectStart),t=t.replace(encodeURIComponent(e.DELIMITER.objectEnd),e.DELIMITER.objectEnd)),JSON.parse(decodeURIComponent(t))},e.decodeArray=function(n){e.isArrayStartEncoded(n)&&e.isArrayEndEncoded(n)&&(n=n.replace(encodeURIComponent(e.DELIMITER.arrayStart),e.DELIMITER.arrayStart),n=n.replace(encodeURIComponent(e.DELIMITER.arrayEnd),e.DELIMITER.arrayEnd)),n=n.substr(1),n=n.substr(0,n.length-1);var i=n.split(",");return t.map(i,function(t){return decodeURIComponent(t)})},e.DELIMITER={objectStart:"{",objectEnd:"}",arrayStart:"[",arrayEnd:"]",objectStartRegExp:"^{",objectEndRegExp:"}+$",arrayStartRegExp:"^[",arrayEndRegExp:"]+$"},e}();e.HashUtils=r}).call(e,n(10))},function(t,e,n){(function(t){"use strict";function i(e,n){var i=t.template('<% var i = 0; var lowercaseValue = value.toLowerCase(); while(i < value.length) { %><% var index = lowercaseValue.indexOf(search, i); if(index != -1) { %><% if(i != index){ %> <span><%- value.substr(i, index) %></span><% } %><span class="coveo-hightlight"><%- value.substr(index, search.length) %></span><% i = index + search.length %></span><% } else { %><span><%- value.substr(i) %></span><% i = value.length; %><% } %><% } %>');
return t.isEmpty(n)?e:i({value:e,search:n.toLowerCase()})}var o=n(15),r=n(14),s=function(){function t(){}return t.replace=function(e,n,i){var r=new t;if(o.Utils.isNullOrEmptyString(e))return r;var s=e.lastIndexOf(n);if(s==-1)return r.value=e,r;for(var a=[];s>=0;){var u={begin:s,size:n.length,replacementSize:i.length};a.push(u),e=e.slice(0,s)+i+e.slice(s+n.length),s=e.lastIndexOf(n)}return r.holes=a,r.value=e,r},t.shortenPath=function(e,n){var i=e,r=new t;if(o.Utils.isNullOrEmptyString(i)||i.length<=n)return r.value=i,r;var s=[],a=-1;if(a=o.Utils.stringStartsWith(i,"\\\\")?i.indexOf("\\",a+2):i.indexOf("\\"),a!==-1){for(var u=0,l=i.indexOf("\\",a+1);l!==-1&&i.length-u+t.SHORTEN_END.length>n;)u=l-a-1,l=i.indexOf("\\",l+1);if(u>0){i=i.slice(0,a+1)+t.SHORTEN_END+i.slice(u);var c={begin:a+1,size:u-t.SHORTEN_END.length,replacementSize:t.SHORTEN_END.length};s.push(c)}}if(i.length>n){var h=i.length-n+t.SHORTEN_END.length,p=i.length-h;i=i.slice(0,p)+t.SHORTEN_END;var c={begin:p,size:h,replacementSize:t.SHORTEN_END.length};s.push(c)}return r.holes=s,r.value=i,r},t.shortenString=function(e,n,i){void 0===n&&(n=200);var r=e;i=o.Utils.toNotNullString(i);var s=new t;if(o.Utils.isNullOrEmptyString(r)||n<=i.length)return s.value=r,s;if(r.length<=n)return s.value=r,s;var a=r;if(n-=i.length,a=a.slice(0,n)," "!==r.charAt(a.length)){var u=a.lastIndexOf(" ");u!==-1&&a.length-u<t.WORD_SHORTER&&(a=a.slice(0,u))}var l=[];return l[0]={begin:a.length,size:r.length-a.length,replacementSize:i.length},a+=i,s.value=a,s.holes=l,s},t.shortenUri=function(e,n){var i=new t;if(o.Utils.isNullOrEmptyString(e)||e.length<=n)return i.value=e,i;var r=[],s=e.indexOf("//");if(s!==-1&&(s=e.indexOf("/",s+2)),s!==-1){for(var a=0,u=e.indexOf("/",s+1);u!==-1&&e.length-a+t.SHORTEN_END.length>n;)a=u-s-1,u=e.indexOf("/",u+1);if(a>0){e=e.slice(0,s+1)+t.SHORTEN_END+e.slice(s+1+a);var l={begin:s+1,size:a,replacementSize:t.SHORTEN_END.length};r.push(l)}}if(e.length>n){var c=e.length-n+t.SHORTEN_END.length,h=e.length-c;e=e.slice(0,h)+t.SHORTEN_END;var l={begin:h,size:c,replacementSize:t.SHORTEN_END.length};r.push(l)}return i.holes=r,i.value=e,i},t.SHORTEN_END="...",t.WORD_SHORTER=10,t}();e.StringAndHoles=s;var a=function(){function e(){}return e.highlightString=function(e,n,i,s){if(r.Assert.isNotUndefined(n),r.Assert.isNotNull(n),r.Assert.isNonEmptyString(s),o.Utils.isNullOrEmptyString(e))return e;for(var a=0,u=e.length,l="",c=0;c<n.length;c++){var h=n[c],p=h.offset,d=p+h.length;if(null!==i){for(var f=!1,g=0;g<i.length;g++){var m=i[g],v=m.begin,y=v+m.size;if(p<v&&d>=v&&d<y)d=v;else{if(p>=v&&d<y){f=!0;break}if(p>=v&&p<y&&d>=y)p=v+m.replacementSize,d-=m.size-m.replacementSize;else if(p<v&&d>=y)d-=m.size-m.replacementSize;else if(p>=y){var b=m.size-m.replacementSize;p-=b,d-=b}}}if(f||p===d)continue}if(d>u)break;l+=t.escape(e.slice(a,p)),l+='<span class="'+s+'"',h.dataHighlightGroup&&(l+=' data-highlight-group="'+h.dataHighlightGroup.toString()+'"'),h.dataHighlightGroupTerm&&(l+=' data-highlight-group-term="'+h.dataHighlightGroupTerm+'"'),l+=">",l+=t.escape(e.slice(p,d)),l+="</span>",a=d}return a!=u&&(l+=t.escape(e.slice(a))),l},e}();e.HighlightUtils=a,e.highlightString=i}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(17),o=function(){function e(){}return e.buildAttributeString=function(e){var n=[];return t.each(e,function(t,e,i){void 0!=t&&n.push(e+"="+JSON.stringify(t.toString()))}),n.join(" ")},e}();e.HTMLUtils=o;var r=function(){function t(){}return t.buildAnchor=function(t,e){var n;return e&&e.text?(n=e.text,e.text=void 0):n=t,"<a href='"+t+" "+o.buildAttributeString(e)+" '>"+n+"</a>"},t}();e.AnchorUtils=r;var s=function(){function e(){}return e.buildImage=function(t,e){var n="<img ";return n+=t?"src='"+t+"' ":"",n+=o.buildAttributeString(e)+"/>"},e.selectImageFromResult=function(t){return document.querySelector("img[data-coveo-uri-hash="+t.raw.urihash+"]")},e.buildImageWithDirectSrcAttribute=function(t,n){var i=new Image,o=t.getViewAsDatastreamUri(n.uniqueId,"$Thumbnail$",{contentType:"image/png"});i.onload=function(){e.selectImageFromResult(n).setAttribute("src",o)},i.src=o},e.buildImageWithBase64SrcAttribute=function(t,n){t.getRawDataStream(n.uniqueId,"$Thumbnail$").then(function(t){var i=String.fromCharCode.apply(null,new Uint8Array(t));e.selectImageFromResult(n).setAttribute("src","data:image/png;base64, "+btoa(i))}).catch(function(){e.selectImageFromResult(n).remove()})},e.buildImageFromResult=function(n,o,r){r=r?r:{};var s=e.buildImage(void 0,t.extend(r,{"data-coveo-uri-hash":n.raw.urihash}));return o.isJsonp()||i.DeviceUtils.isIE8or9()?e.buildImageWithDirectSrcAttribute(o,n):e.buildImageWithBase64SrcAttribute(o,n),s},e}();e.ImageUtils=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(15);!function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.ESCAPE=27]="ESCAPE",t[t.SPACEBAR=32]="SPACEBAR",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.HOME=36]="HOME",t[t.LEFT_ARROW=37]="LEFT_ARROW",t[t.UP_ARROW=38]="UP_ARROW",t[t.RIGHT_ARROW=39]="RIGHT_ARROW",t[t.DOWN_ARROW=40]="DOWN_ARROW",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE"}(e.KEYBOARD||(e.KEYBOARD={}));var o=e.KEYBOARD,r=function(){function e(){}return e.keysEqual=function(t,e){return i.Utils.isNullOrUndefined(t.keyCode)?!i.Utils.isNullOrUndefined(t.which)&&t.which==e:t.keyCode==e},e.isAllowedKeyForOmnibox=function(t){var n=t.keyCode,i=e.isNumberKeyPushed(n)||32==n||13==n||e.isLetterKeyPushed(n)||n>95&&n<112||n>185&&n<193||n>218&&n<223||n==o.BACKSPACE||n==o.DELETE||e.isArrowKeyPushed(n);return i},e.isAllowedKeyForSearchAsYouType=function(t){return e.isAllowedKeyForOmnibox(t)&&!e.isArrowKeyPushed(t.keyCode)},e.isDeleteOrBackspace=function(t){return e.keysEqual(t,o.BACKSPACE)||e.keysEqual(t,o.DELETE)},e.isArrowKeyPushed=function(t){return t==o.LEFT_ARROW||t==o.UP_ARROW||t==o.RIGHT_ARROW||t==o.DOWN_ARROW},e.isNumberKeyPushed=function(t){return t>47&&t<58},e.isLetterKeyPushed=function(t){return t>64&&t<91},e.keypressAction=function(e,n){return function(i){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];if(i){var s=i.charCode||i.keyCode;s&&(t.isArray(e)&&t.contains(e,s)?n(i):s===e&&n(i))}return!1}},e}();e.KeyboardUtils=r}).call(e,n(10))},function(t,e){"use strict";var n,i;try{localStorage=window.localStorage||null}catch(a){}i=function(){function t(t){this.id=t}return t.prototype.save=function(t){try{null!=n&&n.setItem(this.getLocalStorageKey(),JSON.stringify(t))}catch(t){}},t.prototype.load=function(){try{if(null==n)return null;var t=n.getItem(this.getLocalStorageKey());return t&&JSON.parse(t)}catch(t){return null}},t.prototype.remove=function(t){try{if(null!=n)if(void 0==t)n.removeItem(this.getLocalStorageKey());else{var e=this.load();delete e[t],this.save(e)}}catch(t){}},t.prototype.getLocalStorageKey=function(){return"coveo-"+this.id},t}();e.LocalStorageUtils=i},function(t,e){"use strict";!function(t){t[t.WINDOWS=0]="WINDOWS",t[t.MACOSX=1]="MACOSX",t[t.UNIX=2]="UNIX",t[t.LINUX=3]="LINUX",t[t.UNKNOWN=4]="UNKNOWN"}(e.OS_NAME||(e.OS_NAME={}));var n=e.OS_NAME,i=function(){function t(){}return t.get=function(t){void 0===t&&(t=navigator);var e;return e=t.appVersion.indexOf("Win")!=-1?n.WINDOWS:t.appVersion.indexOf("Mac")!=-1?n.MACOSX:t.appVersion.indexOf("X11")!=-1?n.UNIX:t.appVersion.indexOf("Linux")!=-1?n.LINUX:n.UNKNOWN},t}();e.OSUtils=i},function(t,e,n){"use strict";var i=n(58);!function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM",t[t.INNERTOP=3]="INNERTOP",t[t.INNERBOTTOM=4]="INNERBOTTOM"}(e.VerticalAlignment||(e.VerticalAlignment={}));var o=e.VerticalAlignment;!function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t[t.INNERLEFT=3]="INNERLEFT",t[t.INNERRIGHT=4]="INNERRIGHT"}(e.HorizontalAlignment||(e.HorizontalAlignment={}));var r=e.HorizontalAlignment,s=function(){function t(){}return t.positionPopup=function(e,n,o,r,s,a){void 0===a&&(a=0),e.style.position="absolute",s&&i.$$(s).append(e),r.verticalOffset=r.verticalOffset?r.verticalOffset:0,r.horizontalOffset=r.horizontalOffset?r.horizontalOffset:0;var u=i.$$(n).offset();t.basicVerticalAlignment(u,e,n,r),t.basicHorizontalAlignment(u,e,n,r),t.finalAdjustement(i.$$(e).offset(),u,e,r);var l=t.getBoundary(e),c=t.getBoundary(o);if(a<2){var h=t.checkForOutOfBoundary(l,c);if("ok"!=h.horizontal&&r.horizontalClip===!0){var p=e.offsetWidth;l.left<c.left&&(p-=c.left-l.left),l.right>c.right&&(p-=l.right-c.right),e.style.width=p+"px",h.horizontal="ok"}if("ok"!=h.vertical||"ok"!=h.horizontal){var d=t.alignInsideBoundary(r,h);t.positionPopup(e,n,o,d,s,a+1)}}},t.finalAdjustement=function(t,e,n,o){var r=i.$$(n).position();n.style.top=r.top+o.verticalOffset-(t.top-e.top)+"px",n.style.left=r.left+o.horizontalOffset-(t.left-e.left)+"px"},t.basicVerticalAlignment=function(t,e,n,i){switch(i.vertical){case o.TOP:t.top-=e.offsetHeight;break;case o.BOTTOM:t.top+=n.offsetHeight;break;case o.MIDDLE:t.top-=e.offsetHeight/3;case o.INNERTOP:break;case o.INNERBOTTOM:t.top-=e.offsetHeight-n.offsetHeight}},t.basicHorizontalAlignment=function(e,n,i,o){switch(o.horizontal){case r.LEFT:e.left-=n.offsetWidth;break;case r.RIGHT:e.left+=i.offsetWidth;break;case r.CENTER:e.left+=t.offSetToAlignCenter(n,i);break;case r.INNERLEFT:break;case r.INNERRIGHT:e.left-=n.offsetWidth-i.offsetWidth}},t.alignInsideBoundary=function(t,e){var n=t;return"left"==e.horizontal&&(n.horizontal=r.RIGHT),"right"==e.horizontal&&(n.horizontal=r.LEFT),"top"==e.vertical&&(n.vertical=o.BOTTOM),"bottom"==e.vertical&&(n.vertical=o.TOP),n},t.offSetToAlignCenter=function(t,e){return(e.offsetWidth-t.offsetWidth)/2},t.getBoundary=function(t){var e,n=i.$$(t).offset();return e="body"==t.tagName.toLowerCase()?Math.max(t.scrollHeight,t.offsetHeight):"html"==t.tagName.toLowerCase()?Math.max(t.clientHeight,t.scrollHeight,t.offsetHeight):t.offsetHeight,{top:n.top,left:n.left,right:n.left+t.offsetWidth,bottom:n.top+e}},t.checkForOutOfBoundary=function(t,e){var n={vertical:"ok",horizontal:"ok"};return t.top<e.top&&(n.vertical="top"),t.bottom>e.bottom&&(n.vertical="bottom"),t.left<e.left&&(n.horizontal="left"),t.right>e.right&&(n.horizontal="right"),n},t}();e.PopupUtils=s},function(t,e,n){(function(t){"use strict";function i(e,n,i,r){var s=[],a=t.keys(n).sort(o);return t.each(a,function(i){var a=t.compact([i].concat(n[i]).sort(o)),u=d;u+=a.join("|")+")(?=(?:"+p+"|$)+)";var h=l.StringUtils.getHighlights(e,new RegExp(u,r.regexFlags),i);void 0!=h&&c.Utils.isNonEmptyArray(h)&&s.push(h)}),t.each(i,function(n,i){var o=i.split(" "),a=d;t.each(o,function(t,e){a+="(?:"+[t].concat(n[t]).join("|")+")",e==o.length-1&&(a+="(?="),a+=p,e==o.length-1&&(a+=")"),e!=o.length-1&&(a+="+")}),a+=")";var u=l.StringUtils.getHighlights(e,new RegExp(a,r.regexFlags),i);void 0!=u&&c.Utils.isNonEmptyArray(u)&&s.push(u)}),t.chain(s).flatten().compact().uniq(function(t){return t.offset}).sortBy(function(t){return t.offset}).map(function(e){var o=t.keys(n),r=t.keys(i),s=o.concat(r),a=t.indexOf(s,e.dataHighlightGroupTerm)+1;return t.extend(e,{dataHighlightGroup:a})}).value()}function o(t,e){return t.length-e.length}function r(t){var e=h.$$("div").el;return e.innerHTML=t,e}var s=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(34),u=n(67),l=n(61),c=n(15),h=n(58),p="[\\.\\-\\u2011\\s~=,.\\|\\/:'`’;_()!?]",d="("+p+"|^)(",f=function(t){function e(e,n,i){void 0===e&&(e="coveo-highlight"),void 0===n&&(n=0),void 0===i&&(i="gi"),t.call(this),this.cssClass=e,this.shorten=n,this.regexFlags=i}return s(e,t),e}(a.Options),g=function(){function e(){}return e.highlightStreamHTML=function(e,n,o,s){var a=(new f).merge(s),l=r(e);return t.each(h.$$(l).findAll("*"),function(t,e){var r=h.$$(t).text();t.innerHTML=u.HighlightUtils.highlightString(r,i(r,n,o,a),[],a.cssClass)}),l.innerHTML},e.highlightStreamText=function(t,e,n,o){var r=(new f).merge(o);return u.HighlightUtils.highlightString(t,i(t,e,n,r),[],r.cssClass)},e}();e.StreamHighlightUtils=g}).call(e,n(10))},function(t,e,n){"use strict";var i=n(75);e.QueryController=i.QueryController;var o=n(91);e.FacetQueryController=o.FacetQueryController;var r=n(94);e.FacetRangeQueryController=r.FacetRangeQueryController;var s=n(95);e.FacetSliderQueryController=s.FacetSliderQueryController;var a=n(96);e.HierarchicalFacetQueryController=a.HierarchicalFacetQueryController;var u=n(97);e.HistoryController=u.HistoryController;var l=n(99);e.LocalStorageHistoryController=l.LocalStorageHistoryController},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(76),r=n(78),s=n(70),a=n(14),u=n(80),l=n(48),c=n(21),h=n(32),p=n(58),d=n(15),f=n(4),g=n(77),m=n(23),v=n(81),y=function(){function t(){this.searchAsYouType=!1,this.closeModalBox=!0,this.cancel=!1,this.logInActionsHistory=!1}return t}(),b=function(e){function n(t,i,o,r){e.call(this,t,n.ID),this.options=i,this.usageAnalytics=o,this.searchInterface=r,this.showingExecutingQueryAnimation=!1,this.localStorage=new s.LocalStorageUtils("lastQueryHash"),a.Assert.exists(t),a.Assert.exists(i),this.firstQuery=!0,this.historyStore=new v.history.HistoryStore}return i(n,e),n.prototype.setEndpoint=function(t){this.overrideEndpoint=t,this.logger.debug("Endpoint set",t)},n.prototype.getEndpoint=function(){var t=this.overrideEndpoint||this.options.endpoint;return new u.SearchEndpointWithDefaultCallOptions(t,this.getCallOptions())},n.prototype.getLastQuery=function(){return this.lastQuery||(new r.QueryBuilder).build()},n.prototype.executeQuery=function(e){var n=this;e=t.extend(new y,e),e.closeModalBox&&m.ModalBox.close(!0),this.logger.debug("Executing new query"),this.cancelAnyCurrentPendingQuery(),null!=e.beforeExecuteQuery&&e.beforeExecuteQuery(),e.ignoreWarningSearchEvent||this.usageAnalytics.warnAboutSearchEvent(),this.showExecutingQueryAnimation();var i={searchAsYouType:e.searchAsYouType,cancel:e.cancel,origin:e.origin};if(this.newQueryEvent(i),i.cancel)return void this.cancelQuery();var o=this.createQueryBuilder(e);if(o){var r=o.build();e.logInActionsHistory&&this.logQueryInActionsHistory(r,e.isFirstQuery);var s=this.getEndpoint(),u=this.currentPendingQuery=s.search(r);u.then(function(t){a.Assert.exists(t);var i=n.firstQuery;if(n.firstQuery&&(n.firstQuery=!1),u===n.currentPendingQuery){n.logger.debug("Query results received",r,t);var s=n.searchInterface&&n.searchInterface.options&&n.searchInterface.options.enableHistory;i&&!s||!n.keepLastSearchUid(r,t)?(n.lastQueryHash=n.queryHash(r,t),n.lastSearchUid=t.searchUid):(t.searchUid=n.getLastSearchUid(),t._reusedSearchUid=!0,c.QueryUtils.setPropertyOnResults(t,"queryUid",n.getLastSearchUid())),n.lastQuery=r,n.lastQueryResults=t,n.currentError=null;var l={queryBuilder:o,query:r,results:t,searchAsYouType:e.searchAsYouType};n.preprocessResultsEvent(l);var p={queryBuilder:o,query:r,results:t,searchAsYouType:e.searchAsYouType,retryTheQuery:!1};if(0==t.results.length&&n.noResultEvent(p),p.retryTheQuery)return n.executeQuery();n.lastQueryBuilder=o,n.currentPendingQuery=void 0;var d={queryBuilder:o,query:r,results:t,searchAsYouType:e.searchAsYouType};return n.querySuccessEvent(d),h.Defer.defer(function(){n.deferredQuerySuccessEvent(d),n.hideExecutingQueryAnimation()}),t}}).catch(function(t){if(u===n.currentPendingQuery){n.logger.error("Query triggered an error",r,t),n.currentPendingQuery=void 0;var i={queryBuilder:o,endpoint:s,query:r,error:t,searchAsYouType:e.searchAsYouType};n.lastQuery=r,n.lastQueryResults=null,n.currentError=t,n.queryError(i),n.hideExecutingQueryAnimation()}});var l={queryBuilder:o,query:r,searchAsYouType:e.searchAsYouType,promise:u};return this.duringQueryEvent(l),this.currentPendingQuery}},n.prototype.fetchMore=function(e){var n=this;if(void 0==this.currentPendingQuery){this.usageAnalytics.sendAllPendingEvents();var i=new r.QueryBuilder;this.continueLastQueryBuilder(i,e);var o=i.build(),s=this.getEndpoint(),a=this.currentPendingQuery=s.search(o),u={queryBuilder:i,query:o,searchAsYouType:!1,promise:a};return p.$$(this.element).trigger(l.QueryEvents.duringFetchMoreQuery,u),this.lastQueryBuilder=i,this.lastQuery=o,a.then(function(e){n.currentPendingQuery=void 0,null==n.lastQueryResults?n.lastQueryResults=e:t.forEach(e.results,function(t){n.lastQueryResults.results.push(t)});var r={queryBuilder:i,query:o,results:e,searchAsYouType:!1};n.preprocessResultsEvent(r),c.QueryUtils.setIndexAndUidOnQueryResults(o,e,n.getLastSearchUid(),e.pipeline,e.splitTestRun);var s={query:o,results:e,queryBuilder:i,searchAsYouType:!1};n.fetchMoreSuccessEvent(s)}),this.currentPendingQuery}},n.prototype.cancelQuery=function(){this.cancelAnyCurrentPendingQuery(),this.hideExecutingQueryAnimation()},n.prototype.deferExecuteQuery=function(t){var e=this;this.showExecutingQueryAnimation(),h.Defer.defer(function(){return e.executeQuery(t)})},n.prototype.ensureCreatedQueryBuilder=function(){this.createdOneQueryBuilder||this.createQueryBuilder(new y)},n.prototype.createQueryBuilder=function(t){a.Assert.exists(t),this.createdOneQueryBuilder=!0;var e=new r.QueryBuilder;e.language=String.locale,e.firstResult=e.firstResult||0;var n={queryBuilder:e,searchAsYouType:t.searchAsYouType,cancel:t.cancel};this.buildingQueryEvent(n);var i={queryBuilder:e,searchAsYouType:t.searchAsYouType,cancel:t.cancel};if(this.doneBuildingQueryEvent(i),n.cancel||i.cancel)return void this.cancelQuery();var o=this.getPipelineInUrl();return o&&(e.pipeline=o),e},n.prototype.isStandaloneSearchbox=function(){return d.Utils.isNonEmptyString(this.options.searchPageUri)},n.prototype.saveLastQuery=function(){this.localStorage.save({expire:(new Date).getTime()+18e5,hash:this.lastQueryHash,uid:this.lastSearchUid})},n.prototype.getLastQueryHash=function(){return null!=this.lastQueryHash?this.lastQueryHash:(this.loadLastQueryHash(),this.lastQueryHash||this.queryHash((new r.QueryBuilder).build()))},n.prototype.getLastSearchUid=function(){return null!=this.lastSearchUid?this.lastSearchUid:(this.loadLastQueryHash(),this.lastSearchUid)},n.prototype.loadLastQueryHash=function(){var t=this.localStorage.load();null!=t&&(new Date).getTime()<=t.expire&&(this.lastQueryHash=t.hash,this.lastSearchUid=t.uid,this.localStorage.remove())},n.prototype.continueLastQueryBuilder=function(e,n){t.extend(e,this.lastQueryBuilder),e.firstResult=e.firstResult+e.numberOfResults,e.numberOfResults=n},n.prototype.getPipelineInUrl=function(){return c.QueryUtils.getUrlParameter("pipeline")},n.prototype.cancelAnyCurrentPendingQuery=function(){return!!d.Utils.exists(this.currentPendingQuery)&&(this.logger.debug("Cancelling current pending query"),f.Promise.reject(this.currentPendingQuery),this.currentPendingQuery=void 0,!0)},n.prototype.showExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation||(p.$$(this.element).addClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!0)},n.prototype.hideExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation&&(p.$$(this.element).removeClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!1)},n.prototype.keepLastSearchUid=function(t,e){return this.getLastQueryHash()==this.queryHash(t,e)},n.prototype.queryHash=function(e,n){var i=JSON.stringify(t.omit(e,"firstResult","groupBy","debug"));return null!=n&&(i+=n.pipeline),i},n.prototype.getCallOptions=function(){var t={options:{authentication:[]}};return p.$$(this.element).trigger(l.QueryEvents.buildingCallOptions,t),t.options},n.prototype.newQueryEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.newQuery,t)},n.prototype.buildingQueryEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.buildingQuery,t)},n.prototype.doneBuildingQueryEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.doneBuildingQuery,t)},n.prototype.duringQueryEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.duringQuery,t)},n.prototype.querySuccessEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.querySuccess,t)},n.prototype.fetchMoreSuccessEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.fetchMoreSuccess,t)},n.prototype.deferredQuerySuccessEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.deferredQuerySuccess,t)},n.prototype.queryError=function(t){p.$$(this.element).trigger(l.QueryEvents.queryError,t)},n.prototype.preprocessResultsEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.preprocessResults,t)},n.prototype.noResultEvent=function(t){p.$$(this.element).trigger(l.QueryEvents.noResults,t)},n.prototype.debugInfo=function(){var e=this,n={query:this.lastQuery};return null!=this.lastQueryResults&&(n.queryDuration=function(){return e.buildQueryDurationSection(e.lastQueryResults)},n.results=function(){return t.omit(e.lastQueryResults,"results")}),null!=this.currentError&&(n.error=function(){return e.currentError}),n},n.prototype.buildQueryDurationSection=function(e){var n=p.Dom.createElement("div",{className:"coveo-debug-queryDuration"}),i=p.Dom.createElement("div",{className:"coveo-debug-durations"}),o=g.BaseComponent.getComponentRef("Debug");return n.appendChild(i),t.forEach(o.durationKeys,function(t){var o=e[t];if(null!=o){i.appendChild(p.Dom.createElement("div",{className:"coveo-debug-duration",style:"width:"+o+"px","data-id":t}));var r=p.Dom.createElement("div",{className:"coveo-debug-duration-legend","data-id":t});n.appendChild(r);var s=p.Dom.createElement("span",{className:"coveo-debug-duration-label"});s.appendChild(document.createTextNode(t)),r.appendChild(s);var a=p.Dom.createElement("span",{className:"coveo-debug-duration-value"});a.appendChild(document.createTextNode(o)),r.appendChild(a)}}),n},n.prototype.logQueryInActionsHistory=function(t,e){var n={name:"Query",value:t.q,time:JSON.stringify(new Date)};this.historyStore.addElement(n)},n.ID="QueryController",n}(o.RootComponent);e.QueryController=b}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(77),r=function(t){function e(e,n){t.call(this,e,n),this.element=e,this.type=n}return i(e,t),e}(o.BaseComponent);e.RootComponent=r},function(t,e,n){"use strict";var i=n(14),o=n(58),r=n(13),s=function(){function t(e,n){this.element=e,this.type=n,this.disabled=!1,i.Assert.exists(e),i.Assert.isNonEmptyString(n),this.logger=new r.Logger(this),t.bindComponentToElement(e,this)}return t.prototype.debugInfo=function(){var t={};return t[this.constructor.ID]=this,t},t.prototype.disable=function(){this.disabled=!0},t.prototype.enable=function(){this.disabled=!1},t.bindComponentToElement=function(e,n){i.Assert.exists(e),i.Assert.exists(n),i.Assert.isNonEmptyString(n.type),e[t.computeCssClassNameForType(n.type)]=n,o.$$(e).addClass(t.computeCssClassNameForType(n.type)),t.getBoundComponentsForElement(e).push(n)},t.computeCssClassName=function(e){return e.className?e.className:e.className=t.computeCssClassNameForType(e.ID)},t.computeCssClassNameForType=function(t){return i.Assert.isNonEmptyString(t),"Coveo"+t},t.computeSelectorForType=function(e){return i.Assert.isNonEmptyString(e),"."+t.computeCssClassNameForType(e)},t.getBoundComponentsForElement=function(t){return i.Assert.exists(t),null==t.CoveoBoundComponents&&(t.CoveoBoundComponents=[]),t.CoveoBoundComponents},t.getComponentRef=function(t){return Coveo[t]},t}();e.BaseComponent=s},function(t,e,n){(function(t){"use strict";var i=n(79),o=n(21),r=function(){function e(){this.expression=new i.ExpressionBuilder,this.advancedExpression=new i.ExpressionBuilder,this.constantExpression=new i.ExpressionBuilder,this.longQueryExpression=new i.ExpressionBuilder,this.disjunctionExpression=new i.ExpressionBuilder,this.disableQuerySyntax=!1,this.firstResult=0,this.numberOfResults=10,this.requiredFields=[],this.includeRequiredFields=!1,this.enableDidYouMean=!1,this.enableDebug=!1,this.sortCriteria="relevancy",this.retrieveFirstSentences=!0,this.queryUid=o.QueryUtils.createGuid(),this.queryFunctions=[],this.rankingFunctions=[],this.groupByRequests=[],this.enableDuplicateFiltering=!1}return e.prototype.build=function(){var t={q:this.expression.build(),aq:this.advancedExpression.build(),cq:this.constantExpression.build(),lq:this.longQueryExpression.build(),dq:this.disjunctionExpression.build(),searchHub:this.searchHub,tab:this.tab,language:this.language,pipeline:this.pipeline,maximumAge:this.maximumAge,wildcards:this.enableWildcards,questionMark:this.enableQuestionMarks,lowercaseOperators:this.enableLowercaseOperators,partialMatch:this.enablePartialMatch,partialMatchKeywords:this.partialMatchKeywords,partialMatchThreshold:this.partialMatchThreshold,firstResult:this.firstResult,numberOfResults:this.numberOfResults,excerptLength:this.excerptLength,filterField:this.filterField,filterFieldRange:this.filterFieldRange,parentField:this.parentField,childField:this.childField,fieldsToInclude:this.computeFieldsToInclude(),fieldsToExclude:this.fieldsToExclude,enableDidYouMean:this.enableDidYouMean,sortCriteria:this.sortCriteria,sortField:this.sortField,queryFunctions:this.queryFunctions,rankingFunctions:this.rankingFunctions,groupBy:this.groupByRequests,retrieveFirstSentences:this.retrieveFirstSentences,timezone:this.timezone,disableQuerySyntax:this.disableQuerySyntax,enableDuplicateFiltering:this.enableDuplicateFiltering,enableCollaborativeRating:this.enableCollaborativeRating,debug:this.enableDebug,context:this.context,actionsHistory:this.actionsHistory,recommendation:this.recommendation};return t},e.prototype.computeCompleteExpression=function(){return this.computeCompleteExpressionParts().full},e.prototype.computeCompleteExpressionParts=function(){var t=i.ExpressionBuilder.merge(this.expression,this.advancedExpression);return{full:i.ExpressionBuilder.mergeUsingOr(i.ExpressionBuilder.merge(t,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:i.ExpressionBuilder.mergeUsingOr(t,this.disjunctionExpression).build(),basic:i.ExpressionBuilder.mergeUsingOr(this.expression,this.disjunctionExpression).build(),advanced:i.ExpressionBuilder.mergeUsingOr(this.advancedExpression,this.disjunctionExpression).build(),constant:i.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},e.prototype.computeCompleteExpressionExcept=function(t){return this.computeCompleteExpressionPartsExcept(t).full},e.prototype.computeCompleteExpressionPartsExcept=function(t){var e=i.ExpressionBuilder.merge(this.expression,this.advancedExpression);e.remove(t);var n=new i.ExpressionBuilder;n.fromExpressionBuilder(this.expression),n.remove(t);var o=new i.ExpressionBuilder;return o.fromExpressionBuilder(this.advancedExpression),o.remove(t),{full:i.ExpressionBuilder.mergeUsingOr(i.ExpressionBuilder.merge(e,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:i.ExpressionBuilder.mergeUsingOr(e,this.disjunctionExpression).build(),basic:i.ExpressionBuilder.mergeUsingOr(n,this.disjunctionExpression).build(),advanced:i.ExpressionBuilder.mergeUsingOr(o,this.disjunctionExpression).build(),constant:i.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},e.prototype.addFieldsToInclude=function(e){this.fieldsToInclude=t.uniq((this.fieldsToInclude||[]).concat(e))},e.prototype.addRequiredFields=function(e){this.requiredFields=t.uniq(this.requiredFields.concat(e))},e.prototype.addFieldsToExclude=function(e){this.fieldsToExclude=t.uniq((this.fieldsToInclude||[]).concat(e))},e.prototype.computeFieldsToInclude=function(){return this.includeRequiredFields||null!=this.fieldsToInclude?this.requiredFields.concat(this.fieldsToInclude||[]):null},e.prototype.addContextValue=function(t,e){null==this.context&&(this.context={}),this.context[t]=e},e.prototype.addContext=function(e){null==this.context&&(this.context={}),t.extend(this.context,e)},e}();e.QueryBuilder=r}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(21),r=function(){function e(){this.parts=[],this.wrapParts=!0}return e.prototype.add=function(t){i.Assert.isNonEmptyString(t),this.parts.push(t)},e.prototype.fromExpressionBuilder=function(t){this.parts=this.parts.concat(t.parts)},e.prototype.addFieldExpression=function(t,e,n){i.Assert.isNonEmptyString(t),i.Assert.stringStartsWith(t,"@"),i.Assert.isNonEmptyString(e),i.Assert.isLargerOrEqualsThan(1,n.length),this.add(o.QueryUtils.buildFieldExpression(t,e,n))},e.prototype.addFieldNotEqualExpression=function(t,e){i.Assert.isNonEmptyString(t),i.Assert.stringStartsWith(t,"@"),i.Assert.isLargerOrEqualsThan(1,e.length),this.add(o.QueryUtils.buildFieldNotEqualExpression(t,e))},e.prototype.remove=function(e){i.Assert.isNonEmptyString(e);var n=t.indexOf(this.parts,e);n!=-1&&this.parts.splice(t.indexOf(this.parts,e),1)},e.prototype.isEmpty=function(){return 0==this.parts.length},e.prototype.build=function(t){return void 0===t&&(t=" "),0==this.parts.length?void 0:1==this.parts.length?this.parts[0]:this.wrapParts?"("+this.parts.join(")"+t+"(")+")":this.parts.join(t)},e.merge=function(){for(var n=[],i=0;i<arguments.length;i++)n[i-0]=arguments[i];var o=new e;return t.each(n,function(t){o.parts=o.parts.concat(t.parts)}),o},e.mergeUsingOr=function(){for(var n=[],i=0;i<arguments.length;i++)n[i-0]=arguments[i];var o=t.filter(n,function(t){return!t.isEmpty()}),r=new e;if(1==o.length)r.parts=[].concat(o[0].parts);else if(o.length>1){var s=t.map(o,function(t){return t.build()});r.add("("+s.join(") OR (")+")")}return r},e}();e.ExpressionBuilder=r}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var n=function(){function e(t,e){this.endpoint=t,this.callOptions=e,this.options=t.options}return e.prototype.getBaseUri=function(){return this.endpoint.getBaseUri()},e.prototype.getBaseAlertsUri=function(){return this.endpoint.getBaseAlertsUri()},e.prototype.getAuthenticationProviderUri=function(t,e,n){return this.endpoint.getAuthenticationProviderUri(t,e,n)},e.prototype.isJsonp=function(){return this.endpoint.isJsonp()},e.prototype.search=function(t,e){return this.endpoint.search(t,this.enrichCallOptions(e))},e.prototype.getExportToExcelLink=function(t,e,n){return this.endpoint.getExportToExcelLink(t,e,this.enrichCallOptions(n))},e.prototype.tagDocument=function(t,e){return this.endpoint.tagDocument(t,this.enrichCallOptions(t))},e.prototype.getRevealQuerySuggest=function(t,e){return this.endpoint.getRevealQuerySuggest(t,this.enrichCallOptions(e))},e.prototype.rateDocument=function(t,e){return this.endpoint.rateDocument(t,this.enrichCallOptions(e))},e.prototype.getRawDataStream=function(t,e,n){return this.endpoint.getRawDataStream(t,e,this.enrichCallOptions(n))},e.prototype.getDocument=function(t,e){return this.endpoint.getDocument(t,this.enrichCallOptions(e))},e.prototype.getDocumentText=function(t,e){return this.endpoint.getDocumentText(t,this.enrichCallOptions(e))},e.prototype.getDocumentHtml=function(t,e){return this.endpoint.getDocumentHtml(t,this.enrichCallOptions(e))},e.prototype.getViewAsHtmlUri=function(t,e){return this.endpoint.getViewAsHtmlUri(t,this.enrichCallOptions(e))},e.prototype.getViewAsDatastreamUri=function(t,e,n){return this.endpoint.getViewAsDatastreamUri(t,e,this.enrichCallOptions(n))},e.prototype.listFieldValues=function(t,e){return this.endpoint.listFieldValues(t,this.enrichCallOptions(e))},e.prototype.listFields=function(t){return this.endpoint.listFields(this.enrichCallOptions(t))},e.prototype.extensions=function(t){return this.endpoint.extensions(this.enrichCallOptions(t))},e.prototype.follow=function(t){return this.endpoint.follow(t)},e.prototype.listSubscriptions=function(t){return this.endpoint.listSubscriptions(t)},e.prototype.updateSubscription=function(t){return this.endpoint.updateSubscription(t)},e.prototype.deleteSubscription=function(t){return this.endpoint.deleteSubscription(t);
},e.prototype.logError=function(t){return this.endpoint.logError(t)},e.prototype.enrichCallOptions=function(e){return t.extend({},e,this.callOptions)},e}();e.SearchEndpointWithDefaultCallOptions=n}).call(e,n(10))},function(t,e,n){"use strict";var i=n(82);e.analytics=i;var o=n(87);e.SimpleAnalytics=o;var r=n(83);e.history=r;var s=n(90);e.donottrack=s;var a=n(84);e.storage=a},function(t,e,n){"use strict";function i(t){return t.json().then(function(e){return e.raw=t,e})}var o=n(83),r=n(85);e.Version="v15",e.Endpoints={default:"https://usageanalytics.coveo.com",production:"https://usageanalytics.coveo.com",dev:"https://usageanalyticsdev.coveo.com",staging:"https://usageanalyticsstaging.coveo.com"};var s=function(){function t(t){if("undefined"==typeof t)throw new Error("You have to pass options to this constructor");this.endpoint=t.endpoint||e.Endpoints.default,this.token=t.token,this.version=t.version||e.Version}return t.prototype.sendEvent=function(t,e){return fetch(this.getRestEndpoint()+"/analytics/"+t,{method:"POST",headers:this.getHeaders(),mode:"cors",body:JSON.stringify(e),credentials:"include"})},t.prototype.sendSearchEvent=function(t){return this.sendEvent("search",t).then(i)},t.prototype.sendClickEvent=function(t){return this.sendEvent("click",t).then(i)},t.prototype.sendCustomEvent=function(t){return this.sendEvent("custom",t).then(i)},t.prototype.sendViewEvent=function(t){if(""===t.referrer&&delete t.referrer,r.hasDocumentLocation()){var e=new o.HistoryStore,n={name:"PageView",value:document.location.toString(),time:JSON.stringify(new Date),title:document.title};e.addElement(n)}return this.sendEvent("view",t).then(i)},t.prototype.getVisit=function(){return fetch(this.getRestEndpoint()+"/analytics/visit").then(i)},t.prototype.getHealth=function(){return fetch(this.getRestEndpoint()+"/analytics/monitoring/health").then(i)},t.prototype.getRestEndpoint=function(){return this.endpoint+"/rest/"+this.version},t.prototype.getHeaders=function(){var t={"Content-Type":"application/json"};return this.token&&(t.Authorization="Bearer "+this.token),t},t}();e.Client=s,Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var i=n(84),o=n(85);e.STORE_KEY="__coveo.analytics.history",e.MAX_NUMBER_OF_HISTORY_ELEMENTS=20,e.MIN_THRESHOLD_FOR_DUPLICATE_VALUE=6e4,e.MAX_VALUE_SIZE=75;var r=function(){function t(t){this.store=t||i.getAvailableStorage(),this.store instanceof i.CookieStorage||!o.hasCookieStorage()||(new i.CookieStorage).removeItem(e.STORE_KEY)}return t.prototype.addElement=function(t){t.internalTime=(new Date).getTime(),this.cropQueryElement(t);var e=this.getHistory();null!=e?this.isValidEntry(t)&&this.setHistory([t].concat(e)):this.setHistory([t])},t.prototype.getHistory=function(){try{return JSON.parse(this.store.getItem(e.STORE_KEY))}catch(t){return[]}},t.prototype.setHistory=function(t){try{this.store.setItem(e.STORE_KEY,JSON.stringify(t.slice(0,e.MAX_NUMBER_OF_HISTORY_ELEMENTS)))}catch(t){}},t.prototype.clear=function(){try{this.store.removeItem(e.STORE_KEY)}catch(t){}},t.prototype.getMostRecentElement=function(){var t=this.getHistory();if(null!=t){var e=t.sort(function(t,e){return null==t.internalTime&&null==e.internalTime?0:null==t.internalTime&&null!=e.internalTime?1:null!=t.internalTime&&null==e.internalTime?-1:e.internalTime-t.internalTime});return e[0]}return null},t.prototype.cropQueryElement=function(t){t.name&&"query"==t.name.toLowerCase()&&null!=t.value&&(t.value=t.value.slice(0,e.MAX_VALUE_SIZE))},t.prototype.isValidEntry=function(t){var n=this.getMostRecentElement();return!n||n.value!=t.value||t.internalTime-n.internalTime>e.MIN_THRESHOLD_FOR_DUPLICATE_VALUE},t}();e.HistoryStore=r,Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function i(){return e.preferredStorage?e.preferredStorage:o.hasLocalStorage()?localStorage:o.hasCookieStorage()?new s:o.hasSessionStorage()?sessionStorage:new a}var o=n(85),r=n(86);e.preferredStorage=null,e.getAvailableStorage=i;var s=function(){function t(){}return t.prototype.getItem=function(t){return r.Cookie.get(t)},t.prototype.removeItem=function(t){r.Cookie.erase(t)},t.prototype.setItem=function(t,e){r.Cookie.set(t,e)},t}();e.CookieStorage=s;var a=function(){function t(){}return t.prototype.getItem=function(t){return null},t.prototype.removeItem=function(t){},t.prototype.setItem=function(t,e){},t}();e.NullStorage=a},function(t,e){"use strict";function n(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}function i(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(t){return!1}}function o(){return navigator.cookieEnabled}function r(){return null!==document}function s(){return r()&&null!==document.location}e.hasLocalStorage=n,e.hasSessionStorage=i,e.hasCookieStorage=o,e.hasDocument=r,e.hasDocumentLocation=s},function(t,e){"use strict";var n=function(){function t(){}return t.set=function(e,n,i){var o,r,s,a,u;i?(s=new Date,s.setTime(s.getTime()+i),a="; expires="+s.toGMTString()):a="",u=location.hostname,u.indexOf(".")===-1?document.cookie=e+"="+n+a+"; path=/":(r=u.split("."),r.shift(),o="."+r.join("."),document.cookie=e+"="+n+a+"; path=/; domain="+o,null!=t.get(e)&&t.get(e)==n||(o="."+u,document.cookie=e+"="+n+a+"; path=/; domain="+o))},t.get=function(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var o=n[i];if(o=o.replace(/^\s+/,""),0==o.indexOf(e))return o.substring(e.length,o.length)}return null},t.erase=function(e){t.set(e,"",-1)},t}();e.Cookie=n},function(t,e,n){"use strict";var i=n(82),o=n(88),r=n(89),s=function(){function t(){}return t.prototype.init=function(t,e){if("undefined"==typeof t)throw new Error("You must pass your token when you call 'init'");if("string"==typeof t)e=e||i.Endpoints.default,this.client=new i.Client({token:t,endpoint:e});else{if("object"!=typeof t||"undefined"==typeof t.sendEvent)throw new Error("You must pass either your token or a valid object when you call 'init'");this.client=t}},t.prototype.send=function(t,e){if("undefined"==typeof this.client)throw new Error("You must call init before sending an event");switch(e=o.default({},{hash:window.location.hash},e),t){case"pageview":return void this.client.sendViewEvent({location:window.location.toString(),referrer:document.referrer,language:document.documentElement.lang,title:document.title,contentIdKey:r.popFromObject(e,"contentIdKey"),contentIdValue:r.popFromObject(e,"contentIdValue"),contentType:r.popFromObject(e,"contentType"),customData:e});default:throw new Error("Event type: '"+t+"' not implemented")}},t.prototype.onLoad=function(t){if("undefined"==typeof t)throw new Error("You must pass a function when you call 'onLoad'");t()},t}();e.SimpleAPI=s;var a=new s;e.SimpleAnalytics=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=a[t];if(i)return i.apply(a,e)},Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SimpleAnalytics},function(t,e){"use strict";var n=Object.prototype.hasOwnProperty,i=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,r=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");var s=Object(t);return e.forEach(function(t){var e=Object(t);for(var r in e)n.call(e,r)&&(s[r]=e[r]);if(i){var a=i(e);a.forEach(function(t){o.call(e,t)&&(s[t]=e[t])})}}),s};e.ponyfill=r,e.assign="function"==typeof Object.assign?Object.assign:r,Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.assign},function(t,e){"use strict";function n(t,e){if(t){var n=t[e];return delete t[e],n}}e.popFromObject=n},function(t,e){"use strict";e.doNotTrack=[!0,"yes","1"].indexOf(navigator.doNotTrack||navigator.msDoNotTrack||window.doNotTrack),Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.doNotTrack},function(t,e,n){(function(t){"use strict";var i=n(79),o=n(15),r=n(92),s=n(14),a=n(93),u=function(){function e(t){this.facet=t}return e.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0,this.expressionToUseForFacetSearch=void 0,this.constantExpressionToUseForFacetSearch=void 0},e.prototype.computeOurFilterExpression=function(){var e=this,n=new i.ExpressionBuilder,r=this.facet.values.getSelected();r.length>0&&(this.facet.options.useAnd?t.each(r,function(t){n.addFieldExpression(e.facet.options.field,"==",[t.value])}):n.addFieldExpression(this.facet.options.field,"==",t.map(r,function(t){return t.value})));var s=this.facet.values.getExcluded();return s.length>0&&n.addFieldNotEqualExpression(this.facet.options.field,t.map(s,function(t){return t.value})),o.Utils.isNonEmptyString(this.facet.options.additionalFilter)&&n.add(this.facet.options.additionalFilter),n.build()},e.prototype.putGroupByIntoQueryBuilder=function(t){s.Assert.exists(t);var e=this.createGroupByAllowedValues(),n=this.createBasicGroupByRequest(e),i=this.createGroupByQueryOverride(t);if(o.Utils.isNullOrUndefined(i)){var r=t.computeCompleteExpressionParts();this.expressionToUseForFacetSearch=null==r.withoutConstant?"@uri":r.withoutConstant,this.basicExpressionToUseForFacetSearch=null==r.basic?"@uri":r.basic,this.advancedExpressionToUseForFacetSearch=r.advanced,this.constantExpressionToUseForFacetSearch=r.constant}else n.queryOverride=i.basic,n.advancedQueryOverride=i.advanced,n.constantQueryOverride=i.constant,this.expressionToUseForFacetSearch=i.withoutConstant,this.basicExpressionToUseForFacetSearch=i.basic,this.advancedExpressionToUseForFacetSearch=i.advanced,this.constantExpressionToUseForFacetSearch=i.constant;this.lastGroupByRequestIndex=t.groupByRequests.length,this.lastGroupByRequest=n,t.groupByRequests.push(n)},e.prototype.search=function(e,n){var i=this;return void 0===n&&(n=e.nbResults),new Promise(function(o,r){var s=function(t){var r=t.length;return t=i.checkForFacetSearchValuesToRemove(t,e.valueToSearch),a.FacetUtils.needAnotherFacetSearch(t.length,r,n,5)?(e.nbResults+=5,i.search(e,t.length)):void o(t)},u=i.facet.getEndpoint().search(e.getQuery());i.currentSearchPromise=u,u.then(function(n){if(i.currentSearchPromise==u){var o=[];n.groupByResults&&n.groupByResults[0]&&t.each(n.groupByResults[0].values,function(n){n.lookupValue?t.contains(e.alwaysExclude,n.lookupValue.toLowerCase())||o.push(n):t.contains(e.alwaysExclude,n.value.toLowerCase())||o.push(n)}),s(t.first(o,e.nbResults))}else r()}).catch(function(t){r(t)})})},e.prototype.fetchMore=function(e){var n=new r.FacetSearchParameters(this.facet);return n.alwaysInclude=this.facet.options.allowedValues||t.pluck(this.facet.values.getAll(),"value"),n.nbResults=e,this.facet.getEndpoint().search(n.getQuery())},e.prototype.searchInFacetToUpdateDelta=function(e){var n=new r.FacetSearchParameters(this.facet),i=n.getQuery();return i.aq=this.computeOurFilterExpression(),t.each(e,function(t){t.waitingForDelta=!0}),i.groupBy=[this.createBasicGroupByRequest(t.map(e,function(t){return t.value}))],i.groupBy[0].completeFacetWithStandardValues=!1,this.facet.getEndpoint().search(i)},e.prototype.createGroupByAllowedValues=function(){return void 0!=this.facet.options.allowedValues?this.facet.options.allowedValues:void 0!=this.facet.options.customSort?this.getUnionWithCustomSortLowercase(this.facet.options.customSort,this.getAllowedValuesFromSelected()):t.map(this.getAllowedValuesFromSelected(),function(t){return t.value})},e.prototype.getUnionWithCustomSortLowercase=function(e,n){var i=t.map(e,function(t){return t.toLowerCase()}),o=t.chain(n).filter(function(e){return!t.contains(i,e.value.toLowerCase())}).map(function(t){return t.value}).value();return t.compact(e.concat(o))},e.prototype.getAllowedValuesFromSelected=function(){var t=[];if(this.facet.options.useAnd||!this.facet.keepDisplayedValuesNextTime){var e=this.facet.values.getSelected();if(0==e.length)return;t=this.facet.values.getSelected()}else t=this.facet.values.getAll();return t},e.prototype.createGroupByQueryOverride=function(e){var n=this.facet.options.additionalFilter?this.facet.options.additionalFilter:"",i=void 0;return this.facet.options.useAnd?o.Utils.isNonEmptyString(n)&&(i=e.computeCompleteExpressionParts(),o.Utils.isEmptyString(i.basic)&&(i.basic="@uri")):this.facet.values.hasSelectedOrExcludedValues()?(i=e.computeCompleteExpressionPartsExcept(this.computeOurFilterExpression()),o.Utils.isEmptyString(i.basic)&&(i.basic="@uri")):o.Utils.isNonEmptyString(n)&&(i=e.computeCompleteExpressionParts(),o.Utils.isEmptyString(i.basic)&&(i.basic="@uri")),i&&o.Utils.isNonEmptyString(n)&&(i.constant=i.constant?i.constant+" "+n:n),t.each(t.keys(i),function(t){(o.Utils.isEmptyString(i[t])||o.Utils.isNullOrUndefined(i[t]))&&delete i[t]}),0==t.keys(i).length&&(i=void 0),i},e.prototype.createBasicGroupByRequest=function(t,e){void 0===e&&(e=!0);var n=this.facet.numberOfValues;if(null!=this.facet.options.customSort){var i=this.getUnionWithCustomSortLowercase(this.facet.options.customSort,this.facet.values.getSelected().concat(this.facet.values.getExcluded()));n=Math.max(n,i.length)}var r={field:this.facet.options.field,maximumNumberOfValues:n+(this.facet.options.enableMoreLess?1:0),sortCriteria:this.facet.options.sortCriteria,injectionDepth:this.facet.options.injectionDepth,completeFacetWithStandardValues:void 0==this.facet.options.allowedValues};return this.facet.options.lookupField&&(r.lookupField=this.facet.options.lookupField),null!=t&&(r.allowedValues=t),e&&o.Utils.isNonEmptyString(this.facet.options.computedField)&&(r.computedFields=[{field:this.facet.options.computedField,operation:this.facet.options.computedFieldOperation}]),r},e.prototype.checkForFacetSearchValuesToRemove=function(e,n){var i=this,o=a.FacetUtils.getRegexToUseForFacetSearch(n,this.facet.options.facetSearchIgnoreAccents);return t.filter(e,function(e){var n=t.isEmpty(i.facet.options.allowedValues)||t.contains(i.facet.options.allowedValues,e.value),r=i.facet.getValueCaption(e);return n&&o.test(r)})},e}();e.FacetQueryController=u}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(15),o=n(93),r=n(78),s=n(58),a=function(){function e(t){this.facet=t,this.valueToSearch="",this.alwaysInclude=[],this.alwaysExclude=[],this.sortCriteria="occurrences",this.fetchMore=!1,this.nbResults=t.options.numberOfValuesInFacetSearch,this.ignoreAccents=t.options.facetSearchIgnoreAccents,this.searchEvenIfEmpty=t.searchInterface.isNewDesign()}return e.prototype.setValueToSearch=function(t){return this.valueToSearch=t,i.Utils.isNonEmptyString(t)&&(this.alwaysInclude=this.alwaysInclude.concat(o.FacetUtils.getValuesToUseForSearchInFacet(this.valueToSearch,this.facet))),this},e.prototype.excludeCurrentlyDisplayedValuesInSearch=function(e){var n=this;t.each(this.getCurrentlyShowedValueInSearch(e),function(e){var i=o.FacetUtils.getValuesToUseForSearchInFacet(e,n.facet);t.each(i,function(t){n.alwaysExclude.push(t)})}),t.each(this.facet.getDisplayedFacetValues(),function(e){var i=o.FacetUtils.getValuesToUseForSearchInFacet(e.value,n.facet);t.each(i,function(t){n.alwaysExclude.push(t)})})},e.prototype.getGroupByRequest=function(){this.lowerCaseAll();var t=this.nbResults;this.facet.searchInterface.isNewDesign()&&(t+=this.alwaysExclude.length);var e=[];this.valueToSearch&&(e=["*"+this.valueToSearch+"*"]);var n={allowedValues:e.concat(this.alwaysInclude).concat(this.alwaysExclude),maximumNumberOfValues:t,completeFacetWithStandardValues:!this.facet.options.lookupField,field:this.facet.options.field,sortCriteria:this.facet.options.sortCriteria||this.sortCriteria,injectionDepth:this.facet.options.injectionDepth};return this.facet.options.lookupField&&(n.lookupField=this.facet.options.lookupField),this.facet.options.computedField&&(n.computedFields=[{field:this.facet.options.computedField,operation:this.facet.options.computedFieldOperation}]),n},e.prototype.getQuery=function(){var e=t.clone(this.facet.queryController.getLastQuery());return e||(e=(new r.QueryBuilder).build()),e.q=this.facet.facetQueryController.basicExpressionToUseForFacetSearch,e.cq=this.facet.facetQueryController.constantExpressionToUseForFacetSearch,e.aq=this.facet.facetQueryController.advancedExpressionToUseForFacetSearch,e.enableDidYouMean=!1,e.firstResult=0,e.numberOfResults=0,e.fieldsToInclude=[],e.groupBy=[this.getGroupByRequest()],e},e.prototype.getCurrentlyShowedValueInSearch=function(e){return t.map(s.$$(e).findAll(".coveo-facet-value-caption"),function(t){return s.$$(t).text()})},e.prototype.lowerCaseAll=function(){this.alwaysExclude=t.chain(this.alwaysExclude).map(function(t){return t.toLowerCase()}).uniq().value(),this.alwaysInclude=t.chain(this.alwaysInclude).map(function(t){return t.toLowerCase()}).uniq().value()},e}();e.FacetSearchParameters=a}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(61),o=n(21),r=n(60),s=n(57),a=n(15),u=n(58),l=function(){function e(){}return e.getRegexToUseForFacetSearch=function(t,e){return new RegExp(i.StringUtils.stringToRegex(t,e),"i")},e.getValuesToUseForSearchInFacet=function(e,n){var i=[e],a=this.getRegexToUseForFacetSearch(e,n.options.facetSearchIgnoreAccents);return n.options.valueCaption?(t.chain(n.options.valueCaption).pairs().filter(function(t){return a.test(t[1])}).each(function(t){i.push(t[0])}),(o.QueryUtils.isStratusAgnosticField(n.options.field,"@objecttype")||o.QueryUtils.isStratusAgnosticField(n.options.field,"@filetype"))&&t.each(r.FileTypes.getFileTypeCaptions(),function(t,e){e in n.options.valueCaption||!a.test(t)||i.push(e)})):o.QueryUtils.isStratusAgnosticField(n.options.field,"@objecttype")||o.QueryUtils.isStratusAgnosticField(n.options.field,"@filetype")?t.each(t.filter(t.pairs(r.FileTypes.getFileTypeCaptions()),function(t){return a.test(t[1])}),function(t){i.push(t[0])}):o.QueryUtils.isStratusAgnosticField(n.options.field,"@month")&&t.each(t.range(1,13),function(t){a.test(s.DateUtils.monthToString(t-1))&&i.push(("0"+t.toString()).substr(-2))}),i},e.buildFacetSearchPattern=function(e){return e=t.map(e,function(t){return a.Utils.escapeRegexCharacter(t)}),e[0]=".*"+e[0]+".*",e.join("|")},e.needAnotherFacetSearch=function(t,e,n,i){return t<e&&t<i&&t>n},e.addNoStateCssClassToFacetValues=function(e,n){if(0!=e.values.getSelected().length){var i=u.$$(n).findAll("li:not(.coveo-selected)");t.each(i,function(t){u.$$(t).addClass("coveo-no-state")})}},e.tryToGetTranslatedCaption=function(t,e){var n;if(o.QueryUtils.isStratusAgnosticField(t.toLowerCase(),"@filetype"))n=r.FileTypes.getFileTypeCaptions()[e.toLowerCase()];else if(o.QueryUtils.isStratusAgnosticField(t.toLowerCase(),"@month"))try{var i=parseInt(e);n=s.DateUtils.monthToString(i-1)}catch(t){}return void 0!=n&&a.Utils.isNonEmptyString(n)?n:e},e.clipCaptionsToAvoidOverflowingTheirContainer=function(t,e){if(!(t.getBindings&&t.getBindings().searchInterface&&t.getBindings().searchInterface.isNewDesign())&&(!(Coveo.HierarchicalFacet&&t instanceof Coveo.HierarchicalFacet)||e)){t.logger.trace("Clipping captions"),u.$$(t.element).show();for(var n=t.element,i=u.$$(n).findAll(".coveo-facet-value-caption"),o=0;o<i.length;o++)""!=i[o].style.width&&(i[o].style.width="");for(var r=u.$$(n).findAll(".coveo-facet-value-label-wrapper"),s=[],o=0;o<r.length;o++){var a=r[o],l=u.$$(a).find(".coveo-facet-value-caption"),c=a.scrollWidth,h=a.clientWidth,p=l.scrollWidth,d=Math.max(0,c-h);d&&s.push({element:l,width:p,crop:d,label:a})}n.style.display="";for(var o=0;o<s.length;o++){var f=s[o];f.element.style.width=f.width-f.crop+"px",f.crop>0?f.label.setAttribute("title",u.$$(f.element).text()):f.label.setAttribute("title",null)}}},e}();e.FacetUtils=l}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(91),r=n(15),s=function(t){function e(e){t.call(this,e),this.facet=e}return i(e,t),e.prototype.createBasicGroupByRequest=function(e,n){void 0===n&&(n=!0);var i=t.prototype.createBasicGroupByRequest.call(this,null,n);return i.allowedValues=void 0,i=r.Utils.isNonEmptyArray(this.facet.options.ranges)?this.buildGroupByQueryForPredefinedRanges(i):this.buildGroupByQueryForAutomaticRanges(i)},e.prototype.createGroupByAllowedValues=function(){},e.prototype.buildGroupByQueryForAutomaticRanges=function(t){return t.generateAutomaticRanges=!0,t},e.prototype.buildGroupByQueryForPredefinedRanges=function(t){return t.rangeValues=this.facet.options.ranges,t.maximumNumberOfValues=this.facet.options.ranges.length,t},e}(o.FacetQueryController);e.FacetRangeQueryController=s},function(t,e,n){(function(t){"use strict";var i=n(48),o=n(79),r=n(57),s=n(13),a=n(21),u=function(){function e(t){var e=this;this.facet=t,this.facet.bind.onRootElement(i.QueryEvents.querySuccess,function(t){return e.handleQuerySuccess(t)})}return e.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0},e.prototype.putGroupByIntoQueryBuilder=function(t){this.facet.options.graph&&this.putGroupByForGraphIntoQueryBuilder(t),this.putGroupByForSliderIntoQueryBuilder(t)},e.prototype.createBasicGroupByRequest=function(t,e){void 0===e&&(e=!0);var n={field:this.facet.options.field,completeFacetWithStandardValues:!0};return n.allowedValues=void 0,n=this.facet.options.graph?this.buildGroupByQueryForSlider(n):this.buildGroupByQueryForAutomaticRanges(n)},e.prototype.computeOurFilterExpression=function(t){void 0===t&&(t=[this.facet.startOfSlider,this.facet.endOfSlider]);var e=new o.ExpressionBuilder;return void 0!=t[0]&&void 0!=t[1]&&(this.facet.options.excludeOuterBounds?this.addFilterExpressionWithOuterBoundsExcluded(t[0],t[1],e):this.addFilterExpressionWithOuterBoundsIncluded(t[0],t[1],e)),e.build()},e.prototype.handleQuerySuccess=function(e){var n=this;if(!this.isAValidRangeResponse(e)){var i=new s.Logger(this);return i.error("Cannot instantiate FacetSlider for this field : "+this.facet.options.field+". It needs to be configured as a numerical field in the index"),i.error("Disabling the FacetSlider",this.facet),void this.facet.disable()}if(this.facet.options&&this.facet.options.graph&&void 0==this.rangeValuesForGraphToUse){this.rangeValuesForGraphToUse=[];var o=e.results.groupByResults[this.graphGroupByQueriesIndex].values;t.each(o,function(t){var e=t.value.split("..");n.rangeValuesForGraphToUse.push({start:n.facet.options.dateField?n.getISOFormat(e[0].replace("@"," ")):parseInt(e[0],10),end:n.facet.options.dateField?n.getISOFormat(e[1].replace("@"," ")):parseInt(e[1],10)})})}},e.prototype.isAValidRangeResponse=function(t){if(void 0!=this.lastGroupByRequestIndex&&t.results.groupByResults[this.lastGroupByRequestIndex]){var e=t.results.groupByResults[this.lastGroupByRequestIndex].values[0];if(e&&!a.QueryUtils.isRangeString(e.value))return!1}return!0},e.prototype.addFilterExpressionWithOuterBoundsIncluded=function(t,e,n){t==this.facet.options.start&&e==this.facet.options.end||(this.facet.options.dateField&&(t=this.getFilterDateFormat(t),e=this.getFilterDateFormat(e)),n.addFieldExpression(this.facet.options.field,"==",[t+".."+e]))},e.prototype.addFilterExpressionWithOuterBoundsExcluded=function(t,e,n){var i=this.facet.options.start,o=this.facet.options.end,r=t,s=e;this.facet.options.dateField?(r=this.getFilterDateFormat(t),s=this.getFilterDateFormat(e),i=this.getFilterDateFormat(i),o=this.getFilterDateFormat(o)):(r+="",s+="",i+="",o+=""),r!=i&&s==o?n.addFieldExpression(this.facet.options.field,">=",[r]):r==i&&s!=o?n.addFieldExpression(this.facet.options.field,"<=",[s]):this.addFilterExpressionWithOuterBoundsIncluded(t,e,n)},e.prototype.buildGroupByQueryForSlider=function(t){if(void 0!=this.facet.options.start&&void 0!=this.facet.options.end){var e=this.facet.options.start,n=this.facet.options.end;return(this.facet.options.dateField||this.facet.options.dateField)&&(e=this.getISOFormat(e),n=this.getISOFormat(n)),t.rangeValues=[{start:e,end:n,endInclusive:!0,label:"Slider"}],t}return this.buildGroupByQueryForAutomaticRanges(t)},e.prototype.buildGroupByQueryForAutomaticRanges=function(t){return t.generateAutomaticRanges=!0,t},e.prototype.putGroupByForGraphIntoQueryBuilder=function(t){this.graphGroupByQueriesIndex=t.groupByRequests.length;var e=this.createBasicGroupByRequest();if(e.rangeValues){var n=e.rangeValues[0];e.rangeValues=this.createRangeValuesForGraph(n)}var i=this.computeOurFilterExpression(this.facet.getSliderBoundaryForQuery());if(void 0!=i){var o=t.computeCompleteExpressionPartsExcept(i);e.queryOverride=o.basic,e.advancedQueryOverride=o.advanced,e.constantQueryOverride=o.constant,void 0==e.queryOverride?e.queryOverride=this.facet.options.queryOverride||"@uri":e.queryOverride+=this.facet.options.queryOverride?" "+this.facet.options.queryOverride:""}else if(null!=this.facet.options.queryOverride){var r=t.computeCompleteExpression();e.queryOverride=(null!=r?r+" ":"")+this.facet.options.queryOverride}e.sortCriteria="nosort",e.maximumNumberOfValues=this.facet.options.graph.steps,t.groupByRequests.push(e)},e.prototype.putGroupByForSliderIntoQueryBuilder=function(t){this.lastGroupByRequestIndex=t.groupByRequests.length;var e=this.createBasicGroupByRequest();e.maximumNumberOfValues=null!=this.facet.options.graph?this.facet.options.graph.steps||1:1,e.queryOverride=this.facet.options.queryOverride||"@uri",e.sortCriteria="nosort",e.generateAutomaticRanges=!0,e.rangeValues=void 0,t.groupByRequests.push(e)},e.prototype.createRangeValuesForGraph=function(t){return void 0==this.facet.options.graph.steps&&(this.facet.options.graph.steps=10),this.facet.options.dateField&&isNaN(this.facet.options.start)&&(this.facet.options.start=new Date(this.facet.options.start).getTime()),this.facet.options.dateField&&isNaN(this.facet.options.end)&&(this.facet.options.end=new Date(this.facet.options.end).getTime()),void 0!=this.rangeValuesForGraphToUse?this.usePrebuiltRange(t):this.buildRange(t)},e.prototype.usePrebuiltRange=function(e){return t.map(this.rangeValuesForGraphToUse,function(t){return{start:t.start,end:t.end,endInclusive:e.endInclusive,label:e.label}})},e.prototype.buildRange=function(e){var n=this,i=this.facet.options.start,o=(this.facet.options.end-this.facet.options.start)/this.facet.options.graph.steps;return t.map(t.range(0,this.facet.options.graph.steps,1),function(t){var r=i+t*o,s=i+(t+1)*o;return n.facet.options.dateField&&(r=n.getISOFormat(r),s=n.getISOFormat(s)),{endInclusive:e.endInclusive,label:e.label,start:r,end:s}})},e.prototype.getISOFormat=function(t){if(t){isNaN(t)||(t=Number(t));var e=new Date(t);return r.DateUtils.isValid(e)||(e=new Date(this.getBrowserCompatibleFormat(t)),r.DateUtils.isValid(e))?e.toISOString():void this.facet.logger.error("Cannot parse this date format.",t,new Date(t))}},e.prototype.getFilterDateFormat=function(t){return t?this.getISOFormat(t).replace("T","@").replace(".000Z","").replace(/-/g,"/"):void 0},e.prototype.getBrowserCompatibleFormat=function(t){return t.replace("@","T").replace(/\//g,"-")},e}();e.FacetSliderQueryController=u}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(91),r=n(93),s=function(e){function n(t){e.call(this,t),this.facet=t}return i(n,e),n.prototype.search=function(e,n){var i=this;void 0===n&&(n=e.nbResults);var o=r.FacetUtils.getRegexToUseForFacetSearch(this.facet.facetSearch.getValueInInputForFacetSearch(),this.facet.options.facetSearchIgnoreAccents);return new Promise(function(e){var n=t.chain(i.facet.getAllValueHierarchy()).toArray().filter(function(t){return null!=i.facet.getValueCaption(t.facetValue).match(o)}).first(i.facet.options.numberOfValuesInFacetSearch).value();e(t.map(n,function(t){return t.facetValue}))})},n.prototype.getAllowedValuesFromSelected=function(){return[]},n}(o.FacetQueryController);e.HierarchicalFacetQueryController=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(14),r=n(98),s=n(45),a=n(58),u=n(66),l=n(32),c=n(76),h=n(15),p=function(e){function n(t,i,l,c,h){var p=this;void 0===h&&(h=u.HashUtils),e.call(this,t,n.ID),this.windoh=i,this.model=l,this.queryController=c,this.hashUtils=h,this.ignoreNextHashChange=!1,this.initialHashChange=!1,this.willUpdateHash=!1,this.windoh=this.windoh||window,o.Assert.exists(this.model),o.Assert.exists(this.queryController),a.$$(this.element).on(s.InitializationEvents.restoreHistoryState,function(){p.logger.trace("Restore history state. Update model"),p.updateModelFromHash()}),a.$$(this.element).on(this.model.getEventName(r.Model.eventTypes.all),function(){p.logger.trace("Query model changed. Update hash"),p.updateHashFromModel()}),this.hashchange=function(){p.handleHashChange()},this.windoh.addEventListener("hashchange",this.hashchange),a.$$(this.element).on(s.InitializationEvents.nuke,function(){return p.handleNuke()})}return i(n,e),n.prototype.setHashValues=function(t){this.logger.trace("Update history hash");var e="#"+this.hashUtils.encodeValues(t);this.ignoreNextHashChange=this.windoh.location.hash!=e,this.logger.trace("ignoreNextHashChange",this.ignoreNextHashChange),this.logger.trace("initialHashChange",this.initialHashChange),this.logger.trace("from",this.windoh.location.hash,"to",e),this.initialHashChange?(this.initialHashChange=!1,this.windoh.location.replace(e),this.logger.trace("History hash modified",e)):this.ignoreNextHashChange&&(this.windoh.location.hash=e,this.logger.trace("History hash created",e))},n.prototype.handleNuke=function(){this.windoh.removeEventListener("hashchange",this.hashchange)},n.prototype.handleHashChange=function(){if(this.logger.trace("History hash changed"),this.ignoreNextHashChange)return this.logger.trace("History hash change ignored"),void(this.ignoreNextHashChange=!1);var e=this.updateModelFromHash();t.difference(e,n.attributesThatDoNotTriggerQuery).length>0&&this.queryController.executeQuery()},n.prototype.updateHashFromModel=function(){var t=this;this.logger.trace("Model -> history hash"),this.willUpdateHash||(l.Defer.defer(function(){var e=t.model.getAttributes();t.setHashValues(e),t.logger.debug("Saving state to hash",e),t.willUpdateHash=!1}),this.willUpdateHash=!0)},n.prototype.updateModelFromHash=function(){var e=this;this.logger.trace("History hash -> model");var n={},i=[];return t.each(this.model.attributes,function(t,o,r){var s=e.getHashValue(o);n[o]=s,e.model.get(o)!=s&&i.push(o)}),this.initialHashChange=!0,this.model.setMultiple(n),i},n.prototype.getHashValue=function(t){o.Assert.isNonEmptyString(t);var e;try{e=this.hashUtils.getValue(t,this.hashUtils.getHash(this.windoh))}catch(e){this.logger.error("Could not parse parameter "+t+" from URI")}return h.Utils.isUndefined(e)&&(e=this.model.defaultAttributes[t]),e},n.prototype.debugInfo=function(){return{state:this.model.getAttributes()}},n.ID="HistoryController",n.attributesThatDoNotTriggerQuery=["quickview"],n}(c.RootComponent);e.HistoryController=p}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(58),r=n(14),s=n(15),a=n(77);e.MODEL_EVENTS={PREPROCESS:"preprocess",CHANGE_ONE:"change:",CHANGE:"change",RESET:"reset",ALL:"all"};var u=function(e){function n(t,n,i){e.call(this,t,n),this.eventNameSpace=n,this.defaultAttributes=s.Utils.extendDeep(this.defaultAttributes,i),this.attributes=i,this.logger.debug("Creating model")}return i(n,e),n.prototype.set=function(t,e,n){var i={};i[t]=e,this.setMultiple(i,n)},n.prototype.getAttributes=function(){var e=this,n={};return t.each(this.attributes,function(i,o){t.isObject(i)?s.Utils.objectEqual(i,e.defaultAttributes[o])||(n[o]=i):i!=e.defaultAttributes[o]&&(n[o]=i);
}),n},n.prototype.setMultiple=function(e,n){var i=this,o=!1;this.preprocessEvent(e),t.each(e,function(t,e){n&&n.customAttribute||i.checkIfAttributeExists(e),t=i.parseToCorrectType(e,t),(n&&!n.validateType||i.typeIsValid(e,t))&&i.checkIfAttributeChanged(e,t)&&(i.attributes[e]=t,o=!0,null!=n&&n.silent||i.attributeHasChangedEvent(e))}),!o||null!=n&&n.silent||(this.attributesHasChangedEvent(),this.anyEvent())},n.prototype.setNewDefault=function(t,e,n){n&&n.customAttribute||this.checkIfAttributeExists(t),this.defaultAttributes[t]=e},n.prototype.setDefault=function(t){this.set(t,this.defaultAttributes[t])},n.prototype.get=function(t){return void 0==t?this.attributes:this.attributes[t]},n.prototype.getDefault=function(t){return void 0==t?this.defaultAttributes:this.defaultAttributes[t]},n.prototype.reset=function(){this.setMultiple(this.defaultAttributes),this.modelWasResetEvent()},n.prototype.registerNewAttribute=function(t,e){this.defaultAttributes[t]=e,this.attributes[t]=e},n.prototype.getEventName=function(t){return this.eventNameSpace+":"+t},n.prototype.attributesHasChangedEvent=function(){o.$$(this.element).trigger(this.getEventName(n.eventTypes.change),this.createAttributesChangedArgument())},n.prototype.attributeHasChangedEvent=function(t){o.$$(this.element).trigger(this.getEventName(n.eventTypes.changeOne)+t,this.createAttributeChangedArgument(t))},n.prototype.preprocessEvent=function(t){o.$$(this.element).trigger(this.getEventName(n.eventTypes.preprocess),t)},n.prototype.modelWasResetEvent=function(){o.$$(this.element).trigger(this.getEventName(n.eventTypes.reset),this.createModelChangedArgument())},n.prototype.anyEvent=function(){o.$$(this.element).trigger(this.getEventName(n.eventTypes.all),this.createModelChangedArgument())},n.prototype.createAttributeChangedArgument=function(t){return{attribute:t,value:this.attributes[t]}},n.prototype.createAttributesChangedArgument=function(){return{attributes:this.attributes}},n.prototype.createModelChangedArgument=function(){return{model:this}},n.prototype.checkIfAttributeExists=function(e){r.Assert.check(t.has(this.attributes,e))},n.prototype.typeIsValid=function(e,n){return!(!s.Utils.isNullOrUndefined(this.attributes[e])&&!s.Utils.isUndefined(n))||(t.isNumber(this.attributes[e])?this.validateNumber(e,n):t.isBoolean(this.attributes[e])?this.validateBoolean(e,n):this.validateOther(e,n))},n.prototype.validateNumber=function(e,n){return!(!t.isNumber(n)||isNaN(n))||(this.logger.error("Non-matching type for "+e+". Expected number and got "+n),!1)},n.prototype.validateBoolean=function(e,n){return!(!t.isBoolean(n)&&void 0!==!s.Utils.parseBooleanIfNotUndefined(n))||(this.logger.error("Non matching type for "+e+". Expected boolean and got "+n),!1)},n.prototype.validateOther=function(t,e){return!(!s.Utils.isNullOrUndefined(this.defaultAttributes[t])&&typeof e!=typeof this.defaultAttributes[t])||(this.logger.error("Non-matching type for "+t+". Expected "+typeof this.defaultAttributes[t]+" and got "+e),!1)},n.prototype.parseToCorrectType=function(e,n){return t.isNumber(this.attributes[e])?parseInt(n,10):t.isBoolean(this.attributes[e])?t.isBoolean(n)?n:s.Utils.parseBooleanIfNotUndefined(n):n},n.prototype.checkIfAttributeChanged=function(e,n){var i=this.attributes[e];return t.isNumber(i)||t.isString(i)||t.isBoolean(i)?i!==n:t.isArray(i)?!s.Utils.arrayEqual(i,n):!t.isObject(i)||!s.Utils.objectEqual(i,n)},n.prototype.debugInfo=function(){return null},n.eventTypes={preprocess:"preprocess",changeOne:"change:",change:"change",reset:"reset",all:"all"},n}(a.BaseComponent);e.Model=u}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(70),r=n(98),s=n(13),a=n(14),u=n(45),l=n(76),c=n(58),h=function(e){function n(t,i,l,h){var p=this;e.call(this,t,n.ID),this.windoh=i,this.model=l,this.queryController=h,this.omit=[],i.localStorage?(this.storage=new o.LocalStorageUtils(n.ID),a.Assert.exists(this.model),a.Assert.exists(this.queryController),c.$$(this.element).on(u.InitializationEvents.restoreHistoryState,function(){return p.updateModelFromLocalStorage()}),c.$$(this.element).on(this.model.getEventName(r.Model.eventTypes.all),function(){return p.updateLocalStorageFromModel()})):new s.Logger(t).info("No local storage available in current browser. LocalStorageHistoryController cannot initialize itself",this)}return i(n,e),n.prototype.withoutThoseAttribute=function(t){this.omit=t},n.prototype.updateLocalStorageFromModel=function(){var e=t.omit(this.model.getAttributes(),this.omit);this.setStorageValues(e),this.logger.debug("Saving state to localstorage",e)},n.prototype.updateModelFromLocalStorage=function(){var e=this,n={},i=this.storage.load();t.each(this.model.attributes,function(t,o,r){var s=i?i[o]:void 0;void 0==s&&(s=e.model.defaultAttributes[o]),n[o]=s}),this.model.setMultiple(n)},n.prototype.setStorageValues=function(t){this.storage.save(t)},n.ID="LocalStorageHistoryController",n}(l.RootComponent);e.LocalStorageHistoryController=h}).call(e,n(10))},function(t,e,n){"use strict";var i=n(98);e.Model=i.Model;var o=n(101);e.QueryStateModel=o.QueryStateModel;var r=n(102);e.ComponentOptionsModel=r.ComponentOptionsModel;var s=n(103);e.ComponentStateModel=s.ComponentStateModel},function(t,e,n){(function(t){"use strict";function i(e,n){if(s.Assert.exists(e),0==n.length||void 0==n[0])return e;if(1==n.length&&a.Utils.isNonEmptyString(n[0]))return e.get(n[0]);if(t.isObject(n[0])){var i=n[0],o=t.extend({customAttribute:!0},n[1]);return e.setMultiple(i,o)}if(n.length>1){var r=n[0],u=n[1],o=t.extend({customAttribute:!0},n[2]);return s.Assert.isNonEmptyString(r),e.set(r,u,o)}}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(98),s=n(14),a=n(15);e.QUERY_STATE_ATTRIBUTES={Q:"q",FIRST:"first",T:"t",TG:"tg",SORT:"sort",HD:"hd",HQ:"hq",QUICKVIEW:"quickview"};var u=function(e){function n(i,o){var r=t.extend({},n.defaultAttributes,o);e.call(this,i,n.ID,r)}return o(n,e),n.getFacetId=function(t,e){return void 0===e&&(e=!0),"f:"+t+(e?"":":not")},n.getFacetOperator=function(t){return"f:"+t+":operator"},n.getFacetLookupValue=function(t){return n.getFacetId(t)+":lookupvalues"},n.prototype.atLeastOneFacetIsActive=function(){return!t.isUndefined(t.find(this.attributes,function(t,e){return 0==e.indexOf("f:")&&a.Utils.isNonEmptyArray(t)&&e.indexOf(":range")<0}))},n.prototype.set=function(t,n,i){this.validate(t,n),e.prototype.set.call(this,t,n,i)},n.prototype.validate=function(t,e){t==n.attributesEnum.first&&(s.Assert.isNumber(e),s.Assert.isLargerOrEqualsThan(0,e))},n.ID="state",n.defaultAttributes={q:"",first:0,t:"",hd:"",hq:"",sort:"",tg:"",quickview:""},n.attributesEnum={q:"q",first:"first",t:"t",sort:"sort",hd:"hd",hq:"hq",tg:"tg",quickview:"quickview"},n}(r.Model);e.QueryStateModel=u,e.setState=i}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(98),r=function(e){function n(i,o){var r=t.extend({},n.defaultAttributes,o);e.call(this,i,n.ID,r)}return i(n,e),n.ID="ComponentOptions",n.defaultAttributes={resultLink:void 0,searchHub:void 0},n.attributesEnum={resultLink:"resultLink",searchHub:"searchHub"},n}(o.Model);e.ComponentOptionsModel=r}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(98),r=function(t){function e(n){t.call(this,n,e.ID,{})}return i(e,t),e.prototype.registerComponent=function(t,e){var n=this.attributes[t];void 0==n?this.attributes[t]=[e]:this.attributes[t].push(e)},e.ID="ComponentState",e}(o.Model);e.ComponentStateModel=r},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(105));var o=n(109);e.ComponentOptions=o.ComponentOptions,e.ComponentOptionsType=o.ComponentOptionsType;var r=n(107);e.Component=r.Component;var s=n(77);e.BaseComponent=s.BaseComponent;var a=n(76);e.RootComponent=a.RootComponent;var u=n(78);e.QueryBuilder=u.QueryBuilder;var l=n(79);e.ExpressionBuilder=l.ExpressionBuilder;var c=n(106);e.Initialization=c.Initialization;var h=n(106);e.CoveoJQuery=h.Initialization;var p=n(169);e.initCoveoJQuery=p.initCoveoJQuery},function(t,e,n){(function(t){"use strict";function i(t,e){void 0===e&&(e={}),S.Initialization.initializeFramework(t,e,function(){S.Initialization.initSearchInterface(t,e)})}function o(e,n,i){void 0===i&&(i={}),x.Assert.isNonEmptyString(n);var o={};o.searchPageUri=n,o.autoTriggerQuery=!1,o.hideUntilFirstQuery=!1,o.enableHistory=!1,i=t.extend({},i,{StandaloneSearchInterface:o}),S.Initialization.initializeFramework(e,i,function(){S.Initialization.initStandaloneSearchInterface(e,i)})}function r(e,n,i,o){void 0===o&&(o={});var r={};r.mainSearchInterface=n,r.userContext=JSON.stringify(i),r.enableHistory=!1,o=t.extend({},o,{Recommendation:r}),S.Initialization.initializeFramework(e,o,function(){S.Initialization.initRecommendationInterface(e,o)})}function s(t){x.Assert.exists(t);var e=O.Component.resolveBinding(t,C.QueryController);return x.Assert.exists(e),e.executeQuery()}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];x.Assert.exists(t);var i=O.Component.resolveBinding(t,E.QueryStateModel);return E.setState(i,e)}function u(t,e,n){return x.Assert.exists(t),O.Component.get(t,e,n)}function l(t,e){return x.Assert.exists(t),O.Component.getResult(t,e)}function c(t){var e=h(t);return e?e.client:void 0}function h(t){var e=T.$$(t).find("."+O.Component.computeCssClassName(w.Analytics));return e?O.Component.get(e):void 0}function p(t,e,n){var i=c(t);i&&i.logCustomEvent(e,n,t)}function d(t,e,n){var i=c(t);i&&i.logSearchEvent(e,n)}function f(t,e,n){var i=c(t);i&&i.logSearchAsYouType(e,n)}function g(t,e,n,i){var o=c(t);o&&o.logClickEvent(e,n,i,t)}function m(t,e){void 0===e&&(e={}),S.Initialization.registerDefaultOptions(t,e)}function v(t,e,n){S.Initialization.monkeyPatchComponentMethod(e,t,n)}function y(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o,r,s={};0==n.length?(o="Standard",r=!1):1==n.length?"string"==typeof n[0]?(o=n[0],r=!0):"object"==typeof n[0]?(o="Standard",r=!1,s=n[0]):x.Assert.fail("Invalid parameters to init a box"):2==n.length&&(o=n[0],s=n[1],r=!0);var a={};a[o||"Container"]=t.extend({},s.SearchInterface,s[o]),s=t.extend({},s,a),S.Initialization.initializeFramework(e,s,function(){S.Initialization.initBoxInterface(e,s,o,r)})}function b(t){T.$$(t).trigger(A.InitializationEvents.nuke)}var S=n(106),x=n(14),C=n(75),E=n(101),w=n(122),A=n(45),T=n(58),O=n(107);e.init=i,S.Initialization.registerNamedMethod("init",function(t,e){void 0===e&&(e={}),i(t,e)}),e.initSearchbox=o,S.Initialization.registerNamedMethod("initSearchbox",function(t,e,n){void 0===n&&(n={}),o(t,e,n)}),e.initRecommendation=r,S.Initialization.registerNamedMethod("initRecommendation",function(t,e,n,i){void 0===n&&(n={}),void 0===i&&(i={}),r(t,e,n,i)}),e.executeQuery=s,S.Initialization.registerNamedMethod("executeQuery",function(t){return s(t)}),e.state=a,S.Initialization.registerNamedMethod("state",function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return 0!=e.length?a.apply(void 0,[t].concat(e)):a.apply(void 0,[t])}),e.get=u,S.Initialization.registerNamedMethod("get",function(t,e,n){return u(t,e,n)}),e.result=l,S.Initialization.registerNamedMethod("result",function(t,e){return l(t,e)}),e.logCustomEvent=p,S.Initialization.registerNamedMethod("logCustomEvent",function(t,e,n){p(t,e,n)}),e.logSearchEvent=d,S.Initialization.registerNamedMethod("logSearchEvent",function(t,e,n){d(t,e,n)}),e.logSearchAsYouTypeEvent=f,S.Initialization.registerNamedMethod("logSearchAsYouTypeEvent",function(t,e,n){f(t,e,n)}),e.logClickEvent=g,S.Initialization.registerNamedMethod("logClickEvent",function(t,e,n,i){g(t,e,n,i)}),e.options=m,S.Initialization.registerNamedMethod("options",function(t,e){void 0===e&&(e={}),m(t,e)}),e.patch=v,S.Initialization.registerNamedMethod("patch",function(t,e,n){v(t,e,n)}),e.initBox=y,S.Initialization.registerNamedMethod("initBox",function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];y(t,e)}),e.nuke=b,S.Initialization.registerNamedMethod("nuke",function(t){b(t)})}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(13),o=n(107),r=n(15),s=n(14),a=n(58),u=n(45),l=n(108),c=n(75),h=n(66),p=n(101),d=n(103),f=n(102),g=n(121),m=n(18),v=function(){function e(){}return e.registerDefaultOptions=function(t,e){var n=t.CoveoDefaultOptions||{},i=r.Utils.extendDeep(n,e);t.CoveoDefaultOptions=i},e.resolveDefaultOptions=function(t,n){var i,o=t.CoveoDefaultOptions;return i=r.Utils.exists(o)?r.Utils.extendDeep(o,n):n,t.parentElement?e.resolveDefaultOptions(t.parentElement,i):i},e.registerAutoCreateComponent=function(t){s.Assert.exists(t),s.Assert.exists(t.ID),s.Assert.doesNotExists(e.autoCreateComponents[t.ID]),s.Assert.doesNotExists(e.namedMethods[t.ID]),e.autoCreateComponents[t.ID]=t},e.isComponentClassIdRegistered=function(t){return r.Utils.exists(e.autoCreateComponents[t])},e.getListOfRegisteredComponents=function(){return t.keys(e.autoCreateComponents)},e.getRegisteredComponent=function(t){return e.autoCreateComponents[t]},e.initializeFramework=function(n,i,r){s.Assert.exists(n);var h=o.Component.get(n,c.QueryController,!0);if(h)return void this.logger.error("This DOM element has already been initialized as a search interface, skipping initialization",n);i=e.resolveDefaultOptions(n,i),e.performInitFunctionsOption(i,u.InitializationEvents.beforeInitialization),a.$$(n).trigger(u.InitializationEvents.beforeInitialization),r(n,i),e.initExternalComponents(n,i),e.performInitFunctionsOption(i,u.InitializationEvents.afterComponentsInitialization),a.$$(n).trigger(u.InitializationEvents.afterComponentsInitialization),a.$$(n).trigger(u.InitializationEvents.restoreHistoryState),e.performInitFunctionsOption(i,u.InitializationEvents.afterInitialization),a.$$(n).trigger(u.InitializationEvents.afterInitialization);var p=o.Component.get(n,l.SearchInterface),d=a.$$(n).findAll(".coveo-hide-until-loaded");t.each(d,function(t){a.$$(t).removeClass("coveo-hide-until-loaded"),a.$$(t).addClass("coveo-show-after-loaded")}),p.options.autoTriggerQuery&&(e.logFirstQueryCause(p),o.Component.get(n,c.QueryController).executeQuery({logInActionsHistory:Coveo.Recommendation&&p instanceof Coveo.Recommendation,isFirstQuery:!0}))},e.initSearchInterface=function(t,n){void 0===n&&(n={}),n=e.resolveDefaultOptions(t,n);var i=new l.SearchInterface(t,n.SearchInterface,n.Analytics);i.options.originalOptionsObject=n;var o={options:n,bindings:i.getBindings()};e.automaticallyCreateComponentsInside(t,o,["Recommendation"])},e.initStandaloneSearchInterface=function(t,n){void 0===n&&(n={}),n=e.resolveDefaultOptions(t,n),n.Querybox||(n.Querybox={}),n.Omnibox||(n.Omnibox={}),n.Searchbox||(n.Searchbox={}),n.Querybox.triggerQueryOnClear&&n.Omnibox.triggerQueryOnClear&&n.Searchbox.triggerOnQueryClear||(n.Querybox.triggerQueryOnClear=!1,n.Omnibox.triggerQueryOnClear=!1,n.Searchbox.triggerQueryOnClear=!1);var i=new l.StandaloneSearchInterface(t,n.StandaloneSearchInterface,n.Analytics);i.options.originalOptionsObject=n;var o={options:n,bindings:i.getBindings()};e.automaticallyCreateComponentsInside(t,o)},e.initRecommendationInterface=function(n,i){void 0===i&&(i={}),i=e.resolveDefaultOptions(n,i);var o=t.extend({},i.SearchInterface,i.Recommendation);o.mainSearchInterface&&(o.firstLoadingAnimation=a.$$("span").el);var r=new window.Coveo.Recommendation(n,o,i.Analytics);r.options.originalOptionsObject=i;var s={options:i,bindings:r.getBindings()};e.automaticallyCreateComponentsInside(n,s)},e.automaticallyCreateComponentsInside=function(n,i,r){s.Assert.exists(n);var u=[],l=[];t.each(r,function(t){var e=a.$$(n).find("."+o.Component.computeCssClassNameForType(t));if(e){var i=a.$$(e).findAll("*");l=l.concat(i)}});for(var c in e.autoCreateComponents)if(!t.contains(r,c)){var h=e.autoCreateComponents[c],p=o.Component.computeCssClassName(h),d=a.$$(n).findAll("."+p);d=t.difference(d,l),a.$$(n).hasClass(p)&&!t.contains(l,n)&&d.push(n),0!=d.length&&u.push(e.createFunctionThatInitializesComponentOnElements(d,c,h,i))}t.each(u,function(t){return t()})},e.createComponentOfThisClassOnElement=function(n,i,o){s.Assert.isNonEmptyString(n),s.Assert.exists(i);var r=e.autoCreateComponents[n];s.Assert.exists(r);var a={},u={},l=void 0;return void 0!=o&&(t.each(o.bindings,function(t,e){a[e]=t}),u=o.options,l=o.result),e.logger.trace("Creating component of class "+n,i,u),new r(i,u,a,l)},e.registerNamedMethod=function(t,n){s.Assert.isNonEmptyString(t),s.Assert.doesNotExists(e.autoCreateComponents[t]),s.Assert.doesNotExists(e.namedMethods[t]),s.Assert.exists(n),e.namedMethods[t]=n},e.isNamedMethodRegistered=function(t){return r.Utils.exists(e.namedMethods[t])},e.monkeyPatchComponentMethod=function(t,e,n){s.Assert.isNonEmptyString(t),s.Assert.exists(n);var i;if(t.indexOf(".")>0){var a=t.split(".");s.Assert.check(2==a.length,"Invalid method name, correct syntax is CoveoComponent.methodName."),i=a[0],t=a[1]}var u=o.Component.get(e,i);s.Assert.exists(u),s.Assert.exists(u[t]);var l="__"+t;r.Utils.exists(u[l])||(u[l]=u[t]),u[t]=n},e.initBoxInterface=function(t,n,r,a){void 0===n&&(n={}),void 0===r&&(r="Standard"),void 0===a&&(a=!0),n=e.resolveDefaultOptions(t,n);var u="Box";"Standard"!=r&&(u+="For"+r);var l=o.Component.getComponentRef(u);if(l){new i.Logger(t).info("Initializing box of type "+u);var c=a?l.getInjection:function(){},h=new l(t,n[u],n.Analytics,c,n);h.options.originalOptionsObject=n;var p={options:n,bindings:h.getBindings()};e.automaticallyCreateComponentsInside(t,p)}else new i.Logger(t).error("Trying to initialize box of type : "+u+" but not found in code (not compiled)!"),s.Assert.fail("Cannot initialize unknown type of box")},e.dispatchNamedMethodCall=function(t,n,i){s.Assert.isNonEmptyString(t),s.Assert.exists(n);var o=e.namedMethods[t];return s.Assert.exists(o),e.logger.trace("Dispatching named method call of "+t,n,i),0!=i.length?o.apply(null,[n].concat(i)):o.apply(null,[n])},e.dispatchNamedMethodCallOrComponentCreation=function(t,n,i){return s.Assert.isNonEmptyString(t),s.Assert.exists(n),e.isNamedMethodRegistered(t)?e.dispatchNamedMethodCall(t,n,i):e.isComponentClassIdRegistered(t)?e.createComponentOfThisClassOnElement(t,n,i[0]):e.isThereASingleComponentBoundToThisElement(n)?e.dispatchMethodCallOnBoundComponent(t,n,i):void s.Assert.fail("No method or component named "+t+" are registered.")},e.isSearchFromLink=function(t){return r.Utils.isNonEmptyString(t.getBindings().queryStateModel.get("q"))},e.isThereASingleComponentBoundToThisElement=function(t){return s.Assert.exists(t),r.Utils.exists(o.Component.get(t))},e.dispatchMethodCallOnBoundComponent=function(t,e,n){s.Assert.isNonEmptyString(t),s.Assert.exists(e);var i=o.Component.get(e);s.Assert.exists(i);var a=i[t];return r.Utils.exists(a)?a.apply(i,n):void s.Assert.fail("No method named "+t+" exist on component "+i.type)},e.logFirstQueryCause=function(t){var n=h.HashUtils.getValue("firstQueryCause",h.HashUtils.getHash());if(null!=n){var i=h.HashUtils.getValue("firstQueryMeta",h.HashUtils.getHash())||{};t.usageAnalytics.logSearchEvent(g.analyticsActionCauseList[n],i)}else e.isSearchFromLink(t)?t.usageAnalytics.logSearchEvent(g.analyticsActionCauseList.searchFromLink,{}):t.usageAnalytics.logSearchEvent(g.analyticsActionCauseList.interfaceLoad,{})},e.performInitFunctionsOption=function(t,n){r.Utils.exists(t)&&e.performFunctions(t[n])},e.performFunctions=function(e){r.Utils.exists(e)&&t.each(e,function(t){"function"==typeof t&&t()})},e.initExternalComponents=function(n,i){if(i&&i.externalComponents){var a=o.Component.get(n,l.SearchInterface),u=o.Component.get(n,p.QueryStateModel),h=o.Component.get(n,d.ComponentStateModel),g=o.Component.get(n,c.QueryController),v=o.Component.get(n,f.ComponentOptionsModel),y=a.usageAnalytics;s.Assert.exists(a),s.Assert.exists(u),s.Assert.exists(g),s.Assert.exists(h),s.Assert.exists(y);var b={options:i,bindings:{searchInterface:a,queryStateModel:u,queryController:g,usageAnalytics:y,componentStateModel:h,componentOptionsModel:v,root:n}};t.each(i.externalComponents,function(t){var n=t;r.Utils.isHtmlElement(n)?e.automaticallyCreateComponentsInside(n,b):m.JQueryUtils.isInstanceOfJQuery(n)&&e.automaticallyCreateComponentsInside(n.get(0),b)})}},e.createFunctionThatInitializesComponentOnElements=function(n,i,s,a){return function(){t.each(n,function(n){if(null==o.Component.get(n,i)){var u=void 0;if(r.Utils.exists(a.options)){var l=a.options[i],c=a.options[n.id],h=a.options.initOptions?a.options.initOptions[i]:{};u=r.Utils.extendDeep(c,h),u=r.Utils.extendDeep(l,u)}var p=t.extend({},a,{options:u});e.createComponentOfThisClassOnElement(s.ID,n,p)}})}},e.logger=new i.Logger("Initialization"),e.autoCreateComponents={},e.namedMethods={},e}();e.Initialization=v}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(14),r=n(15),s=n(18),a=n(58),u=n(101),l=n(103),c=n(102),h=n(75),p=n(108),d=n(116),f=n(77),g=n(43),m=function(e){function n(n,i,o){var r=this;void 0===o&&(o={}),e.call(this,n,i),this.element=n,this.type=i,this.bind=new v(this),this.root=o.root||this.resolveRoot(),this.queryStateModel=o.queryStateModel||this.resolveQueryStateModel(),this.componentStateModel=o.componentStateModel||this.resolveComponentStateModel(),this.queryController=o.queryController||this.resolveQueryController(),this.searchInterface=o.searchInterface||this.resolveSearchInterface(),this.usageAnalytics=o.usageAnalytics||this.resolveUA(),this.componentOptionsModel=o.componentOptionsModel||this.resolveComponentOptionsModel(),this.ensureDom=t.once(function(){return r.createDom()}),null!=this.searchInterface&&this.searchInterface.attachComponent(i,this),this.initDebugInfo()}return i(n,e),n.prototype.getBindings=function(){return{root:this.root,queryStateModel:this.queryStateModel,queryController:this.queryController,searchInterface:this.searchInterface,componentStateModel:this.componentStateModel,componentOptionsModel:this.componentOptionsModel,usageAnalytics:this.usageAnalytics}},n.prototype.createDom=function(){},n.prototype.resolveSearchInterface=function(){return n.resolveBinding(this.element,p.SearchInterface)},n.prototype.resolveRoot=function(){var t=n.resolveBinding(this.element,p.SearchInterface);return t?t.element:void 0},n.prototype.resolveQueryController=function(){return n.resolveBinding(this.element,h.QueryController)},n.prototype.resolveComponentStateModel=function(){return n.resolveBinding(this.element,l.ComponentStateModel)},n.prototype.resolveQueryStateModel=function(){return n.resolveBinding(this.element,u.QueryStateModel)},n.prototype.resolveComponentOptionsModel=function(){return n.resolveBinding(this.element,c.ComponentOptionsModel)},n.prototype.resolveUA=function(){var t=this.resolveSearchInterface();return t&&t.usageAnalytics?t.usageAnalytics:new d.NoopAnalyticsClient},n.prototype.resolveResult=function(){return n.getResult(this.element)},n.prototype.initDebugInfo=function(){var t=this;a.$$(this.element).on("dblclick",function(e){if(e.altKey){var n=t.debugInfo();null!=n&&a.$$(t.root).trigger(g.DebugEvents.showDebugPanel,t.debugInfo())}})},n.get=function(e,i,s){if(o.Assert.exists(e),t.isString(i))return e[n.computeCssClassNameForType(i)];if(r.Utils.exists(i))return o.Assert.exists(i.ID),e[n.computeCssClassNameForType(i.ID)];var a=f.BaseComponent.getBoundComponentsForElement(e);return s||o.Assert.check(a.length<=1,"More than one component is bound to this element. You need to specify the component type."),a[0]},n.getResult=function(t,e){void 0===e&&(e=!1);var n=a.$$(t).closest(".CoveoResult");return o.Assert.check(e||void 0!=n),n.CoveoResult},n.bindResultToElement=function(t,e){o.Assert.exists(t),o.Assert.exists(e),a.$$(t).addClass("CoveoResult"),t.CoveoResult=e},n.resolveBinding=function(t,e){o.Assert.exists(t),o.Assert.exists(e),o.Assert.exists(e.ID);var i;if(a.$$(t).is("."+n.computeCssClassNameForType(e.ID)))i=t;else{var r=a.$$(t).findClass(n.computeCssClassNameForType(e.ID));if(r&&0!=r.length)i=r;else{var s=a.$$(t).closest(n.computeCssClassNameForType(e.ID));s&&(i=s)}}return i?i[n.computeCssClassNameForType(e.ID)]:void 0},n.pointElementsToDummyForm=function(e){var n=a.$$(e).is("input")?[e]:[];n=n.concat(a.$$(e).findAll("input")),t.each(t.compact(n),function(t){t.setAttribute("form","coveo-dummy-form")})},n}(f.BaseComponent);e.Component=m;var v=function(){function t(t){this.owner=t,o.Assert.exists(t)}return t.prototype.on=function(t,e,n){if(s.JQueryUtils.getJQuery()&&s.JQueryUtils.isInstanceOfJQuery(t)){var i=t;i.on(e,this.wrapToCallIfEnabled(n))}else{var o=t;a.$$(o).on(e,this.wrapToCallIfEnabled(n))}},t.prototype.one=function(t,e,n){if(t instanceof HTMLElement){var i=t;a.$$(i).one(e,this.wrapToCallIfEnabled(n))}else{var o=t;o.one(e,this.wrapToCallIfEnabled(n))}},t.prototype.onRootElement=function(t,e){this.on(this.owner.root,t,e)},t.prototype.oneRootElement=function(t,e){this.one(this.owner.root,t,e)},t.prototype.onQueryState=function(t,e,n){this.onRootElement(this.getQueryStateEventName(t,e),n)},t.prototype.oneQueryState=function(t,e,n){this.oneRootElement(this.getQueryStateEventName(t,e),n)},t.prototype.trigger=function(t,e,n){this.wrapToCallIfEnabled(function(){if(t instanceof HTMLElement){var i=t;a.$$(i).trigger(e,n)}else{var o=t;o.trigger(e,n)}})(n)},t.prototype.wrapToCallIfEnabled=function(t){var e=this;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i-0]=arguments[i];if(!e.owner.disabled)return n&&n[0]instanceof CustomEvent?n[0].detail&&(n=[n[0].detail]):n&&s.JQueryUtils.isInstanceOfJqueryEvent(n[0])&&(n=void 0!=n[1]?[n[1]]:[]),t.apply(e.owner,n)}},t.prototype.getQueryStateEventName=function(t,e){var n;return n=t&&e?this.owner.queryStateModel.getEventName(t+e):this.owner.queryStateModel.getEventName(t)},t}();e.ComponentEvents=v}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(9),r=n(109),s=n(17),a=n(58),u=n(59),l=n(14),c=n(101),h=n(103),p=n(102),d=n(75),f=n(98),g=n(48),m=n(53),v=n(97),y=n(99),b=n(45),S=n(116),x=n(15),C=n(76),E=n(77),w=n(117),A=n(66),T=n(118),O=n(119),_=n(120),M=n(121),N=function(e){function n(t,i,o,u){var m=this;void 0===u&&(u=window),e.call(this,t,n.ID),this.element=t,this.options=i,this.analyticsOptions=o,this.isNewDesignAttribute=!1,s.DeviceUtils.isMobileDevice()&&a.$$(document.body).addClass("coveo-mobile-device"),T.attach(t),this.options=r.ComponentOptions.initComponentOptions(t,n,i),l.Assert.exists(t),l.Assert.exists(this.options),this.options.hideUntilFirstQuery&&this.showAndHideFirstQueryAnimation(),this.root=t,this.queryStateModel=new c.QueryStateModel(t),this.componentStateModel=new h.ComponentStateModel(t),this.componentOptionsModel=new p.ComponentOptionsModel(t),this.usageAnalytics=this.initializeAnalytics(),this.queryController=new d.QueryController(t,this.options,this.usageAnalytics,this),new _.SentryLogger(this.queryController);var S=this.queryStateModel.getEventName(f.Model.eventTypes.preprocess);a.$$(this.element).on(S,function(t,e){return m.handlePreprocessQueryStateModel(e)}),a.$$(this.element).on(g.QueryEvents.buildingQuery,function(t,e){return m.handleBuildingQuery(e)}),a.$$(this.element).on(g.QueryEvents.querySuccess,function(t,e){return m.handleQuerySuccess(e)}),a.$$(this.element).on(g.QueryEvents.queryError,function(t,e){return m.handleQueryError(e)}),this.options.enableHistory?this.options.useLocalStorageForHistory?new y.LocalStorageHistoryController(t,u,this.queryStateModel,this.queryController):new v.HistoryController(t,u,this.queryStateModel,this.queryController):a.$$(this.element).on(b.InitializationEvents.restoreHistoryState,function(){return m.queryStateModel.setMultiple(m.queryStateModel.defaultAttributes)});var x=this.queryStateModel.getEventName(f.Model.eventTypes.changeOne+c.QueryStateModel.attributesEnum.quickview);a.$$(this.element).on(x,function(t,e){return m.handleQuickviewChanged(e)}),this.element.style.display=t.style.display||"block",this.setupDebugInfo(),this.isNewDesignAttribute="new"==this.root.getAttribute("data-design")}return i(n,e),n.prototype.showWaitAnimation=function(){a.$$(this.options.firstLoadingAnimation).detach(),a.$$(this.element).addClass("coveo-waiting-for-first-query"),this.element.appendChild(this.options.firstLoadingAnimation)},n.prototype.hideWaitAnimation=function(){a.$$(this.options.firstLoadingAnimation).detach(),a.$$(this.element).removeClass("coveo-waiting-for-first-query")},n.prototype.attachComponent=function(t,e){this.getComponents(t).push(e)},n.prototype.detachComponent=function(e,n){var i=this.getComponents(e),o=t.indexOf(i,n);o>-1&&i.splice(o,1)},n.prototype.getBindings=function(){return{root:this.root,queryStateModel:this.queryStateModel,queryController:this.queryController,searchInterface:this,componentStateModel:this.componentStateModel,componentOptionsModel:this.componentOptionsModel,usageAnalytics:this.usageAnalytics}},n.prototype.getComponents=function(t){return null==this.attachedComponents&&(this.attachedComponents={}),t in this.attachedComponents||(this.attachedComponents[t]=[]),this.attachedComponents[t]},n.prototype.isNewDesign=function(){return this.isNewDesignAttribute},n.prototype.initializeAnalytics=function(){var t=E.BaseComponent.getComponentRef("Analytics");return t?t.create(this.element,this.analyticsOptions):new S.NoopAnalyticsClient},n.prototype.setupDebugInfo=function(){var t=this;this.options.enableDebugInfo&&setTimeout(function(){return new w.Debug(t.element,t.queryController)})},n.prototype.showAndHideFirstQueryAnimation=function(){var e=this;this.showWaitAnimation(),a.$$(this.element).one(g.QueryEvents.querySuccess,function(){t.defer(function(){return e.hideWaitAnimation()})}),a.$$(this.element).one(g.QueryEvents.queryError,function(){t.defer(function(){return e.hideWaitAnimation()})})},n.prototype.handlePreprocessQueryStateModel=function(t){var e=this.queryStateModel.get(c.QueryStateModel.attributesEnum.tg),n=this.queryStateModel.get(c.QueryStateModel.attributesEnum.t),i=e,o=n;void 0!==t.tg&&(t.tg=this.getTabGroupId(t.tg),i!=t.tg&&(t.t=t.t||c.QueryStateModel.defaultAttributes.t,t.sort=t.sort||c.QueryStateModel.defaultAttributes.sort,i=t.tg)),void 0!==t.t&&(t.t=this.getTabId(i,t.t),o!=t.t&&(t.sort=t.sort||c.QueryStateModel.defaultAttributes.sort,o=t.t)),void 0!==t.sort&&(t.sort=this.getSort(o,t.sort)),void 0!==t.quickview&&(t.quickview=this.getQuickview(t.quickview))},n.prototype.getTabGroupId=function(e){var n=E.BaseComponent.getComponentRef("TabGroup");if(n){var i=this.getComponents(n.ID);if(e!=c.QueryStateModel.defaultAttributes.tg&&t.any(i,function(t){return!t.disabled&&e==t.options.id}))return e;if(i.length>0)return i[0].options.id}return c.QueryStateModel.defaultAttributes.tg},n.prototype.getTabId=function(e,n){var i=E.BaseComponent.getComponentRef("Tab"),o=E.BaseComponent.getComponentRef("TabGroup");if(i){var r=this.getComponents(i.ID);if(o&&e!=c.QueryStateModel.defaultAttributes.tg){var s=this.getComponents(o.ID),a=t.find(s,function(t){return e==t.options.id});if(n!=c.QueryStateModel.defaultAttributes.t&&t.any(r,function(t){return n==t.options.id&&a.isElementIncludedInTabGroup(t.element)}))return n;var u=t.find(r,function(t){
return a.isElementIncludedInTabGroup(t.element)});return null!=u?u.options.id:c.QueryStateModel.defaultAttributes.t}if(n!=c.QueryStateModel.defaultAttributes.t&&t.any(r,function(t){return n==t.options.id}))return n;if(r.length>0)return r[0].options.id}return c.QueryStateModel.defaultAttributes.t},n.prototype.getSort=function(e,n){var i=E.BaseComponent.getComponentRef("Sort");if(i){var o=this.getComponents(i.ID),r=E.BaseComponent.getComponentRef("Tab");if(r&&e!=c.QueryStateModel.defaultAttributes.t){var s=this.getComponents(r.ID),a=t.find(s,function(t){return e==t.options.id}),u=a.options.sort;if(n!=c.QueryStateModel.defaultAttributes.sort&&t.any(o,function(t){return a.isElementIncludedInTab(t.element)&&t.match(n)}))return n;if(null!=u)return u.toString();var l=t.find(o,function(t){return a.isElementIncludedInTab(t.element)});return null!=l?l.options.sortCriteria[0].toString():c.QueryStateModel.defaultAttributes.sort}if(n!=c.QueryStateModel.defaultAttributes.sort&&t.any(o,function(t){return t.match(n)}))return n;if(o.length>0)return o[0].options.sortCriteria[0].toString()}return c.QueryStateModel.defaultAttributes.sort},n.prototype.getQuickview=function(e){var n=E.BaseComponent.getComponentRef("Quickview");if(n){var i=this.getComponents(n.ID);if(t.any(i,function(t){return t.getHashId()==e}))return e}return c.QueryStateModel.defaultAttributes.quickview},n.prototype.handleQuickviewChanged=function(e){var n=E.BaseComponent.getComponentRef("Quickview");if(n){var i=this.getComponents(n.ID);if(""!=e.value){var o=t.partition(i,function(t){return t.getHashId()==e.value});0!=o[0].length&&(t.first(o[0]).open(),t.forEach(t.tail(o[0]),function(t){return t.close()})),t.forEach(o[1],function(t){return t.close()})}else t.forEach(i,function(t){t.close()})}},n.prototype.handleBuildingQuery=function(t){this.options.enableDuplicateFiltering&&(t.queryBuilder.enableDuplicateFiltering=!0),x.Utils.isNullOrUndefined(this.options.pipeline)||(t.queryBuilder.pipeline=this.options.pipeline),x.Utils.isNullOrUndefined(this.options.maximumAge)||(t.queryBuilder.maximumAge=this.options.maximumAge),x.Utils.isNullOrUndefined(this.options.resultsPerPage)||(t.queryBuilder.numberOfResults=this.options.resultsPerPage),x.Utils.isNullOrUndefined(this.options.excerptLength)||(t.queryBuilder.excerptLength=this.options.excerptLength),x.Utils.isNonEmptyString(this.options.expression)&&t.queryBuilder.advancedExpression.add(this.options.expression),x.Utils.isNonEmptyString(this.options.filterField)&&(t.queryBuilder.filterField=this.options.filterField),x.Utils.isNonEmptyString(this.options.timezone)&&(t.queryBuilder.timezone=this.options.timezone),t.queryBuilder.enableCollaborativeRating=this.options.enableCollaborativeRating,t.queryBuilder.enableDuplicateFiltering=this.options.enableDuplicateFiltering},n.prototype.handleQuerySuccess=function(t){var e=0==t.results.results.length;this.toggleSectionState("coveo-no-results",e);var n=a.$$(this.element).find(".coveo-results-header");n&&a.$$(n).removeClass("coveo-query-error")},n.prototype.handleQueryError=function(t){this.toggleSectionState("coveo-no-results");var e=a.$$(this.element).find(".coveo-results-header");e&&a.$$(e).addClass("coveo-query-error")},n.prototype.toggleSectionState=function(e,n){var i=this;void 0===n&&(n=!0);var o=a.$$(this.element).find(".coveo-facet-column"),r=a.$$(this.element).find(".coveo-results-column"),s=a.$$(this.element).find(".coveo-results-header"),u=a.$$(this.element).findAll(".coveo-facet-search-results");o&&a.$$(o).toggleClass(e,n&&!this.queryStateModel.atLeastOneFacetIsActive()),r&&a.$$(r).toggleClass(e,n&&!this.queryStateModel.atLeastOneFacetIsActive()),s&&a.$$(s).toggleClass(e,n&&!this.queryStateModel.atLeastOneFacetIsActive()),u&&u.length>0&&t.each(u,function(t){a.$$(t).toggleClass(e,n&&!i.queryStateModel.atLeastOneFacetIsActive())})},n.ID="SearchInterface",n.options={enableHistory:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableAutomaticResponsiveMode:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),useLocalStorageForHistory:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),resultsPerPage:r.ComponentOptions.buildNumberOption({defaultValue:10,min:0}),excerptLength:r.ComponentOptions.buildNumberOption({defaultValue:200,min:0}),expression:r.ComponentOptions.buildStringOption({defaultValue:""}),filterField:r.ComponentOptions.buildFieldOption({defaultValue:""}),hideUntilFirstQuery:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),firstLoadingAnimation:r.ComponentOptions.buildChildHtmlElementOption({childSelector:".coveo-first-loading-animation",defaultFunction:function(){return u.DomUtils.getBasicLoadingAnimation()}}),autoTriggerQuery:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),endpoint:r.ComponentOptions.buildCustomOption(function(t){return null!=t&&t in o.SearchEndpoint.endpoints?o.SearchEndpoint.endpoints[t]:null},{defaultFunction:function(){return o.SearchEndpoint.endpoints.default}}),timezone:r.ComponentOptions.buildStringOption({defaultFunction:function(){return O.jstz.determine().name()}}),enableDebugInfo:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableCollaborativeRating:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableDuplicateFiltering:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),pipeline:r.ComponentOptions.buildStringOption(),maximumAge:r.ComponentOptions.buildNumberOption(),searchPageUri:r.ComponentOptions.buildStringOption()},n.SMALL_INTERFACE_CLASS_NAME="coveo-small-search-interface",n}(C.RootComponent);e.SearchInterface=N;var R=function(t){function e(n,i,o,s){var u=this;void 0===s&&(s=window),t.call(this,n,r.ComponentOptions.initComponentOptions(n,e,i),o,s),this.element=n,this.options=i,this.analyticsOptions=o,this._window=s,a.$$(this.root).on(g.QueryEvents.newQuery,function(t,e){return u.handleRedirect(t,e)})}return i(e,t),e.prototype.handleRedirect=function(t,e){var n={searchPageUri:this.options.searchPageUri,cancel:!1};a.$$(this.root).trigger(m.StandaloneSearchInterfaceEvents.beforeRedirect,n),n.cancel||(e.cancel=!0,this.searchboxIsEmpty()&&!this.options.redirectIfEmpty||this.redirectToSearchPage(n.searchPageUri))},e.prototype.redirectToSearchPage=function(t){var e=this,n=this.queryStateModel.getAttributes(),i=this.usageAnalytics.getCurrentEventCause();null!=i&&(i==M.analyticsActionCauseList.searchboxSubmit.name&&(i=M.analyticsActionCauseList.searchFromLink.name),n.firstQueryCause=i);var o=this.usageAnalytics.getCurrentEventMeta();null!=o&&(n.firstQueryMeta=o),setTimeout(function(){e._window.location.href=t+"#"+A.HashUtils.encodeValues(n)},0)},e.prototype.searchboxIsEmpty=function(){return x.Utils.isEmptyString(this.queryStateModel.get(c.QueryStateModel.attributesEnum.q))},e.ID="StandaloneSearchInterface",e.options={redirectIfEmpty:r.ComponentOptions.buildBooleanOption({defaultValue:!0})},e}(N);e.StandaloneSearchInterface=R}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(13),r=n(58),s=n(110),a=n(114),u=n(112),l=n(113),c=n(15),h=n(35);!function(t){t[t.BOOLEAN=0]="BOOLEAN",t[t.NUMBER=1]="NUMBER",t[t.STRING=2]="STRING",t[t.LOCALIZED_STRING=3]="LOCALIZED_STRING",t[t.LIST=4]="LIST",t[t.SELECTOR=5]="SELECTOR",t[t.CHILD_HTML_ELEMENT=6]="CHILD_HTML_ELEMENT",t[t.TEMPLATE=7]="TEMPLATE",t[t.FIELD=8]="FIELD",t[t.FIELDS=9]="FIELDS",t[t.ICON=10]="ICON",t[t.OBJECT=11]="OBJECT",t[t.QUERY=12]="QUERY",t[t.HELPER=13]="HELPER",t[t.LONG_STRING=14]="LONG_STRING",t[t.JSON=15]="JSON",t[t.JAVASCRIPT=16]="JAVASCRIPT",t[t.NONE=17]="NONE"}(e.ComponentOptionsType||(e.ComponentOptionsType={}));var p=e.ComponentOptionsType,d=/([A-Z])|\W+(\w)/g,f=/\s*,\s*/,g=/([a-zA-Z\-]+)\s*:\s*(([^,]|,\s*(?!([a-zA-Z\-]+)\s*:))+)/g,m=function(){function e(){}return e.buildBooleanOption=function(t){return e.buildOption(p.BOOLEAN,e.loadBooleanOption,t)},e.buildNumberOption=function(t){return e.buildOption(p.NUMBER,e.loadNumberOption,t)},e.buildStringOption=function(t){return e.buildOption(p.STRING,e.loadStringOption,t)},e.buildIconOption=function(t){return e.buildOption(p.ICON,e.loadStringOption,t)},e.buildHelperOption=function(t){return e.buildOption(p.HELPER,e.loadStringOption,t)},e.buildJsonOption=function(t){return e.buildOption(p.JSON,e.loadStringOption,t)},e.buildLocalizedStringOption=function(t){return e.buildOption(p.LOCALIZED_STRING,e.loadLocalizedStringOption,t)},e.buildFieldOption=function(t){return e.buildOption(p.FIELD,e.loadFieldOption,t)},e.buildFieldsOption=function(t){return e.buildOption(p.FIELDS,e.loadFieldsOption,t)},e.buildListOption=function(t){return e.buildOption(p.LIST,e.loadListOption,t)},e.buildSelectorOption=function(t){return e.buildOption(p.SELECTOR,e.loadSelectorOption,t)},e.buildChildHtmlElementOption=function(t){return e.buildOption(p.CHILD_HTML_ELEMENT,e.loadChildHtmlElementOption,t)},e.buildTemplateOption=function(t){return e.buildOption(p.TEMPLATE,e.loadTemplateOption,t)},e.buildCustomOption=function(t,n){var i=function(n,i,o){var r=e.loadStringOption(n,i,o);if(!c.Utils.isNullOrEmptyString(r))return t(r)};return e.buildOption(p.STRING,i,n)},e.buildCustomListOption=function(t,n){var i=function(n,i,o){var r=e.loadListOption(n,i,o);return t(r)};return e.buildOption(p.LIST,i,n)},e.buildObjectOption=function(n){var i=function(i,o,r){for(var s=t.keys(n.subOptions),a={},u={},l=0;l<s.length;l++){var c=s[l],h=e.mergeCamelCase(o,c);a[h]=n.subOptions[c]}e.initOptions(i,a,u);for(var p={},d=!1,l=0;l<s.length;l++){var c=s[l],h=e.mergeCamelCase(o,c);null!=u[h]&&(p[c]=u[h],d=!0)}return d?p:null};return e.buildOption(p.OBJECT,i,n)},e.buildOption=function(t,e,n){void 0===n&&(n={});var i=n;return i.type=t,i.load=e,i},e.attrNameFromName=function(t,n){return n&&n.attrName?n.attrName:t?"data-"+e.camelCaseToHyphen(t):t},e.camelCaseToHyphen=function(t){return t.replace(d,"-$1$2").toLowerCase()},e.mergeCamelCase=function(t,e){return t+e.substr(0,1).toUpperCase()+e.substr(1)},e.initComponentOptions=function(t,n,i){return e.initOptions(t,n.options,i,n.ID)},e.initOptions=function(e,n,i,r){var s=new o.Logger(this);null==i&&(i={});for(var a=t.keys(n),u=0;u<a.length;u++){var l=a[u],d=n[l],f=void 0,g=d.load;if(null!=g&&(f=g(e,l,d),f&&d.deprecated&&s.warn(r+"."+l+" : "+d.deprecated)),c.Utils.isNullOrUndefined(f)&&void 0!=i[l]&&(f=i[l]),null==f&&void 0==i[l]&&(null!=d.defaultValue?f=d.type==p.LIST?t.extend([],d.defaultValue):d.type==p.OBJECT?t.extend({},d.defaultValue):d.defaultValue:null!=d.defaultFunction&&(f=d.defaultFunction(e))),null!=f){if(d.validator){var m=d.validator(f);if(!m){s.warn(r+" ."+l+" has invalid value :  "+f),d.required&&s.error(r+" ."+l+" is required and has an invalid value : "+f+". ***THIS COMPONENT WILL NOT WORK***"),delete i[l];continue}}d.type==p.OBJECT&&null!=i[l]?i[l]=t.extend(i[l],f):d.type==p.LOCALIZED_STRING?i[l]=h.l(f):i[l]=f}}for(var u=0;u<a.length;u++){var v=a[u],d=n[v];d.postProcessing&&(i[v]=d.postProcessing(i[v],i))}return i},e.loadStringOption=function(t,n,i){return t.getAttribute(e.attrNameFromName(n,i))||e.getAttributeFromAlias(t,i)},e.loadFieldOption=function(t,n,o){var r=e.loadStringOption(t,n,o);return i.Assert.check(!c.Utils.isNonEmptyString(r)||c.Utils.isCoveoField(r),r+" is not a valid field"),r},e.loadFieldsOption=function(n,o,r){var s=e.loadStringOption(n,o,r);if(null==s)return null;var a=s.split(f);return t.each(a,function(t){i.Assert.check(c.Utils.isCoveoField(t),t+" is not a valid field")}),a},e.loadLocalizedStringOption=function(n,i,o){var r=e.loadStringOption(n,i,o),s=String.locale||String.defaultLocale;if(null!=s&&null!=r){var a=s.toLowerCase().split("-"),u=t.map(a,function(t,e){return a.slice(0,e+1).join("-")}),l=r.match(g);if(null!=l)for(var c=0;c<l.length;c++){var h=g.exec(l[c]);if(null!=h){var p=h[1].toLowerCase();if(t.contains(u,p))return h[2].replace(/^\s+|\s+$/g,"")}}return null!=r?r.toLocaleString():null}return r},e.loadNumberOption=function(t,n,i){var o=e.loadStringOption(t,n,i);if(null==o)return null;var r=i.float===!0?c.Utils.parseFloatIfNotUndefined(o):c.Utils.parseIntIfNotUndefined(o);return null!=i.min&&i.min>r&&(r=i.min),null!=i.max&&i.max<r&&(r=i.max),r},e.loadBooleanOption=function(t,n,i){return c.Utils.parseBooleanIfNotUndefined(e.loadStringOption(t,n,i))},e.loadListOption=function(t,n,i){var o=i.separator||/\s*,\s*/,r=e.loadStringOption(t,n,i);return c.Utils.isNonEmptyString(r)?r.split(o):null},e.loadEnumOption=function(t,n,i,o){var r=e.loadStringOption(t,n,i);return null!=r?o[r]:null},e.loadSelectorOption=function(t,n,i,o){void 0===o&&(o=document);var r=e.loadStringOption(t,n,i);return c.Utils.isNonEmptyString(r)?o.querySelector(r):null},e.loadChildHtmlElementOption=function(t,n,i,o){void 0===o&&(o=document);var r,s=i.selectorAttr||e.attrNameFromName(n,i)+"-selector",a=t.getAttribute(s)||e.getAttributeFromAlias(t,i);if(null!=a&&(r=o.body.querySelector(a)),null==r){var u=i.childSelector;null==u&&(u="."+n),r=e.loadChildHtmlElementFromSelector(t,u)}return r},e.loadChildHtmlElementFromSelector=function(t,e){return i.Assert.isNonEmptyString(e),r.$$(t).is(e)?t:r.$$(t).find(e)},e.loadChildrenHtmlElementFromSelector=function(t,e){return i.Assert.isNonEmptyString(e),r.$$(t).findAll(e)},e.loadTemplateOption=function(t,n,i,o){void 0===o&&(o=document);var r,s=i.selectorAttr||e.attrNameFromName(n,i)+"-selector",a=t.getAttribute(s)||e.getAttributeFromAlias(t,i);if(null!=a){var u=o.querySelector(a);null!=u&&(r=e.createResultTemplateFromElement(u))}if(null==r){var l=i.idAttr||e.attrNameFromName(n,i)+"-id",c=t.getAttribute(l)||e.getAttributeFromAlias(t,i);null!=c&&(r=e.loadResultTemplateFromId(c))}if(null==r){var h=i.childSelector;null==h&&(h="."+n.replace(/([A-Z])/g,"-$1").toLowerCase()),r=e.loadChildrenResultTemplateFromSelector(t,h)}return r},e.loadResultTemplateFromId=function(t){return c.Utils.isNonEmptyString(t)?s.TemplateCache.getTemplate(t):null},e.loadChildrenResultTemplateFromSelector=function(n,i){var o=e.loadChildrenHtmlElementFromSelector(n,i);return o.length>0?new a.TemplateList(t.compact(t.map(o,function(t){return e.createResultTemplateFromElement(t)}))):null},e.findParentScrolling=function(t,n){for(void 0===n&&(n=document);t!=n&&null!=t;){if(e.isElementScrollable(t))return"body"!==t.tagName.toLowerCase()?t:window;t=t.parentElement}return window},e.isElementScrollable=function(t){return"scroll"==r.$$(t).css("overflow-y")||"scroll"==t.style.overflowY},e.getAttributeFromAlias=function(t,n){if(n.alias)return t.getAttribute(e.attrNameFromName(n.alias))},e.createResultTemplateFromElement=function(e){i.Assert.exists(e);var n=e.getAttribute("type"),o="You must specify the type of template. Valid values are : "+u.UnderscoreTemplate.mimeTypes.toString()+" "+l.HtmlTemplate.mimeTypes.toString();return i.Assert.check(c.Utils.isNonEmptyString(n),o),t.indexOf(u.UnderscoreTemplate.mimeTypes,n)!=-1?u.UnderscoreTemplate.create(e):t.indexOf(l.HtmlTemplate.mimeTypes,n)!=-1?new l.HtmlTemplate(e):void i.Assert.fail("Cannot guess template type from attribute: "+n+". Valid values are "+o)},e}();e.ComponentOptions=m}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(111),o=n(14),r=n(112),s=n(113),a=function(){function e(){}return e.registerTemplate=function(n,r,s,a){void 0===s&&(s=!0),void 0===a&&(a=!1),o.Assert.isNonEmptyString(n),o.Assert.exists(r),r instanceof i.Template||(r=new i.Template(r)),null==r.name&&(r.name=n),e.templates[n]=r,s&&!t.contains(e.templateNames,n)&&e.templateNames.push(n),a&&(e.defaultTemplates[n]=r)},e.getTemplate=function(t){return o.Assert.exists(e.templates[t]),e.templates[t]},e.getTemplates=function(){return e.templates},e.getTemplateNames=function(){return e.templateNames},e.getDefaultTemplates=function(){return t.keys(e.defaultTemplates)},e.getDefaultTemplate=function(t){return o.Assert.exists(e.defaultTemplates[t]),e.defaultTemplates[t]},e.scanAndRegisterTemplates=function(){r.UnderscoreTemplate.isLibraryAvailable()&&e.scanAndRegisterUnderscoreTemplates(),e.scanAndRegisterHtmlTemplates()},e.scanAndRegisterUnderscoreTemplates=function(){t.each(r.UnderscoreTemplate.mimeTypes,function(n){for(var i=document.querySelectorAll("script[id][type='"+n+"']"),o=i.length,s=new Array(o);o--;)s[o]=i.item(o);t.each(s,function(t){var n=new r.UnderscoreTemplate(t);e.registerTemplate(t.getAttribute("id"),n)})})},e.scanAndRegisterHtmlTemplates=function(){t.each(s.HtmlTemplate.mimeTypes,function(n){for(var i=document.querySelectorAll("script[id][type='"+n+"']"),o=i.length,r=new Array(o);o--;)r[o]=i.item(o);t.each(r,function(t){var n=new s.HtmlTemplate(t);e.registerTemplate(t.getAttribute("id"),n)})})},e.templates={},e.templateNames=[],e.defaultTemplates={},e}();e.TemplateCache=a,document.addEventListener("DOMContentLoaded",function(){a.scanAndRegisterTemplates()})}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(13),o=n(61),r=n(106),s=n(58),a=n(77),u=function(){function e(t,e){this.dataToString=t,this.condition=e,this.logger=new i.Logger(this)}return e.getFieldFromString=function(e){var n=t.map(o.StringUtils.match(e,/(?:(?!\b@)@([a-z0-9]+(?:\.[a-z0-9]+)*\b))|\braw.([a-z0-9]+)|\braw\['([^']+)'\]|\braw\['([^']+)'\]/gi),function(t){return t[1]||t[2]||t[3]||t[4]||null});return t.each(r.Initialization.getListOfRegisteredComponents(),function(t){var i=r.Initialization.getRegisteredComponent(t).fields;null!=i&&e.indexOf(a.BaseComponent.computeCssClassNameForType(t))!=-1&&(n=n.concat(i))}),n},e.prototype.instantiateToString=function(t,e){return void 0===e&&(e=!0),!this.dataToString||e&&null!=this.condition&&!this.condition(t)?null:this.dataToString(t)},e.prototype.instantiateToElement=function(t,e){void 0===e&&(e=!0);var n=this.instantiateToString(t,e);if(null!=n){var i=s.htmlToDom(n);return this.logger.trace("Instantiated result template",t,i),i.template=this,i}return null},e.prototype.toHtmlElement=function(){return null},e.prototype.getFields=function(){return[]},e.prototype.getType=function(){return"Template"},e}();e.Template=u}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(111),r=n(14),s=n(109),a=n(15),u=n(58);t.templateSettings={evaluate:/(?:<%|{{)([\s\S]+?)(?:%>|}})/g,interpolate:/(?:<%|{{)=([\s\S]+?)(?:%>|}})/g,escape:/(?:<%|{{)-([\s\S]+?)(?:%>|}})/g};var l=function(e){function n(i){var a=this;e.call(this),this.element=i,r.Assert.exists(i);var l=i.innerHTML;this.template=t.template(l);var c=u.$$(i).getAttribute("data-condition");null!=c&&(this.condition=new Function("obj","with(obj||{}){return "+c+"}")),this.dataToString=function(e){var i=t.extend({},e,n.templateHelpers);return a.template(i)},this.fields=o.Template.getFieldFromString(l+" "+c);var h=s.ComponentOptions.loadFieldsOption(i,"fields",{includeInResults:!0});null!=h&&(this.fields=this.fields.concat(t.map(h,function(t){return t.substr(1)})))}return i(n,e),n.prototype.toHtmlElement=function(){var e=u.$$("script");return e.setAttribute("type",t.first(n.mimeTypes)),e.setAttribute("data-condition",u.$$(this.element).getAttribute("data-condition")),e.text(this.element.innerHTML),e.el},n.prototype.getType=function(){return"UnderscoreTemplate"},n.create=function(t){return r.Assert.exists(t),new n(t)},n.fromString=function(t,e){var i=document.createElement("script");return i.text=t,null!=e&&u.$$(i).setAttribute("data-condition",e),u.$$(i).setAttribute("type",n.mimeTypes[0]),new n(i)},n.prototype.getFields=function(){return this.fields},n.registerTemplateHelper=function(t,e){n.templateHelpers[t]=e},n.isLibraryAvailable=function(){return a.Utils.exists(window._)},n.templateHelpers={},n.mimeTypes=["text/underscore","text/underscore-template","text/x-underscore","text/x-underscore-template"],n}(o.Template);e.UnderscoreTemplate=l}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(111),r=n(109),s=n(14),a=n(58),u=function(e){function n(n){e.call(this,function(){return n.innerHTML}),this.element=n;var i=a.$$(n).getAttribute("data-condition");null!=i&&(i=i.toString().replace(/&quot;/g,'"'),this.condition=new Function("obj","with(obj||{}){return "+i+"}")),this.fields=o.Template.getFieldFromString(n.innerHTML+" "+i);var s=r.ComponentOptions.loadFieldsOption(n,"fields",{includeInResults:!0});null!=s&&(this.fields=this.fields.concat(t.map(s,function(t){return t.substr(1)})))}return i(n,e),n.prototype.toHtmlElement=function(){var e=a.$$("script");return e.setAttribute("type",t.first(n.mimeTypes)),e.setAttribute("data-condition",a.$$(this.element).getAttribute("data-condition")),e.text(this.element.innerHTML),e.el},n.prototype.getType=function(){return"HtmlTemplate"},n.prototype.getFields=function(){return this.fields},n.create=function(t){return s.Assert.exists(t),new n(t)},n.fromString=function(t,e){var i=document.createElement("script");return i.text=t,null!=e&&a.$$(i).setAttribute("data-condition",e),a.$$(i).setAttribute("type",n.mimeTypes[0]),new n(i)},n.mimeTypes=["text/html"],n}(o.Template);e.HtmlTemplate=u}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(111),r=n(115),s=function(e){function n(t){e.call(this),this.templates=t}return i(n,e),n.prototype.instantiateToString=function(t,e){for(var n=0;n<this.templates.length;n++){var i=this.templates[n].instantiateToString(t,e);if(null!=i)return i}return(new r.DefaultResultTemplate).instantiateToString(t)},n.prototype.instantiateToElement=function(t,e){void 0===e&&(e=!0);for(var n=0;n<this.templates.length;n++){var i=this.templates[n].instantiateToElement(t,e);if(null!=i)return i}return(new r.DefaultResultTemplate).instantiateToElement(t)},n.prototype.getFields=function(){return t.reduce(this.templates,function(t,e){return t.concat(e.getFields())},[])},n.prototype.getType=function(){return"TemplateList"},n}(o.Template);e.TemplateList=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(111),r=n(112),s=n(110),a=n(14),u=function(e){function n(){e.call(this)}return i(n,e),n.prototype.instantiateToString=function(e){a.Assert.exists(e),e=t.extend({},e,r.UnderscoreTemplate.templateHelpers);var n=t.map(s.TemplateCache.getDefaultTemplates(),function(t){return s.TemplateCache.getTemplate(t)});n.sort(function(t,e){return null==t.condition&&null!=e.condition?1:null!=t.condition&&null==e.condition?-1:0});for(var i=0;i<n.length;i++){var o=n[i].instantiateToString(e);if(null!=o)return o}return t.template('<div><div class="coveo-title"><a class="CoveoResultLink"><%= title?Coveo.TemplateHelpers.getHelper("highlight").call(title, titleHighlights):clickUri %></a></div><% if(excerpt){ %><div class="coveo-excerpt"><%= Coveo.TemplateHelpers.getHelper("highlight").call(excerpt, excerptHighlights) %></div><% } %><table class="CoveoFieldTable"><%= Coveo.TemplateHelpers.getHelper("highlight").call() %></table></div>')(e)},n.prototype.instantiateToElement=function(t){var e=document.createElement("div");return e.innerHTML=this.instantiateToString(t),e},n.prototype.getFields=function(){var e=t.map(s.TemplateCache.getDefaultTemplates(),function(t){return s.TemplateCache.getTemplate(t)});return t.flatten(t.map(e,function(t){return t.getFields()}))},n.prototype.getType=function(){return"DefaultResultTemplate"},n}(o.Template);e.DefaultResultTemplate=u}).call(e,n(10))},function(t,e,n){"use strict";var i=n(4),o=function(){function t(){this.isContextual=!1}return t.prototype.isActivated=function(){return!1},t.prototype.getCurrentEventCause=function(){return this.currentEventCause},t.prototype.getCurrentEventMeta=function(){return this.currentEventMeta},t.prototype.logSearchEvent=function(t,e){this.setNoopCauseAndMeta(t.name,e)},t.prototype.logSearchAsYouType=function(t,e){this.setNoopCauseAndMeta(t.name,e)},t.prototype.logClickEvent=function(t,e,n,i){this.setNoopCauseAndMeta(t.name,e)},t.prototype.logCustomEvent=function(t,e,n){this.setNoopCauseAndMeta(t.name,e)},t.prototype.getTopQueries=function(t){return new i.Promise(function(t,e){t([])})},t.prototype.getCurrentVisitIdPromise=function(){return new i.Promise(function(t,e){t(null)})},t.prototype.getCurrentVisitId=function(){return null},t.prototype.sendAllPendingEvents=function(){},t.prototype.cancelAllPendingEvents=function(){},t.prototype.warnAboutSearchEvent=function(){},t.prototype.getPendingSearchEvent=function(){return null},t.prototype.setNoopCauseAndMeta=function(t,e){this.currentEventCause=t,this.currentEventMeta=e},t}();e.NoopAnalyticsClient=o},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(109),r=n(70),s=n(48),a=n(49),u=n(43),l=n(58),c=n(61),h=n(9),p=n(111),d=n(4),f=n(76),g=n(77),m=n(23),v=n(28),y=n(69),b=n(45),S=function(e){function n(t,i,c,h){var p=this;void 0===h&&(h=m.ModalBox),e.call(this,t,n.ID),this.element=t,this.queryController=i,this.options=c,this.modalBox=h,this.debug=!1,this.highlightRecommendation=!1,this.options=o.ComponentOptions.initComponentOptions(t,n,c),l.$$(this.element).on(s.QueryEvents.buildingQuery,function(t,e){e.queryBuilder.enableDebug=p.debug||e.queryBuilder.enableDebug}),l.$$(this.element).on(a.ResultListEvents.newResultDisplayed,function(t,e){return p.handleNewResultDisplayed(e)}),l.$$(this.element).on(u.DebugEvents.showDebugPanel,function(t,e){p.handleShowDebugPanel(e)}),l.$$(this.element).on(b.InitializationEvents.nuke,function(){p.unbindEscapeEvent()}),this.localStorageDebug=new r.LocalStorageUtils("DebugPanel"),this.collapsedSections=this.localStorageDebug.load()||[]}return i(n,e),n.prototype.showDebugPanel=function(t){var e=this,n=t(),i=this.modalBox.open(n.body,{title:"",className:"coveo-debug",titleClose:!0,overlayClose:!0,validation:function(){return e.unbindEscapeEvent(),!0}});this.bindEscapeEvent();var o=l.$$(i.wrapper).find(".coveo-title"),r=this.buildSearchBox(n.body),s=l.$$("a",{download:"debug.json",href:this.downloadHref(n.json)},"Download"),a=function(n){var i=t(n);return s.el.setAttribute("href",e.downloadHref(i.json)),i.body};o.appendChild(this.buildEnabledHighlightRecommendation()),o.appendChild(this.buildEnableDebugCheckbox(n.body,r,a)),o.appendChild(r),o.appendChild(s.el)},n.prototype.handleEscapeEvent=function(t){t.keyCode==y.KEYBOARD.ESCAPE&&this.modalBox&&this.modalBox.close()},n.prototype.bindEscapeEvent=function(){this.boundEscapeKey=this.handleEscapeEvent.bind(this),l.$$(document.body).on("keyup",this.boundEscapeKey)},n.prototype.unbindEscapeEvent=function(){this.boundEscapeKey&&l.$$(document.body).off("keyup",this.boundEscapeKey),this.boundEscapeKey=null},n.prototype.handleShowDebugPanel=function(e){var n=this;null==this.stackDebug&&(setTimeout(function(){var t=n.stackDebug;n.showDebugPanel(function(e){return n.buildStackPanel(t,e)}),n.stackDebug=null}),this.stackDebug={}),t.extend(this.stackDebug,e)},n.prototype.handleNewResultDisplayed=function(t){var e=this;null!=t.item&&(this.highlightRecommendation&&t.result.isRecommendation&&l.$$(t.item).addClass("coveo-is-recommendation"),l.$$(t.item).on("dblclick",function(n){e.handleResultDoubleClick(n,t)}))},n.prototype.handleResultDoubleClick=function(e,n){var i=this;if(e.altKey){var o=n.result.index,r=function(e){return null!=e?t.find(e.results,function(t){return t.index==o}):n.result},s=n.item.template,a={result:r,fields:function(t){return i.buildFieldsSection(r(t))},rankingInfo:function(t){return i.buildRankingInfoSection(r(t))},template:this.templateToJson(s)};this.handleShowDebugPanel(a)}},n.prototype.downloadHref=function(t){return"data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t))},n.prototype.buildStackPanel=function(e,i){var o=this,r=l.Dom.createElement("div",{className:"coveo-debug"}),s=t.pairs(t.keys(e));s=s.sort(function(e,i){var o=t.indexOf(n.customOrder,e[1]),r=t.indexOf(n.customOrder,i[1]);return o!=-1&&r!=-1?o-r:o!=-1?-1:r!=-1?1:e[0]-i[0]});var a={};return t.forEach(s,function(t){var n=o.buildSection(t[1]),s=o.buildStackPanelSection(e[t[1]],i);n.container.appendChild(s.section),null!=s.json&&(a[t[1]]=s.json),r.appendChild(n.dom)}),{body:r,json:a}},n.prototype.buildStackPanelSection=function(e,n){if(e instanceof HTMLElement)return{section:e};if(t.isFunction(e))return this.buildStackPanelSection(e(n),n);var i=this.toJson(e);return{section:this.buildProperty(i),json:i}},n.prototype.buildSearchBox=function(t){var e=this,n=l.Dom.createElement("div",{className:"coveo-debug-search"},"<input type='text'/>");n.onclick=function(t){t.stopPropagation()};var i="",o=n.querySelector("input");return o.setAttribute("placeholder","Search in debug"),o.onkeyup=function(n){if(null==n||13==n.keyCode){var r=o.value.toLowerCase();i!=r&&(i=r,e.search(r,t))}},o.onchange=function(){var n=o.value.toLowerCase();i!=n&&(i=n,e.search(n,t))},n},n.prototype.search=function(e,n){var i=this;t.isEmpty(e)?(l.$$(n).findAll(".coveo-search-match, .coveo-search-submatch").forEach(function(t){l.$$(t).removeClass("coveo-search-match, coveo-search-submatch")}),l.$$(n).removeClass("coveo-searching")):(l.$$(n).addClass("coveo-searching-loading"),setTimeout(function(){var o=l.$$(n).findAll(".coveo-section .coveo-section-container > .coveo-property");t.each(o,function(t){i.findInProperty(t,e)}),l.$$(n).addClass("coveo-searching"),l.$$(n).removeClass("coveo-searching-loading")}))},n.prototype.findInProperty=function(e,n){var i=this,o=l.$$(e),r=e.label.indexOf(n)!=-1;if(r?this.highlightSearch(e.labelDom,n):this.removeHighlightSearch(e.labelDom),o.hasClass("coveo-property-object")){o.toggleClass("coveo-search-match",r);var s=e.buildKeys(),a=!1;return t.each(s,function(t){a=i.findInProperty(t,n)||a}),o.toggleClass("coveo-search-submatch",a),r||a}return e.value.indexOf(n)!=-1?(this.highlightSearch(e.valueDom,n),r=!0):this.removeHighlightSearch(e.valueDom),o.toggleClass("coveo-search-match",r),r},n.prototype.buildEnableDebugCheckbox=function(t,e,n){var i=this,o=l.Dom.createElement("div",{className:"coveo-enabled-debug"},"<label>Enable query debug <input type='checkbox'/></label>");l.$$(o).on("click",function(t){t.stopPropagation()});var r=l.$$(o).find("input");return this.debug&&r.setAttribute("checked","checked"),r.onchange=function(){i.debug=!i.debug,l.$$(i.element).one([s.QueryEvents.querySuccess,s.QueryEvents.queryError],function(e,i){l.$$(t).removeClass("coveo-debug-loading"),l.$$(t).empty(),l.$$(n(i.results)).children().forEach(function(e){t.appendChild(e)})}),i.queryController.executeQuery({closeModalBox:!1}),l.$$(t).addClass("coveo-debug-loading");var o=e.querySelector("input");o.value="",o.onkeyup(null)},o},n.prototype.buildEnabledHighlightRecommendation=function(){var t=this,e=l.Dom.createElement("div",{className:"coveo-enabled-highlight-recommendation"},"<label>Highlight recommendation <input type='checkbox'/></label>");e.onclick=function(t){t.stopPropagation()};var n=l.$$(e).find("input");return this.highlightRecommendation&&n.setAttribute("checked","checked"),n.onchange=function(){t.highlightRecommendation=!t.highlightRecommendation,t.queryController.executeQuery({closeModalBox:!1})},e},n.prototype.buildSection=function(e){var n=this,i=l.Dom.createElement("div",{className:"coveo-section coveo-"+e+"-section"}),o=l.Dom.createElement("div",{className:"coveo-section-header"});l.$$(o).text(e),i.appendChild(o);var r=l.Dom.createElement("div",{className:"coveo-section-container"});return i.appendChild(r),t.contains(this.collapsedSections,e)&&l.$$(i).addClass("coveo-debug-collapsed"),
o.onclick=function(){l.$$(i).toggleClass("coveo-debug-collapsed"),t.contains(n.collapsedSections,e)?n.collapsedSections=t.without(n.collapsedSections,e):n.collapsedSections.push(e),n.localStorageDebug.save(n.collapsedSections)},{dom:i,header:o,container:r}},n.prototype.fetchFields=function(){var t=this;return null==this.fields?this.queryController.getEndpoint().listFields().then(function(e){return t.fields={},e.forEach(function(e){t.fields[e.name]=e}),t.fields}):d.Promise.resolve(this.fields)},n.prototype.buildFieldsSection=function(e){return this.fetchFields().then(function(n){var i={};return t.each(e.raw,function(t,e){var o=n["@"+e];null==o&&e.match(/^sys/)&&(o=n["@"+e.substr(3)]),null==o?i["@"+e]=t:"Date"==o.fieldType?i["@"+e]=new Date(t):o.splitGroupByField?i["@"+e]=t.split(/\s*;\s*/):i["@"+e]=t}),i})},n.prototype.buildRankingInfoSection=function(t){return t.rankingInfo&&this.parseRankingInfo(t.rankingInfo)},n.prototype.parseRankingInfo=function(e){var n=this,i={};if(e){var o=/Document weights:\n((?:.)*?)\n+/g.exec(e),r=/Terms weights:\n((?:.|\n)*)\n+/g.exec(e),s=/Total weight: ([0-9]+)/g.exec(e);if(o&&o[1]&&(i["Document weights"]=this.parseWeights(o[1])),s&&s[1]&&(i["Total weight"]=Number(s[1])),r&&r[1]){var a=c.StringUtils.match(r[1],/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g);i["Terms weights"]=t.object(t.map(a,function(e){var i=t.object(t.map(c.StringUtils.match(e[1],/([^:]+): ([0-9]+), ([0-9]+); /g),function(t){return[t[1],{Correlation:Number(t[2]),"TF-IDF":Number(t[3])}]})),o=n.parseWeights(e[2]);return[t.keys(i).join(", "),{terms:i,Weights:o}]}))}}return i},n.prototype.parseWeights=function(e){var n=e.match(/(\w+(?:\s\w+)*): ([-0-9]+)/g);return t.object(t.map(n,function(t){var e=t.match(/^(\w+(?:\s\w+)*): ([-0-9]+)$/);return[e[1],Number(e[2])]}))},n.prototype.buildProperty=function(e,n){return e instanceof d.Promise?this.buildPromise(e,n):!t.isArray(e)&&!t.isObject(e)||t.isString(e)?this.buildBasicProperty(e,n):this.buildObjectProperty(e,n)},n.prototype.buildPromise=function(t,e){var n=this,i=document.createElement("div");return i.className="coveo-property coveo-property-promise",t.then(function(t){var o=n.buildProperty(t,e);l.$$(i).replaceWith(o)}),i},n.prototype.buildObjectProperty=function(e,n){var i=this,o=document.createElement("div");o.className="coveo-property coveo-property-object";var r=document.createElement("div");r.className="coveo-property-value";var s=t.keys(e);t.isArray(e)||s.sort();var a,u=function(){return null==a&&(a=[],t.each(s,function(t){var n=i.buildProperty(e[t],t);null!=n&&(a.push(n),r.appendChild(n))})),a};if(o.buildKeys=u,null!=n){var l=document.createElement("div");l.className="coveo-property-label",l.appendChild(document.createTextNode(n)),o.labelDom=l,o.appendChild(l),0!=s.length&&(o.className+=" coveo-collapsible",l.onclick=function(){u();var e=o.className.split(/\s+/);t.contains(e,"coveo-expanded")?e=t.without(e,"coveo-expanded"):e.push("coveo-expanded"),o.className=e.join(" ")})}else u();if(0==s.length){var c=t.without(o.className.split(/\s+/),"coveo-property-object");c.push("coveo-property-basic"),o.className=c.join(" "),t.isArray(e)?r.innerHTML="[]":r.innerHTML="{}",o.value=""}return o.label=null!=n?n.toLowerCase():"",o.appendChild(r),o},n.prototype.buildBasicProperty=function(e,n){var i=this,o=document.createElement("div");if(o.className="coveo-property coveo-property-basic",null!=n){var r=document.createElement("div");r.className="coveo-property-label",r.appendChild(document.createTextNode(n)),o.appendChild(r),o.labelDom=r}var s=null!=e?e.toString():String(e);null!=e&&null!=e.ref&&(e=e.ref);var a=document.createElement("div");a.appendChild(document.createTextNode(s)),a.ondblclick=function(){i.selectElementText(a)},o.appendChild(a),o.valueDom=a;var u=["coveo-property-value"];return t.isString(e)&&u.push("coveo-property-value-string"),(t.isNull(e)||t.isUndefined(e))&&u.push("coveo-property-value-null"),t.isNumber(e)&&u.push("coveo-property-value-number"),t.isBoolean(e)&&u.push("coveo-property-value-boolean"),t.isDate(e)&&u.push("coveo-property-value-date"),t.isObject(e)&&u.push("coveo-property-value-object"),t.isArray(e)&&u.push("coveo-property-value-array"),a.className=u.join(" "),o.label=null!=n?n.toLowerCase():"",o.value=s.toLowerCase(),o},n.prototype.toJson=function(e,i,o){var r=this;if(void 0===i&&(i=0),void 0===o&&(o=[]),e instanceof g.BaseComponent||e instanceof h.SearchEndpoint)return this.componentToJson(e,i);if(e instanceof HTMLElement)return this.htmlToJson(e);if(e instanceof p.Template)return this.templateToJson(e);if(e instanceof d.Promise)return e.then(function(t){return r.toJson(t,i,o)});if(e==window)return this.toJsonRef(e);if(t.isArray(e)||t.isObject(e)){if(t.contains(o,e))return this.toJsonRef(e,"< RECURSIVE >");if(i>=n.maxDepth)return this.toJsonRef(e);if(t.isArray(e))return t.map(e,function(t,n){return r.toJson(t,i+1,o.concat([e]))});if(t.isDate(e))return this.toJsonRef(e,v.format(e,"F"));var s={};return t.each(e,function(t,n){s[n]=r.toJson(t,i+1,o.concat([e]))}),s.ref,s}return e},n.prototype.toJsonRef=function(t,e){return e=new String(e||t),e.ref=t,e},n.prototype.componentToJson=function(e,n){void 0===n&&(n=0);var i=t.keys(e.options);return i.length>0?this.toJson(e.options,n):this.toJsonRef(e.options,new String("No options"))},n.prototype.htmlToJson=function(t){if(null!=t)return{tagName:t.tagName,id:t.id,classList:t.className.split(/\s+/)}},n.prototype.templateToJson=function(t){if(null==t)return null;var e=t.element,n={type:t.getType()};return null!=e&&(n.id=e.id,n.condition=e.attributes["data-condition"],n.content=e.innerText),n},n.prototype.selectElementText=function(t){if(window.getSelection&&document.createRange){var e=window.getSelection(),n=document.createRange();n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n)}else if("createTextRange"in document.body){var i=document.body.createTextRange();i.moveToElementText(t),i.select()}},n.prototype.highlightSearch=function(t,e){if(null!=t){var n=t.innerText.split(new RegExp("(?="+c.StringUtils.regexEncode(e)+")","gi"));t.innerHTML="",n.forEach(function(n){var i,o=new RegExp("("+c.StringUtils.regexEncode(e)+")","i"),r=n.match(o);null!=r?(i=l.Dom.createElement("span",{className:"coveo-debug-highlight"}),i.appendChild(document.createTextNode(r[1])),t.appendChild(i),i=l.Dom.createElement("span"),i.appendChild(document.createTextNode(n.substr(r[1].length))),t.appendChild(i)):(i=l.Dom.createElement("span"),i.appendChild(document.createTextNode(n)),t.appendChild(i))})}},n.prototype.removeHighlightSearch=function(t){null!=t&&(t.innerHTML=t.innerText)},n.prototype.debugInfo=function(){return null},n.ID="Debug",n.options={enableDebug:o.ComponentOptions.buildBooleanOption({defaultValue:!1})},n.customOrder=["error","queryDuration","result","fields","rankingInfo","template","query","results","state"],n.durationKeys=["indexDuration","proxyDuration","clientDuration","duration"],n.maxDepth=10,n}(f.RootComponent);e.Debug=S}).call(e,n(10))},function(t,e,n){var i;!function(){"use strict";function o(t,e){function n(t,e){return function(){return t.apply(e,arguments)}}var i;if(e=e||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=e.touchBoundary||10,this.layer=t,this.tapDelay=e.tapDelay||200,this.tapTimeout=e.tapTimeout||700,!o.notNeeded(t)){for(var r=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],a=this,u=0,l=r.length;l>u;u++)a[r[u]]=n(a[r[u]],a);s&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,i){var o=Node.prototype.removeEventListener;"click"===e?o.call(t,e,n.hijacked||n,i):o.call(t,e,n,i)},t.addEventListener=function(e,n,i){var o=Node.prototype.addEventListener;"click"===e?o.call(t,e,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):o.call(t,e,n,i)}),"function"==typeof t.onclick&&(i=t.onclick,t.addEventListener("click",function(t){i(t)},!1),t.onclick=null)}}var r=navigator.userAgent.indexOf("Windows Phone")>=0,s=navigator.userAgent.indexOf("Android")>0&&!r,a=/iP(ad|hone|od)/.test(navigator.userAgent)&&!r,u=a&&/OS 4_\d(_\d)?/.test(navigator.userAgent),l=a&&/OS [6-7]_\d/.test(navigator.userAgent),c=navigator.userAgent.indexOf("BB10")>0;o.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(a&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},o.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!s;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},o.prototype.sendClick=function(t,e){var n,i;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),i=e.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},o.prototype.determineEventType=function(t){return s&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},o.prototype.focus=function(t){var e;a&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},o.prototype.updateScrollParent=function(t){var e,n;if(e=t.fastClickScrollParent,!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},o.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},o.prototype.onTouchStart=function(t){var e,n,i;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],a){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!u){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},o.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n},o.prototype.onTouchMove=function(t){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0)},o.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},o.prototype.onTouchEnd=function(t){var e,n,i,o,r,c=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,l&&(r=t.changedTouches[0],c=document.elementFromPoint(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset)||c,c.fastClickScrollParent=this.targetElement.fastClickScrollParent),i=c.tagName.toLowerCase(),"label"===i){if(e=this.findControl(c)){if(this.focus(c),s)return!1;c=e}}else if(this.needsFocus(c))return t.timeStamp-n>100||a&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(c),this.sendClick(c,t),a&&"select"===i||(this.targetElement=null,t.preventDefault()),!1);return!(!a||u||(o=c.fastClickScrollParent,!o||o.fastClickLastScrollTop===o.scrollTop))||(this.needsClick(c)||(t.preventDefault(),this.sendClick(c,t)),!1)},o.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},o.prototype.onMouse=function(t){return!this.targetElement||(!!t.forwardedTouchEvent||(!t.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1))))},o.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail||(e=this.onMouse(t),e||(this.targetElement=null),e)},o.prototype.destroy=function(){var t=this.layer;s&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},o.notNeeded=function(t){var e,n,i,o;if("undefined"==typeof window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!s)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(c&&(i=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),i[1]>=10&&i[2]>=3&&(e=document.querySelector("meta[name=viewport]")))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction||(o=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],!!(o>=27&&(e=document.querySelector("meta[name=viewport]"),e&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth)))||("none"===t.style.touchAction||"manipulation"===t.style.touchAction))},o.attach=function(t,e){return new o(t,e)},i=function(){return o}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))}()},function(t,e,n){!function(t){var n=function(){"use strict";var t="s",e=2011,i=function(t){var e=-t.getTimezoneOffset();return null!==e?e:0},o=function(t,e,n){var i=new Date;return void 0!==t&&i.setFullYear(t),i.setDate(n),i.setMonth(e),i},r=function(t){return i(o(t,0,2))},s=function(t){return i(o(t,5,2))},a=function(t){var e=t.getMonth()>7?s(t.getFullYear()):r(t.getFullYear()),n=i(t);return e-n!==0},u=function(){var n=r(e),i=s(e),o=n-i;return o<0?n+",1":o>0?i+",1,"+t:n+",0"},l=function(){var t=u();return new n.TimeZone(n.olson.timezones[t])},c=function(t){var e=new Date(2010,6,15,1,0,0,0),n={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,10,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":e,"Asia/Yekaterinburg":e,"Asia/Omsk":e,"Asia/Krasnoyarsk":e,"Asia/Irkutsk":e,"Asia/Yakutsk":e,"Asia/Vladivostok":e,"Asia/Kamchatka":e,"Europe/Minsk":e,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return n[t]};return{determine:l,date_is_dst:a,dst_start_for:c}}();n.TimeZone=function(t){"use strict";var e={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Pacific/Tongatapu":["Pacific/Apia"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},i=t,o=function(){for(var t=e[i],o=t.length,r=0,s=t[0];r<o;r+=1)if(s=t[r],n.date_is_dst(n.dst_start_for(s)))return void(i=s)},r=function(){return"undefined"!=typeof e[i]};return r()&&o(),{name:function(){return i}}},n.olson={},n.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},e.jstz=n}(this)},function(t,e,n){(function(t){"use strict";var i=n(13),o=n(17),r=function(){function e(t,e){void 0===e&&(e=window),this.queryController=t,this.windoh=e,this.logger=new i.Logger(this),this.bindErrorHandler()}return e.prototype.bindErrorHandler=function(){var e=this,n=this.windoh.onerror;t.isFunction(n)?this.windoh.onerror=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];n.apply(n,t),e.handleError.apply(e,t)}:this.windoh.onerror=this.handleError.bind(this)},e.prototype.handleError=function(t,e,n,i,r){if(e.toLowerCase().match(/coveo/)&&!this.windoh.location.host.toLowerCase().match(/localhost/)){var s={message:t,filename:e,line:n,column:i,error:r.toString(),errorStack:r.stack,device:o.DeviceUtils.getDeviceName()},a={level:"DEBUG",title:this.windoh.location.href,message:JSON.stringify(s)};this.queryController.getEndpoint().logError(a)}},e}();e.SentryLogger=r}).call(e,n(10))},function(t,e){"use strict";e.analyticsActionCauseList={interfaceLoad:{name:"interfaceLoad",type:"interface"},interfaceChange:{name:"interfaceChange",type:"interface",metaMap:{interfaceChangeTo:1}},contextRemove:{name:"contextRemove",type:"misc",metaMap:{contextName:1}},didyoumeanAutomatic:{name:"didyoumeanAutomatic",type:"misc"},didyoumeanClick:{name:"didyoumeanClick",type:"misc"},resultsSort:{name:"resultsSort",type:"misc",metaMap:{resultsSortBy:1}},searchboxSubmit:{name:"searchboxSubmit",type:"search box"},searchboxClear:{name:"searchboxClear",type:"search box"},searchboxAsYouType:{name:"searchboxAsYouType",type:"search box"},breadcrumbFacet:{name:"breadcrumbFacet",type:"breadcrumb",metaMap:{facetId:1,facetValue:2,facetTitle:3}},breadcrumbResetAll:{name:"breadcrumbResetAll",type:"breadcrumb"},documentTag:{name:"documentTag",type:"document",metaMap:{facetId:1,facetValue:2,facetTitle:3}},documentField:{name:"documentField",type:"document",metaMap:{facetId:1,facetValue:2,facetTitle:3}},documentQuickview:{name:"documentQuickview",type:"document",metaMap:{documentTitle:1,documentURL:2}},documentOpen:{name:"documentOpen",type:"document",metaMap:{documentTitle:1,documentURL:2}},omniboxFacetSelect:{name:"omniboxFacetSelect",type:"omnibox",metaMap:{facetId:1,facetValue:2,facetTitle:3}},omniboxFacetExclude:{name:"omniboxFacetExclude",type:"omnibox",metaMap:{facetId:1,facetValue:2,facetTitle:3}},omniboxFacetDeselect:{name:"omniboxFacetDeselect",type:"omnibox",metaMap:{facetId:1,facetValue:2,facetTitle:3}},omniboxFacetUnexclude:{name:"omniboxFacetUnexclude",type:"omnibox",metaMap:{faceId:1,facetValue:2,facetTitle:3}},omniboxAnalytics:{name:"omniboxAnalytics",type:"omnibox",metaMap:{partialQuery:1,suggestionRanking:2,partialQueries:3,suggestions:4}},omniboxFromLink:{name:"omniboxFromLink",type:"omnibox",metaMap:{partialQuery:1,suggestionRanking:2,partialQueries:3,suggestions:4}},omniboxField:{name:"omniboxField",type:"omnibox"},facetClearAll:{name:"facetClearAll",type:"facet",metaMap:{facetId:1}},facetSearch:{name:"facetSearch",type:"facet",metaMap:{facetId:1}},facetToggle:{name:"facetToggle",type:"facet",metaMap:{facetId:1,facetOperatorBefore:2,facetOperatorAfter:3}},facetRangeSlider:{name:"facetRangeSlider",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetRangeGraph:{name:"facetRangeGraph",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetSelect:{name:"facetSelect",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetSelectAll:{name:"facetSelectAll",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetDeselect:{name:"facetDeselect",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetExclude:{name:"facetExclude",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},facetUnexclude:{name:"facetUnexclude",type:"facet",metaMap:{facetId:1,facetValue:2,facetTitle:3}},errorBack:{name:"errorBack",type:"errors"},errorClearQuery:{name:"errorClearQuery",type:"errors"},errorRetry:{name:"errorRetry",type:"errors"},noResultsBack:{name:"noResultsBack",type:"noResults"},expandToFullUI:{name:"expandToFullUI",type:"interface"},caseCreationInputChange:{name:"inputChange",type:"caseCreation"},caseCreationSubmitButton:{name:"submitButton",type:"caseCreation"},caseCreationCancelButton:{name:"cancelButton",type:"caseCreation"},caseCreationUnloadPage:{name:"unloadPage",type:"caseCreation"},casecontextAdd:{name:"casecontextAdd",type:"casecontext",metaMap:{caseID:5}},casecontextRemove:{name:"casecontextRemove",type:"casecontext",metaMap:{caseID:5}},preferencesChange:{name:"preferencesChange",type:"preferences",metaMap:{preferenceName:1,preferenceType:2}},getUserHistory:{name:"getUserHistory",type:"userHistory"},userActionDocumentClick:{name:"userActionDocumentClick",type:"userHistory"},caseAttach:{name:"caseAttach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},caseDetach:{name:"caseDetach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},customfiltersChange:{name:"customfiltersChange",type:"customfilters",metaMap:{customFilterName:1,customFilterType:2,customFilterExpression:3}},pagerNumber:{name:"pagerNumber",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerNext:{name:"pagerNext",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerPrevious:{name:"pagerPrevious",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerScrolling:{name:"pagerScrolling",type:"getMoreResults"},pagerResize:{name:"pagerResize",type:"getMoreResults"},searchFromLink:{name:"searchFromLink",type:"interface"},triggerNotify:{name:"notify",type:"queryPipelineTriggers"},triggerExecute:{name:"execute",type:"queryPipelineTriggers"},triggerQuery:{name:"query",type:"queryPipelineTriggers"},triggerRedirect:{name:"redirect",type:"queryPipelineTriggers"},queryError:{name:"query",type:"errors",metaMap:{query:1,aq:2,cq:3,dq:4,errorType:5,errorMessage:6}},exportToExcel:{name:"exportToExcel",type:"misc"},recommendation:{name:"recommendation",type:"recommendation"},recommendationInterfaceLoad:{name:"recommendationInterfaceLoad",type:"recommendation"},recommendationOpen:{name:"recommendationOpen",type:"recommendation"},advancedSearch:{name:"advancedSearch",type:"advancedSearch"}}},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(109),s=n(37),a=n(9),u=n(14),l=n(48),c=n(102),h=n(58),p=n(98),d=n(15),f=n(116),g=n(123),m=n(127),v=n(121),y=n(108),b=n(128),S=n(168),x=function(e){function n(t,i,s){var a=this;if(void 0===i&&(i={}),e.call(this,t,n.ID,s),this.element=t,this.options=i,this.bindings=s,this.options=r.ComponentOptions.initComponentOptions(t,n,i),this.retrieveInfoFromDefaultSearchEndpoint(),this.initializeAnalyticsClient(),u.Assert.exists(this.client),this.bind.onRootElement(l.QueryEvents.buildingQuery,function(t){return a.handleBuildingQuery(t)}),this.bind.onRootElement(l.QueryEvents.queryError,function(t){return a.handleQueryError(t)}),!this.componentOptionsModel){var d=h.$$(t).find("."+o.Component.computeCssClassName(c.ComponentOptionsModel));d&&(this.componentOptionsModel=d[o.Component.computeCssClassName(c.ComponentOptionsModel)])}if(this.componentOptionsModel){this.componentOptionsModel.set(c.ComponentOptionsModel.attributesEnum.searchHub,this.options.searchHub);var f=this.componentOptionsModel.getEventName(p.Model.eventTypes.changeOne+c.ComponentOptionsModel.attributesEnum.searchHub);this.bind.onRootElement(f,function(t){return a.handleSearchHubChanged(t)})}}return i(n,e),n.prototype.logSearchEvent=function(t,e){this.client.logSearchEvent(t,e)},n.prototype.logSearchAsYouType=function(t,e){this.client.logSearchAsYouType(t,e)},n.prototype.logCustomEvent=function(t,e,n){void 0===n&&(n=this.element),this.client.logCustomEvent(t,e,n)},n.prototype.logClickEvent=function(t,e,n,i){void 0===i&&(i=this.element),this.client.logClickEvent(t,e,n,i)},n.prototype.initializeAnalyticsEndpoint=function(){return new s.AnalyticsEndpoint({token:this.options.token,serviceUrl:this.options.endpoint,organization:this.options.organization})},n.prototype.initializeAnalyticsClient=function(){if(d.Utils.isNonEmptyString(this.options.endpoint)){var t=this.initializeAnalyticsEndpoint(),e=void 0;this.root&&this.element&&(e=this.root.contains(this.element)?this.root:this.element);var n=h.$$(this.root).hasClass(o.Component.computeCssClassName(b.Recommendation));this.instantiateAnalyticsClient(t,e,n)}else this.client=new f.NoopAnalyticsClient},n.prototype.instantiateAnalyticsClient=function(t,e,n){n?this.client=new S.RecommendationAnalyticsClient(t,e,this.options.user,this.options.userDisplayName,this.options.anonymous,this.options.splitTestRunName,this.options.splitTestRunVersion,this.options.searchHub,this.options.sendToCloud,this.getBindings()):this.client=new g.LiveAnalyticsClient(t,e,this.options.user,this.options.userDisplayName,this.options.anonymous,this.options.splitTestRunName,this.options.splitTestRunVersion,this.options.searchHub,this.options.sendToCloud)},n.prototype.retrieveInfoFromDefaultSearchEndpoint=function(){var t=a.SearchEndpoint.endpoints.default;null==this.options.token&&t&&(this.options.token=t.options.accessToken),!this.options.organization&&t&&(this.options.organization=t.options.queryStringArguments.workgroup)},n.prototype.handleBuildingQuery=function(t){u.Assert.exists(t),t.queryBuilder.searchHub=this.options.searchHub},n.prototype.handleSearchHubChanged=function(t){this.options.searchHub=t.value},n.prototype.handleQueryError=function(t){u.Assert.exists(t),this.client.logCustomEvent(v.analyticsActionCauseList.queryError,{query:t.query.q,aq:t.query.aq,cq:t.query.cq,dq:t.query.dq,errorType:t.error.type,errorMessage:t.error.message},this.element)},n.create=function(e,i,r){var s=o.Component.computeSelectorForType(n.ID),a=[];return a=a.concat(h.$$(e).findAll(s)),o.Component.get(e,y.SearchInterface)instanceof b.Recommendation||(a=this.ignoreElementsInsideRecommendationInterface(a)),a.push(h.$$(e).closest(o.Component.computeCssClassName(n))),h.$$(e).is(s)&&a.push(e),a=t.compact(a),1==a.length?n.getClient(a[0],i,r):a.length>1?new m.MultiAnalyticsClient(t.map(a,function(t){return n.getClient(t,i,r)})):new f.NoopAnalyticsClient},n.ignoreElementsInsideRecommendationInterface=function(e){return t.filter(e,function(t){return void 0===h.$$(t).closest(o.Component.computeCssClassName(b.Recommendation))})},n.getClient=function(t,e,i){var r=o.Component.get(t,n,!0);return r instanceof n?r.client:new n(t,e,i).client},n.ID="Analytics",n.options={user:r.ComponentOptions.buildStringOption(),userDisplayName:r.ComponentOptions.buildStringOption(),token:r.ComponentOptions.buildStringOption(),endpoint:r.ComponentOptions.buildStringOption({defaultValue:s.AnalyticsEndpoint.DEFAULT_ANALYTICS_URI}),anonymous:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchHub:r.ComponentOptions.buildStringOption({defaultValue:"default"}),splitTestRunName:r.ComponentOptions.buildStringOption(),splitTestRunVersion:r.ComponentOptions.buildStringOption(),sendToCloud:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),organization:r.ComponentOptions.buildStringOption()},n}(o.Component);e.Analytics=x}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(17),o=n(124),r=n(126),s=n(14),a=n(13),u=n(121),l=n(32),c=n(58),h=n(41),p=n(125),d=n(101),f=n(107),g=n(8),m=function(){function e(t,e,n,o,r,u,l,c,h){this.endpoint=t,this.rootElement=e,this.userId=n,this.userDisplayName=o,this.anonymous=r,this.splitTestRunName=u,this.splitTestRunVersion=l,this.originLevel1=c,this.sendToCloud=h,this.isContextual=!1,this.language=String.locale,this.device=i.DeviceUtils.getDeviceName(),this.mobile=i.DeviceUtils.isMobileDevice(),s.Assert.exists(t),s.Assert.exists(e),s.Assert.isNonEmptyString(this.language),s.Assert.isNonEmptyString(this.device),s.Assert.isNonEmptyString(this.originLevel1),this.logger=new a.Logger(this)}return e.prototype.isActivated=function(){
return!0},e.prototype.getCurrentVisitId=function(){return this.endpoint.getCurrentVisitId()},e.prototype.getCurrentVisitIdPromise=function(){return this.endpoint.getCurrentVisitIdPromise()},e.prototype.getCurrentEventCause=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventCause():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventCause():null},e.prototype.getCurrentEventMeta=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventMeta():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventMeta():null},e.prototype.logSearchEvent=function(t,e){var n=this.buildMetaObject(e);this.pushSearchEvent(t,n)},e.prototype.logSearchAsYouType=function(t,e){var n=this.buildMetaObject(e);this.pushSearchAsYouTypeEvent(t,n)},e.prototype.logClickEvent=function(t,e,n,i){var o=this.buildMetaObject(e,n);this.pushClickEvent(t,o,n,i)},e.prototype.logCustomEvent=function(t,e,n){var i=this.buildMetaObject(e);this.pushCustomEvent(t,i,n)},e.prototype.getTopQueries=function(t){return this.endpoint.getTopQueries(t)},e.prototype.sendAllPendingEvents=function(){this.pendingSearchAsYouTypeSearchEvent&&this.pendingSearchAsYouTypeSearchEvent.sendRightNow()},e.prototype.cancelAllPendingEvents=function(){this.pendingSearchAsYouTypeSearchEvent&&(this.pendingSearchAsYouTypeSearchEvent.cancel(),this.pendingSearchAsYouTypeSearchEvent=null),this.pendingSearchEvent&&(this.pendingSearchEvent.cancel(),this.pendingSearchEvent=null)},e.prototype.getPendingSearchEvent=function(){return this.pendingSearchEvent?this.pendingSearchEvent:this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent:null},e.prototype.warnAboutSearchEvent=function(){t.isUndefined(this.pendingSearchEvent)&&t.isUndefined(this.pendingSearchAsYouTypeSearchEvent)&&(this.logger.warn("A search was triggered, but no analytics event was logged. If you wish to have consistent analytics data, consider logging a search event using the methods provided by the framework","https://developers.coveo.com/x/TwA5"),window.console&&console.trace&&console.trace())},e.prototype.pushCustomEvent=function(t,e,n){var i=this,o=this.buildCustomEvent(t,e,n);this.triggerChangeAnalyticsCustomData("CustomEvent",e,o),this.checkToSendAnyPendingSearchAsYouType(t),l.Defer.defer(function(){i.sendToCloud&&i.endpoint.sendCustomEvent(o),c.$$(i.rootElement).trigger(h.AnalyticsEvents.customEvent,{customEvent:p.APIAnalyticsBuilder.convertCustomEventToAPI(o)})})},e.prototype.pushSearchEvent=function(t,e){var n=this;if(s.Assert.exists(t),this.pendingSearchEvent&&this.pendingSearchEvent.getEventCause()!==t.name&&(this.pendingSearchEvent.stopRecording(),this.pendingSearchEvent=null),this.checkToSendAnyPendingSearchAsYouType(t),!this.pendingSearchEvent){var i=this.buildSearchEvent(t,e);this.triggerChangeAnalyticsCustomData("SearchEvent",e,i);var r=this.pendingSearchEvent=new o.PendingSearchEvent(this.rootElement,this.endpoint,i,this.sendToCloud);l.Defer.defer(function(){n.pendingSearchEvent=void 0,r.stopRecording()})}},e.prototype.checkToSendAnyPendingSearchAsYouType=function(t){this.eventIsNotRelatedToSearchbox(t.name)?this.sendAllPendingEvents():this.cancelAnyPendingSearchAsYouTypeEvent()},e.prototype.pushSearchAsYouTypeEvent=function(t,e){this.cancelAnyPendingSearchAsYouTypeEvent();var n=this.buildSearchEvent(t,e);this.triggerChangeAnalyticsCustomData("SearchEvent",e,n),this.pendingSearchAsYouTypeSearchEvent=new r.PendingSearchAsYouTypeSearchEvent(this.rootElement,this.endpoint,n,this.sendToCloud)},e.prototype.pushClickEvent=function(t,e,n,i){var o=this,r=this.buildClickEvent(t,e,n,i);this.checkToSendAnyPendingSearchAsYouType(t),this.triggerChangeAnalyticsCustomData("ClickEvent",e,r,{resultData:n}),s.Assert.isNonEmptyString(r.searchQueryUid),s.Assert.isNonEmptyString(r.collectionName),s.Assert.isNonEmptyString(r.sourceName),s.Assert.isNumber(r.documentPosition),l.Defer.defer(function(){o.sendToCloud&&o.endpoint.sendDocumentViewEvent(r),c.$$(o.rootElement).trigger(h.AnalyticsEvents.documentViewEvent,{documentViewEvent:p.APIAnalyticsBuilder.convertDocumentViewToAPI(r)})})},e.prototype.buildAnalyticsEvent=function(e,n){return{actionCause:e.name,actionType:e.type,username:this.userId,userDisplayName:this.userDisplayName,anonymous:this.anonymous,device:this.device,mobile:this.mobile,language:this.language,responseTime:void 0,originLevel1:this.originLevel1,originLevel2:this.getOriginLevel2(this.rootElement),originLevel3:document.referrer,customData:t.keys(n).length>0?n:void 0,userAgent:navigator.userAgent}},e.prototype.buildSearchEvent=function(t,e){return this.merge(this.buildAnalyticsEvent(t,e),{searchQueryUid:void 0,pipeline:void 0,splitTestRunName:this.splitTestRunName,splitTestRunVersion:this.splitTestRunVersion,queryText:void 0,advancedQuery:void 0,results:void 0,resultsPerPage:void 0,pageNumber:void 0,didYouMean:void 0,facets:void 0,contextual:this.isContextual})},e.prototype.buildClickEvent=function(t,e,n,i){return this.merge(this.buildAnalyticsEvent(t,e),{searchQueryUid:n.queryUid,queryPipeline:n.pipeline,splitTestRunName:this.splitTestRunName||n.splitTestRun,splitTestRunVersion:this.splitTestRunVersion||(void 0!=n.splitTestRun?n.pipeline:void 0),documentUri:n.uri,documentUriHash:n.raw.urihash,documentUrl:n.clickUri,documentTitle:n.title,documentCategory:n.raw.objecttype,originLevel2:this.getOriginLevel2(i),collectionName:n.raw.collection,sourceName:n.raw.source,documentPosition:n.index+1,responseTime:0,viewMethod:t.name,rankingModifier:n.rankingModifier})},e.prototype.buildCustomEvent=function(t,e,n){return this.merge(this.buildAnalyticsEvent(t,e),{eventType:t.type,eventValue:t.name,originLevel2:this.getOriginLevel2(n),responseTime:0})},e.prototype.getOriginLevel2=function(t){return this.resolveActiveTabFromElement(t)||"default"},e.prototype.buildMetaObject=function(e,n){var i=t.extend({},e);if(i.JSUIVersion=g.version.lib+";"+g.version.product,n){var o=void 0,r=void 0,s=n.raw.uniqueid;s?(r="uniqueid",o=s):(r="urihash",o=n.raw.urihash),i.contentIDKey=r,i.contentIDValue=o}return i},e.prototype.cancelAnyPendingSearchAsYouTypeEvent=function(){this.pendingSearchAsYouTypeSearchEvent&&(this.pendingSearchAsYouTypeSearchEvent.cancel(),this.pendingSearchAsYouTypeSearchEvent=void 0)},e.prototype.resolveActiveTabFromElement=function(t){s.Assert.exists(t);var e=this.resolveQueryStateModel(t);return e&&e.get(d.QueryStateModel.attributesEnum.t)},e.prototype.resolveQueryStateModel=function(t){return f.Component.resolveBinding(t,d.QueryStateModel)},e.prototype.eventIsNotRelatedToSearchbox=function(t){return t!==u.analyticsActionCauseList.searchboxSubmit.name&&t!==u.analyticsActionCauseList.searchboxClear.name},e.prototype.triggerChangeAnalyticsCustomData=function(e,n,i,o){n.metaDataAsString={},n.metaDataAsNumber={};var r={language:i.language,originLevel1:i.originLevel1,originLevel2:i.originLevel2,originLevel3:i.originLevel3,metaObject:n},s=t.extend({},{type:e,actionType:i.actionType,actionCause:i.actionCause},r,o);c.$$(this.rootElement).trigger(h.AnalyticsEvents.changeAnalyticsCustomData,s),i.language=s.language,i.originLevel1=s.originLevel1,i.originLevel2=s.originLevel2,i.originLevel3=s.originLevel3,i.customData=n;var a=i.customData.metaDataAsString;t.keys(a).length>0&&(this.logger.warn("Using deprecated 'metaDataAsString' key to log custom analytics data. Custom meta should now be put at the root of the object."),t.extend(i.customData,a)),delete i.customData.metaDataAsString;var u=i.customData.metaDataAsNumber;t.keys(u).length>0&&(this.logger.warn("Using deprecated 'metaDataAsNumber' key to log custom analytics data. Custom meta should now be put at the root of the object."),t.extend(i.customData,u)),delete i.customData.metaDataAsNumber},e.prototype.merge=function(e,n){return t.extend({},e,n)},e}();e.LiveAnalyticsClient=m}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(48),o=n(14),r=n(58),s=n(108),a=n(107),u=n(75),l=n(32),c=n(125),h=n(41),p=n(121),d=n(101),f=function(){function e(t,e,n,s){var a=this;this.root=t,this.endpoint=e,this.templateSearchEvent=n,this.sendToCloud=s,this.searchPromises=[],this.results=[],this.cancelled=!1,this.finished=!1,this.searchEvents=[],o.Assert.exists(t),o.Assert.exists(e),o.Assert.exists(n),this.handler=function(t,e){a.handleDuringQuery(t,e)},r.$$(t).on(i.QueryEvents.duringQuery,this.handler)}return e.prototype.getEventCause=function(){return this.templateSearchEvent.actionCause},e.prototype.getEventMeta=function(){return this.templateSearchEvent.customData},e.prototype.cancel=function(){this.stopRecording(),this.cancelled=!0},e.prototype.handleDuringQuery=function(e,n){var i=this;o.Assert.check(!this.finished),o.Assert.check(!this.cancelled),this.searchPromises.push(n.promise);var r;r=e.target;var l=a.Component.get(r,s.SearchInterface);o.Assert.exists(l);var c=a.Component.get(r,u.QueryController);o.Assert.exists(c),n.promise.then(function(e){if(o.Assert.exists(e),o.Assert.check(!i.finished),e._reusedSearchUid!==!0||i.templateSearchEvent.actionCause==p.analyticsActionCauseList.recommendation.name){var r=t.extend({},i.templateSearchEvent);return i.fillSearchEvent(r,l,n.query,e),i.searchEvents.push(r),i.results.push(e),e}}).finally(function(){var e=t.indexOf(i.searchPromises,n.promise);i.searchPromises.splice(e,1),0==i.searchPromises.length&&i.flush()})},e.prototype.stopRecording=function(){this.handler&&(r.$$(this.root).off(i.QueryEvents.duringQuery,this.handler),r.$$(this.root).off(i.QueryEvents.duringFetchMoreQuery,this.handler),this.handler=null)},e.prototype.flush=function(){var e=this;this.cancelled||(this.stopRecording(),this.finished=!0,o.Assert.check(this.searchEvents.length==this.results.length),l.Defer.defer(function(){e.sendToCloud&&e.endpoint.sendSearchEvents(e.searchEvents);var n=t.map(e.searchEvents,function(t){return c.APIAnalyticsBuilder.convertSearchEventToAPI(t)});r.$$(e.root).trigger(h.AnalyticsEvents.searchEvent,{searchEvents:n})}))},e.prototype.fillSearchEvent=function(e,n,i,r){o.Assert.exists(e),o.Assert.exists(n),o.Assert.exists(i),o.Assert.exists(r);var s=n.queryStateModel.get(d.QueryStateModel.attributesEnum.q);e.queryPipeline=r.pipeline,e.splitTestRunName=e.splitTestRunName||r.splitTestRun,e.splitTestRunVersion=e.splitTestRunVersion||(void 0!=r.splitTestRun?r.pipeline:void 0),e.originLevel2=e.originLevel2||n.queryStateModel.get("t")||"default",e.queryText=s||i.q||"",e.advancedQuery=i.aq||"",e.didYouMean=i.enableDidYouMean,e.numberOfResults=r.totalCount,e.responseTime=r.duration,e.pageNumber=i.firstResult/i.numberOfResults,e.resultsPerPage=i.numberOfResults,e.searchQueryUid=r.searchUid,e.queryPipeline=r.pipeline,void 0!=i.context&&t.each(i.context,function(t,n){e.customData["context_"+n]=t}),void 0!=r.refinedKeywords&&0!=r.refinedKeywords.length&&(e.customData.refinedKeywords=r.refinedKeywords)},e}();e.PendingSearchEvent=f}).call(e,n(10))},function(t,e){"use strict";var n=function(){function t(){}return t.convertSearchEventToAPI=function(t){var e={advancedQuery:t.advancedQuery,customMetadatas:t.customData,device:t.device,didYouMean:t.didYouMean,language:t.language,pageNumber:t.pageNumber,queryText:t.queryText,responseTime:t.responseTime,numberOfResults:t.numberOfResults,resultsPerPage:t.resultsPerPage,searchHub:t.originLevel1,searchInterface:t.originLevel2,searchQueryUid:t.searchQueryUid,type:t.actionType,actionCause:t.actionCause,queryPipeline:t.queryPipeline,splitTestRunName:t.splitTestRunName,splitTestRunVersion:t.splitTestRunVersion};return e},t.convertDocumentViewToAPI=function(t){var e={collectionName:t.collectionName,device:t.device,documentPosition:t.documentPosition,title:t.documentTitle,documentUrl:t.documentUrl,documentUri:t.documentUri,documentUriHash:t.documentUriHash,language:t.language,responseTime:t.responseTime,searchHub:t.originLevel1,searchInterface:t.originLevel2,searchQueryUid:t.searchQueryUid,sourceName:t.sourceName,viewMethod:t.viewMethod,customMetadatas:t.customData,actionCause:t.actionCause,queryPipeline:t.queryPipeline,splitTestRunName:t.splitTestRunName,splitTestRunVersion:t.splitTestRunVersion};return e},t.convertCustomEventToAPI=function(t){var e={actionCause:t.actionCause,actionType:t.actionType,device:t.device,language:t.language,responseTime:t.responseTime,searchHub:t.originLevel1,searchInterface:t.originLevel2,customMetadatas:t.customData};return e},t}();e.APIAnalyticsBuilder=n},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(124),r=n(58),s=n(45),a=n(10),u=function(t){function e(e,n,i,o){var a=this;t.call(this,e,n,i,o),this.root=e,this.endpoint=n,this.templateSearchEvent=i,this.sendToCloud=o,this.delayBeforeSending=5e3,this.armBatchDelay=50,this.beforeUnloadHandler=function(){a.onWindowUnload()},window.addEventListener("beforeunload",this.beforeUnloadHandler),r.$$(e).on(s.InitializationEvents.nuke,function(){return a.handleNuke()})}return i(e,t),e.prototype.handleDuringQuery=function(e,n){var i=this,o=a.clone(e);this.beforeResolve=new Promise(function(e){i.toSendRightNow=function(){i.isCancelledOrFinished()||(e(i),t.prototype.handleDuringQuery.call(i,o,n))},a.delay(function(){i.toSendRightNow()},i.delayBeforeSending)})},e.prototype.sendRightNow=function(){this.toSendRightNow&&this.toSendRightNow()},e.prototype.modifyCustomData=function(t,e){a.each(this.searchEvents,function(n){n.customData[t]=e}),this.templateSearchEvent.customData||(this.templateSearchEvent.customData={}),this.templateSearchEvent.customData[t]=e},e.prototype.modifyEventCause=function(t){a.each(this.searchEvents,function(e){e.actionCause=t.name,e.actionType=t.type}),this.templateSearchEvent.actionCause=t.name,this.templateSearchEvent.actionType=t.type},e.prototype.stopRecording=function(){t.prototype.stopRecording.call(this),this.beforeUnloadHandler&&(window.removeEventListener("beforeunload",this.beforeUnloadHandler),this.beforeUnloadHandler=void 0)},e.prototype.handleNuke=function(){window.removeEventListener("beforeunload",this.beforeUnloadHandler)},e.prototype.onWindowUnload=function(){this.isCancelledOrFinished()||(this.armBatchDelay=0,this.sendRightNow())},e.prototype.isCancelledOrFinished=function(){return!!this.cancelled||!!this.finished&&(this.cancel(),!0)},e}(o.PendingSearchEvent);e.PendingSearchAsYouTypeSearchEvent=u},function(t,e,n){(function(t){"use strict";var n=function(){function e(t){void 0===t&&(t=[]),this.analyticsClients=t,this.isContextual=!1}return e.prototype.isActivated=function(){return t.some(this.analyticsClients,function(t){return t.isActivated()})},e.prototype.getCurrentEventCause=function(){return t.find(t.map(this.analyticsClients,function(t){return t.getCurrentEventCause()}),function(t){return null!=t})},e.prototype.getCurrentEventMeta=function(){return t.find(t.map(this.analyticsClients,function(t){return t.getCurrentEventMeta()}),function(t){return null!=t})},e.prototype.logSearchEvent=function(e,n){t.each(this.analyticsClients,function(t){return t.logSearchEvent(e,n)})},e.prototype.logSearchAsYouType=function(e,n){t.each(this.analyticsClients,function(t){return t.logSearchEvent(e,n)})},e.prototype.logClickEvent=function(e,n,i,o){t.each(this.analyticsClients,function(t){return t.logClickEvent(e,n,i,o)})},e.prototype.logCustomEvent=function(e,n,i){t.each(this.analyticsClients,function(t){return t.logCustomEvent(e,n,i)})},e.prototype.getTopQueries=function(e){var n=this;return Promise.all(t.map(this.analyticsClients,function(t){return t.getTopQueries(e)})).then(function(t){return n.mergeTopQueries(t,e.pageSize)})},e.prototype.getCurrentVisitIdPromise=function(){return t.first(this.analyticsClients).getCurrentVisitIdPromise()},e.prototype.getCurrentVisitId=function(){return t.first(this.analyticsClients).getCurrentVisitId()},e.prototype.sendAllPendingEvents=function(){t.each(this.analyticsClients,function(t){return t.sendAllPendingEvents()})},e.prototype.warnAboutSearchEvent=function(){t.each(this.analyticsClients,function(t){return t.warnAboutSearchEvent()})},e.prototype.cancelAllPendingEvents=function(){t.each(this.analyticsClients,function(t){return t.cancelAllPendingEvents()})},e.prototype.getPendingSearchEvent=function(){return t.first(this.analyticsClients).getPendingSearchEvent()},e.prototype.mergeTopQueries=function(e,n){return void 0===n&&(n=5),t.chain(e).flatten().first(n).value()},e}();e.MultiAnalyticsClient=n}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(108),r=n(109),s=n(48),a=n(46),u=n(49),l=n(51),c=n(47),h=n(41),p=n(121),d=n(42),f=n(129),g=n(101),m=n(98),v=n(15),y=n(58),b=n(130),S=n(81),x=function(e){function n(t,i,o,a){var u=this;void 0===i&&(i={}),void 0===o&&(o={}),void 0===a&&(a=window),e.call(this,t,r.ComponentOptions.initComponentOptions(t,n,i),o,a),this.element=t,this.options=i,this.analyticsOptions=o,this.options.id||this.generateDefaultId(),this.options.mainSearchInterface&&this.bindToMainSearchInterface(),y.$$(this.element).on(s.QueryEvents.buildingQuery,function(t,e){return u.handleRecommendationBuildingQuery(e)}),y.$$(this.element).on(s.QueryEvents.querySuccess,function(t,e){return u.handleRecommendationQuerySuccess(e)}),y.$$(this.element).on(s.QueryEvents.noResults,function(t,e){return u.handleRecommendationNoResults()}),y.$$(this.element).on(s.QueryEvents.queryError,function(t,e){return u.handleRecommendationQueryError()}),this.preventEventPropagation(),this.historyStore=new S.history.HistoryStore,b.ResponsiveRecommendation.init(this.root,this,i)}return i(n,e),n.prototype.getId=function(){return this.options.id},n.prototype.enable=function(){e.prototype.enable.call(this),this.show()},n.prototype.disable=function(){e.prototype.disable.call(this),this.hide()},n.prototype.hide=function(){this.displayStyle||(this.displayStyle=this.element.style.display),y.$$(this.element).hide()},n.prototype.show=function(){this.displayStyle||(this.displayStyle=this.element.style.display),this.element.style.display=this.displayStyle},n.prototype.bindToMainSearchInterface=function(){var t=this;y.$$(this.options.mainSearchInterface).on(s.QueryEvents.querySuccess,function(e,n){t.mainInterfaceQuery=n,t.mainQuerySearchUID=n.results.searchUid,t.mainQueryPipeline=n.results.pipeline,t.usageAnalytics.logSearchEvent(p.analyticsActionCauseList.recommendation,{}),t.queryController.executeQuery()})},n.prototype.handleRecommendationBuildingQuery=function(t){this.disabled||(this.modifyQueryForRecommendation(t),this.addRecommendationInfoInQuery(t))},n.prototype.handleRecommendationQuerySuccess=function(t){this.disabled||this.options.hideIfNoResults&&(0===t.results.totalCount?this.hide():this.show())},n.prototype.handleRecommendationNoResults=function(){this.disabled||this.options.hideIfNoResults&&this.hide()},n.prototype.handleRecommendationQueryError=function(){this.disabled||this.hide()},n.prototype.modifyQueryForRecommendation=function(t){this.mainInterfaceQuery&&v.Utils.copyObjectAttributes(t.queryBuilder,this.mainInterfaceQuery.queryBuilder,this.options.optionsToUse)},n.prototype.addRecommendationInfoInQuery=function(e){t.isEmpty(this.options.userContext)||e.queryBuilder.addContext(JSON.parse(this.options.userContext)),this.options.sendActionsHistory&&(e.queryBuilder.actionsHistory=this.getHistory()),e.queryBuilder.recommendation=this.options.id},n.prototype.getHistory=function(){var t=this.historyStore.getHistory();return null==t&&(t=[]),JSON.stringify(t)},n.prototype.preventEventPropagation=function(){this.preventEventPropagationOn(s.QueryEvents),this.preventEventPropagationOn(a.OmniboxEvents),this.preventEventPropagationOn(u.ResultListEvents),this.preventEventPropagationOn(l.SettingsEvents),this.preventEventPropagationOn(c.PreferencesPanelEvents),this.preventEventPropagationOn(h.AnalyticsEvents),this.preventEventPropagationOn(d.BreadcrumbEvents),this.preventEventPropagationOn(f.QuickviewEvents),this.preventEventPropagationOn(this.getAllModelEvents())},n.prototype.preventEventPropagationOn=function(t,e){void 0===e&&(e=function(t){return t});for(var n in t)y.$$(this.root).on(e(n),function(t){return t.stopPropagation()})},n.prototype.getAllModelEvents=function(){var e=this,n={};return t.each(t.values(m.Model.eventTypes),function(i){t.each(t.values(g.QUERY_STATE_ATTRIBUTES),function(t){var o=e.getBindings().queryStateModel.getEventName(i+t);n[o]=o})}),n},n.prototype.generateDefaultId=function(){var t="Recommendation";1!==n.NEXT_ID&&(this.logger.warn("Generating another recommendation default id","Consider configuring a human friendly / meaningful id for this interface"),t=t+"_"+n.NEXT_ID),n.NEXT_ID++,this.options.id=t},n.ID="Recommendation",n.NEXT_ID=1,n.options={mainSearchInterface:r.ComponentOptions.buildSelectorOption(),userContext:r.ComponentOptions.buildJsonOption(),id:r.ComponentOptions.buildStringOption(),optionsToUse:r.ComponentOptions.buildListOption({defaultValue:["expression"]}),sendActionsHistory:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),hideIfNoResults:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),autoTriggerQuery:r.ComponentOptions.buildBooleanOption({postProcessing:function(t,e){return!e.mainSearchInterface&&t}}),enableResponsiveMode:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),responsiveBreakpoint:r.ComponentOptions.buildNumberOption({defaultValue:1e3}),dropdownHeaderLabel:r.ComponentOptions.buildLocalizedStringOption({defaultValue:"Recommendations"})},n}(o.SearchInterface);e.Recommendation=x}).call(e,n(10))},function(t,e){"use strict";var n=function(){function t(){}return t.quickviewLoaded="quickviewLoaded",t.openQuickview="openQuickview",t}();e.QuickviewEvents=n},function(t,e,n){(function(t){"use strict";var i=n(131),o=n(132),r=n(108),s=n(15),a=n(58),u=n(13),l=n(128),c=n(167),h=n(164),p=n(162),d=n(35),f=n(151),g=n(133),m=n(107),v=function(){function e(t,n,i,o){this.coveoRoot=t,this.ID=n,this.recommendationRoot=this.getRecommendationRoot(),this.dropdownHeaderLabel=i.dropdownHeaderLabel,this.breakpoint=this.defineResponsiveBreakpoint(i),this.logger=new u.Logger(this),this.dropdown=this.buildDropdown(o),this.facets=this.getFacets(),this.facetSliders=this.getFacetSliders(),this.registerOnOpenHandler(),this.registerOnCloseHandler(),this.dropdownContainer=a.$$("div",{className:e.DROPDOWN_CONTAINER_CSS_CLASS_NAME})}return e.init=function(t,n,o){var r=new u.Logger("ResponsiveRecommendation"),s=this.findParentRootOfRecommendationComponent(t);return s?a.$$(s).find(".coveo-results-column")?void i.ResponsiveComponentsManager.register(e,a.$$(s),l.Recommendation.ID,n,o):void r.info("Cannot find element with class coveo-results-column. Disabling responsive mode for this component."):void r.info("Recommendation component has no parent interface. Disabling responsive mode for this component.")},e.findParentRootOfRecommendationComponent=function(t){var e=a.$$(t).parents(m.Component.computeCssClassName(r.SearchInterface));return e[0]?a.$$(e[0]):null},e.prototype.handleResizeEvent=function(){this.needSmallMode()&&!o.ResponsiveComponentsUtils.isSmallRecommendationActivated(this.coveoRoot)?this.changeToSmallMode():!this.needSmallMode()&&o.ResponsiveComponentsUtils.isSmallRecommendationActivated(this.coveoRoot)&&this.changeToLargeMode(),this.dropdown.isOpened&&this.dropdown.dropdownContent.positionDropdown()},e.prototype.needDropdownWrapper=function(){return this.needSmallMode()},e.prototype.needSmallMode=function(){return this.coveoRoot.width()<=this.breakpoint},e.prototype.changeToSmallMode=function(){this.dropdown.close(),a.$$(this.coveoRoot.find("."+i.ResponsiveComponentsManager.DROPDOWN_HEADER_WRAPPER_CSS_CLASS)).el.appendChild(this.dropdown.dropdownHeader.element.el),this.disableFacetPreservePosition(),o.ResponsiveComponentsUtils.activateSmallRecommendation(this.coveoRoot),o.ResponsiveComponentsUtils.activateSmallRecommendation(this.recommendationRoot)},e.prototype.changeToLargeMode=function(){this.enableFacetPreservePosition(),this.dropdown.cleanUp(),o.ResponsiveComponentsUtils.deactivateSmallRecommendation(this.coveoRoot),o.ResponsiveComponentsUtils.deactivateSmallRecommendation(this.recommendationRoot)},e.prototype.buildDropdown=function(t){var e=this.buildDropdownContent(),n=this.buildDropdownHeader(),i=t?t:new p.ResponsiveDropdown(e,n,this.coveoRoot);return i.disablePopupBackground(),i},e.prototype.buildDropdownHeader=function(){var t=a.$$("a"),e=a.$$("p");e.text(d.l(this.dropdownHeaderLabel)),t.el.appendChild(e.el);var n=new h.ResponsiveDropdownHeader("recommendation",t);return n},e.prototype.buildDropdownContent=function(){var t,e=this.coveoRoot.find(".coveo-recommendation-column");t=e?a.$$(e):a.$$(this.coveoRoot.find("."+m.Component.computeCssClassName(l.Recommendation)));var n=new c.RecommendationDropdownContent("recommendation",t,this.coveoRoot);return n},e.prototype.defineResponsiveBreakpoint=function(t){var n;return n=s.Utils.isNullOrUndefined(t.responsiveBreakpoint)?e.RESPONSIVE_BREAKPOINT:t.responsiveBreakpoint},e.prototype.getFacetSliders=function(){var e=[];return t.each(this.coveoRoot.findAll("."+m.Component.computeCssClassName(f.FacetSlider)),function(t){var n=m.Component.get(t,f.FacetSlider);n instanceof f.FacetSlider&&e.push(n)}),e},e.prototype.getFacets=function(){var e=[];return t.each(this.coveoRoot.findAll("."+m.Component.computeCssClassName(g.Facet)),function(t){var n=m.Component.get(t,g.Facet);n instanceof g.Facet&&e.push(n)}),e},e.prototype.dismissFacetSearches=function(){t.each(this.facets,function(t){t.facetSearch&&t.facetSearch.currentlyDisplayedResults&&t.facetSearch.completelyDismissSearch()})},e.prototype.enableFacetPreservePosition=function(){t.each(this.facets,function(t){return t.options.preservePosition=!0})},e.prototype.disableFacetPreservePosition=function(){t.each(this.facets,function(t){return t.options.preservePosition=!1})},e.prototype.drawFacetSliderGraphs=function(){t.each(this.facetSliders,function(t){return t.drawDelayedGraphData()})},e.prototype.registerOnOpenHandler=function(){this.dropdown.registerOnOpenHandler(this.drawFacetSliderGraphs,this)},e.prototype.registerOnCloseHandler=function(){this.dropdown.registerOnCloseHandler(this.dismissFacetSearches,this)},e.prototype.getRecommendationRoot=function(){return a.$$(this.coveoRoot.find("."+m.Component.computeCssClassName(l.Recommendation)))},e.DROPDOWN_CONTAINER_CSS_CLASS_NAME="coveo-recommendation-dropdown-container",e.RESPONSIVE_BREAKPOINT=1e3,e}();e.ResponsiveRecommendation=v}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(45),r=n(107),s=n(108),a=n(132),u=n(15),l=n(133),c=n(165),h=function(){function e(n){var o=this;this.disabledComponents=[],this.responsiveComponents=[],this.coveoRoot=n,this.dropdownHeadersWrapper=i.$$("div",{className:e.DROPDOWN_HEADER_WRAPPER_CSS_CLASS}),this.searchBoxElement=this.getSearchBoxElement(),this.resizeListener=t.debounce(function(){o.addDropdownHeaderWrapperIfNeeded(),o.shouldSwitchToSmallMode()?o.coveoRoot.addClass("coveo-small-interface"):o.shouldSwitchToSmallMode()||o.coveoRoot.removeClass("coveo-small-interface"),t.each(o.responsiveComponents,function(t){t.handleResizeEvent()})},200),window.addEventListener("resize",this.resizeListener),this.bindNukeEvents()}return e.register=function(n,i,r,s,a){var l=this;i.on(o.InitializationEvents.afterInitialization,function(){if(l.shouldEnableResponsiveMode(i)){var o=t.find(l.componentManagers,function(t){return i.el==t.coveoRoot.el});if(o||(o=new e(i),l.componentManagers.push(o)),!u.Utils.isNullOrUndefined(a.enableResponsiveMode)&&!a.enableResponsiveMode)return void o.disableComponent(r);l.componentInitializations.push({responsiveComponentsManager:o,arguments:[n,i,r,s,a]})}l.remainingComponentInitializations--,0==l.remainingComponentInitializations&&(l.resizeAllComponentsManager(),l.instantiateResponsiveComponents())}),this.remainingComponentInitializations++},e.shouldEnableResponsiveMode=function(t){var e=r.Component.get(t.el,s.SearchInterface,!0);return e instanceof s.SearchInterface&&e.options.enableAutomaticResponsiveMode&&e.isNewDesign()},e.instantiateResponsiveComponents=function(){t.each(this.componentInitializations,function(t){var e=t.responsiveComponentsManager;e.register.apply(e,t.arguments)})},e.resizeAllComponentsManager=function(){t.each(this.componentManagers,function(t){t.resizeListener()})},e.prototype.register=function(t,e,n,i,o){if(!this.isDisabled(n)){if(!this.isActivated(n)){var r=new t(e,n,o);this.isFacet(n)&&(this.responsiveFacets=r),this.isTabs(n)?this.responsiveComponents.push(r):this.responsiveComponents.unshift(r)}this.isFacet(n)&&this.responsiveFacets.registerComponent(i)}},e.prototype.disableComponent=function(t){this.disabledComponents.push(t)},e.prototype.isDisabled=function(e){return t.indexOf(this.disabledComponents,e)!=-1},e.prototype.shouldSwitchToSmallMode=function(){var t=this.needDropdownWrapper(),e=this.coveoRoot.width()<=a.ResponsiveComponentsUtils.MEDIUM_MOBILE_WIDTH;return t||e},e.prototype.needDropdownWrapper=function(){for(var t=0;t<this.responsiveComponents.length;t++){var e=this.responsiveComponents[t];if(e.needDropdownWrapper&&e.needDropdownWrapper())return!0}return!1},e.prototype.addDropdownHeaderWrapperIfNeeded=function(){if(this.needDropdownWrapper()){var t=i.$$(this.coveoRoot).find(".coveo-tab-section");this.searchBoxElement?this.dropdownHeadersWrapper.insertAfter(this.searchBoxElement):t?this.dropdownHeadersWrapper.insertAfter(t):this.coveoRoot.prepend(this.dropdownHeadersWrapper.el)}},e.prototype.isFacet=function(t){return t==l.Facet.ID},e.prototype.isTabs=function(t){return t==c.Tab.ID},e.prototype.isActivated=function(e){return void 0!=t.find(this.responsiveComponents,function(t){return t.ID==e})},e.prototype.getSearchBoxElement=function(){var t=this.coveoRoot.find(".coveo-search-section");return t?t:this.coveoRoot.find(".CoveoSearchbox")},e.prototype.bindNukeEvents=function(){var t=this;i.$$(this.coveoRoot).on(o.InitializationEvents.nuke,function(){window.removeEventListener("resize",t.resizeListener)})},e.DROPDOWN_HEADER_WRAPPER_CSS_CLASS="coveo-dropdown-header-wrapper",e.componentManagers=[],e.remainingComponentInitializations=0,e.componentInitializations=[],e}();e.ResponsiveComponentsManager=h}).call(e,n(10))},function(t,e){"use strict";var n=function(){function t(){}return t.shouldDrawFacetSlider=function(t){return!this.isSmallFacetActivated(t)&&!this.isSmallRecommendationActivated(t)},t.isSmallTabsActivated=function(t){return t.hasClass(this.smallTabsClassName)},t.isSmallFacetActivated=function(t){return t.hasClass(this.smallFacetClassName)},t.isSmallRecommendationActivated=function(t){return t.hasClass(this.smallRecommendationClassName)},t.activateSmallTabs=function(t){t.addClass(this.smallTabsClassName)},t.deactivateSmallTabs=function(t){t.removeClass(this.smallTabsClassName)},t.activateSmallFacet=function(t){t.addClass(this.smallFacetClassName)},t.deactivateSmallFacet=function(t){t.removeClass(this.smallFacetClassName)},t.activateSmallRecommendation=function(t){t.addClass(this.smallRecommendationClassName)},t.deactivateSmallRecommendation=function(t){t.removeClass(this.smallRecommendationClassName)},t.smallTabsClassName="coveo-small-tabs",t.smallFacetClassName="coveo-small-facets",t.smallRecommendationClassName="coveo-small-recommendation",t.MEDIUM_MOBILE_WIDTH=640,t}();e.ResponsiveComponentsUtils=n},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(134),s=n(109),a=n(17),u=n(35),l=n(91),c=n(135),h=n(141),p=n(142),d=n(143),f=n(144),g=n(93),m=n(45),v=n(48),y=n(14),b=n(58),S=n(121),x=n(15),C=n(145),E=n(146),w=n(137),A=n(147),T=n(32),O=n(101),_=n(98),M=n(46),N=n(148),R=n(149),D=n(139),I=n(92),F=n(106),k=n(42),$=n(150),L=n(69),U=n(140),B=n(50),P=function(e){
function n(i,o,a,u){var l=this;void 0===u&&(u=n.ID),e.call(this,i,u,a),this.element=i,this.options=o,this.keepDisplayedValuesNextTime=!1,this.values=new r.FacetValues,this.currentPage=0,this.firstQuery=!0,this.canFetchMore=!0,this.showingWaitAnimation=!1,this.listenToQueryStateChange=!0,this.options=s.ComponentOptions.initComponentOptions(i,n,o),null!=this.options.valueCaption&&(this.options.availableSorts=t.filter(this.options.availableSorts,function(t){return!/^alpha.*$/.test(t)})),$.ResponsiveFacets.init(this.root,this,this.options),this.omniboxZIndex=n.omniboxIndex,n.omniboxIndex--,this.checkForComputedFieldAndSort(),this.checkForValueCaptionType(),this.checkForCustomSort(),this.initFacetQueryController(),this.initQueryEvents(),this.initQueryStateEvents(),this.initComponentStateEvents(),this.initOmniboxEvents(),this.initBreadCrumbEvents(),this.initSearchAlertEvents(),this.updateNumberOfValues(),this.resize=function(){l.disabled||g.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(l)},window.addEventListener("resize",t.debounce(this.resize,200)),this.bind.onRootElement(m.InitializationEvents.nuke,function(){return l.handleNuke()}),this.bind.oneRootElement(v.QueryEvents.querySuccess,function(){l.firstQuery=!1})}return i(n,e),n.prototype.createDom=function(){var e=this;if(this.initBottomAndTopSpacer(),this.buildFacetContent(),this.updateAppearanceDependingOnState(),this.facetSettings&&this.options.enableSettingsFacetState){var n=t.once(function(){e.facetSettings.loadSavedState.apply(e.facetSettings)});this.bind.onRootElement(v.QueryEvents.newQuery,n)}},n.prototype.selectValue=function(t){y.Assert.exists(t),this.ensureDom(),this.logger.info("Selecting facet value",this.facetValuesList.select(t)),this.facetValueHasChanged()},n.prototype.selectMultipleValues=function(e){var n=this;y.Assert.exists(e),this.ensureDom(),t.each(e,function(t){n.logger.info("Selecting facet value",n.facetValuesList.select(t))}),this.facetValueHasChanged()},n.prototype.deselectValue=function(t){y.Assert.exists(t),this.ensureDom(),this.logger.info("Deselecting facet value",this.facetValuesList.unselect(t)),this.facetValueHasChanged()},n.prototype.deselectMultipleValues=function(e){var n=this;y.Assert.exists(e),this.ensureDom(),t.each(e,function(t){n.logger.info("Deselecting facet value",n.facetValuesList.unselect(t))}),this.facetValueHasChanged()},n.prototype.excludeValue=function(t){y.Assert.exists(t),this.ensureDom(),this.logger.info("Excluding facet value",this.facetValuesList.exclude(t)),this.facetValueHasChanged()},n.prototype.excludeMultipleValues=function(e){var n=this;y.Assert.exists(e),this.ensureDom(),t.each(e,function(t){n.logger.info("Excluding facet value",n.facetValuesList.exclude(t))}),this.facetValueHasChanged()},n.prototype.unexcludeValue=function(t){y.Assert.exists(t),this.ensureDom(),this.logger.info("Unexcluding facet value",this.facetValuesList.unExclude(t)),this.facetValueHasChanged()},n.prototype.unexcludeMultipleValues=function(e){var n=this;y.Assert.exists(e),this.ensureDom(),t.each(e,function(t){n.logger.info("Unexcluding facet value",n.facetValuesList.unExclude(t))}),this.facetValueHasChanged()},n.prototype.toggleSelectValue=function(t){y.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle select facet value",this.facetValuesList.toggleSelect(t)),this.facetValueHasChanged()},n.prototype.toggleExcludeValue=function(t){y.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle exclude facet value",this.facetValuesList.toggleExclude(t)),this.facetValueHasChanged()},n.prototype.getDisplayedValues=function(){return t.pluck(this.getDisplayedFacetValues(),"value")},n.prototype.getDisplayedFacetValues=function(){this.ensureDom();var e=this.facetValuesList.getAllCurrentlyDisplayed();return t.map(e,function(t){return t.facetValue})},n.prototype.getSelectedValues=function(){return this.ensureDom(),t.map(this.values.getSelected(),function(t){return t.value})},n.prototype.getExcludedValues=function(){return this.ensureDom(),t.map(this.values.getExcluded(),function(t){return t.value})},n.prototype.reset=function(){this.ensureDom(),this.values.reset(),this.rebuildValueElements(),this.updateAppearanceDependingOnState(),this.updateQueryStateModel()},n.prototype.switchToAnd=function(){this.ensureDom(),this.logger.info("Switching to AND"),this.facetHeader.switchToAnd()},n.prototype.switchToOr=function(){this.ensureDom(),this.logger.info("Switching to OR"),this.facetHeader.switchToOr()},n.prototype.getEndpoint=function(){return this.queryController.getEndpoint()},n.prototype.updateSort=function(t){this.ensureDom(),this.options.sortCriteria!=t&&(this.options.sortCriteria=t,this.triggerNewQuery())},n.prototype.unfadeInactiveValuesInMainList=function(){b.$$(this.element).removeClass("coveo-facet-fade")},n.prototype.fadeInactiveValuesInMainList=function(t){b.$$(this.element).addClass("coveo-facet-fade")},n.prototype.showWaitingAnimation=function(){this.ensureDom(),this.showingWaitAnimation||(this.searchInterface.isNewDesign()||(b.$$(this.headerElement).find(".coveo-icon").style.display="none"),b.$$(this.headerElement).find(".coveo-facet-header-wait-animation").style.display="",this.showingWaitAnimation=!0)},n.prototype.hideWaitingAnimation=function(){this.ensureDom(),this.showingWaitAnimation&&(b.$$(this.headerElement).find(".coveo-icon").style.display="",b.$$(this.headerElement).find(".coveo-facet-header-wait-animation").style.display="none",this.showingWaitAnimation=!1)},n.prototype.processFacetSearchAllResultsSelected=function(e){var n=this,i=[];t.each(e,function(t){n.ensureFacetValueIsInList(t),i.push(t.value)});var o=this.values.getSelected().concat(this.values.getExcluded());this.numberOfValues=o.length+t.difference(o,e).length,this.numberOfValues=Math.max(this.numberOfValues,this.options.numberOfValues),this.currentPage=Math.floor((this.numberOfValues-this.options.numberOfValues)/this.options.pageSize),this.updateQueryStateModel(),this.triggerNewQuery(function(){return n.usageAnalytics.logSearchEvent(S.analyticsActionCauseList.facetSelectAll,{facetId:n.options.id,facetTitle:n.options.title})})},n.prototype.pinFacetPosition=function(){this.options.preservePosition&&(this.pinnedViewportPosition=this.element.getBoundingClientRect().top)},n.prototype.getValueCaption=function(t){y.Assert.exists(t);var e=t.lookupValue||t.value,n=e;return n=g.FacetUtils.tryToGetTranslatedCaption(this.options.field,e),x.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(n=this.options.valueCaption[e]||n),"function"==typeof this.options.valueCaption&&(this.values.get(e),n=this.options.valueCaption.call(this,this.facetValuesList.get(e).facetValue))),n},n.prototype.showMore=function(){this.currentPage++,this.updateNumberOfValues(),this.nbAvailableValues>=this.numberOfValues||!this.canFetchMore?this.rebuildValueElements():this.triggerMoreQuery()},n.prototype.showLess=function(){b.$$(this.lessElement).removeClass("coveo-active"),this.currentPage=0,this.updateNumberOfValues(),b.$$(this.moreElement).addClass("coveo-active"),this.values.sortValuesDependingOnStatus(this.numberOfValues),this.rebuildValueElements()},n.prototype.collapse=function(){this.ensureDom(),this.facetHeader&&this.facetHeader.collapseFacet()},n.prototype.expand=function(){this.ensureDom(),this.facetHeader&&this.facetHeader.expandFacet()},n.prototype.triggerNewQuery=function(t){t?this.queryController.executeQuery({beforeExecuteQuery:t}):this.queryController.executeQuery({ignoreWarningSearchEvent:!0}),this.showWaitingAnimation()},n.prototype.handleDeferredQuerySuccess=function(t){y.Assert.exists(t),this.unfadeInactiveValuesInMainList(),this.hideWaitingAnimation(),this.updateVisibilityBasedOnDependsOn();var e=t.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];this.facetQueryController.lastGroupByResult=e,e||(this.keepDisplayedValuesNextTime=!1),this.processNewGroupByResults(e)},n.prototype.handlePopulateBreadcrumb=function(t){if(y.Assert.exists(t),this.values.hasSelectedOrExcludedValues()){var e=new E.BreadcrumbValueList(this,this.values.getSelected().concat(this.values.getExcluded()),C.BreadcrumbValueElement).build();t.breadcrumbs.push({element:e})}},n.prototype.handlePopulateSearchAlerts=function(t){this.values.hasSelectedOrExcludedValues()&&t.text.push(new E.BreadcrumbValueList(this,this.values.getSelected().concat(this.values.getExcluded()),C.BreadcrumbValueElement).buildAsString())},n.prototype.initFacetQueryController=function(){this.facetQueryController=new l.FacetQueryController(this)},n.prototype.initFacetValuesList=function(){this.facetValuesList=new d.FacetValuesList(this,w.FacetValueElement),this.element.appendChild(this.facetValuesList.build())},n.prototype.initFacetSearch=function(){this.facetSearch=new c.FacetSearch(this,A.FacetSearchValuesList,this.root),this.element.appendChild(this.facetSearch.build())},n.prototype.facetValueHasChanged=function(){var t=this;this.updateQueryStateModel(),this.rebuildValueElements(),T.Defer.defer(function(){t.updateAppearanceDependingOnState()})},n.prototype.updateAppearanceDependingOnState=function(){b.$$(this.element).toggleClass("coveo-active",this.values.hasSelectedOrExcludedValues()),b.$$(this.element).toggleClass("coveo-facet-empty",!this.isAnyValueCurrentlyDisplayed()),b.$$(this.facetHeader.eraserElement).toggle(this.values.hasSelectedOrExcludedValues())},n.prototype.initQueryEvents=function(){var t=this;this.bind.onRootElement(v.QueryEvents.duringQuery,function(){return t.handleDuringQuery()}),this.bind.onRootElement(v.QueryEvents.buildingQuery,function(e){return t.handleBuildingQuery(e)}),this.bind.onRootElement(v.QueryEvents.doneBuildingQuery,function(e){return t.handleDoneBuildingQuery(e)}),this.bind.onRootElement(v.QueryEvents.deferredQuerySuccess,function(e){return t.handleDeferredQuerySuccess(e)})},n.prototype.initQueryStateEvents=function(){var t=this;this.includedAttributeId=O.QueryStateModel.getFacetId(this.options.id),this.excludedAttributeId=O.QueryStateModel.getFacetId(this.options.id,!1),this.operatorAttributeId=O.QueryStateModel.getFacetOperator(this.options.id),this.lookupValueAttributeId=O.QueryStateModel.getFacetLookupValue(this.options.id),this.queryStateModel.registerNewAttribute(this.includedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.excludedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.operatorAttributeId,""),this.queryStateModel.registerNewAttribute(this.lookupValueAttributeId,{}),this.bind.onQueryState(_.MODEL_EVENTS.CHANGE,void 0,function(e){return t.handleQueryStateChanged(e)})},n.prototype.initComponentStateEvents=function(){this.componentStateId=O.QueryStateModel.getFacetId(this.options.id),this.componentStateModel.registerComponent(this.componentStateId,this)},n.prototype.initOmniboxEvents=function(){var t=this;this.options.includeInOmnibox&&this.bind.onRootElement(M.OmniboxEvents.populateOmnibox,function(e){return t.handlePopulateOmnibox(e)})},n.prototype.initBreadCrumbEvents=function(){var t=this;this.options.includeInBreadcrumb&&(this.bind.onRootElement(k.BreadcrumbEvents.populateBreadcrumb,function(e){return t.handlePopulateBreadcrumb(e)}),this.bind.onRootElement(k.BreadcrumbEvents.clearBreadcrumb,function(e){return t.handleClearBreadcrumb()}))},n.prototype.initSearchAlertEvents=function(){var t=this;this.bind.onRootElement(B.SearchAlertsEvents.searchAlertsPopulateMessage,function(e){return t.handlePopulateSearchAlerts(e)})},n.prototype.handleOmniboxWithStaticValue=function(e){var n=this,i=new RegExp("^"+e.completeQueryExpression.regex.source,"i"),o=t.first(t.filter(this.getDisplayedValues(),function(t){var e=n.getValueCaption(n.facetValuesList.get(t).facetValue);return i.test(e)}),this.options.numberOfValuesInOmnibox),r=t.map(o,function(t){return n.facetValuesList.get(t).facetValue}),s=new R.OmniboxValuesList(this,r,e,N.OmniboxValueElement).build();e.rows.push({element:s,zIndex:this.omniboxZIndex})},n.prototype.processNewGroupByResults=function(e){this.logger.trace("Displaying group by results",e),void 0!=e&&void 0!=e.values&&(this.nbAvailableValues=e.values.length);var n=new r.FacetValues(e);this.updateValues(n),this.canFetchMore=this.numberOfValues<this.nbAvailableValues,this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField?this.triggerUpdateDeltaQuery(t.filter(this.values.getAll(),function(t){return!t.selected&&!t.excluded})):this.values.getSelected().length>0&&!this.options.useAnd&&this.values.updateDeltaWithFilteredFacetValues(new r.FacetValues),this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField||(this.rebuildValueElements(),this.updateAppearanceDependingOnState(),this.ensurePinnedFacetHasntMoved()),this.keepDisplayedValuesNextTime=!1},n.prototype.updateQueryStateModel=function(){this.listenToQueryStateChange=!1,this.updateExcludedQueryStateModel(),this.updateIncludedQueryStateModel(),this.facetHeader.updateOperatorQueryStateModel(),this.updateLookupValueQueryStateModel(),this.listenToQueryStateChange=!0},n.prototype.rebuildValueElements=function(){this.updateNumberOfValues(),this.facetValuesList.rebuild(this.numberOfValues),this.searchInterface.isNewDesign()?this.shouldRenderMoreLess()?(this.updateMoreLess(),this.shouldRenderFacetSearch()&&this.updateSearchInNewDesign(this.nbAvailableValues>this.numberOfValues)):this.shouldRenderFacetSearch()&&this.updateSearchInNewDesign():this.shouldRenderMoreLess()&&this.updateMoreLess()},n.prototype.updateSearchInNewDesign=function(t){var e=this;if(void 0===t&&(t=!0),this.searchInterface.isNewDesign()&&t){var n=new D.ValueElementRenderer(this,r.FacetValue.create(u.l("Search"))),i=n.build().withNo([n.excludeIcon,n.icon]);b.$$(i.listItem).addClass("coveo-facet-search-button"),i.stylishCheckbox.removeAttribute("tabindex"),a.DeviceUtils.isMobileDevice()&&b.$$(i.label).on("click",function(t){i.checkbox.getAttribute("checked")?i.checkbox.removeAttribute("checked"):i.checkbox.setAttribute("checked","checked"),b.$$(i.checkbox).trigger("change"),t.stopPropagation(),t.preventDefault()}),b.$$(i.checkbox).on("change",function(){b.$$(e.element).addClass("coveo-facet-searching"),e.facetSearch.focus()}),this.facetValuesList.valueContainer.appendChild(i.listItem)}},n.prototype.updateMoreLess=function(t,e){void 0===t&&(t=this.getMinimumNumberOfValuesToDisplay()<this.numberOfValues),void 0===e&&(e=this.nbAvailableValues>this.numberOfValues),t?b.$$(this.lessElement).addClass("coveo-active"):b.$$(this.lessElement).removeClass("coveo-active"),e?b.$$(this.moreElement).addClass("coveo-active"):b.$$(this.moreElement).removeClass("coveo-active"),t||e?b.$$(this.footerElement).removeClass("coveo-facet-empty"):b.$$(this.footerElement).addClass("coveo-facet-empty")},n.prototype.handleClickMore=function(){this.showMore()},n.prototype.handleClickLess=function(){this.showLess()},n.prototype.handleNuke=function(){window.removeEventListener("resize",this.resize)},n.prototype.checkForComputedFieldAndSort=function(){this.options.sortCriteria.toLowerCase().indexOf("computedfield")!=-1&&x.Utils.isNullOrUndefined(this.options.computedField)&&this.logger.warn("Sort criteria is specified as ComputedField, but the facet uses no computed field. Facet will always be empty !",this)},n.prototype.checkForValueCaptionType=function(){this.options.valueCaption&&"function"==typeof this.options.valueCaption&&(this.options.enableFacetSearch=!1,this.options.includeInOmnibox=!1,this.logger.warn("Using a function as valueCaption is now deprecated. Use a json key value pair instead. Facet search and omnibox has been disabled for this facet",this))},n.prototype.checkForCustomSort=function(){void 0==this.options.customSort||t.contains(this.options.availableSorts,"custom")||this.options.availableSorts.unshift("custom"),"custom"==this.options.availableSorts[0]&&(this.options.sortCriteria="nosort")},n.prototype.initBottomAndTopSpacer=function(){var t=this,e=b.$$(this.options.paddingContainer).find(".coveo-bottomSpace"),n=b.$$(this.options.paddingContainer).find(".coveo-topSpace");this.options.preservePosition&&(b.$$(this.options.paddingContainer).on("mouseleave",function(){return t.unpinFacetPosition()}),this.pinnedTopSpace=n,this.pinnedBottomSpace=e,this.pinnedTopSpace||(this.pinnedTopSpace=document.createElement("div"),b.$$(this.pinnedTopSpace).addClass("coveo-topSpace"),b.$$(this.pinnedTopSpace).insertBefore(this.options.paddingContainer.firstChild)),this.pinnedBottomSpace||(this.pinnedBottomSpace=document.createElement("div"),b.$$(this.pinnedBottomSpace).addClass("coveo-bottomSpace"),this.options.paddingContainer.appendChild(this.pinnedBottomSpace)))},n.prototype.updateIncludedQueryStateModel=function(){var t={included:this.getSelectedValues(),title:this.includedAttributeId};this.queryStateModel.set(this.includedAttributeId,t.included)},n.prototype.updateExcludedQueryStateModel=function(){var t={title:this.excludedAttributeId,excluded:this.getExcludedValues()};this.queryStateModel.set(this.excludedAttributeId,t.excluded)},n.prototype.updateLookupValueQueryStateModel=function(){if(this.options.lookupField){var e={};t.each(this.values.getSelected().concat(this.values.getExcluded()),function(t){e[t.value]=t.lookupValue}),this.queryStateModel.set(this.lookupValueAttributeId,e)}},n.prototype.handleQueryStateChangedOperator=function(t){"and"==t?this.switchToAnd():"or"==t&&this.switchToOr()},n.prototype.handleQueryStateChangedIncluded=function(e){var n=t.difference(this.getSelectedValues(),e);x.Utils.isNonEmptyArray(n)&&this.deselectMultipleValues(n),x.Utils.arrayEqual(this.getSelectedValues(),e,!1)||this.selectMultipleValues(e)},n.prototype.handleQueryStateChangedExcluded=function(e){var n=t.difference(this.getExcludedValues(),e);x.Utils.isNonEmptyArray(n)&&this.unexcludeMultipleValues(n),x.Utils.arrayEqual(this.getExcludedValues(),e,!1)||this.excludeMultipleValues(e)},n.prototype.handleLookupvalueChanged=function(e){var n=this;t.each(e,function(t,e){n.facetValuesList.get(decodeURIComponent(e)).facetValue.lookupValue=decodeURIComponent(t)})},n.prototype.handleQueryStateChanged=function(t){y.Assert.exists(t),this.ensureDom();var e=t.attributes,n=e[this.includedAttributeId],i=e[this.excludedAttributeId],o=e[this.operatorAttributeId],r=e[this.lookupValueAttributeId];this.listenToQueryStateChange&&(x.Utils.isNullOrEmptyString(o)||this.handleQueryStateChangedOperator(o),x.Utils.isNullOrUndefined(n)||this.handleQueryStateChangedIncluded(n),x.Utils.isNullOrUndefined(i)||this.handleQueryStateChangedExcluded(i),x.Utils.isNullOrUndefined(r)||this.handleLookupvalueChanged(r))},n.prototype.handlePopulateOmnibox=function(t){y.Assert.exists(t),y.Assert.exists(t.completeQueryExpression),this.queryController.ensureCreatedQueryBuilder(),this.canFetchMore?this.handleOmniboxWithSearchInFacet(t):this.handleOmniboxWithStaticValue(t)},n.prototype.handleOmniboxWithSearchInFacet=function(e){var n=this,i=new RegExp("^"+e.completeQueryExpression.regex.source,"i"),o=new Promise(function(o,s){var a=new I.FacetSearchParameters(n);a.setValueToSearch(e.completeQueryExpression.word),a.nbResults=n.options.numberOfValuesInOmnibox,n.facetQueryController.search(a).then(function(s){var a=t.map(t.filter(s,function(t){return i.test(t.lookupValue)}),function(t){return n.values.get(t.lookupValue)||r.FacetValue.create(t)}),u=new R.OmniboxValuesList(n,a,e,N.OmniboxValueElement).build();o({element:u,zIndex:n.omniboxZIndex})}).catch(function(){o({element:void 0})})});e.rows.push({deferred:o})},n.prototype.handleDuringQuery=function(){this.ensureDom(),this.keepDisplayedValuesNextTime||this.fadeInactiveValuesInMainList(this.options.facetSearchDelay)},n.prototype.handleBuildingQuery=function(t){if(y.Assert.exists(t),y.Assert.exists(t.queryBuilder),this.facetQueryController.prepareForNewQuery(),this.values.hasSelectedOrExcludedValues()){var e=this.facetQueryController.computeOurFilterExpression();this.logger.trace("Putting filter in query",e),t.queryBuilder.advancedExpression.add(e)}},n.prototype.handleDoneBuildingQuery=function(t){y.Assert.exists(t),y.Assert.exists(t.queryBuilder);var e=t.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(e)},n.prototype.handleClearBreadcrumb=function(){this.reset()},n.prototype.updateValues=function(t){y.Assert.exists(t),this.keepDisplayedValuesNextTime?this.values.updateCountsFromNewValues(t):(t.importActiveValuesFromOtherList(this.values),t.sortValuesDependingOnStatus(this.numberOfValues),this.values=t),this.updateNumberOfValues()},n.prototype.ensureFacetValueIsInList=function(t){y.Assert.exists(t),this.values.contains(t.value)||this.values.add(t)},n.prototype.isAnyValueCurrentlyDisplayed=function(){return!this.values.isEmpty()},n.prototype.buildFacetContent=function(){this.headerElement=this.buildHeader(),this.element.appendChild(this.headerElement),this.initFacetValuesList(),this.shouldRenderFacetSearch()&&this.initFacetSearch(),this.shouldRenderMoreLess()&&(this.moreElement=this.buildMore(),this.lessElement=this.buildLess()),this.footerElement=this.buildFooter(),this.element.appendChild(this.footerElement),this.searchInterface.isNewDesign()&&this.lessElement&&this.moreElement?(this.footerElement.appendChild(this.lessElement),this.footerElement.appendChild(this.moreElement)):this.moreElement&&this.lessElement&&(this.footerElement.appendChild(this.moreElement),this.footerElement.appendChild(this.lessElement))},n.prototype.buildHeader=function(){var t=this.options.headerIcon;this.searchInterface.isNewDesign()&&this.options.headerIcon==this.options.field&&(t=void 0),this.facetHeader=new f.FacetHeader({facetElement:this.element,title:this.options.title,icon:t,field:this.options.field,enableClearElement:!0,enableCollapseElement:this.options.enableCollapse,facet:this,settingsKlass:this.options.enableSettings?h.FacetSettings:void 0,sortKlass:p.FacetSort,availableSorts:this.options.availableSorts,isNewDesign:this.getBindings().searchInterface.isNewDesign()});var e=this.facetHeader.build();return this.facetSettings=this.facetHeader.settings,this.facetSort=this.facetHeader.sort,e},n.prototype.unpinFacetPosition=function(){this.shouldFacetUnpin()&&this.options.preservePosition&&(b.$$(this.pinnedTopSpace).addClass("coveo-with-animation"),b.$$(this.pinnedBottomSpace).addClass("coveo-with-animation"),this.pinnedTopSpace.style.height="0px",this.pinnedBottomSpace.style.height="0px",this.unpinnedViewportPosition=void 0)},n.prototype.isFacetPinned=function(){return x.Utils.exists(this.pinnedViewportPosition)},n.prototype.shouldFacetUnpin=function(){return x.Utils.exists(this.unpinnedViewportPosition)},n.prototype.ensurePinnedFacetHasntMoved=function(){var e=this;if(this.isFacetPinned()){y.Assert.exists(this.pinnedViewportPosition),b.$$(this.pinnedTopSpace).removeClass("coveo-with-animation"),b.$$(this.pinnedBottomSpace).removeClass("coveo-with-animation"),this.pinnedTopSpace.style.height="0px",this.pinnedBottomSpace.style.height="0px";var n=this.options.scrollContainer==document.body?window:this.options.scrollContainer,i=this.element.getBoundingClientRect().top,o=i-this.pinnedViewportPosition,r=function(){n instanceof Window?window.scrollTo(0,window.scrollY+o):n.scrollTop=n.scrollTop+o};r(),i=this.element.getBoundingClientRect().top,o=i-this.pinnedViewportPosition,o<0?this.pinnedTopSpace.style.height=o*-1+"px":t.defer(function(){for(var t=0,n=0;o>0&&n++<100;)t+=100,e.pinnedBottomSpace.style.height=t+"px",i=e.element.getBoundingClientRect().top,o=i-e.pinnedViewportPosition,r()}),this.unpinnedViewportPosition=this.pinnedViewportPosition,this.pinnedViewportPosition=null}},n.prototype.buildFooter=function(){return b.$$("div",{className:"coveo-facet-footer"}).el},n.prototype.buildMore=function(){var t,e=this;t=this.searchInterface.isNewDesign()?b.$$("div",{className:"coveo-facet-more",tabindex:0},b.$$("span",{className:"coveo-icon"})).el:b.$$("a",{className:"coveo-facet-more"},u.l("More")).el;var n=function(){return e.handleClickMore()};return b.$$(t).on("click",n),b.$$(t).on("keyup",L.KeyboardUtils.keypressAction(L.KEYBOARD.ENTER,n)),t},n.prototype.buildLess=function(){var t,e=this;t=this.searchInterface.isNewDesign()?b.$$("div",{className:"coveo-facet-less",tabindex:0},b.$$("span",{className:"coveo-icon"})).el:b.$$("a",{className:"coveo-facet-less"},u.l("Less")).el;var n=function(){return e.handleClickLess()};return b.$$(t).on("click",n),b.$$(t).on("keyup",L.KeyboardUtils.keypressAction(L.KEYBOARD.ENTER,n)),t},n.prototype.triggerMoreQuery=function(){var e=this;this.logger.info("Triggering new facet more query"),this.showWaitingAnimation(),this.facetQueryController.fetchMore(this.numberOfValues+1).then(function(n){var i=new r.FacetValues(n.groupByResults[0]);i.importActiveValuesFromOtherList(e.values),i.sortValuesDependingOnStatus(e.numberOfValues),e.values=i,e.nbAvailableValues=e.values.size(),e.updateNumberOfValues(),e.canFetchMore=e.numberOfValues<e.nbAvailableValues,e.values.hasSelectedOrExcludedValues()&&!e.options.useAnd&&e.options.isMultiValueField?e.triggerUpdateDeltaQuery(t.filter(e.values.getAll(),function(t){return!t.selected&&!t.excluded})):(e.values.hasSelectedOrExcludedValues()&&!e.options.useAnd?(e.values.updateDeltaWithFilteredFacetValues(new r.FacetValues),e.hideWaitingAnimation()):e.hideWaitingAnimation(),e.rebuildValueElements())}).catch(function(){return e.hideWaitingAnimation()})},n.prototype.triggerUpdateDeltaQuery=function(e){var n=this;this.showWaitingAnimation(),this.facetQueryController.searchInFacetToUpdateDelta(e).then(function(e){var i=new r.FacetValues;t.each(e.groupByResults,function(e){t.each(e.values,function(t){i.contains(t.value)||i.add(r.FacetValue.createFromGroupByValue(t))})}),n.values.updateDeltaWithFilteredFacetValues(i),n.rebuildValueElements(),n.hideWaitingAnimation()})},n.prototype.updateNumberOfValues=function(){this.currentPage<=0?(this.currentPage=0,this.numberOfValues=0):this.numberOfValues=this.options.numberOfValues+this.currentPage*this.options.pageSize,this.numberOfValues=Math.max(this.numberOfValues,this.getMinimumNumberOfValuesToDisplay())},n.prototype.getMinimumNumberOfValuesToDisplay=function(){var t=this.values.getExcluded().length+this.values.getSelected().length;if(null!=this.options.customSort&&null!=this.facetSort&&this.options.customSort.length>0){var e=-1;new U.FacetValuesOrder(this,this.facetSort).reorderValues(this.values.getAll()).forEach(function(t,n){t.selected&&(e=n)}),t=e+1}return Math.max(t,this.options.numberOfValues)},n.prototype.updateVisibilityBasedOnDependsOn=function(){x.Utils.isNonEmptyString(this.options.dependsOn)&&b.$$(this.element).toggleClass("coveo-facet-dependent",!this.doesParentFacetHasSelectedValue()&&!this.values.hasSelectedOrExcludedValues())},n.prototype.doesParentFacetHasSelectedValue=function(){var t=O.QueryStateModel.getFacetId(this.options.dependsOn),e=this.queryStateModel.get(t);return null!=e&&0!=e.length},n.prototype.shouldRenderFacetSearch=function(){return this.options.enableFacetSearch},n.prototype.shouldRenderMoreLess=function(){return this.options.enableMoreLess},n.prototype.debugInfo=function(){var t={};return t[this.constructor.ID]={component:this,groupByRequest:this.facetQueryController.lastGroupByRequest,groupByResult:this.facetQueryController.lastGroupByResult},t},n.ID="Facet",n.omniboxIndex=50,n.options={title:s.ComponentOptions.buildLocalizedStringOption({defaultValue:u.l("NoTitle"),section:"Identification",priority:10}),field:s.ComponentOptions.buildFieldOption({required:!0,groupByField:!0,section:"Identification"}),headerIcon:s.ComponentOptions.buildIconOption({deprecated:"This option is exposed for legacy reason, and the recommendation is to not use this option."}),id:s.ComponentOptions.buildStringOption({postProcessing:function(t,e){return t||e.field}}),isMultiValueField:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),lookupField:s.ComponentOptions.buildFieldOption({deprecated:"This option is exposed for legacy reason, and the recommendation is to not use this option."}),enableSettings:s.ComponentOptions.buildBooleanOption({defaultValue:!0,section:"SettingsMenu",priority:9}),enableSettingsFacetState:s.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableSettings"}),availableSorts:s.ComponentOptions.buildListOption({defaultValue:["occurrences","score","alphaAscending","alphaDescending"],values:["Occurrences","Score","AlphaAscending","AlphaDescending","ComputedFieldAscending","ComputedFieldDescending","ChiSquare","NoSort"],depend:"enableSettings"}),sortCriteria:s.ComponentOptions.buildStringOption({postProcessing:function(t,e){return t||(e.availableSorts.length>0?e.availableSorts[0]:"occurrences")}}),customSort:s.ComponentOptions.buildListOption({section:"Identification"}),numberOfValues:s.ComponentOptions.buildNumberOption({defaultValue:5,min:0,section:"Identification"}),injectionDepth:s.ComponentOptions.buildNumberOption({defaultValue:1e3,min:0}),showIcon:s.ComponentOptions.buildBooleanOption({defaultValue:!1,deprecated:"This option is exposed for legacy reason, and the recommendation is to not use this option."}),useAnd:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableTogglingOperator:s.ComponentOptions.buildBooleanOption({defaultValue:!1,alias:"allowTogglingOperator"}),enableFacetSearch:s.ComponentOptions.buildBooleanOption({defaultValue:!0,section:"FacetSearch",priority:8}),facetSearchDelay:s.ComponentOptions.buildNumberOption({defaultValue:100,min:0,depend:"enableFacetSearch"}),facetSearchIgnoreAccents:s.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableFacetSearch"}),numberOfValuesInFacetSearch:s.ComponentOptions.buildNumberOption({defaultValue:15,min:1}),includeInBreadcrumb:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),numberOfValuesInBreadcrumb:s.ComponentOptions.buildNumberOption({defaultFunction:function(){return a.DeviceUtils.isMobileDevice()?3:5},min:0,depend:"includeInBreadcrumb"}),includeInOmnibox:s.ComponentOptions.buildBooleanOption({defaultValue:!1,deprecated:"This option is exposed for legacy reason, and the recommendation is to not use this option."}),numberOfValuesInOmnibox:s.ComponentOptions.buildNumberOption({defaultFunction:function(){return a.DeviceUtils.isMobileDevice()?3:5},min:0,depend:"includeInOmnibox",deprecated:"This option is exposed for legacy reason, and the recommendation is to not use this option."}),computedField:s.ComponentOptions.buildFieldOption({section:"ComputedField",priority:7}),computedFieldOperation:s.ComponentOptions.buildStringOption({defaultValue:"sum",section:"ComputedField"}),computedFieldFormat:s.ComponentOptions.buildStringOption({defaultValue:"c0",section:"ComputedField"}),computedFieldCaption:s.ComponentOptions.buildLocalizedStringOption({defaultValue:u.l("ComputedField"),section:"ComputedField"}),preservePosition:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),paddingContainer:s.ComponentOptions.buildSelectorOption({defaultFunction:function(t){return t.parentElement}}),scrollContainer:s.ComponentOptions.buildSelectorOption({defaultFunction:function(t){return document.body}}),enableMoreLess:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),pageSize:s.ComponentOptions.buildNumberOption({defaultValue:10,min:1,depend:"enableMoreLess"}),enableCollapse:s.ComponentOptions.buildBooleanOption({defaultValue:!0,depend:"enableSettings"}),allowedValues:s.ComponentOptions.buildListOption(),additionalFilter:s.ComponentOptions.buildStringOption(),dependsOn:s.ComponentOptions.buildStringOption(),valueCaption:s.ComponentOptions.buildCustomOption(function(){return null}),enableResponsiveMode:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),responsiveBreakpoint:s.ComponentOptions.buildNumberOption({defaultValue:800}),dropdownHeaderLabel:s.ComponentOptions.buildLocalizedStringOption()},n}(o.Component);e.Facet=P,F.Initialization.registerAutoCreateComponent(P)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(15),r=n(28),s=function(){function e(){this.selected=!1,
this.excluded=!1,this.waitingForDelta=!1}return e.prototype.reset=function(){this.selected=!1,this.excluded=!1},e.prototype.updateCountsFromNewValue=function(t){i.Assert.exists(t),this.occurrences=t.occurrences,this.delta=t.delta,this.computedField=t.computedField},e.prototype.cloneWithZeroOccurrences=function(){return this.occurrences=0,this.computedField=void 0,this.delta=void 0,this},e.prototype.cloneWithDelta=function(t,e){i.Assert.isLargerOrEqualsThan(0,t);var n=this.cloneWithZeroOccurrences();return n.delta=e,n.occurrences=t,n},e.prototype.getFormattedCount=function(){var t=void 0;return o.Utils.exists(this.delta)&&this.delta>0?t="+"+r.format(this.delta,"n0"):this.occurrences>0&&(t=r.format(this.occurrences,"n0")),t},e.prototype.getFormattedComputedField=function(t){return 0!=this.computedField?r.format(this.computedField,t):void 0},e.create=function(n){if(t.isString(n))return e.createFromValue(n);if(t.isObject(n))return"computedFieldResults"in n?e.createFromGroupByValue(n):e.createFromFieldValue(n);throw new Error("Can't create value from "+n)},e.createFromValue=function(t){i.Assert.isNonEmptyString(t);var n=new e;return n.value=t,n.lookupValue=t,n},e.createFromGroupByValue=function(t){i.Assert.exists(t),i.Assert.exists(t);var n=new e;return n.value=t.value,n.lookupValue=o.Utils.exists(t.lookupValue)?t.lookupValue:t.value,n.occurrences=t.numberOfResults,n.computedField=o.Utils.isNonEmptyArray(t.computedFieldResults)?t.computedFieldResults[0]:void 0,n.score=t.score,n},e.createFromFieldValue=function(t){i.Assert.exists(t);var n=new e;return n.value=t.value,n.lookupValue=t.lookupValue,n.occurrences=t.numberOfResults,n},e}();e.FacetValue=s;var a=function(){function e(e){o.Utils.exists(e)?this.values=t.map(e.values,function(t){return s.createFromGroupByValue(t)}):this.values=[]}return e.prototype.add=function(t){i.Assert.exists(t),i.Assert.check(!this.contains(t.value)),this.values.push(t)},e.prototype.remove=function(e){i.Assert.isNonEmptyString(e),e=e,this.values=t.filter(this.values,function(t){return t.value!=e})},e.prototype.size=function(){return this.values.length},e.prototype.isEmpty=function(){return 0==this.values.length},e.prototype.at=function(t){return i.Assert.isLargerOrEqualsThan(0,t),i.Assert.isSmallerThan(this.values.length,t),this.values[t]},e.prototype.get=function(e){return t.find(this.values,function(t){return t.value.toLowerCase()==e.toLowerCase()})},e.prototype.contains=function(t){return o.Utils.exists(this.get(t))},e.prototype.getAll=function(){return this.values},e.prototype.getSelected=function(){return t.filter(this.values,function(t){return t.selected})},e.prototype.getExcluded=function(){return t.filter(this.values,function(t){return t.excluded})},e.prototype.hasSelectedOrExcludedValues=function(){return 0!=this.getSelected().length||0!=this.getExcluded().length},e.prototype.reset=function(){t.each(this.values,function(t){return t.reset()})},e.prototype.importActiveValuesFromOtherList=function(e){var n=this;i.Assert.exists(e),t.each(e.getSelected(),function(t){var e=n.get(t.value);o.Utils.exists(e)?e.selected=!0:n.values.push(t.cloneWithZeroOccurrences())}),t.each(e.getExcluded(),function(t){var e=n.get(t.value);if(o.Utils.exists(e))e.excluded=!0;else if(0!=t.occurrences){var i=t.occurrences,r=t.cloneWithZeroOccurrences();r.occurrences=i,n.values.push(r)}else n.values.push(t.cloneWithZeroOccurrences())})},e.prototype.updateCountsFromNewValues=function(e){i.Assert.exists(e),this.values=t.map(this.values,function(t){var n=e.get(t.value);return o.Utils.exists(n)?(t.updateCountsFromNewValue(n),t):t.cloneWithZeroOccurrences()})},e.prototype.updateDeltaWithFilteredFacetValues=function(e){i.Assert.exists(e),t.each(this.values,function(t){var n=e.get(t.value);t.waitingForDelta=!1,o.Utils.exists(n)?t.occurrences-n.occurrences>0?t.delta=t.occurrences-n.occurrences:t.delta=null:t.selected||t.excluded||(t.delta=t.occurrences)})},e.prototype.mergeWithUnfilteredFacetValues=function(e){var n=this;i.Assert.exists(e);var r=[];t.each(e.values,function(t){var e=n.get(t.value);o.Utils.exists(e)?e.occurrences==t.occurrences?r.push(e):r.push(t.cloneWithDelta(t.occurrences,t.occurrences-e.occurrences)):r.push(t.cloneWithDelta(t.occurrences,t.occurrences))});var s=0;t.each(this.values,function(t){var n=e.get(t.value);if(o.Utils.exists(n)){for(var i=0;i<r.length;i++)if(r[i].value==t.value){s=i+1;break}}else(t.selected||t.excluded)&&(r.splice(s,0,t),s++)}),this.values=r},e.prototype.sortValuesDependingOnStatus=function(e){if(this.values=t.sortBy(this.values,function(t){return t.selected?1:t.excluded?3:2}),null!=e&&e<this.values.length){var n=this.getExcluded().length,i=this.values.splice(this.values.length-n,n);Array.prototype.splice.apply(this.values,[e-n,0].concat(i))}},e}();e.FacetValues=a}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(133),o=n(58),r=n(15),s=n(45),a=n(17),u=n(136),l=n(92),c=n(121),h=n(107),p=n(59),d=n(72),f=n(35),g=n(14),m=n(69),v=n(93),y=n(134),b=n(61),S=n(137),x=n(23),C=n(108),E=n(132),w=n(140),A=function(){function e(e,n,r){var a=this;this.facet=e,this.facetSearchValuesListKlass=n,this.root=r,this.showingFacetSearchWaitAnimation=!1,this.moreValuesToFetch=!0,this.searchBarIsAnimating=!1,this.searchResults=document.createElement("ul"),o.$$(this.searchResults).addClass("coveo-facet-search-results"),this.onResize=t.debounce(function(){a.facet instanceof i.Facet&&a.facet.searchInterface instanceof C.SearchInterface&&a.shouldPositionSearchResults()&&a.positionSearchResults()},250),this.onDocumentClick=function(t){a.handleClickElsewhere(t)},window.addEventListener("resize",function(){return a.onResize()}),document.addEventListener("click",function(t){return a.onDocumentClick(t)}),o.$$(e.root).on(s.InitializationEvents.nuke,function(){return a.handleNuke()})}return e.prototype.isMobileDevice=function(){return a.DeviceUtils.isMobileDevice()&&!this.facet.searchInterface.isNewDesign()},e.prototype.build=function(){return this.isMobileDevice()?this.buildSearchMobile():this.buildBaseSearch()},e.prototype.positionSearchResults=function(t){if(void 0===t&&(t=this.search),null!=this.searchResults){this.isMobileDevice()||(this.searchResults.style.display="block",this.searchResults.style.width=this.facet.element.clientWidth-40+"px"),"none"==o.$$(this.searchResults).css("display")&&(this.searchResults.style.display="");var e=o.$$(this.search);if("none"==e.css("display")||this.searchBarIsAnimating){"none"==o.$$(this.searchResults).css("display")&&(this.searchResults.style.display="");var n=this;u.EventsUtils.addPrefixedEvent(this.search,"AnimationEnd",function(e){d.PopupUtils.positionPopup(n.searchResults,t,n.root,{horizontal:d.HorizontalAlignment.CENTER,vertical:d.VerticalAlignment.BOTTOM}),u.EventsUtils.removePrefixedEvent(n.search,"AnimationEnd",this)})}else d.PopupUtils.positionPopup(this.searchResults,t,this.root,{horizontal:d.HorizontalAlignment.CENTER,vertical:d.VerticalAlignment.BOTTOM})}},e.prototype.completelyDismissSearch=function(){this.cancelAnyPendingSearchOperation(),this.facet.unfadeInactiveValuesInMainList(),o.$$(this.searchResults).empty(),this.moreValuesToFetch=!0,o.$$(this.search).removeClass("coveo-facet-search-no-results"),o.$$(this.facet.element).removeClass("coveo-facet-searching"),this.hideSearchResultsElement(),this.input.value="",o.$$(this.clear).hide(),this.currentlyDisplayedResults=void 0},e.prototype.triggerNewFacetSearch=function(t){var e=this;this.cancelAnyPendingSearchOperation(),this.showFacetSearchWaitingAnimation(),this.facet.logger.info("Triggering new facet search"),this.facetSearchPromise=this.facet.facetQueryController.search(t),this.facetSearchPromise&&this.facetSearchPromise.then(function(n){e.facet.usageAnalytics.logCustomEvent(c.analyticsActionCauseList.facetSearch,{facetId:e.facet.options.id,facetTitle:e.facet.options.title},e.facet.root),e.facet.logger.debug("Received field values",n),e.processNewFacetSearchResults(n,t),e.hideFacetSearchWaitingAnimation(),e.facetSearchPromise=void 0}).catch(function(t){return r.Utils.exists(t)&&(e.facet.logger.error("Error while retrieving facet values",t),e.hideFacetSearchWaitingAnimation()),e.facetSearchPromise=void 0,null})},e.prototype.focus=function(){this.input.focus(),this.handleFacetSearchFocus()},e.prototype.shouldPositionSearchResults=function(){return!this.isMobileDevice()&&!E.ResponsiveComponentsUtils.isSmallFacetActivated(o.$$(this.root))&&o.$$(this.facet.element).hasClass("coveo-facet-searching")},e.prototype.buildBaseSearch=function(){var t=this;return this.search=document.createElement("div"),o.$$(this.search).addClass("coveo-facet-search"),this.magnifier=document.createElement("div"),o.$$(this.magnifier).addClass("coveo-facet-search-magnifier"),this.search.appendChild(this.magnifier),this.wait=document.createElement("div"),o.$$(this.wait).addClass("coveo-facet-search-wait-animation"),this.search.appendChild(this.wait),this.hideFacetSearchWaitingAnimation(),this.clear=document.createElement("div"),o.$$(this.clear).addClass("coveo-facet-search-clear"),this.clear.setAttribute("title",f.l("Clear",f.l("Search"))),this.clear.style.display="none",this.search.appendChild(this.clear),this.clearIcon=document.createElement("span"),o.$$(this.clearIcon).addClass("coveo-icon"),this.clear.appendChild(this.clearIcon),this.middle=document.createElement("div"),o.$$(this.middle).addClass("coveo-facet-search-middle"),this.search.appendChild(this.middle),this.input=document.createElement("input"),this.input.setAttribute("type","text"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("placeholder",this.facet.searchInterface.isNewDesign()?"":f.l("SearchIn",this.facet.options.title)),o.$$(this.input).addClass("coveo-facet-search-input"),h.Component.pointElementsToDummyForm(this.input),this.middle.appendChild(this.input),o.$$(this.input).on("keyup",function(e){return t.handleFacetSearchKeyUp(e)}),o.$$(this.clear).on("click",function(e){return t.handleFacetSearchClear()}),o.$$(this.input).on("focus",function(e){return t.handleFacetSearchFocus()}),this.detectSearchBarAnimation(),this.root.appendChild(this.searchResults),this.searchResults.style.display="none",this.search},e.prototype.buildSearchMobile=function(){var t=this,e=document.createElement("div");return o.$$(e).addClass("coveo-facet-search-button-mobile"),o.$$(e).text(f.l("Search")),this.search=this.buildBaseSearch(),o.$$(e).on("click",function(){var e=document.createElement("div");e.appendChild(t.search),x.ModalBox.open(e,{title:p.DomUtils.getPopUpCloseButton(f.l("Close"),f.l("SearchIn",t.facet.options.title)),validation:function(){return t.completelyDismissSearch(),!0},className:"coveo-mobile-facet-search",titleClose:!0}),t.input.value="",t.input.focus()}),e},e.prototype.handleFacetSearchKeyUp=function(t){g.Assert.exists(t);var e=""==this.input.value;this.showOrHideClearElement(e),this.isMobileDevice()?this.startNewSearchTimeout(this.buildParamsForNormalSearch()):this.handleKeyboardNavigation(t,e)},e.prototype.handleNuke=function(){window.removeEventListener("resize",this.onResize),document.removeEventListener("click",this.onDocumentClick)},e.prototype.handleFacetSearchFocus=function(){this.isMobileDevice()||(this.facet.searchInterface.isNewDesign()?this.startNewSearchTimeout(this.buildParamsForExcludingCurrentlyDisplayedValues()):this.startNewSearchTimeout(this.buildParamsForNormalSearch()))},e.prototype.handleClickElsewhere=function(t){this.currentlyDisplayedResults&&!this.isMobileDevice()&&this.search!=t.target&&this.searchResults!=t.target&&this.completelyDismissSearch()},e.prototype.handleFacetSearchClear=function(){this.input.value="",o.$$(this.clear).hide(),this.completelyDismissSearch()},e.prototype.showOrHideClearElement=function(t){t?(o.$$(this.clear).hide(),o.$$(this.search).removeClass("coveo-facet-search-no-results")):o.$$(this.clear).show()},e.prototype.handleKeyboardNavigation=function(t,e){switch(t.which){case m.KEYBOARD.ENTER:this.keyboardNavigationEnterPressed(t,e);break;case m.KEYBOARD.DELETE:this.keyboardNavigationDeletePressed(t);break;case m.KEYBOARD.ESCAPE:this.completelyDismissSearch();break;case m.KEYBOARD.DOWN_ARROW:this.moveCurrentResultDown();break;case m.KEYBOARD.UP_ARROW:this.moveCurrentResultUp();break;default:this.moreValuesToFetch=!0,this.highlightCurrentQueryWithinSearchResults(),this.startNewSearchTimeout(this.buildParamsForNormalSearch())}},e.prototype.keyboardNavigationEnterPressed=function(t,e){t.shiftKey?this.triggerNewFacetSearch(this.buildParamsForNormalSearch()):"none"!=this.searchResults.style.display?(this.performSelectActionOnCurrentSearchResult(),this.completelyDismissSearch()):o.$$(this.search).is(".coveo-facet-search-no-results")&&!e&&this.selectAllValuesMatchingSearch()},e.prototype.keyboardNavigationDeletePressed=function(t){t.shiftKey&&(this.performExcludeActionOnCurrentSearchResult(),this.completelyDismissSearch(),this.input.value="")},e.prototype.startNewSearchTimeout=function(t){var e=this;this.cancelAnyPendingSearchOperation(),this.facetSearchTimeout=setTimeout(function(){var n=e.getValueInInputForFacetSearch();""==n?t.searchEvenIfEmpty?e.triggerNewFacetSearch(t):e.completelyDismissSearch():e.triggerNewFacetSearch(t)},this.facet.options.facetSearchDelay)},e.prototype.cancelAnyPendingSearchOperation=function(){r.Utils.exists(this.facetSearchTimeout)&&(clearTimeout(this.facetSearchTimeout),this.facetSearchTimeout=void 0),r.Utils.exists(this.facetSearchPromise)&&(Promise.reject(this.facetSearchPromise).catch(function(){}),this.facetSearchPromise=void 0),this.hideFacetSearchWaitingAnimation()},e.prototype.processNewFacetSearchResults=function(t,e){g.Assert.exists(t),t=new w.FacetValuesOrder(this.facet,this.facet.facetSort).reorderValues(t),t.length>0?(o.$$(this.search).removeClass("coveo-facet-search-no-results"),this.facet.fadeInactiveValuesInMainList(this.facet.options.facetSearchDelay),this.rebuildSearchResults(t,e),e.fetchMore||this.showSearchResultsElement(),this.highlightCurrentQueryWithinSearchResults(),v.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet,!0),this.makeFirstSearchResultTheCurrentOne()):e.fetchMore?this.moreValuesToFetch=!1:(this.hideSearchResultsElement(),o.$$(this.search).addClass("coveo-facet-search-no-results"))},e.prototype.rebuildSearchResults=function(e,n){var i=this;g.Assert.exists(e),n.fetchMore||o.$$(this.searchResults).empty();var s=document.createElement("li");r.Utils.isNonEmptyString(n.valueToSearch)&&(o.$$(s).addClass(["coveo-facet-selectable","coveo-facet-search-selectable","coveo-facet-search-select-all"]),o.$$(s).text("SelectAll"),o.$$(s).on("click",function(){return i.selectAllValuesMatchingSearch()}),this.isMobileDevice()||this.searchResults.appendChild(s));var a=t.map(e,function(t){return y.FacetValue.create(t)});if(t.each(new this.facetSearchValuesListKlass(this.facet,S.FacetValueElement).build(a),function(t){i.searchResults.appendChild(t)}),this.currentlyDisplayedResults?this.currentlyDisplayedResults=this.currentlyDisplayedResults.concat(t.pluck(a,"value")):this.currentlyDisplayedResults=t.pluck(a,"value"),this.isMobileDevice()){var u=document.createElement("span");o.$$(u).addClass("coveo-mobile-facet-search-select-all"),s.appendChild(u),this.searchResults.appendChild(s)}t.each(o.$$(this.searchResults).findAll(".coveo-facet-selectable"),function(t){o.$$(t).addClass("coveo-facet-search-selectable"),i.setupFacetSearchResultsEvents(t)}),this.facet.searchInterface.isNewDesign()&&o.$$(this.searchResults).on("scroll",function(){return i.handleFacetSearchResultsScroll()})},e.prototype.setupFacetSearchResultsEvents=function(t){var e=this;o.$$(t).on("mousemove",function(){e.makeCurrentResult(t)});var n=!1,i=!1;o.$$(t).on("mousedown",function(){return i=!1}),o.$$(t).on("mousemove",function(){return i=!0}),o.$$(t).on("touchmove",function(){return n=!0}),o.$$(t).on("mouseup touchend",function(){n||i||setTimeout(function(){e.completelyDismissSearch()},0),n=!1,i=!1})},e.prototype.handleFacetSearchResultsScroll=function(){if(!this.facetSearchPromise&&""==this.getValueInInputForFacetSearch()&&this.moreValuesToFetch){var t=this.searchResults.clientHeight,e=this.searchResults.scrollHeight,n=this.searchResults.scrollTop+t;e-n<t/2&&this.triggerNewFacetSearch(this.buildParamsForFetchingMore())}},e.prototype.buildParamsForNormalSearch=function(){var t=new l.FacetSearchParameters(this.facet);return t.setValueToSearch(this.getValueInInputForFacetSearch()),t.fetchMore=!1,t},e.prototype.buildParamsForFetchingMore=function(){var t=this.buildParamsForExcludingCurrentlyDisplayedValues();return t.fetchMore=!0,t},e.prototype.buildParamsForExcludingCurrentlyDisplayedValues=function(){var t=new l.FacetSearchParameters(this.facet);return t.excludeCurrentlyDisplayedValuesInSearch(this.searchResults),t.setValueToSearch(this.getValueInInputForFacetSearch()),t},e.prototype.showSearchResultsElement=function(){this.positionSearchResults()},e.prototype.hideSearchResultsElement=function(){this.searchResults.style.display="none"},e.prototype.highlightCurrentQueryWithinSearchResults=function(){var e=this,n=o.$$(this.searchResults).findAll(".coveo-facet-value-caption");t.each(n,function(t){var n=e.getValueInInputForFacetSearch(),i=new RegExp("("+b.StringUtils.wildcardsToRegex(n,e.facet.options.facetSearchIgnoreAccents)+")","ig"),r=o.$$(t).text(),s=r.replace(i,'<span class="coveo-highlight">$1</span>');t.innerHTML=s})},e.prototype.makeFirstSearchResultTheCurrentOne=function(){this.makeCurrentResult(this.getSelectables()[0])},e.prototype.makeCurrentResult=function(e){t.each(this.getSelectables(),function(t){o.$$(t).removeClass("coveo-current")}),o.$$(e).addClass("coveo-current")},e.prototype.moveCurrentResultDown=function(){var e=o.$$(this.searchResults).find(".coveo-current");t.each(this.getSelectables(),function(t){o.$$(t).removeClass("coveo-current")});var n,i=this.getSelectables(),r=t.indexOf(i,e);n=r<i.length-1?o.$$(i[r+1]):o.$$(i[0]),this.highlightAndShowCurrentResultWithKeyboard(n)},e.prototype.moveCurrentResultUp=function(){var e=o.$$(this.searchResults).find(".coveo-current");t.each(o.$$(this.searchResults).findAll(".coveo-facet-selectable"),function(t){o.$$(t).removeClass("coveo-current")});var n,i=this.getSelectables(),r=t.indexOf(i,e);n=r>0?o.$$(i[r-1]):o.$$(i[i.length-1]),this.highlightAndShowCurrentResultWithKeyboard(n)},e.prototype.highlightAndShowCurrentResultWithKeyboard=function(t){t.addClass("coveo-current"),this.searchResults.scrollTop=t.el.offsetTop},e.prototype.getSelectables=function(t){return void 0===t&&(t=this.searchResults),o.$$(t).findAll(".coveo-facet-selectable")},e.prototype.performSelectActionOnCurrentSearchResult=function(){var t=o.$$(this.searchResults).find(".coveo-current");g.Assert.check(void 0!=t);var e=o.$$(t).find('input[type="checkbox"]');void 0!=e?(e.checked=!0,o.$$(e).trigger("change")):t.click()},e.prototype.performExcludeActionOnCurrentSearchResult=function(){var t=o.$$(this.searchResults).find(".coveo-current");g.Assert.check(null!=t);var e=o.$$(t).find(".coveo-facet-value-caption"),n=this.facet.facetValuesList.get(o.$$(e).text());this.facet.toggleExcludeValue(n.facetValue),n.triggerOnExcludeQuery()},e.prototype.getValueInInputForFacetSearch=function(){return this.input.value},e.prototype.selectAllValuesMatchingSearch=function(){var e=this;this.facet.showWaitingAnimation();var n=new l.FacetSearchParameters(this.facet);n.nbResults=1e3,n.setValueToSearch(this.getValueInInputForFacetSearch()),this.facet.facetQueryController.search(n).then(function(n){e.completelyDismissSearch(),x.ModalBox.close(!0);var i=t.map(n,function(t){var n=e.facet.values.get(t.value);return r.Utils.exists(n)||(n=y.FacetValue.create(t)),n.selected=!0,n.excluded=!1,n});e.facet.processFacetSearchAllResultsSelected(i)}),this.completelyDismissSearch()},e.prototype.showFacetSearchWaitingAnimation=function(){o.$$(this.magnifier).hide(),o.$$(this.wait).show(),this.showingFacetSearchWaitAnimation=!0},e.prototype.hideFacetSearchWaitingAnimation=function(){o.$$(this.magnifier).show(),o.$$(this.wait).hide(),this.showingFacetSearchWaitAnimation=!1},e.prototype.detectSearchBarAnimation=function(){var t=this;u.EventsUtils.addPrefixedEvent(this.search,"AnimationStart",function(e){"grow"==e.animationName&&(t.searchBarIsAnimating=!0)}),u.EventsUtils.addPrefixedEvent(this.search,"AnimationEnd",function(e){"grow"==e.animationName&&(t.searchBarIsAnimating=!1)})},e}();e.FacetSearch=A}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var n=function(){function e(){}return e.addPrefixedEvent=function(e,n,i){t.each(this.prefixes,function(t){""==t&&(n=n.toLowerCase()),e.addEventListener(t+n,i,!1)})},e.removePrefixedEvent=function(e,n,i){t.each(this.prefixes,function(t){""==t&&(n=n.toLowerCase()),e.removeEventListener(t+n,i,!1)})},e.prefixes=["webkit","moz","MS","o",""],e}();e.EventsUtils=n}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(48),r=n(58),s=n(138),a=function(t){function e(e,n,i){var s=this;t.call(this,e,n),this.facet=e,this.facetValue=n,this.keepDisplayedValueNextTime=i,this.firstQuery=!0,r.$$(e.root).one(o.QueryEvents.querySuccess,function(){s.firstQuery=!1})}return i(e,t),e.prototype.bindEvent=function(){t.prototype.bindEvent.call(this,{displayNextTime:this.keepDisplayedValueNextTime,pinFacet:this.facet.options.preservePosition})},e}(s.ValueElement);e.FacetValueElement=a},function(t,e,n){"use strict";var i=n(139),o=n(15),r=n(121),s=n(58),a=n(17),u=n(32),l=n(23),c=n(69),h=function(){function t(t,e,n,i){this.facet=t,this.facetValue=e,this.onSelect=n,this.onExclude=i}return t.prototype.build=function(){return this.renderer=new i.ValueElementRenderer(this.facet,this.facetValue).build(),this.bindEvent({displayNextTime:!0,pinFacet:this.facet.options.preservePosition}),this},t.prototype.bindEvent=function(t){o.Utils.isNullOrUndefined(t.omniboxObject)?this.isOmnibox=!1:this.isOmnibox=!0,this.handleEventForCheckboxChange(t),this.facetValue.excluded?this.handleEventForExcludedValueElement(t):this.handleEventForValueElement(t)},t.prototype.select=function(){this.facetValue.selected=!0,this.facetValue.excluded=!1,this.renderer.setCssClassOnListValueElement()},t.prototype.unselect=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this.renderer.setCssClassOnListValueElement()},t.prototype.exclude=function(){var t=this;this.facetValue.selected=!1,this.facetValue.excluded=!0,this.renderer.setCssClassOnListValueElement();var e;e=this.facetValue.excluded?this.isOmnibox?r.analyticsActionCauseList.omniboxFacetUnexclude:r.analyticsActionCauseList.facetUnexclude:this.isOmnibox?r.analyticsActionCauseList.omniboxFacetExclude:r.analyticsActionCauseList.facetExclude,this.onExclude?this.facet.triggerNewQuery(function(){return t.onExclude(t,e)}):this.facet.triggerNewQuery(function(){return t.facet.usageAnalytics.logSearchEvent(e,t.getAnalyticsFacetMeta())})},t.prototype.unexclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this.renderer.setCssClassOnListValueElement()},t.prototype.triggerOnExcludeQuery=function(){var t,e=this;t=this.facetValue.excluded?this.isOmnibox?r.analyticsActionCauseList.omniboxFacetUnexclude:r.analyticsActionCauseList.facetUnexclude:this.isOmnibox?r.analyticsActionCauseList.omniboxFacetExclude:r.analyticsActionCauseList.facetExclude,this.onExclude?this.facet.triggerNewQuery(function(){return e.onExclude(e,t)}):this.facet.triggerNewQuery(function(){return e.facet.usageAnalytics.logSearchEvent(t,e.getAnalyticsFacetMeta())})},t.prototype.handleSelectValue=function(t){var e=this;this.facet.keepDisplayedValuesNextTime=t.displayNextTime&&!this.facet.options.useAnd;var n;this.facetValue.excluded?(n=this.isOmnibox?r.analyticsActionCauseList.omniboxFacetUnexclude:r.analyticsActionCauseList.facetUnexclude,this.facet.unexcludeValue(this.facetValue)):(n=this.facetValue.selected?this.isOmnibox?r.analyticsActionCauseList.omniboxFacetDeselect:r.analyticsActionCauseList.facetDeselect:this.isOmnibox?r.analyticsActionCauseList.omniboxFacetSelect:r.analyticsActionCauseList.facetSelect,this.facet.toggleSelectValue(this.facetValue)),this.onSelect?this.facet.triggerNewQuery(function(){return e.onSelect(e,n)}):this.facet.triggerNewQuery(function(){return e.facet.usageAnalytics.logSearchEvent(n,e.getAnalyticsFacetMeta())})},t.prototype.handleExcludeClick=function(t){this.facet.keepDisplayedValuesNextTime=t.displayNextTime&&!this.facet.options.useAnd,this.facet.toggleExcludeValue(this.facetValue),this.triggerOnExcludeQuery()},t.prototype.handleEventForExcludedValueElement=function(t){var e=this,n=function(n){return t.pinFacet&&e.facet.pinFacetPosition(),t.omniboxObject&&e.omniboxCloseEvent(t.omniboxObject),e.handleSelectValue(t),!1};s.$$(this.renderer.label).on("click",function(t){t.stopPropagation(),n(t)}),s.$$(this.renderer.stylishCheckbox).on("keydown",c.KeyboardUtils.keypressAction([c.KEYBOARD.SPACEBAR,c.KEYBOARD.ENTER],n))},t.prototype.handleEventForValueElement=function(t){var e=this,n=function(n){return t.omniboxObject&&e.omniboxCloseEvent(t.omniboxObject),n.stopPropagation(),n.preventDefault(),e.handleExcludeClick(t),!1};s.$$(this.renderer.excludeIcon).on("click",n),s.$$(this.renderer.excludeIcon).on("keydown",c.KeyboardUtils.keypressAction([c.KEYBOARD.SPACEBAR,c.KEYBOARD.ENTER],n));var i=function(n){return t.pinFacet&&e.facet.pinFacetPosition(),n.preventDefault(),s.$$(e.renderer.checkbox).trigger("change"),!1};s.$$(this.renderer.label).on("click",i),s.$$(this.renderer.stylishCheckbox).on("keydown",c.KeyboardUtils.keypressAction([c.KEYBOARD.SPACEBAR,c.KEYBOARD.ENTER],i))},t.prototype.handleEventForCheckboxChange=function(t){var e=this;s.$$(this.renderer.checkbox).on("change",function(){t.omniboxObject&&e.omniboxCloseEvent(t.omniboxObject),e.handleSelectValue(t),a.DeviceUtils.isMobileDevice()&&!e.facet.searchInterface.isNewDesign()&&e.facet.options.enableFacetSearch&&u.Defer.defer(function(){l.ModalBox.close(!0),e.facet.facetSearch.completelyDismissSearch()})})},t.prototype.omniboxCloseEvent=function(t){t.closeOmnibox(),t.clear()},t.prototype.getAnalyticsFacetMeta=function(){return{facetId:this.facet.options.id,facetValue:this.facetValue.value,facetTitle:this.facet.options.title}},t}();e.ValueElement=h},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(15),r=n(35),s=n(107),a=function(){function e(t,e){this.facet=t,this.facetValue=e}return e.prototype.withNo=function(e){return t.isArray(e)?t.each(e,function(t){t&&i.$$(t).detach()}):e&&i.$$(e).detach(),this},e.prototype.build=function(){var t=this;this.listItem=i.$$("li",{className:"coveo-facet-value coveo-facet-selectable"}).el,this.listItem.setAttribute("data-value",this.facetValue.value),this.facet.searchInterface.isNewDesign()||(this.excludeIcon=this.buildExcludeIcon(),this.listItem.appendChild(this.excludeIcon)),this.label=i.$$("label",{className:"coveo-facet-value-label"}).el,this.listItem.appendChild(this.label),this.facet.searchInterface.isNewDesign()&&(this.excludeIcon=this.buildExcludeIcon(),this.listItem.appendChild(this.excludeIcon),i.$$(this.excludeIcon).on("mouseover",function(){i.$$(t.listItem).addClass("coveo-facet-value-will-exclude")}),i.$$(this.excludeIcon).on("mouseout",function(){i.$$(t.listItem).removeClass("coveo-facet-value-will-exclude")})),o.Utils.exists(this.facetValue.computedField)&&(this.computedField=this.buildValueComputedField(),this.computedField&&this.label.appendChild(this.computedField),i.$$(this.label).addClass("coveo-with-computed-field"));var e=i.$$("div",{className:"coveo-facet-value-label-wrapper"}).el;return this.label.appendChild(e),this.checkbox=this.buildValueCheckbox(),e.appendChild(this.checkbox),this.stylishCheckbox=this.buildValueStylishCheckbox(),e.appendChild(this.stylishCheckbox),this.facet.options.showIcon&&!this.facet.searchInterface.isNewDesign()&&(this.icon=this.buildValueIcon(),e.appendChild(this.icon)),this.facet.searchInterface.isNewDesign()?(this.valueCount=this.buildValueCount(),this.valueCount&&e.appendChild(this.valueCount),this.valueCaption=this.buildValueCaption(),e.appendChild(this.valueCaption)):(this.valueCaption=this.buildValueCaption(),e.appendChild(this.valueCaption),this.valueCount=this.buildValueCount(),this.valueCount&&e.appendChild(this.valueCount)),this.setCssClassOnListValueElement(),this},e.prototype.setCssClassOnListValueElement=function(){i.$$(this.listItem).toggleClass("coveo-selected",this.facetValue.selected),i.$$(this.listItem).toggleClass("coveo-excluded",this.facetValue.excluded)},e.prototype.buildExcludeIcon=function(){var t=i.$$("div",{title:r.l("Exclude",this.facet.getValueCaption(this.facetValue)),className:"coveo-facet-value-exclude",tabindex:0}).el;return this.addFocusAndBlurEventListeners(t),this.facet.searchInterface.isNewDesign()&&t.appendChild(i.$$("span",{className:"coveo-icon"}).el),o.Utils.exists(this.facetValue.computedField)&&i.$$(t).addClass("coveo-facet-value-exclude-with-computed-field"),t},e.prototype.buildValueComputedField=function(){var t=this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat);if(o.Utils.isNonEmptyString(t)){var e=i.$$("span",{className:"coveo-facet-value-computed-field"}).el;return i.$$(e).text(t),e}},e.prototype.buildValueCheckbox=function(){var t=i.$$("input",{type:"checkbox"}).el;return this.facetValue.selected?t.setAttribute("checked","checked"):t.removeAttribute("checked"),this.facetValue.excluded?t.setAttribute("disabled","disabled"):t.removeAttribute("disabled"),s.Component.pointElementsToDummyForm(t),t},e.prototype.buildValueStylishCheckbox=function(){var t=i.$$("div",{className:"coveo-facet-value-checkbox",tabindex:0},i.$$("span")).el;return this.addFocusAndBlurEventListeners(t),t},e.prototype.buildValueIcon=function(){var t=this.getValueIcon();return o.Utils.exists(t)?i.$$("img",{className:"coveo-facet-value-icon coveo-icon",src:this.getValueIcon()}).el:this.buildValueIconFromSprite()},e.prototype.getValueIcon=function(){return o.Utils.exists(this.facet.options.valueIcon)?this.facet.options.valueIcon(this.facetValue):void 0},e.prototype.buildValueIconFromSprite=function(){return i.$$("div",{className:"coveo-facet-value-icon coveo-icon "+this.facet.options.field.substr(1)+" "+this.facetValue.value}).el},e.prototype.buildValueCaption=function(){var t=this.facet.getValueCaption(this.facetValue),e=i.$$("span",{className:"coveo-facet-value-caption",title:t}).el;return i.$$(e).text(t),e},e.prototype.buildValueCount=function(){var t=this.facetValue.getFormattedCount();if(o.Utils.isNonEmptyString(t)){var e=i.$$("span",{className:"coveo-facet-value-count"}).el;return i.$$(e).text(t),e}},e.prototype.addFocusAndBlurEventListeners=function(t){var e=this;i.$$(t).on("focus",function(){return i.$$(e.listItem).addClass("coveo-focused")}),i.$$(t).on("blur",function(){return i.$$(e.listItem).removeClass("coveo-focused")})},e}();e.ValueElementRenderer=a}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(61),o=function(){function e(t,e){this.facet=t,this.facetSort=e}return e.prototype.reorderValues=function(t){if(this.facetSort){if("custom"==this.facetSort.activeSort.name&&void 0!=this.facet.options.customSort)return this.reorderValuesWithCustomOrder(t);if(this.facetSort.activeSort.name.indexOf("alpha")!=-1)return this.reorderValuesWithCustomCaption(t)}return t},e.prototype.reorderValuesWithCustomOrder=function(e){var n=t.map(this.facet.options.customSort,function(t){return t.toLowerCase()}),o=t.map(e,function(e,o){var r=t.findIndex(n,function(t){return i.StringUtils.equalsCaseInsensitive(t,e.value)||null!=e.lookupValue&&i.StringUtils.equalsCaseInsensitive(t,e.lookupValue)});return r==-1&&(r=o+n.length),{facetValue:e,index:r}}),r=t.sortBy(o,"index");return r="ascending"==this.facetSort.customSortDirection?r:r.reverse(),t.pluck(r,"facetValue")},e.prototype.reorderValuesWithCustomCaption=function(e){
var n=this,i=t.sortBy(e,function(t){return n.facet.getValueCaption(t).toLowerCase()});return this.facetSort.activeSort.name.indexOf("descending")!=-1&&(i=i.reverse()),i},e}();e.FacetValuesOrder=o}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(142),r=n(58),s=n(70),a=n(15),u=n(35),l=n(101),c=n(121),h=n(17),p=n(72),d=function(e){function n(t,n){e.call(this,t,n),this.sorts=t,this.facet=n,this.customSortDirectionChange=!1,this.enabledSortsIgnoreRenderBecauseOfPairs=[],this.filterDuplicateForRendering()}return i(n,e),n.prototype.build=function(){var e=this;this.settingsButton=r.$$("div",{className:"coveo-facet-header-settings",title:u.l("Settings")}).el,this.settingsIcon=r.$$("span",{className:"coveo-icon"}).el,this.settingsButton.appendChild(this.settingsIcon),this.settingsPopup=r.$$("div",{className:"coveo-facet-settings-popup"}).el,a.Utils.isNonEmptyArray(this.enabledSorts)&&(this.sortSection=this.buildSortSection(),this.enabledSortsAllowDirection()&&(this.directionSection=this.buildDirectionSection())),this.facet.options.enableSettingsFacetState&&(this.saveStateSection=this.buildSaveStateSection(),this.clearStateSection=this.buildClearStateSection()),this.facet.options.enableCollapse&&(this.hideSection=this.buildHideSection(),this.showSection=this.buildShowSection());var n=function(){e.appendIfNotUndefined(e.saveStateSection),e.appendIfNotUndefined(e.clearStateSection),e.appendIfNotUndefined(e.hideSection),e.appendIfNotUndefined(e.showSection)};return this.handleMouseEventOnButton(this.sortSection),a.Utils.isNonEmptyArray(this.enabledSorts)?(this.settingsPopup.appendChild(this.sortSection.element),t.each(this.directionSection,function(t){e.appendIfNotUndefined(t)}),n()):n(),this.settingsButton},n.prototype.loadSavedState=function(){if(this.facetStateLocalStorage){var t=this.facetStateLocalStorage.load(),e=this.facet.queryStateModel.get(this.includedStateAttribute),n=this.facet.queryStateModel.get(this.excludedStateAttribute),i=this.facet.queryStateModel.get(this.operatorStateAttribute);if(!a.Utils.isNullOrUndefined(t)&&a.Utils.isEmptyArray(e)&&a.Utils.isEmptyArray(n)&&!a.Utils.isNonEmptyString(i)){var o={};o[this.includedStateAttribute]=t.included,o[this.excludedStateAttribute]=t.excluded,o[this.operatorStateAttribute]=t.operator,this.facet.queryStateModel.setMultiple(o),this.loadedFromSettings=o}}else this.facet.logger.info("Facet state local storage not enabled : See Facet.options.enableSettingsFacetState")},n.prototype.saveState=function(){this.facetStateLocalStorage?this.facetStateLocalStorage.save({included:this.facet.queryStateModel.get(this.includedStateAttribute),excluded:this.facet.queryStateModel.get(this.excludedStateAttribute),operator:this.facet.queryStateModel.get(this.operatorStateAttribute)}):this.facet.logger.info("Facet state local storage not enabled : See Facet.options.enableSettingsFacetState")},n.prototype.close=function(){r.$$(this.settingsPopup).detach()},n.prototype.open=function(){var e=this;p.PopupUtils.positionPopup(this.settingsPopup,this.settingsButton,this.facet.root,this.getPopupAlignment(),this.facet.root),this.hideSection&&this.showSection&&(r.$$(this.hideSection).toggle(!r.$$(this.facet.element).hasClass("coveo-facet-collapsed")),r.$$(this.showSection).toggle(r.$$(this.facet.element).hasClass("coveo-facet-collapsed"))),this.facet.options.enableSettingsFacetState&&r.$$(this.clearStateSection).toggle(!a.Utils.isNullOrUndefined(this.facetStateLocalStorage.load())),t.each(this.enabledSorts,function(t,n){a.Utils.isNullOrUndefined(e.sortSection.sortItems[n])||(e.activeSort.name==t.name.toLowerCase()||e.activeSort.relatedSort==t.name.toLowerCase()?e.selectItem(e.sortSection.sortItems[n]):e.unselectItem(e.sortSection.sortItems[n]))})},n.prototype.buildSortSection=function(){var e=this.buildSection("coveo-facet-settings-section-sort"),n=this.buildIcon(),i=this.buildItems();if(this.facet.searchInterface.isNewDesign()){var o=document.createElement("div");r.$$(o).addClass("coveo-facet-settings-section-sort-title"),r.$$(o).text(u.l("SortBy")+" :"),i.appendChild(o)}var s=this.buildSortSectionItems();return t.each(s,function(t){i.appendChild(t)}),e.appendChild(n),e.appendChild(i),{element:e,sortItems:s}},n.prototype.buildSortSectionItems=function(){var e=this,n=t.map(this.enabledSorts,function(n){if(!t.contains(e.enabledSortsIgnoreRenderBecauseOfPairs,n)){var i=e.buildItem(u.l(n.label),n.description);return r.$$(i).on("click",function(t){return e.handleClickSortButton(t,n)}),i}});return n=t.compact(n)},n.prototype.closePopupAndUpdateSort=function(){this.close(),"custom"!=this.activeSort.name?this.facet.updateSort(this.activeSort.name):(this.facet.updateSort("nosort"),this.customSortDirectionChange&&(this.customSortDirectionChange=!1,this.facet.queryController.executeQuery()))},n.prototype.enabledSortsAllowDirection=function(){return t.some(this.enabledSorts,function(t){return t.directionToggle})},n.prototype.buildDirectionSection=function(){var t=this;if(this.facet.searchInterface.isNewDesign()){var e=this.buildAscendingOrDescendingSection("Ascending"),n=this.buildIcon(),i=this.buildIcon(),o=this.buildItems(),s=this.buildAscendingOrDescending("Ascending");o.appendChild(s),e.appendChild(n),e.appendChild(o),r.$$(e).on("click",function(e){return t.handleDirectionClick(e,"ascending")});var a=this.buildAscendingOrDescendingSection("Descending"),u=this.buildItems(),l=this.buildAscendingOrDescending("Descending");return u.appendChild(l),a.appendChild(i),a.appendChild(u),r.$$(a).on("click",function(e){return t.handleDirectionClick(e,"descending")}),this.activeSort.directionToggle?this.selectItem(this.getItems(e)[0]):(r.$$(e).addClass("coveo-facet-settings-disabled"),r.$$(a).addClass("coveo-facet-settings-disabled")),[e,a]}var c=this.buildSection("coveo-facet-settings-section-direction"),h=this.buildIcon(),p=this.buildItems(),s=this.buildAscendingOrDescending("Ascending");r.$$(s).on("click",function(e){return t.handleDirectionClick(e,"ascending")});var l=this.buildAscendingOrDescending("Descending");return r.$$(l).on("click",function(e){return t.handleDirectionClick(e,"descending")}),p.appendChild(s),p.appendChild(l),c.appendChild(h),c.appendChild(p),this.activeSort.directionToggle?this.selectItem(this.getCurrentDirectionItem([c])):r.$$(c).addClass("coveo-facet-settings-disabled"),[c]},n.prototype.buildSaveStateSection=function(){var e=this,n=this.buildSection("coveo-facet-settings-section-save-state"),i=this.buildIcon(),o=this.buildItems();this.facetStateLocalStorage=new s.LocalStorageUtils("facet-state-"+this.facet.options.id),this.includedStateAttribute=l.QueryStateModel.getFacetId(this.facet.options.id),this.excludedStateAttribute=l.QueryStateModel.getFacetId(this.facet.options.id,!1),this.operatorStateAttribute=l.QueryStateModel.getFacetOperator(this.facet.options.id);var a=document.createElement("div");return r.$$(a).addClass("coveo-facet-settings-item"),a.setAttribute("title",t.escape(u.l("SaveFacetState"))),r.$$(a).text(t.escape(u.l("SaveFacetState"))),o.appendChild(a),n.appendChild(i),n.appendChild(o),r.$$(n).on("click",function(t){return e.handleSaveStateClick()}),n},n.prototype.buildClearStateSection=function(){var t=this,e=this.buildSection("coveo-facet-settings-section-clear-state"),n=this.buildIcon(),i=this.buildItems(),o=this.buildItem(u.l("ClearFacetState"));return i.appendChild(o),e.appendChild(n),e.appendChild(i),r.$$(e).on("click",function(e){return t.handleClearStateClick()}),e},n.prototype.buildHideSection=function(){var t=this,e=this.buildSection("coveo-facet-settings-section-hide"),n=this.buildIcon(),i=this.buildItems(),o=this.buildItem(u.l("Collapse"));return i.appendChild(o),e.appendChild(n),e.appendChild(i),r.$$(e).on("click",function(e){t.facet.facetHeader.collapseFacet(),t.close()}),e},n.prototype.buildShowSection=function(){var t=this,e=this.buildSection("coveo-facet-settings-section-show"),n=this.buildIcon(),i=this.buildItems(),o=this.buildItem(u.l("Expand"));return i.appendChild(o),e.appendChild(n),e.appendChild(i),r.$$(e).on("click",function(e){t.facet.facetHeader.expandFacet(),t.close()}),e},n.prototype.buildIcon=function(){if(this.facet.searchInterface.isNewDesign()){var t=document.createElement("div");r.$$(t).addClass("coveo-icon-container");var e=document.createElement("div");return r.$$(e).addClass("coveo-icon"),t.appendChild(e),t}var t=document.createElement("div");return r.$$(t).addClass("coveo-icon"),t},n.prototype.buildAscendingOrDescending=function(t){var e=this.buildItem(u.l(t));return e.setAttribute("data-direction",t.toLowerCase()),e},n.prototype.buildAscendingOrDescendingSection=function(t){return this.buildSection("coveo-facet-settings-section-direction-"+t.toLowerCase())},n.prototype.buildItem=function(e,n){return void 0===n&&(n=e),r.$$("div",{className:"coveo-facet-settings-item",title:t.escape(n)},t.escape(e)).el},n.prototype.buildItems=function(){var t=document.createElement("div");return r.$$(t).addClass("coveo-facet-settings-items"),t},n.prototype.buildSection=function(t){var e=document.createElement("div");return r.$$(e).addClass(["coveo-facet-settings-section",t]),e},n.prototype.handleClickSettingsButtons=function(t,e){a.Utils.isNullOrUndefined(this.settingsPopup.parentElement)?this.open():this.close()},n.prototype.handleClickSortButton=function(e,i){this.activeSort!=i&&this.activeSort.relatedSort!=i.name&&(this.activeSort=i,i.directionToggle&&t.contains(this.enabledSorts,n.availableSorts[this.activeSort.relatedSort])?this.activateDirectionSection():this.disableDirectionSection(),this.selectItem(e.target),this.closePopupAndUpdateSort())},n.prototype.handleDirectionClick=function(e,i){var o=this;r.$$(e.target.parentElement.parentElement).hasClass("coveo-facet-settings-disabled")||this.activeSort.name.indexOf(i)!=-1||(this.activeSort=n.availableSorts[this.activeSort.relatedSort],t.each(this.directionSection,function(t){o.unselectSection(t)}),this.selectItem(e.target),"custom"==this.activeSort.name&&this.customSortDirection!=i&&(this.customSortDirection=i,this.customSortDirectionChange=!0),this.closePopupAndUpdateSort())},n.prototype.handleSaveStateClick=function(){this.saveState(),this.close()},n.prototype.handleClearStateClick=function(){var t=this;this.facetStateLocalStorage.remove(),this.facet.reset(),this.close(),this.facet.triggerNewQuery(function(){return t.facet.usageAnalytics.logSearchEvent(c.analyticsActionCauseList.facetClearAll,{facetId:t.facet.options.id,facetTitle:t.facet.options.title})})},n.prototype.handleMouseEventOnButton=function(t){var e,n=this;r.$$(this.settingsButton).on("click",function(e){return n.handleClickSettingsButtons(e,t)});var i=function(){e=setTimeout(function(){n.close()},300)},o=function(){clearTimeout(e)};r.$$(this.settingsIcon).on("mouseleave",i),r.$$(this.settingsPopup).on("mouseleave",i),r.$$(this.settingsIcon).on("mouseenter",o),r.$$(this.settingsPopup).on("mouseenter",o)},n.prototype.getCurrentDirectionItem=function(e){var n=this;void 0===e&&(e=this.directionSection);var i;return t.each(e,function(e){i||(i=t.find(n.getItems(e),function(t){return n.activeSort.name.indexOf(t.getAttribute("data-direction"))!=-1}))}),i||(i=e[0]),i},n.prototype.activateDirectionSection=function(){var e=this;t.each(this.directionSection,function(t){r.$$(t).removeClass("coveo-facet-settings-disabled"),e.unselectSection(t)}),this.selectItem(this.getCurrentDirectionItem())},n.prototype.disableDirectionSection=function(){var e=this;t.each(this.directionSection,function(t){r.$$(t).addClass("coveo-facet-settings-disabled"),e.unselectSection(t)})},n.prototype.getItems=function(t){return r.$$(t).findAll(".coveo-facet-settings-item")},n.prototype.unselectSection=function(e){t.each(this.getItems(e),function(t){r.$$(t).removeClass("coveo-selected")})},n.prototype.selectItem=function(t){r.$$(t).addClass("coveo-selected")},n.prototype.unselectItem=function(t){r.$$(t).removeClass("coveo-selected")},n.prototype.getPopupAlignment=function(){var t=h.DeviceUtils.isMobileDevice()?p.HorizontalAlignment.CENTER:p.HorizontalAlignment.INNERLEFT,e=p.VerticalAlignment.BOTTOM;return{horizontal:t,vertical:e}},n.prototype.filterDuplicateForRendering=function(){var e=this;t.each(this.enabledSorts,function(t,n){if(null!=t.relatedSort)for(var i=n+1;i<e.enabledSorts.length;i++)if(e.enabledSorts[i].name==t.relatedSort){e.enabledSortsIgnoreRenderBecauseOfPairs.push(e.enabledSorts[i]);break}})},n.prototype.appendIfNotUndefined=function(t){a.Utils.isNullOrUndefined(t)||this.settingsPopup.appendChild(t)},n}(o.FacetSort);e.FacetSettings=d}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(35),o=n(141),r=n(15),s=function(){function e(e,n){var i=this;this.facet=n,this.enabledSorts=[],this.customSortDirection="ascending",t.each(e,function(t){var e=o.FacetSettings.availableSorts[t.toLowerCase()];void 0!=e&&i.enabledSorts.push(e)}),this.removeEnabledSortsBasedOnFacetType(),r.Utils.isNonEmptyArray(this.enabledSorts)&&(void 0!=this.facet.options.sortCriteria&&(this.activeSort=t.find(this.enabledSorts,function(t){return t.name==i.facet.options.sortCriteria})),this.activeSort||(this.activeSort=this.enabledSorts[0]))}return e.prototype.removeEnabledSortsBasedOnFacetType=function(){if(Coveo.FacetRange&&this.facet instanceof Coveo.FacetRange){var t=this.facet;t.options.slider&&(this.enabledSorts=[])}},e.availableSorts={score:{label:i.l("Score"),directionToggle:!1,description:i.l("ScoreDescription"),name:"score"},occurrences:{label:i.l("Occurrences"),directionToggle:!1,description:i.l("OccurrencesDescription"),name:"occurrences"},alphaascending:{label:i.l("Label"),directionToggle:!0,description:i.l("LabelDescription"),name:"alphaascending",relatedSort:"alphadescending"},alphadescending:{label:i.l("Label"),directionToggle:!0,description:i.l("LabelDescription"),name:"alphadescending",relatedSort:"alphaascending"},computedfieldascending:{label:i.l("Value"),directionToggle:!0,description:i.l("ValueDescription"),name:"computedfieldascending",relatedSort:"computedfielddescending"},computedfielddescending:{label:i.l("Value"),directionToggle:!0,description:i.l("ValueDescription"),name:"computedfielddescending",relatedSort:"computedfieldascending"},chisquare:{label:i.l("RelativeFrequency"),directionToggle:!1,description:i.l("RelativeFrequencyDescription"),name:"chisquare"},custom:{label:i.l("Custom"),directionToggle:!0,description:i.l("CustomDescription"),name:"custom",relatedSort:"custom"}},e}();e.FacetSort=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(137),o=n(58),r=n(134),s=n(15),a=n(93),u=n(140),l=function(){function e(t,e){this.facet=t,this.facetValueElementKlass=e,this.valueList={},this.currentlyDisplayed=[]}return e.prototype.build=function(){return this.valueContainer=document.createElement("ul"),o.$$(this.valueContainer).addClass("coveo-facet-values"),this.valueContainer},e.prototype.getAllCurrentlyDisplayed=function(){return this.currentlyDisplayed},e.prototype.getAll=function(){return t.toArray(this.valueList)},e.prototype.getAllFacetValue=function(){return t.map(this.getAll(),function(t){return t.facetValue})},e.prototype.get=function(t){var e;return t instanceof r.FacetValue?e=t.value:(t=s.Utils.anyTypeToString(t),e=t),this.ensureFacetValueIsInList(t),this.valueList[e.toLowerCase()]},e.prototype.select=function(t){var e=this.get(t);return e.select(),e},e.prototype.unselect=function(t){var e=this.get(t);return e.unselect(),e},e.prototype.exclude=function(t){var e=this.get(t);return e.exclude(),e},e.prototype.unExclude=function(t){var e=this.get(t);return e.unexclude(),e},e.prototype.toggleSelect=function(t){var e=this.get(t);return e.facetValue.selected?e.unselect():e.select(),e},e.prototype.toggleExclude=function(t){var e=this.get(t);return e.facetValue.excluded?e.unexclude():e.exclude(),e},e.prototype.rebuild=function(e){var n=this;o.$$(this.valueContainer).empty(),this.currentlyDisplayed=[];var i=this.getValuesToBuildWith(),r=e,s=document.createDocumentFragment();t.each(i,function(t,e,i){if(n.facetValueShouldBeRemoved(t))n.facet.values.remove(t.value),r+=1;else if(e<r){var o=new n.facetValueElementKlass(n.facet,t,!0);n.valueList[t.value.toLowerCase()]=o;var a=o.build().renderer.listItem;s.appendChild(a),n.currentlyDisplayed.push(o)}}),this.valueContainer.appendChild(s),a.FacetUtils.addNoStateCssClassToFacetValues(this.facet,this.valueContainer),a.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet)},e.prototype.getValuesToBuildWith=function(){return this.facet.facetSort?new u.FacetValuesOrder(this.facet,this.facet.facetSort).reorderValues(this.facet.values.getAll()):this.facet.values.getAll()},e.prototype.facetValueShouldBeRemoved=function(t){return!(0!=t.occurrences||0!=t.delta&&void 0!=t.delta||t.selected||t.excluded||this.facet.keepDisplayedValuesNextTime)},e.prototype.ensureFacetValueIsInList=function(t){var e;t instanceof r.FacetValue?(e=this.facet.values.get(t.value),null==e&&(this.facet.values.add(t),e=t)):(e=this.facet.values.get(t),null==e&&(e=r.FacetValue.createFromValue(t),this.facet.values.add(e)));var n=e.value.toLowerCase(),o=this.valueList[n];void 0==o?(o=this.valueList[n]=new i.FacetValueElement(this.facet,e,!0),o.build()):o.facetValue=e},e}();e.FacetValuesList=l}).call(e,n(10))},function(t,e,n){"use strict";var i=n(58),o=n(93),r=n(35),s=n(121),a=function(){function t(t){this.options=t,this.element=document.createElement("div"),i.$$(this.element).addClass("coveo-facet-header")}return t.prototype.build=function(){return this.options.isNewDesign&&void 0!=this.options.icon?this.element.appendChild(this.buildIcon()):this.options.isNewDesign||this.element.appendChild(this.buildIcon()),this.options.isNewDesign||this.element.appendChild(this.buildWaitAnimation()),this.options.settingsKlass?(this.sort=this.settings=new this.options.settingsKlass(this.options.availableSorts,this.options.facet),this.element.appendChild(this.settings.build())):this.options.sortKlass&&(this.sort=new this.options.sortKlass(this.options.availableSorts,this.options.facet)),this.options.enableCollapseElement&&!this.options.isNewDesign&&(this.collapseElement=this.buildCollapse(),this.element.appendChild(this.collapseElement),this.expandElement=this.buildExpand(),this.element.appendChild(this.expandElement)),this.options.facet&&(this.operatorElement=this.buildOperatorToggle(),this.element.appendChild(this.operatorElement),i.$$(this.operatorElement).toggle(this.options.facet.options.enableTogglingOperator)),this.eraserElement=this.buildEraser(),this.element.appendChild(this.eraserElement),this.element.appendChild(this.buildTitle()),this.options.isNewDesign&&this.element.appendChild(this.buildWaitAnimation()),this.element},t.prototype.switchToAnd=function(){this.options.facet&&(this.options.facet.options.useAnd=!0,this.rebuildOperatorToggle(),this.updateOperatorQueryStateModel())},t.prototype.switchToOr=function(){this.options.facet&&(this.options.facet.options.useAnd=!1,this.rebuildOperatorToggle(),this.updateOperatorQueryStateModel())},t.prototype.collapseFacet=function(){this.collapseElement&&this.expandElement&&(i.$$(this.collapseElement).hide(),i.$$(this.expandElement).show()),i.$$(this.options.facetElement).addClass("coveo-facet-collapsed")},t.prototype.expandFacet=function(){this.collapseElement&&this.expandElement&&(i.$$(this.expandElement).hide(),i.$$(this.collapseElement).show()),i.$$(this.options.facetElement).removeClass("coveo-facet-collapsed"),this.options.facet&&o.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.options.facet)},t.prototype.updateOperatorQueryStateModel=function(){if(this.options.facet&&this.options.facet.options.enableTogglingOperator){var t="";0==this.options.facet.getSelectedValues().length&&0==this.options.facet.getExcludedValues().length||(t=this.options.facet.options.useAnd?"and":"or"),this.options.facet.queryStateModel.set(this.options.facet.operatorAttributeId,t)}},t.prototype.rebuildOperatorToggle=function(){var t=this.buildOperatorToggle();this.operatorElement&&i.$$(this.operatorElement).replaceWith(t),this.operatorElement=t},t.prototype.buildIcon=function(){var t;return t=this.options.icon?"coveo-icon-custom "+this.options.icon:"coveo-icon "+this.options.field.substr(1),this.iconElement=document.createElement("div"),i.$$(this.iconElement).addClass(t),this.iconElement},t.prototype.buildWaitAnimation=function(){return this.waitElement=document.createElement("div"),i.$$(this.waitElement).addClass("coveo-facet-header-wait-animation"),i.$$(this.waitElement).hide(),this.waitElement},t.prototype.buildCollapse=function(){var t=this,e=document.createElement("span");i.$$(e).addClass("coveo-icon");var n=document.createElement("div");return n.setAttribute("title",r.l("Collapse")),i.$$(n).addClass("coveo-facet-header-collapse"),n.appendChild(e),i.$$(n).on("click",function(){return t.collapseFacet()}),n},t.prototype.buildExpand=function(){var t=this,e=document.createElement("span");i.$$(e).addClass("coveo-icon");var n=document.createElement("div");return n.setAttribute("title",r.l("Expand")),i.$$(n).hide(),i.$$(n).addClass("coveo-facet-header-expand"),n.appendChild(e),i.$$(n).on("click",function(){return t.expandFacet()}),n},t.prototype.buildOperatorToggle=function(){var t=this,e=document.createElement("span");i.$$(e).addClass(["coveo-"+(this.options.facet.options.useAnd?"and":"or"),"coveo-icon"]);var n=document.createElement("div");return n.setAttribute("title",r.l("SwitchTo",this.options.facet.options.useAnd?r.l("Or"):r.l("And"))),i.$$(n).addClass("coveo-facet-header-operator"),n.appendChild(e),i.$$(n).on("click",function(){return t.handleOperatorClick()}),n},t.prototype.handleOperatorClick=function(){var t=this;if(this.options.facet.options.useAnd?this.options.facet.switchToOr():this.options.facet.switchToAnd(),0!=this.options.facet.getSelectedValues().length){var e=this.options.facet.options.useAnd?"AND":"OR",n=this.options.facet.options.useAnd?"OR":"AND";this.options.facet.triggerNewQuery(function(){return t.options.facet.usageAnalytics.logSearchEvent(s.analyticsActionCauseList.facetToggle,{facetId:t.options.facet.options.id,facetOperatorBefore:n,facetOperatorAfter:e,facetTitle:t.options.title})})}},t.prototype.buildTitle=function(){var t=document.createElement("div");return i.$$(t).text(this.options.title),i.$$(t).addClass("coveo-facet-header-title"),t},t.prototype.buildEraser=function(){var t=this,e=document.createElement("span");i.$$(e).addClass("coveo-icon");var n=document.createElement("div");return n.setAttribute("title",r.l("Clear",this.options.title)),n.appendChild(e),i.$$(n).addClass("coveo-facet-header-eraser"),i.$$(n).on("click",function(){var e=t.options.facet||t.options.facetSlider;e.reset(),e.usageAnalytics.logSearchEvent(s.analyticsActionCauseList.facetClearAll,{facetId:e.options.id,facetTitle:e.options.title}),e.queryController.executeQuery()}),n},t}();e.FacetHeader=a},function(t,e,n){(function(t){"use strict";var i=n(14),o=n(17),r=n(121),s=n(58),a=function(){function e(t,e){this.facet=t,this.facetValue=e}return e.prototype.build=function(t){var e=this;void 0===t&&(t=!0),i.Assert.exists(this.facetValue);var n=o.DeviceUtils.isMobileDevice()?s.$$("div"):s.$$("span");n.addClass("coveo-facet-breadcrumb-value"),n.toggleClass("coveo-selected",this.facetValue.selected),n.toggleClass("coveo-excluded",this.facetValue.excluded),n.el.setAttribute("title",this.getBreadcrumbTooltip());var a=s.$$("span",{className:"coveo-facet-breadcrumb-caption"});a.text(this.facet.getValueCaption(this.facetValue)),n.el.appendChild(a.el);var u=s.$$("span",{className:"coveo-facet-breadcrumb-clear"});n.el.appendChild(u.el);var l=!1;return n.on("click",function(){l||(l=!0,e.facetValue.excluded?e.facet.unexcludeValue(e.facetValue.value):e.facet.deselectValue(e.facetValue.value),e.facet.triggerNewQuery(function(){return e.facet.usageAnalytics.logSearchEvent(r.analyticsActionCauseList.breadcrumbFacet,{facetId:e.facet.options.id,facetValue:e.facetValue.value,facetTitle:e.facet.options.title})}))}),n},e.prototype.getBreadcrumbTooltip=function(){var e=[this.facet.getValueCaption(this.facetValue),this.facetValue.getFormattedCount(),this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat)];return t.compact(e).join(" ")},e}();e.BreadcrumbValueElement=a}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(17),o=n(14),r=n(35),s=n(58),a=n(28),u=function(){function e(t,e,n){this.facet=t,this.facetValues=e,this.breadcrumbValueElementKlass=n,this.setExpandedAndCollapsed(),this.elem=s.$$("div",{className:"coveo-facet-breadcrumb"}).el;var o=i.DeviceUtils.isMobileDevice()?s.$$("div"):s.$$("span");o.addClass("coveo-facet-breadcrumb-title"),o.text(this.facet.options.title+(i.DeviceUtils.isMobileDevice()?"":":")),this.elem.appendChild(o.el),this.valueContainer=s.$$("span",{className:"coveo-facet-breadcrumb-values"}).el,this.elem.appendChild(this.valueContainer)}return e.prototype.build=function(){return this.buildExpanded(),0!=this.collapsed.length&&this.buildCollapsed(),this.elem},e.prototype.buildAsString=function(){return this.build(),this.elem?this.facet.options.title+": "+t.map(s.$$(this.elem).findAll(".coveo-facet-breadcrumb-value"),function(t){return s.$$(t).text()}).join(", "):""},e.prototype.buildExpanded=function(){var e=this;t.each(this.expanded,function(t,n){if(0!=n&&!i.DeviceUtils.isMobileDevice()&&!e.facet.searchInterface.isNewDesign()){var o=s.$$("span",{className:"coveo-facet-breadcrumb-separator"});o.text(", "),e.valueContainer.appendChild(o.el)}var r=new e.breadcrumbValueElementKlass(e.facet,t).build();e.valueContainer.appendChild(r.el)})},e.prototype.buildCollapsed=function(){var e=this,n=t.filter(this.collapsed,function(t){return t.selected}).length,u=t.filter(this.collapsed,function(t){return t.excluded}).length;o.Assert.check(n+u==this.collapsed.length);var l=s.$$("div",{className:"coveo-facet-breadcrumb-value"});if(!i.DeviceUtils.isMobileDevice()&&!this.facet.searchInterface.isNewDesign()){var c=s.$$("span",{className:"coveo-separator"});c.text(", "),l.el.appendChild(c.el)}if(n>0){var h=s.$$("span",{className:"coveo-facet-breadcrumb-multi-count"});h.text(r.l("NMore",a.format(n,"n0"))),l.el.appendChild(h.el);var p=s.$$("div",{className:"coveo-selected coveo-facet-breadcrumb-multi-icon"});l.el.appendChild(p.el)}if(u>0){var d=s.$$("span",{className:"coveo-facet-breadcrumb-multi-count"});d.text(r.l("NMore",a.format(u,"n0"))),l.el.appendChild(d.el);var f=s.$$("div",{className:"coveo-excluded coveo-facet-breadcrumb-multi-icon"});l.el.appendChild(f.el)}var g=t.map(this.collapsed,function(t){return new e.breadcrumbValueElementKlass(e.facet,t)}),m=t.map(g,function(t){return t.getBreadcrumbTooltip()});l.el.setAttribute("title",m.join("\n")),l.on("click",function(){var n=[];t.forEach(g,function(t){if(!i.DeviceUtils.isMobileDevice()&&!e.facet.searchInterface.isNewDesign()){var o=s.$$("span",{className:"coveo-facet-breadcrumb-separator"});o.text(", "),n.push(o.el)}n.push(t.build(!1).el)}),t.each(n,function(t){s.$$(t).insertBefore(l.el)}),l.detach()}),this.valueContainer.appendChild(l.el)},e.prototype.setExpandedAndCollapsed=function(){this.facetValues.length>this.facet.options.numberOfValuesInBreadcrumb?(this.collapsed=t.rest(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1),this.expanded=t.first(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1)):(this.collapsed=[],this.expanded=this.facetValues)},e}();e.BreadcrumbValueList=u}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var n=function(){function e(t,e){this.facet=t,this.facetValueElementKlass=e}return e.prototype.build=function(e){var n=this,i=t.map(e,function(e){return t.find(n.facet.values.getAll(),function(t){return t.value==e.value})||e});return t.map(i,function(t){return new n.facetValueElementKlass(n.facet,t,n.facet.keepDisplayedValuesNextTime).build().renderer.listItem})},e}();e.FacetSearchValuesList=n}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(138),r=function(t){function e(e,n,i,o,r){t.call(this,e,n,o,r),this.facet=e,this.facetValue=n,this.eventArg=i}return i(e,t),e.prototype.bindEvent=function(){t.prototype.bindEvent.call(this,{displayNextTime:!1,pinFacet:!1,omniboxObject:this.eventArg})},e}(o.ValueElement);e.OmniboxValueElement=r},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(15),r=n(93),s=function(){function e(t,e,n,i){this.facet=t,this.facetValues=e,this.omniboxObject=n,this.omniboxValueElementKlass=i}return e.prototype.build=function(){var e=this,n=[];return t.each(this.facetValues,function(t){n.push(e.buildOmniboxForOneRow(t,e.omniboxObject))}),this.buildFinalOmniboxElement(n)},e.prototype.buildOmniboxForOneRow=function(t,e){var n=this,o=function(t,e){return n.logAnalyticsEvent(t,e)},r=function(t,e){return n.logAnalyticsEvent(t,e)},s=new this.omniboxValueElementKlass(this.facet,t,e,o,r),a=s.build().renderer.listItem,u=e.completeQueryExpression.regex,l=e.completeQueryExpression.word,c=i.$$(a).find(".coveo-facet-value-caption");c.innerHTML=this.highlightOmniboxMatch(this.facet.getValueCaption(t),u,l);var h=i.$$("div",{className:"coveo-omnibox-selectable coveo-facet-value coveo-omnibox-facet-value"}).el;return h.appendChild(a),i.$$(h).on("keyboardSelect",function(){var t=i.$$(a).find("input[type=checkbox]");i.$$(t).trigger("change")}),h},e.prototype.buildFinalOmniboxElement=function(e){var n=this.buildOmniboxHeader();if(!o.Utils.isEmptyArray(e)){var s=i.$$("div",{className:"coveo-omnibox-facet-value"}).el;return s.appendChild(n),t.each(e,function(t){s.appendChild(t)}),r.FacetUtils.addNoStateCssClassToFacetValues(this.facet,s),s}},e.prototype.buildOmniboxHeader=function(){var t=this.facet.options.title,e=i.$$("div",{className:"coveo-omnibox-facet-header"}).el;if(this.facet.searchInterface.isNewDesign())return i.$$(e).text(t),e;var n=i.$$("span",{className:"coveo-icon "+this.facet.options.field.substr(1)}).el;return e.appendChild(n),i.$$(e).text(t),e},e.prototype.highlightOmniboxMatch=function(t,e,n){var i=t.search(e),o=i+n.length;return t.slice(0,i)+'<span class="coveo-highlight">'+t.slice(i,o)+"</span>"+t.slice(o)},e.prototype.logAnalyticsEvent=function(e,n){var i=t.pluck(this.facetValues,"value");e.facet.usageAnalytics.logSearchEvent(n,{query:this.omniboxObject.completeQueryExpression.word,facetId:e.facet.options.id,facetTitle:e.facet.options.title,facetValue:e.facetValue.value,suggestions:i.join(";"),suggestionRanking:t.indexOf(i,e.facetValue.value)})},e}();e.OmniboxValuesList=s}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(131),r=n(132),s=n(107),a=n(13),u=n(35),l=n(15),c=n(133),h=n(151),p=n(162),d=n(163),f=n(164),g=function(){function e(t,n,i,o){this.coveoRoot=t,this.ID=n,this.facets=[],this.facetSliders=[],this.preservePositionOriginalValues=[],this.dropdownHeaderLabel=this.getDropdownHeaderLabel(),this.dropdown=this.buildDropdown(o),this.bindDropdownContentEvents(),this.registerOnOpenHandler(),this.registerOnCloseHandler(),this.logger=new a.Logger(this),l.Utils.isNullOrUndefined(i.responsiveBreakpoint)?this.breakpoint=e.RESPONSIVE_BREAKPOINT:this.breakpoint=i.responsiveBreakpoint}return e.init=function(t,n,r){if(!i.$$(t).find(".coveo-facet-column")){var s=new a.Logger("ResponsiveFacets");return void s.info("No element with class coveo-facet-column. Responsive facets cannot be enabled")}o.ResponsiveComponentsManager.register(e,i.$$(t),c.Facet.ID,n,r)},e.prototype.registerComponent=function(t){t instanceof c.Facet?(this.facets.push(t),this.preservePositionOriginalValues.push(t.options.preservePosition)):t instanceof h.FacetSlider&&this.facetSliders.push(t)},e.prototype.needDropdownWrapper=function(){return this.needSmallMode();
},e.prototype.handleResizeEvent=function(){this.needSmallMode()&&!r.ResponsiveComponentsUtils.isSmallFacetActivated(this.coveoRoot)?this.changeToSmallMode():!this.needSmallMode()&&r.ResponsiveComponentsUtils.isSmallFacetActivated(this.coveoRoot)&&this.changeToLargeMode(),this.dropdown.isOpened&&this.dropdown.dropdownContent.positionDropdown()},e.prototype.dismissFacetSearches=function(){t.each(this.facets,function(t){t.facetSearch&&t.facetSearch.currentlyDisplayedResults&&t.facetSearch.completelyDismissSearch()})},e.prototype.drawFacetSliderGraphs=function(){t.each(this.facetSliders,function(t){return t.drawDelayedGraphData()})},e.prototype.needSmallMode=function(){return this.coveoRoot.width()<=this.breakpoint},e.prototype.changeToSmallMode=function(){this.dropdown.close(),this.disableFacetPreservePosition(),i.$$(this.coveoRoot.find("."+o.ResponsiveComponentsManager.DROPDOWN_HEADER_WRAPPER_CSS_CLASS)).append(this.dropdown.dropdownHeader.element.el),r.ResponsiveComponentsUtils.activateSmallFacet(this.coveoRoot)},e.prototype.changeToLargeMode=function(){this.restoreFacetPreservePositionValue(),this.dropdown.cleanUp(),r.ResponsiveComponentsUtils.deactivateSmallFacet(this.coveoRoot)},e.prototype.buildDropdown=function(t){var e=this.buildDropdownContent(),n=this.buildDropdownHeader(),i=t?t:new p.ResponsiveDropdown(e,n,this.coveoRoot);return i},e.prototype.buildDropdownContent=function(){var t=i.$$(this.coveoRoot.find(".coveo-facet-column")),n=i.$$("div",{className:"coveo-facet-header-filter-by-container",style:"display: none"}),o=i.$$("div",{className:"coveo-facet-header-filter-by"});o.text(u.l("Filter by:")),n.append(o.el),t.prepend(n.el);var r=new d.ResponsiveDropdownContent("facet",t,this.coveoRoot,e.DROPDOWN_MIN_WIDTH,e.DROPDOWN_WIDTH_RATIO);return r},e.prototype.buildDropdownHeader=function(){var t=i.$$("a"),e=i.$$("p");e.text(this.dropdownHeaderLabel),t.el.appendChild(e.el);var n=new f.ResponsiveDropdownHeader("facet",t);return n},e.prototype.registerOnOpenHandler=function(){this.dropdown.registerOnOpenHandler(this.drawFacetSliderGraphs,this)},e.prototype.registerOnCloseHandler=function(){this.dropdown.registerOnCloseHandler(this.dismissFacetSearches,this)},e.prototype.bindDropdownContentEvents=function(){var n=this;this.dropdown.dropdownContent.element.on("scroll",t.debounce(function(){t.each(n.facets,function(t){var e=t.facetSearch;e&&e.currentlyDisplayedResults&&!n.isFacetSearchScrolledIntoView(e.search)?t.facetSearch.positionSearchResults(n.dropdown.dropdownContent.element.el):e&&t.facetSearch.currentlyDisplayedResults&&t.facetSearch.positionSearchResults()})},e.DEBOUNCE_SCROLL_WAIT))},e.prototype.restoreFacetPreservePositionValue=function(){var e=this;t.each(this.facets,function(t,n){return t.options.preservePosition=e.preservePositionOriginalValues[n]})},e.prototype.disableFacetPreservePosition=function(){t.each(this.facets,function(t){return t.options.preservePosition=!1})},e.prototype.isFacetSearchScrolledIntoView=function(t){var e=t.getBoundingClientRect().top,n=t.getBoundingClientRect().bottom,i=this.dropdown.dropdownContent.element.el.getBoundingClientRect().top,o=this.dropdown.dropdownContent.element.el.getBoundingClientRect().bottom;return i=i>=0?i:0,e>=i&&n<=o},e.prototype.getDropdownHeaderLabel=function(){var n,o="."+s.Component.computeCssClassName(c.Facet)+", ."+s.Component.computeCssClassName(h.FacetSlider);return t.each(i.$$(this.coveoRoot.find(".coveo-facet-column")).findAll(o),function(t){var e;e=i.$$(t).hasClass(s.Component.computeCssClassName(c.Facet))?s.Component.get(t,c.Facet):s.Component.get(t,h.FacetSlider),!n&&e.options.dropdownHeaderLabel&&(n=e.options.dropdownHeaderLabel)}),n||(n=u.l(e.DROPDOWN_HEADER_LABEL_DEFAULT_VALUE)),n},e.RESPONSIVE_BREAKPOINT=800,e.DEBOUNCE_SCROLL_WAIT=250,e.DROPDOWN_MIN_WIDTH=280,e.DROPDOWN_WIDTH_RATIO=.35,e.DROPDOWN_HEADER_LABEL_DEFAULT_VALUE="Filters",e}();e.ResponsiveFacets=g}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(152),r=n(107),s=n(109),a=n(150),u=n(144),l=n(35),c=n(45),h=n(65),p=n(95),d=n(48),f=n(42),g=n(98),m=n(58),v=n(121),y=n(101),b=n(52),S=n(14),x=n(15),C=n(132),E=n(106),w=n(161),A=n(50),T=function(e){function n(i,o,r,u){var l=this;e.call(this,i,n.ID,r),this.element=i,this.options=o,this.slider=u,this.isEmpty=!1,this.options=s.ComponentOptions.initComponentOptions(i,n,o),a.ResponsiveFacets.init(this.root,this,this.options),null==this.options.excludeOuterBounds&&(this.options.excludeOuterBounds=!1),this.options.start&&(this.options.start=this.options.dateField?new Date(this.options.start.replace(/-/g,"/")).getTime():Number(this.options.start)),this.options.end&&(this.options.end=this.options.dateField?new Date(this.options.end.replace(/-/g,"/")).getTime():Number(this.options.end)),this.hasAGraph()&&(h.FeatureDetectionUtils.supportSVG()||(this.options.graph=void 0,this.logger.info("Your browser does not support SVG. Cannot add graphic to your facet range",this)),"undefined"==typeof w&&(this.options.graph=void 0,this.logger.info("Cannot find the required dependencies d3.js. Cannot add graphic to your facet range",this))),this.facetQueryController=new p.FacetSliderQueryController(this),this.initQueryStateEvents(),this.bind.onRootElement(d.QueryEvents.newQuery,function(){return l.handleNewQuery()}),this.bind.onRootElement(d.QueryEvents.noResults,function(){return l.handleNoresults()}),this.bind.onRootElement(d.QueryEvents.deferredQuerySuccess,function(t){return l.handleDeferredQuerySuccess(t)}),this.bind.onRootElement(d.QueryEvents.buildingQuery,function(t){return l.handleBuildingQuery(t)}),this.bind.onRootElement(d.QueryEvents.doneBuildingQuery,function(t){return l.handleDoneBuildingQuery(t)}),this.bind.onRootElement(f.BreadcrumbEvents.populateBreadcrumb,function(t){return l.handlePopulateBreadcrumb(t)}),this.bind.onRootElement(A.SearchAlertsEvents.searchAlertsPopulateMessage,function(t){return l.handlePopulateSearchAlerts(t)}),this.bind.onRootElement(f.BreadcrumbEvents.clearBreadcrumb,function(){return l.reset()}),this.onResize=t.debounce(function(){C.ResponsiveComponentsUtils.shouldDrawFacetSlider(m.$$(l.root))&&l.slider&&!l.isEmpty&&l.slider.drawGraph()},n.DEBOUNCED_RESIZE_DELAY),window.addEventListener("resize",this.onResize),m.$$(this.root).on(c.InitializationEvents.nuke,this.handleNuke)}return i(n,e),n.prototype.createDom=function(){this.facetHeader=new u.FacetHeader({field:this.options.field,facetElement:this.element,title:this.options.title,enableClearElement:!0,enableCollapseElement:!0,isNewDesign:this.getBindings().searchInterface.isNewDesign(),facetSlider:this}),this.element.appendChild(this.facetHeader.build())},n.prototype.reset=function(){this.slider&&(this.slider.initializeState(),this.updateQueryState(),this.updateAppearanceDependingOnState())},n.prototype.getSelectedValues=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider?[this.startOfSlider,this.endOfSlider]:[void 0,void 0]},n.prototype.setSelectedValues=function(t){this.setupSliderIfNeeded(void 0),this.startOfSlider=t[0],this.endOfSlider=t[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},n.prototype.isActive=function(){return!(isNaN(this.startOfSlider)||isNaN(this.endOfSlider)||isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)||this.startOfSlider==this.initialStartOfSlider&&this.endOfSlider==this.initialEndOfSlider)},n.prototype.getSliderBoundaryForQuery=function(){var t=!1;return this.slider?this.slider&&this.isActive()&&(t=!0):t=!0,t?this.generateBoundary():void 0},n.prototype.drawDelayedGraphData=function(){void 0==this.delayedGraphData||this.isEmpty||this.slider.drawGraph(this.delayedGraphData)},n.prototype.handleNoresults=function(){this.isEmpty=!0,this.updateAppearanceDependingOnState()},n.prototype.handleNewQuery=function(){this.isEmpty=!1},n.prototype.handleRangeQueryStateChanged=function(t){this.setupSliderIfNeeded(t),this.startOfSlider=void 0==t.value[0]?this.startOfSlider:t.value[0],this.endOfSlider=void 0==t.value[1]?this.endOfSlider:t.value[1],this.setSelectedValues([this.startOfSlider,this.endOfSlider])},n.prototype.handlePopulateBreadcrumb=function(t){var e=this,n=function(){e.isActive()&&t.breadcrumbs.push({element:e.buildBreadcrumbFacetSlider()})};this.slider?n():m.$$(this.root).one(d.QueryEvents.deferredQuerySuccess,function(){n(),m.$$(e.root).trigger(f.BreadcrumbEvents.redrawBreadcrumb)})},n.prototype.handlePopulateSearchAlerts=function(t){this.isActive()&&t.text.push(m.$$(this.buildBreadcrumbFacetSlider()).text())},n.prototype.buildBreadcrumbFacetSlider=function(){var t=this,e=m.$$("div",{className:"coveo-facet-slider-breadcrumb"}).el,n=m.$$("span",{className:"coveo-facet-slider-breadcrumb-title"});n.text(this.options.title+": "),e.appendChild(n.el);var i=m.$$("span",{className:"coveo-facet-slider-breadcrumb-values"});e.appendChild(i.el);var o=m.$$("span",{className:"coveo-facet-slider-breadcrumb-value"});o.text(this.slider.getCaption()),i.el.appendChild(o.el);var r=m.$$("span",{className:"coveo-facet-slider-breadcrumb-clear"});return o.el.appendChild(r.el),o.on("click",function(){t.reset(),t.usageAnalytics.logSearchEvent(v.analyticsActionCauseList.facetClearAll,{facetId:t.options.id,facetTitle:t.options.title}),t.queryController.executeQuery()}),e},n.prototype.initSlider=function(){this.buildSlider(),this.slider.initializeState([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState()},n.prototype.initQueryStateEvents=function(){var t=this;this.rangeQueryStateAttribute=y.QueryStateModel.getFacetId(this.options.id)+":range",this.queryStateModel.registerNewAttribute(this.rangeQueryStateAttribute,[void 0,void 0]);var e=this.queryStateModel.getEventName(g.Model.eventTypes.changeOne+this.rangeQueryStateAttribute);this.bind.onRootElement(e,function(e){t.slider?t.handleRangeQueryStateChanged(e):t.setRangeStateSliderStillNotCreated(e)})},n.prototype.setRangeStateSliderStillNotCreated=function(t){this.rangeFromUrlState=this.copyValues(t.value)},n.prototype.buildSlider=function(){var e=this,n=m.$$("div",{className:"coveo-facet-values coveo-slider-container"}).el;this.hasAGraph()&&m.$$(n).addClass("coveo-with-graph");var i=m.$$("div").el;this.slider=this.slider?this.slider:new o.Slider(i,t.extend({},this.options,{dateField:this.options.dateField}),this.root),m.$$(i).on(b.SliderEvents.endSlide,function(t,n){e.handleEndSlide(n)}),m.$$(i).on(b.SliderEvents.duringSlide,function(t,n){e.handleDuringSlide(n)}),this.hasAGraph()&&m.$$(i).on(b.SliderEvents.graphValueSelected,function(t,n){e.handleGraphValueSelected(n)}),n.appendChild(i),this.element.appendChild(n),this.updateAppearanceDependingOnState()},n.prototype.handleBuildingQuery=function(t){S.Assert.exists(t),S.Assert.exists(t.queryBuilder);var e=this.getSliderBoundaryForQuery();if(void 0!=e){this.facetQueryController.prepareForNewQuery();var n=this.facetQueryController.computeOurFilterExpression(e);x.Utils.isNonEmptyString(n)&&(this.logger.trace("Putting filter in query",n),t.queryBuilder.advancedExpression.add(n))}},n.prototype.handleDoneBuildingQuery=function(t){var e=t.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(e)},n.prototype.handleDeferredQuerySuccess=function(t){this.ensureDom(),this.setupSliderIfNeeded(t);var e=t.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];void 0!=e&&void 0!=e.values[0]||(this.isEmpty=!0),this.updateAppearanceDependingOnState(),this.hasAGraph()&&this.renderToSliderGraph(t)},n.prototype.handleEndSlide=function(t){var e=t.slider.getValues();this.startOfSlider=e[0],this.endOfSlider=e[1],this.updateQueryState(e)&&(this.updateAppearanceDependingOnState(),this.usageAnalytics.logSearchEvent(v.analyticsActionCauseList.facetRangeSlider,{facetId:this.options.id,facetRangeStart:this.startOfSlider.toString(),facetRangeEnd:this.endOfSlider.toString()}),this.queryController.executeQuery())},n.prototype.handleDuringSlide=function(t){var e=t.slider.getValues();this.startOfSlider=e[0],this.endOfSlider=e[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateAppearanceDependingOnState(!0)},n.prototype.handleGraphValueSelected=function(t){(this.options.rangeSlider&&this.startOfSlider!=t.start||this.endOfSlider!=t.end)&&(this.options.rangeSlider&&(this.startOfSlider=t.start),this.endOfSlider=t.end,this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateQueryState(),this.usageAnalytics.logSearchEvent(v.analyticsActionCauseList.facetRangeGraph,{facetId:this.options.id,facetRangeStart:this.startOfSlider.toString(),facetRangeEnd:this.endOfSlider.toString()}),this.queryController.executeQuery())},n.prototype.updateQueryState=function(t,e){void 0===t&&(t=this.slider.getValues()),void 0===e&&(e=!1);var n=this.copyValues(t),i=t[0]+0,o=t[1]+0,r=this.queryStateModel.get(this.rangeQueryStateAttribute);return(null==r||n[0]!=r[0]||n[1]!=r[1])&&(n[0]=i,n[1]=o,this.queryStateModel.set(this.rangeQueryStateAttribute,n,{silent:e}),!0)},n.prototype.copyValues=function(t){var e=[];return e[0]=Number(t[0])+0,e[1]=Number(t[1])+0,e},n.prototype.renderToSliderGraph=function(e){var n,i=this,o=e.results.groupByResults[this.facetQueryController.graphGroupByQueriesIndex],r=0;o&&(n=t.map(o.values,function(t){r+=t.numberOfResults;var e=t.value.split("..")[0],n=t.value.split("..")[1];i.options.dateField?(e=new Date(e.split("@")[0]).getTime(),n=new Date(n.split("@")[0]).getTime()):(e=Number(e),n=Number(n));var o=t.numberOfResults;return{start:e,y:o,end:n,isDate:i.options.dateField}})),0==r?(this.isEmpty=!0,this.updateAppearanceDependingOnState()):void 0==n||this.isDropdownHidden()?void 0!=n&&this.isDropdownHidden()&&(this.delayedGraphData=n):this.slider.drawGraph(n)},n.prototype.isDropdownHidden=function(){var t=this.root.querySelector(".coveo-facet-column");if(t)return"none"==m.$$(t).css("display");if(m.$$(this.root).hasClass("CoveoRecommendation")){var e=m.$$(this.root).parents(".coveo-recommendation-column")[0]||this.root;return"none"==m.$$(e).css("display")}return!1},n.prototype.generateBoundary=function(){if(this.slider){var t=this.generateBoundaryFromSlider();return void 0==t[0]&&void 0==t[1]?this.generateBoundaryFromState():t}return this.generateBoundaryFromState()},n.prototype.generateBoundaryFromSlider=function(){var t,e;return void 0!=this.startOfSlider&&(t=this.startOfSlider),void 0!=this.endOfSlider&&(e=this.endOfSlider),[t,e]},n.prototype.generateBoundaryFromState=function(){var t,e,n=this.queryStateModel.get(this.rangeQueryStateAttribute)[0];void 0!=n&&(t=n);var i=this.queryStateModel.get(this.rangeQueryStateAttribute)[1];return void 0!=i&&(e=i),t!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[0]||e!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[1]?[t,e]:[void 0,void 0]},n.prototype.setupSliderIfNeeded=function(t){if(this.ensureDom(),x.Utils.isNullOrUndefined(this.slider)){this.alreadySetBoundary()||this.trySetSliderBoundaryFromOptions(),this.alreadySetBoundary()||void 0==t||this.trySetSliderBoundaryFromQueryResult(t),this.trySetSliderBoundaryFromState(),this.setupSliderStateVariables();var e=this.verifySetup();e?this.logger.warn("Unable to initialize slider with current values",this):(this.initSlider(),this.updateQueryState())}},n.prototype.verifySetup=function(){var t=0;return t+=void 0==this.initialStartOfSlider?1:0,t+=isNaN(this.initialStartOfSlider)?1:0,t+=void 0==this.initialEndOfSlider?1:0,t+=isNaN(this.initialEndOfSlider)?1:0},n.prototype.setupSliderStateVariables=function(){isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)?this.logger.warn("Cannnot initialize slider with those values : start: "+this.initialStartOfSlider+" end: "+this.initialEndOfSlider):(this.initialStartOfSlider=Number(this.initialStartOfSlider),this.initialEndOfSlider=Number(this.initialEndOfSlider),this.startOfSlider=void 0!=this.startOfSlider?Number(this.startOfSlider):this.initialStartOfSlider,this.endOfSlider=void 0!=this.endOfSlider?Number(this.endOfSlider):this.initialEndOfSlider,this.options.start=this.initialStartOfSlider,this.options.end=this.initialEndOfSlider,this.queryStateModel.setNewDefault(this.rangeQueryStateAttribute,[this.initialStartOfSlider,this.initialEndOfSlider]))},n.prototype.alreadySetBoundary=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider},n.prototype.trySetSliderBoundaryFromOptions=function(){x.Utils.isNullOrUndefined(this.options.start)||this.setupInitialSliderStateStart(this.options.start),x.Utils.isNullOrUndefined(this.options.end)||this.setupInitialSliderStateEnd(this.options.end)},n.prototype.trySetSliderBoundaryFromState=function(){var t=this.rangeFromUrlState||this.queryStateModel.get(this.rangeQueryStateAttribute);t&&void 0!=t[0]&&void 0!=t[1]&&(t[0]=Number(t[0]),t[1]=Number(t[1]),this.setupInitialSliderStateStart(t[0]),this.setupInitialSliderStateEnd(t[1]),this.startOfSlider=t[0],this.endOfSlider=t[1])},n.prototype.trySetSliderBoundaryFromQueryResult=function(t){var e=t.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];e&&e.values.length>0&&(this.setupInitialSliderStateStart(e.values[0].value.split("..")[0]),this.setupInitialSliderStateEnd(e.values[e.values.length-1].value.split("..")[1]))},n.prototype.setupInitialSliderStateStart=function(t){void 0==this.initialStartOfSlider&&(this.initialStartOfSlider=t,this.options.dateField&&isNaN(t)&&(this.initialStartOfSlider=new Date(t.replace("@"," ")).getTime()))},n.prototype.setupInitialSliderStateEnd=function(t){void 0==this.initialEndOfSlider&&(this.initialEndOfSlider=t,this.options.dateField&&isNaN(t)&&(this.initialEndOfSlider=new Date(t.replace("@"," ")).getTime()))},n.prototype.hasAGraph=function(){return void 0!=this.options.graph},n.prototype.updateAppearanceDependingOnState=function(t){void 0===t&&(t=!1),!this.isEmpty||this.isActive()||t?(m.$$(this.element).removeClass("coveo-disabled-empty"),m.$$(this.facetHeader.eraserElement).toggle(this.isActive())):m.$$(this.element).addClass("coveo-disabled-empty"),this.isActive()||t?m.$$(this.element).removeClass("coveo-disabled"):m.$$(this.element).addClass("coveo-disabled")},n.prototype.handleNuke=function(){window.removeEventListener("resize",this.onResize)},n.options={title:s.ComponentOptions.buildLocalizedStringOption({defaultValue:l.l("NoTitle")}),dateField:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),field:s.ComponentOptions.buildFieldOption({groupByField:!0,required:!0}),id:s.ComponentOptions.buildStringOption({postProcessing:function(t,e){return t||e.field}}),dateFormat:s.ComponentOptions.buildStringOption(),queryOverride:s.ComponentOptions.buildStringOption(),start:s.ComponentOptions.buildStringOption(),end:s.ComponentOptions.buildStringOption(),excludeOuterBounds:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),rounded:s.ComponentOptions.buildNumberOption({min:0}),steps:s.ComponentOptions.buildNumberOption({min:2}),rangeSlider:s.ComponentOptions.buildBooleanOption(),displayAsValue:s.ComponentOptions.buildObjectOption({subOptions:{enable:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),unitSign:s.ComponentOptions.buildStringOption(),separator:s.ComponentOptions.buildStringOption({defaultValue:"-"})}}),displayAsPercent:s.ComponentOptions.buildObjectOption({subOptions:{enable:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),separator:s.ComponentOptions.buildStringOption({defaultValue:"-"})}}),graph:s.ComponentOptions.buildObjectOption({subOptions:{steps:s.ComponentOptions.buildNumberOption({min:2}),animationDuration:s.ComponentOptions.buildNumberOption({min:0}),margin:s.ComponentOptions.buildObjectOption({subOptions:{top:s.ComponentOptions.buildNumberOption({min:0}),bottom:s.ComponentOptions.buildNumberOption({min:0}),left:s.ComponentOptions.buildNumberOption({min:0}),right:s.ComponentOptions.buildNumberOption({min:0})}})}}),getSteps:s.ComponentOptions.buildCustomOption(function(){return null}),valueCaption:s.ComponentOptions.buildCustomOption(function(){return null}),enableResponsiveMode:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),responsiveBreakpoint:s.ComponentOptions.buildNumberOption({defaultValue:800}),dropdownHeaderLabel:s.ComponentOptions.buildLocalizedStringOption()},n.ID="FacetSlider",n.DEBOUNCED_RESIZE_DELAY=250,n}(r.Component);e.FacetSlider=T,E.Initialization.registerAutoCreateComponent(T)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(17),r=n(52),s=n(15),a=n(153),u=n(161),l=n(28),c=function(){function e(e,n,o){var r=this;if(this.element=e,this.options=n,this.root=o,this.steps=[],this.options.dateField&&(this.options.start=new Date(this.options.start).getTime(),this.options.end=new Date(this.options.end).getTime()),void 0==this.options.rounded&&(this.options.rounded=0),(this.options.steps||this.options.getSteps)&&this.buildSteps(),this.options.graph&&(this.sliderGraph=new g(this)),this.sliderLine=new h(this),t.each(this.sliderLine.build(),function(t){r.element.appendChild(t)}),this.options.rangeSlider)this.sliderRange=new d(this),t.each(this.sliderRange.build(),function(t){r.element.appendChild(t)});else{this.sliderButton=new p(this,1);var s=this.sliderButton.build();i.$$(s).addClass("coveo-no-range-button"),this.element.appendChild(s),this.sliderLine.setActiveWidth(this.sliderButton)}this.sliderCaption=new f(this),this.element.appendChild(this.sliderCaption.build())}return e.prototype.onMoving=function(){this.options.rangeSlider?(this.sliderRange.setBoundary(),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(this.setButtonBoundary(),this.sliderLine.setActiveWidth(this.sliderButton)),this.options.graph&&this.sliderGraph.draw(),this.displayCaption()},e.prototype.initializeState=function(t){void 0===t&&(t=[this.options.start,this.options.end]),this.currentValues=t,this.options.rangeSlider?(this.sliderRange.initializeSliderRangeState(t),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(void 0==t?this.sliderButton.toEnd():this.sliderButton.setValue(t[1]),this.setButtonBoundary(),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.getPosition=function(){return this.options.rangeSlider?this.sliderRange.getPosition():[0,this.sliderButton.getPosition()]},e.prototype.getPercentPosition=function(){return this.options.rangeSlider?this.sliderRange.getPercentPosition():[0,this.sliderButton.getPercent()]},e.prototype.getValues=function(){return void 0!=this.currentValues?this.currentValues:this.options.rangeSlider?this.sliderRange.getValue():[this.options.start,this.sliderButton.getValue()]},e.prototype.getCaptionFromValue=function(t){return this.sliderCaption.getCaptionFromValues(t)},e.prototype.getCaption=function(){return this.sliderCaption.getCaption()},e.prototype.setValues=function(t){void 0!=t&&(t[0]=Math.max(t[0],this.options.start),t[1]=Math.min(t[1],this.options.end)),this.currentValues=t,this.options.rangeSlider?(this.sliderRange.setValue(t),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(this.sliderButton.setValue(t[1]),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.drawGraph=function(t){this.sliderGraph&&this.sliderGraph.draw(t)},e.prototype.setButtonBoundary=function(){this.sliderButton.leftBoundary=0,this.sliderButton.rightBoundary=this.element.clientWidth},e.prototype.displayCaption=function(){void 0!=this.options.valueCaption?this.sliderCaption.setFromString(this.options.valueCaption(this.getValues())):void 0!=this.options.percentCaption?this.sliderCaption.setFromString(this.options.percentCaption(this.getPercentPosition())):void 0!=this.options.displayAsPercent&&void 0!=this.options.displayAsPercent.separator&&this.options.displayAsPercent.enable?this.sliderCaption.setAsPercent():this.sliderCaption.setAsValue()},e.prototype.buildSteps=function(){if(this.options.getSteps)this.steps=this.options.getSteps(this.options.start,this.options.end);else{var t=(this.options.end-this.options.start)/Math.max(1,this.options.steps);if(t>0)for(var e=this.options.start;e<=this.options.end;)this.steps.push(e),e+=t;else this.steps.push(this.options.start),this.steps.push(this.options.end)}},e}();e.Slider=c;var h=function(){function t(t){this.slider=t}return t.prototype.build=function(){return this.backGround=i.$$("div",{className:"coveo-slider-line coveo-background"}).el,this.activePart=i.$$("div",{className:"coveo-slider-line coveo-active"}).el,[this.backGround,this.activePart]},t.prototype.setActiveWidth=function(t,e){if(this.slider.options.rangeSlider){var n=100*(e.getPercent()-t.getPercent());this.activePart.style.width=n+"%",this.activePart.style.left=100*t.getPercent()+"%",this.activePart.style.right=100*e.getPercent()+"%"}else{var n=100*t.getPercent();this.activePart.style.width=n+"%"}},t}(),p=function(){function e(t,e){this.slider=t,this.which=e,this.eventMouseDown=o.DeviceUtils.isMobileDevice()?"touchstart":"mousedown",this.eventMouseMove=o.DeviceUtils.isMobileDevice()?"touchmove":"mousemove",this.eventMouseUp=o.DeviceUtils.isMobileDevice()?"touchend":"mouseup"}return e.prototype.build=function(){return this.element=i.$$("div",{className:"coveo-slider-button"}).el,this.bindEvents(),this.element.CoveoSliderButton=this,this.element},e.prototype.toBeginning=function(){this.element.style.left="0%"},e.prototype.toEnd=function(){this.element.style.left="100%"},e.prototype.setValue=function(t){var e=this.fromValueToPercent(t);this.element.style.left=Math.round(100*e)+"%"},e.prototype.getPosition=function(){var t=this.element.style.left;return t.indexOf("%")!=-1?parseFloat(t)/100*this.slider.element.clientWidth:parseFloat(t)},e.prototype.getPercent=function(t){return void 0===t&&(t=this.getPosition()),0==this.slider.element.clientWidth?0:+(t/this.slider.element.clientWidth).toFixed(2)},e.prototype.getValue=function(){var t=this.getPercent()*(this.slider.options.end-this.slider.options.start)+this.slider.options.start;return t},e.prototype.fromValueToPercent=function(t){return 1-(this.slider.options.end-t)/(this.slider.options.end-this.slider.options.start)},e.prototype.fromPositionToValue=function(t){var e=this.getPercent(t);return this.slider.options.start+e*(this.slider.options.end-this.slider.options.start)},e.prototype.fromValueToPosition=function(t){var e=this.fromValueToPercent(t);return this.slider.element.clientWidth*e},e.prototype.bindEvents=function(){var t=this;i.$$(this.element).on(this.eventMouseDown,function(e){t.handleStartSlide(e)});var e=this.slider.options.document||document;e.addEventListener(this.eventMouseMove,function(e){"touchmove"==t.eventMouseMove&&t.isMouseDown&&e.preventDefault(),t.handleMoving(e)}),e.addEventListener(this.eventMouseUp,function(){t.handleEndSlide()})},e.prototype.getUserSelect=function(){return void 0!==document.body.style.msUserSelect?"msUserSelect":void 0!==document.body.style.webkitUserSelect?"webkitUserSelect":void 0!==document.body.style.MozUserSelect?"MozUserSelect":"userSelect"},e.prototype.handleStartSlide=function(t){var e=this.getMousePosition(t);this.isMouseDown=!0,this.startPositionX=e.x,this.lastElementLeft=parseInt(this.element.style.left,10)/100*this.slider.element.clientWidth,this.origUserSelect=document.body.style[this.getUserSelect()],this.origCursor=document.body.style.cursor,document.body.style[this.getUserSelect()]="none",document.body.style.cursor="pointer",i.$$(this.element).addClass("coveo-active"),i.$$(this.element).trigger(r.SliderEvents.startSlide,{button:this,slider:this.slider}),t.stopPropagation()},e.prototype.handleMoving=function(t){this.isMouseDown&&(this.slider.onMoving(),this.updatePosition(t),this.handleButtonNearEnd(),i.$$(this.element).trigger(r.SliderEvents.duringSlide,{button:this,slider:this.slider}))},e.prototype.handleEndSlide=function(){this.isMouseDown&&(document.body.style[this.getUserSelect()]=this.origUserSelect,document.body.style.cursor=this.origCursor,i.$$(this.element).removeClass("coveo-active"),i.$$(this.element).trigger(r.SliderEvents.endSlide,{button:this,slider:this.slider})),this.isMouseDown=!1},e.prototype.handleButtonNearEnd=function(){0==this.which&&(void 0==this.origZIndex&&(this.origZIndex=this.element.style.zIndex||"1"),this.currentPos>90?this.element.style.zIndex=this.origZIndex+1:this.element.style.zIndex=this.origZIndex)},e.prototype.getMousePosition=function(t){var e=0,n=0;return t instanceof TouchEvent?(e=t.touches[0].pageX,n=t.touches[0].pageY):t.pageX&&t.pageY?(e=t.pageX,n=t.pageY):t.clientX&&t.clientY&&(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:e,y:n}},e.prototype.updatePosition=function(t){var e=this.getMousePosition(t),n=e.x-this.startPositionX;if(this.currentPos=this.lastElementLeft+n,this.slider.options.steps||this.slider.options.getSteps){var i=this.snapToStep(n);this.currentPos=i.position;var o=i.value}this.currentPos=Math.max(this.leftBoundary,this.currentPos),this.currentPos=Math.min(this.rightBoundary,this.currentPos),this.currentPos=100*this.getPercent(this.currentPos),this.currentPos=Math.min(this.currentPos,100),this.currentPos=Math.max(this.currentPos,0),this.element.style.left=Math.round(this.currentPos)+"%",this.slider.options.steps||this.slider.options.getSteps?this.slider.currentValues[this.which]=o:this.slider.currentValues[this.which]=this.getValue()},e.prototype.snapToStep=function(e){var n=this,i=t.map(this.slider.steps,function(t,e){return Math.abs(n.currentPos-n.fromValueToPosition(n.slider.steps[e]))}),o=t.map(this.slider.steps,function(t,e){return Math.abs(n.rightBoundary-n.fromValueToPosition(n.slider.steps[e]))}),r=t.map(this.slider.steps,function(t,e){return Math.abs(n.leftBoundary-n.fromValueToPosition(n.slider.steps[e]))}),s=t.min(i),a=t.min(o),u=t.min(r),l=this.slider.steps[t.indexOf(i,s)],c=this.slider.steps[t.indexOf(o,a)],h=this.slider.steps[t.indexOf(r,u)];return l=Math.min(l,c),l=Math.max(l,h),{position:this.fromValueToPosition(l),value:l}},e}();e.SliderButton=p;var d=function(){function t(t){this.slider=t,this.firstButton=new p(t,0),this.secondButton=new p(t,1)}return t.prototype.build=function(){var t=this.firstButton.build(),e=this.secondButton.build();return i.$$(e).addClass("coveo-range-button"),[t,e]},t.prototype.initializeSliderRangeState=function(t){void 0==t?(this.firstButton.toBeginning(),this.secondButton.toEnd()):(this.firstButton.setValue(t[0]),this.secondButton.setValue(t[1])),this.setBoundary()},t.prototype.setValue=function(t){this.firstButton.setValue(t[0]),this.secondButton.setValue(t[1])},t.prototype.setBoundary=function(){this.firstButton.leftBoundary=0,this.firstButton.rightBoundary=this.secondButton.getPosition(),this.secondButton.leftBoundary=this.firstButton.getPosition(),this.secondButton.rightBoundary=this.slider.element.clientWidth},t.prototype.getPosition=function(){return[this.firstButton.getPosition(),this.secondButton.getPosition()]},t.prototype.getPercentPosition=function(){return[this.firstButton.getPercent(),this.secondButton.getPercent()]},t.prototype.getValue=function(){return[this.firstButton.getValue(),this.secondButton.getValue()]},t}(),f=function(){function t(t){this.slider=t,this.separator="-",this.unitSign="",this.slider.options.displayAsPercent&&this.slider.options.displayAsPercent.enable?this.separator=void 0!=this.slider.options.displayAsPercent.separator?this.slider.options.displayAsPercent.separator:this.separator:this.slider.options.displayAsValue&&this.slider.options.displayAsValue.enable&&(this.separator=void 0!=this.slider.options.displayAsValue.separator?this.slider.options.displayAsValue.separator:this.separator,this.unitSign=void 0!=this.slider.options.displayAsValue.unitSign?this.slider.options.displayAsValue.unitSign:this.unitSign);
}return t.prototype.build=function(){return this.caption=i.$$("div",{className:"coveo-slider-caption"}).el,this.caption},t.prototype.getCaption=function(){return i.$$(this.caption).text()},t.prototype.getCaptionFromValues=function(t){return this.getValueCaption(t)},t.prototype.getCaptionFromValuesAsPercent=function(t){return this.getValueCaption(t)},t.prototype.setAsValue=function(){i.$$(this.caption).text(this.getValueCaption())},t.prototype.setAsPercent=function(){var t=this.slider.getPercentPosition();i.$$(this.caption).text([(100*t[0]).toFixed(this.slider.options.rounded),"%",this.separator,(100*t[1]).toFixed(this.slider.options.rounded),"%"].join(" "))},t.prototype.setFromString=function(t){i.$$(this.caption).text(t)},t.prototype.getValueCaption=function(t){void 0===t&&(t=this.slider.getValues());var e=t[0],n=t[1];if(this.slider.options.dateField){var i=new Date(e),o=new Date(n);i.setHours(0,0,0,0),o.setHours(0,0,0,0),e=l.format(i,this.slider.options.dateFormat||"MMM dd, yyyy"),n=l.format(o,this.slider.options.dateFormat||"MMM dd, yyyy"),this.unitSign=""}else e=e.toFixed(this.slider.options.rounded),n=n.toFixed(this.slider.options.rounded);return[e,this.unitSign,this.separator,n,this.unitSign].join(" ")},t}(),g=function(){function e(t){this.slider=t,this.svg=u.select(t.element).append("svg").append("g"),this.x=a.scaleBand(),this.y=a.scaleLinear(),this.slider.options.graph.margin=s.Utils.extendDeep({top:20,right:0,left:0,bottom:20},this.slider.options.graph.margin||{}),this.slider.options.graph.animationDuration=this.slider.options.graph.animationDuration||500,this.tooltip=i.$$("div",{className:"coveo-slider-tooltip"}).el,this.tooltip.style.display="none",this.slider.element.appendChild(this.tooltip),this.slider.options.graph.steps=this.slider.options.graph.steps||10}return e.prototype.draw=function(t){if(void 0===t&&(t=this.oldData),t){var e=this.slider.element.offsetWidth,n=this.slider.element.offsetHeight,i=e-this.slider.options.graph.margin.left-this.slider.options.graph.margin.right,o=n-this.slider.options.graph.margin.top-this.slider.options.graph.margin.bottom;this.applyTransformOnSvg(i,o),this.setXAndYRange(i,o),this.setXAndYDomain(t);var r=this.svg.selectAll(".coveo-bar").data(t),s=this.slider.getValues();this.renderGraphBars(r,i,o,s),this.setGraphBarsTransition(r,o,s),this.oldData=t}},e.prototype.setXAndYRange=function(t,e){this.x.range([0,t]),this.x.padding(.2),this.y.range([e-this.slider.options.graph.margin.top,0])},e.prototype.setXAndYDomain=function(e){this.padGraphWithEmptyData(e),this.x.domain(t.map(e,function(t){return t.start})),this.y.domain([0,u.max(e,function(t){return t.y})])},e.prototype.padGraphWithEmptyData=function(t){var e=t[0].end-t[0].start;0!=e&&(this.padBeginningOfGraphWithEmptyData(t,e),this.padEndOfGraphWithEmptyData(t,e))},e.prototype.padBeginningOfGraphWithEmptyData=function(t,e){if(t[0].start>this.slider.options.start)for(var n=t[0].start-this.slider.options.start,i=Math.round(n/e),o=t[0].start,r=i;r>0;r--)t.unshift({start:o-e,end:o,y:0}),o-=e},e.prototype.padEndOfGraphWithEmptyData=function(t,e){var n=t.length-1;if(t[n].end<this.slider.options.end)for(var i=this.slider.options.end-t[n].end,o=Math.round(i/e),r=t[n].end,s=0;s<o;s++)t.push({start:r,end:r+e,y:0}),r+=e},e.prototype.applyTransformOnSvg=function(t,e){var n=i.$$(this.slider.element).find("svg");n.setAttribute("width",t+"px"),n.setAttribute("height",e+"px"),this.svg.attr("transform","translate("+this.slider.options.graph.margin.left+","+this.slider.options.graph.margin.top+")")},e.prototype.renderGraphBars=function(t,e,n,i){t.enter().append("rect").attr("class",this.getFunctionForClass(i)).attr("width",this.x.bandwidth()).attr("height",this.getFunctionForHeight(n)).attr("x",this.getFunctionForX()).attr("y",this.getFunctionForY()).on("click",this.getFunctionForClick()).on("mouseover",this.getFunctionForMouseOver(n)).on("mouseout",this.getFunctionForMouseOut())},e.prototype.setGraphBarsTransition=function(t,e,n){t.transition().attr("x",this.getFunctionForX()).attr("width",this.x.bandwidth()).attr("class",this.getFunctionForClass(n)).transition().duration(this.slider.options.graph.animationDuration).attr("y",this.getFunctionForY()).attr("height",this.getFunctionForHeight(e))},e.prototype.getBarClass=function(t,e,n){return e.start>=t[0]&&e.end<=t[1]?"coveo-active":t[0]==this.slider.options.start&&0==n?"coveo-active":t[1]==this.slider.options.end&&n==this.slider.options.graph.steps-1?"coveo-active":""},e.prototype.setTooltip=function(t,e){var n=i.$$("span",{className:"coveo-caption"});n.text(this.slider.getCaptionFromValue([t.start,t.end]));var o=i.$$("span",{className:"coveo-count"});o.text(t.y.toString()),i.$$(this.tooltip).empty(),this.tooltip.appendChild(n.el),this.tooltip.appendChild(o.el),this.tooltip.style.display="block",this.tooltip.style.left=this.x(t.start)-.2*this.slider.options.graph.steps+"px",this.tooltip.style.top=this.y(t.y)-e+"px"},e.prototype.getFunctionForX=function(){var t=this;return function(e){return t.x(e.start)}},e.prototype.getFunctionForY=function(){var t=this;return function(e){return t.y(e.y)}},e.prototype.getFunctionForHeight=function(t){var e=this;return function(n){return t-e.y(n.y)}},e.prototype.getFunctionForClass=function(t){var e=this;return function(n,i){return"coveo-bar "+e.getBarClass(t,n,i)}},e.prototype.getFunctionForClick=function(){var t=this;return function(e,n){i.$$(t.slider.element).trigger(r.SliderEvents.graphValueSelected,{start:e.start,end:e.end,value:e.y})}},e.prototype.getFunctionForMouseOver=function(t){var e=this;return function(n){e.setTooltip(n,t)}},e.prototype.getFunctionForMouseOut=function(){var t=this;return function(){t.tooltip.style.display="none"}},e}()}).call(e,n(10))},function(t,e,n){!function(t,i){i(e,n(154),n(155),n(156),n(158),n(159),n(160),n(157))}(this,function(t,e,n,i,o,r,s,a){"use strict";function u(t){function e(e){var n=e+"",s=i.get(n);if(!s){if(r!==H)return r;i.set(n,s=o.push(e))}return t[(s-1)%t.length]}var i=n.map(),o=[],r=H;return t=null==t?[]:V.call(t),e.domain=function(t){if(!arguments.length)return o.slice();o=[],i=n.map();for(var r,s,a=-1,u=t.length;++a<u;)i.has(s=(r=t[a])+"")||i.set(s,o.push(r));return e},e.range=function(n){return arguments.length?(t=V.call(n),e):t.slice()},e.unknown=function(t){return arguments.length?(r=t,e):r},e.copy=function(){return u().domain(o).range(t).unknown(r)},e}function l(){function t(){var t=r().length,o=a[1]<a[0],u=a[o-0],l=a[1-o];n=(l-u)/Math.max(1,t-h+2*p),c&&(n=Math.floor(n)),u+=(l-u-n*(t-h))*d,i=n*(1-h),c&&(u=Math.round(u),i=Math.round(i));var f=e.range(t).map(function(t){return u+n*t});return s(o?f.reverse():f)}var n,i,o=u().unknown(void 0),r=o.domain,s=o.range,a=[0,1],c=!1,h=0,p=0,d=.5;return delete o.unknown,o.domain=function(e){return arguments.length?(r(e),t()):r()},o.range=function(e){return arguments.length?(a=[+e[0],+e[1]],t()):a.slice()},o.rangeRound=function(e){return a=[+e[0],+e[1]],c=!0,t()},o.bandwidth=function(){return i},o.step=function(){return n},o.round=function(e){return arguments.length?(c=!!e,t()):c},o.padding=function(e){return arguments.length?(h=p=Math.max(0,Math.min(1,e)),t()):h},o.paddingInner=function(e){return arguments.length?(h=Math.max(0,Math.min(1,e)),t()):h},o.paddingOuter=function(e){return arguments.length?(p=Math.max(0,Math.min(1,e)),t()):p},o.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),t()):d},o.copy=function(){return l().domain(r()).range(a).round(c).paddingInner(h).paddingOuter(p).align(d)},t()}function c(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return c(e())},t}function h(){return c(l().paddingInner(1))}function p(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:q(e)}function d(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:i(t)}}}function f(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:i(t)}}}function g(t,e,n,i){var o=t[0],r=t[1],s=e[0],a=e[1];return r<o?(o=n(r,o),s=i(a,s)):(o=n(o,r),s=i(s,a)),function(t){return s(o(t))}}function m(t,n,i,o){var r=Math.min(t.length,n.length)-1,s=new Array(r),a=new Array(r),u=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++u<r;)s[u]=i(t[u],t[u+1]),a[u]=o(n[u],n[u+1]);return function(n){var i=e.bisect(t,n,1,r)-1;return a[i](s[i](n))}}function v(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function y(t,e){function n(){return r=Math.min(u.length,l.length)>2?m:g,s=a=null,o}function o(e){return(s||(s=r(u,l,h?d(t):t,c)))(+e)}var r,s,a,u=z,l=z,c=i.interpolate,h=!1;return o.invert=function(t){return(a||(a=r(l,u,p,h?f(e):e)))(+t)},o.domain=function(t){return arguments.length?(u=Q.call(t,j),n()):u.slice()},o.range=function(t){return arguments.length?(l=V.call(t),n()):l.slice()},o.rangeRound=function(t){return l=V.call(t),c=i.interpolateRound,n()},o.clamp=function(t){return arguments.length?(h=!!t,n()):h},o.interpolate=function(t){return arguments.length?(c=t,n()):c},n()}function b(t){var n=t.domain;return t.ticks=function(t){var i=n();return e.ticks(i[0],i[i.length-1],null==t?10:t)},t.tickFormat=function(t,e){return W(n(),t,e)},t.nice=function(i){var o=n(),r=o.length-1,s=null==i?10:i,a=o[0],u=o[r],l=e.tickStep(a,u,s);return l&&(l=e.tickStep(Math.floor(a/l)*l,Math.ceil(u/l)*l,s),o[0]=Math.floor(a/l)*l,o[r]=Math.ceil(u/l)*l,n(o)),t},t}function S(){var t=y(p,i.interpolateNumber);return t.copy=function(){return v(t,S())},b(t)}function x(){function t(t){return+t}var e=[0,1];return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=Q.call(n,j),t):e.slice()},t.copy=function(){return x().domain(e)},b(t)}function C(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:q(e)}function E(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function w(t){return isFinite(t)?+("1e"+t):t<0?0:t}function A(t){return 10===t?w:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function T(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function O(t){return function(e){return-t(-e)}}function _(){function t(){return s=T(r),a=A(r),i()[0]<0&&(s=O(s),a=O(a)),n}var n=y(C,E).domain([1,10]),i=n.domain,r=10,s=T(10),a=A(10);return n.base=function(e){return arguments.length?(r=+e,t()):r},n.domain=function(e){return arguments.length?(i(e),t()):i()},n.ticks=function(t){var n,o=i(),u=o[0],l=o[o.length-1];(n=l<u)&&(d=u,u=l,l=d);var c,h,p,d=s(u),f=s(l),g=null==t?10:+t,m=[];if(!(r%1)&&f-d<g){if(d=Math.round(d)-1,f=Math.round(f)+1,u>0){for(;d<f;++d)for(h=1,c=a(d);h<r;++h)if(p=c*h,!(p<u)){if(p>l)break;m.push(p)}}else for(;d<f;++d)for(h=r-1,c=a(d);h>=1;--h)if(p=c*h,!(p<u)){if(p>l)break;m.push(p)}}else m=e.ticks(d,f,Math.min(f-d,g)).map(a);return n?m.reverse():m},n.tickFormat=function(t,e){if(null==e&&(e=10===r?".0e":","),"function"!=typeof e&&(e=o.format(e)),t===1/0)return e;null==t&&(t=10);var i=Math.max(1,r*t/n.ticks().length);return function(t){var n=t/a(Math.round(s(t)));return n*r<r-.5&&(n*=r),n<=i?e(t):""}},n.nice=function(){return i(Y(i(),{floor:function(t){return a(Math.floor(s(t)))},ceil:function(t){return a(Math.ceil(s(t)))}}))},n.copy=function(){return v(n,_().base(r))},n}function M(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function N(){function t(t,e){return(e=M(e,n)-(t=M(t,n)))?function(i){return(M(i,n)-t)/e}:q(e)}function e(t,e){return e=M(e,n)-(t=M(t,n)),function(i){return M(t+e*i,1/n)}}var n=1,i=y(t,e),o=i.domain;return i.exponent=function(t){return arguments.length?(n=+t,o(o())):n},i.copy=function(){return v(i,N().exponent(n))},b(i)}function R(){return N().exponent(.5)}function D(){function t(){var t=0,s=Math.max(1,o.length);for(r=new Array(s-1);++t<s;)r[t-1]=e.quantile(i,t/s);return n}function n(t){if(!isNaN(t=+t))return o[e.bisect(r,t)]}var i=[],o=[],r=[];return n.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:[e>0?r[e-1]:i[0],e<r.length?r[e]:i[i.length-1]]},n.domain=function(n){if(!arguments.length)return i.slice();i=[];for(var o,r=0,s=n.length;r<s;++r)o=n[r],null==o||isNaN(o=+o)||i.push(o);return i.sort(e.ascending),t()},n.range=function(e){return arguments.length?(o=V.call(e),t()):o.slice()},n.quantiles=function(){return r.slice()},n.copy=function(){return D().domain(i).range(o)},n}function I(){function t(t){if(t<=t)return a[e.bisect(s,t,0,r)]}function n(){var e=-1;for(s=new Array(r);++e<r;)s[e]=((e+1)*o-(e-r)*i)/(r+1);return t}var i=0,o=1,r=1,s=[.5],a=[0,1];return t.domain=function(t){return arguments.length?(i=+t[0],o=+t[1],n()):[i,o]},t.range=function(t){return arguments.length?(r=(a=V.call(t)).length-1,n()):a.slice()},t.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[i,s[0]]:e>=r?[s[r-1],o]:[s[e-1],s[e]]},t.copy=function(){return I().domain([i,o]).range(a)},b(t)}function F(){function t(t){if(t<=t)return i[e.bisect(n,t,0,o)]}var n=[.5],i=[0,1],o=1;return t.domain=function(e){return arguments.length?(n=V.call(e),o=Math.min(n.length,i.length-1),t):n.slice()},t.range=function(e){return arguments.length?(i=V.call(e),o=Math.min(n.length,i.length-1),t):i.slice()},t.invertExtent=function(t){var e=i.indexOf(t);return[n[e-1],n[e]]},t.copy=function(){return F().domain(n).range(i)},t}function k(t){return new Date(t)}function $(t){return t instanceof Date?+t:+new Date(+t)}function L(t,n,o,r,s,a,u,l,c){function h(e){return(u(e)<e?b:a(e)<e?S:s(e)<e?x:r(e)<e?C:n(e)<e?o(e)<e?E:w:t(e)<e?A:T)(e)}function d(n,i,o,r){if(null==n&&(n=10),"number"==typeof n){var s=Math.abs(o-i)/n,a=e.bisector(function(t){return t[2]}).right(O,s);a===O.length?(r=e.tickStep(i/et,o/et,n),n=t):a?(a=O[s/O[a-1][2]<O[a][2]/s?a-1:a],r=a[1],n=a[0]):(r=e.tickStep(i,o,n),n=l)}return null==r?n:n.every(r)}var f=y(p,i.interpolateNumber),g=f.invert,m=f.domain,b=c(".%L"),S=c(":%S"),x=c("%I:%M"),C=c("%I %p"),E=c("%a %d"),w=c("%b %d"),A=c("%B"),T=c("%Y"),O=[[u,1,G],[u,5,5*G],[u,15,15*G],[u,30,30*G],[a,1,K],[a,5,5*K],[a,15,15*K],[a,30,30*K],[s,1,X],[s,3,3*X],[s,6,6*X],[s,12,12*X],[r,1,J],[r,2,2*J],[o,1,Z],[n,1,tt],[n,3,3*tt],[t,1,et]];return f.invert=function(t){return new Date(g(t))},f.domain=function(t){return arguments.length?m(Q.call(t,$)):m().map(k)},f.ticks=function(t,e){var n,i=m(),o=i[0],r=i[i.length-1],s=r<o;return s&&(n=o,o=r,r=n),n=d(t,o,r,e),n=n?n.range(o,r+1):[],s?n.reverse():n},f.tickFormat=function(t,e){return null==e?h:c(e)},f.nice=function(t,e){var n=m();return(t=d(t,n[0],n[n.length-1],e))?m(Y(n,t)):f},f.copy=function(){return v(f,L(t,n,o,r,s,a,u,l,c))},f}function U(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function B(t){function e(e){var r=(e-n)/(i-n);return t(o?Math.max(0,Math.min(1,r)):r)}var n=0,i=1,o=!1;return e.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.clamp=function(t){return arguments.length?(o=!!t,e):o},e.interpolator=function(n){return arguments.length?(t=n,e):t},e.copy=function(){return B(t).domain([n,i]).clamp(o)},b(e)}var P=Array.prototype,Q=P.map,V=P.slice,H={name:"implicit"},q=function(t){return function(){return t}},j=function(t){return+t},z=[0,1],W=function(t,n,i){var r,s=t[0],a=t[t.length-1],u=e.tickStep(s,a,null==n?10:n);switch(i=o.formatSpecifier(null==i?",f":i),i.type){case"s":var l=Math.max(Math.abs(s),Math.abs(a));return null!=i.precision||isNaN(r=o.precisionPrefix(u,l))||(i.precision=r),o.formatPrefix(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=o.precisionRound(u,Math.max(Math.abs(s),Math.abs(a))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=o.precisionFixed(u))||(i.precision=r-2*("%"===i.type))}return o.format(i)},Y=function(t,e){t=t.slice();var n,i=0,o=t.length-1,r=t[i],s=t[o];return s<r&&(n=i,i=o,o=n,n=r,r=s,s=n),t[i]=e.floor(r),t[o]=e.ceil(s),t},G=1e3,K=60*G,X=60*K,J=24*X,Z=7*J,tt=30*J,et=365*J,nt=function(){return L(r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,r.timeMillisecond,s.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},it=function(){return L(r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,r.utcMillisecond,s.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},ot=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},rt=ot("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),st=ot("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),at=ot("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),ut=ot("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),lt=i.interpolateCubehelixLong(a.cubehelix(300,.5,0),a.cubehelix(-240,.5,1)),ct=i.interpolateCubehelixLong(a.cubehelix(-100,.75,.35),a.cubehelix(80,1.5,.8)),ht=i.interpolateCubehelixLong(a.cubehelix(260,.75,.35),a.cubehelix(80,1.5,.8)),pt=a.cubehelix(),dt=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return pt.h=360*t-100,pt.s=1.5-1.5*e,pt.l=.8-.9*e,pt+""},ft=U(ot("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),gt=U(ot("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),mt=U(ot("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),vt=U(ot("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));t.scaleBand=l,t.scalePoint=h,t.scaleIdentity=x,t.scaleLinear=S,t.scaleLog=_,t.scaleOrdinal=u,t.scaleImplicit=H,t.scalePow=N,t.scaleSqrt=R,t.scaleQuantile=D,t.scaleQuantize=I,t.scaleThreshold=F,t.scaleTime=nt,t.scaleUtc=it,t.schemeCategory10=rt,t.schemeCategory20b=st,t.schemeCategory20c=at,t.schemeCategory20=ut,t.interpolateCubehelixDefault=lt,t.interpolateRainbow=dt,t.interpolateWarm=ct,t.interpolateCool=ht,t.interpolateViridis=ft,t.interpolateMagma=gt,t.interpolateInferno=mt,t.interpolatePlasma=vt,t.scaleSequential=B,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t){return function(e,n){return o(t(e),n)}}function n(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/o;return r>=S?o*=10:r>=x?o*=5:r>=C&&(o*=2),e<t?-o:o}function i(t){return t.length}var o=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},r=function(t){return 1===t.length&&(t=e(t)),{left:function(e,n,i,o){for(null==i&&(i=0),null==o&&(o=e.length);i<o;){var r=i+o>>>1;t(e[r],n)<0?i=r+1:o=r}return i},right:function(e,n,i,o){for(null==i&&(i=0),null==o&&(o=e.length);i<o;){var r=i+o>>>1;t(e[r],n)>0?o=r:i=r+1}return i}}},s=r(o),a=s.right,u=s.left,l=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},c=function(t){return null===t?NaN:+t},h=function(t,e){var n,i,o=t.length,r=0,s=0,a=-1,u=0;if(null==e)for(;++a<o;)isNaN(n=c(t[a]))||(i=n-r,r+=i/++u,s+=i*(n-r));else for(;++a<o;)isNaN(n=c(e(t[a],a,t)))||(i=n-r,r+=i/++u,s+=i*(n-r));if(u>1)return s/(u-1)},p=function(t,e){var n=h(t,e);return n?Math.sqrt(n):n},d=function(t,e){var n,i,o,r=-1,s=t.length;if(null==e){for(;++r<s;)if(null!=(i=t[r])&&i>=i){n=o=i;break}for(;++r<s;)null!=(i=t[r])&&(n>i&&(n=i),o<i&&(o=i))}else{for(;++r<s;)if(null!=(i=e(t[r],r,t))&&i>=i){n=o=i;break}for(;++r<s;)null!=(i=e(t[r],r,t))&&(n>i&&(n=i),o<i&&(o=i))}return[n,o]},f=Array.prototype,g=f.slice,m=f.map,v=function(t){return function(){return t}},y=function(t){return t},b=function(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var i=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),r=new Array(o);++i<o;)r[i]=t+i*n;return r},S=Math.sqrt(50),x=Math.sqrt(10),C=Math.sqrt(2),E=function(t,e,i){var o=n(t,e,i);return b(Math.ceil(t/o)*o,Math.floor(e/o)*o+o/2,o)},w=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},A=function(){function t(t){var o,r,s=t.length,u=new Array(s);for(o=0;o<s;++o)u[o]=e(t[o],o,t);var l=n(u),c=l[0],h=l[1],p=i(u,c,h);Array.isArray(p)||(p=E(c,h,p));for(var d=p.length;p[0]<=c;)p.shift(),--d;for(;p[d-1]>=h;)p.pop(),--d;var f,g=new Array(d+1);for(o=0;o<=d;++o)f=g[o]=[],f.x0=o>0?p[o-1]:c,f.x1=o<d?p[o]:h;for(o=0;o<s;++o)r=u[o],c<=r&&r<=h&&g[a(p,r,0,d)].push(t[o]);return g}var e=y,n=d,i=w;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:v(n),t):e},t.domain=function(e){return arguments.length?(n="function"==typeof e?e:v([e[0],e[1]]),t):n},t.thresholds=function(e){return arguments.length?(i="function"==typeof e?e:v(Array.isArray(e)?g.call(e):e),t):i},t},T=function(t,e,n){if(null==n&&(n=c),i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,o=(i-1)*e,r=Math.floor(o),s=+n(t[r],r,t),a=+n(t[r+1],r+1,t);return s+(a-s)*(o-r)}},O=function(t,e,n){return t=m.call(t,c).sort(o),Math.ceil((n-e)/(2*(T(t,.75)-T(t,.25))*Math.pow(t.length,-1/3)))},_=function(t,e,n){return Math.ceil((n-e)/(3.5*p(t)*Math.pow(t.length,-1/3)))},M=function(t,e){var n,i,o=-1,r=t.length;if(null==e){for(;++o<r;)if(null!=(i=t[o])&&i>=i){n=i;break}for(;++o<r;)null!=(i=t[o])&&i>n&&(n=i)}else{for(;++o<r;)if(null!=(i=e(t[o],o,t))&&i>=i){n=i;break}for(;++o<r;)null!=(i=e(t[o],o,t))&&i>n&&(n=i)}return n},N=function(t,e){var n,i=0,o=t.length,r=-1,s=o;if(null==e)for(;++r<o;)isNaN(n=c(t[r]))?--s:i+=n;else for(;++r<o;)isNaN(n=c(e(t[r],r,t)))?--s:i+=n;if(s)return i/s},R=function(t,e){var n,i=[],r=t.length,s=-1;if(null==e)for(;++s<r;)isNaN(n=c(t[s]))||i.push(n);else for(;++s<r;)isNaN(n=c(e(t[s],s,t)))||i.push(n);return T(i.sort(o),.5)},D=function(t){for(var e,n,i,o=t.length,r=-1,s=0;++r<o;)s+=t[r].length;for(n=new Array(s);--o>=0;)for(i=t[o],e=i.length;--e>=0;)n[--s]=i[e];return n},I=function(t,e){var n,i,o=-1,r=t.length;if(null==e){for(;++o<r;)if(null!=(i=t[o])&&i>=i){n=i;break}for(;++o<r;)null!=(i=t[o])&&n>i&&(n=i)}else{for(;++o<r;)if(null!=(i=e(t[o],o,t))&&i>=i){n=i;break}for(;++o<r;)null!=(i=e(t[o],o,t))&&n>i&&(n=i)}return n},F=function(t){for(var e=0,n=t.length-1,i=t[0],o=new Array(n<0?0:n);e<n;)o[e]=[i,i=t[++e]];return o},k=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},$=function(t,e){if(n=t.length){var n,i,r=0,s=0,a=t[s];for(e||(e=o);++r<n;)(e(i=t[r],a)<0||0!==e(a,a))&&(a=i,s=r);return 0===e(a,a)?s:void 0}},L=function(t,e,n){for(var i,o,r=(null==n?t.length:n)-(e=null==e?0:+e);r;)o=Math.random()*r--|0,i=t[r+e],t[r+e]=t[o+e],t[o+e]=i;return t},U=function(t,e){var n,i=0,o=t.length,r=-1;if(null==e)for(;++r<o;)(n=+t[r])&&(i+=n);else for(;++r<o;)(n=+e(t[r],r,t))&&(i+=n);return i},B=function(t){if(!(r=t.length))return[];for(var e=-1,n=I(t,i),o=new Array(n);++e<n;)for(var r,s=-1,a=o[e]=new Array(r);++s<r;)a[s]=t[s][e];return o},P=function(){return B(arguments)};t.bisect=a,t.bisectRight=a,t.bisectLeft=u,t.ascending=o,t.bisector=r,t.descending=l,t.deviation=p,t.extent=d,t.histogram=A,t.thresholdFreedmanDiaconis=O,t.thresholdScott=_,t.thresholdSturges=w,t.max=M,t.mean=N,t.median=R,t.merge=D,t.min=I,t.pairs=F,t.permute=k,t.quantile=T,t.range=b,t.scan=$,t.shuffle=L,t.sum=U,t.ticks=E,t.tickStep=n,t.transpose=B,t.variance=h,t.zip=P,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(){}function n(t,n){var i=new e;if(t instanceof e)t.each(function(t,e){i.set(e,t)});else if(Array.isArray(t)){var o,r=-1,s=t.length;if(null==n)for(;++r<s;)i.set(r,t[r]);else for(;++r<s;)i.set(n(o=t[r],r,t),o)}else if(t)for(var a in t)i.set(a,t[a]);return i}function i(){return{}}function o(t,e,n){t[e]=n}function r(){return n()}function s(t,e,n){t.set(e,n)}function a(){}function u(t,e){var n=new a;if(t instanceof a)t.each(function(t){n.add(t)});else if(t){var i=-1,o=t.length;if(null==e)for(;++i<o;)n.add(t[i]);else for(;++i<o;)n.add(e(t[i],i,t))}return n}var l="$";e.prototype=n.prototype={constructor:e,has:function(t){return l+t in this},get:function(t){return this[l+t]},set:function(t,e){return this[l+t]=e,this},remove:function(t){var e=l+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===l&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===l&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===l&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===l&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===l&&++t;return t},empty:function(){for(var t in this)if(t[0]===l)return!1;return!0},each:function(t){for(var e in this)e[0]===l&&t(this[e],e.slice(1),this)}};var c=function(){function t(e,i,o,r){if(i>=c.length)return null!=u?u(e):null!=a?e.sort(a):e;for(var s,l,h,p=-1,d=e.length,f=c[i++],g=n(),m=o();++p<d;)(h=g.get(s=f(l=e[p])+""))?h.push(l):g.set(s,[l]);return g.each(function(e,n){r(m,n,t(e,i,o,r))}),m}function e(t,n){if(++n>c.length)return t;var i,o=h[n-1];return null!=u&&n>=c.length?i=t.entries():(i=[],t.each(function(t,o){i.push({key:o,values:e(t,n)})})),null!=o?i.sort(function(t,e){return o(t.key,e.key)}):i}var a,u,l,c=[],h=[];return l={object:function(e){return t(e,0,i,o)},map:function(e){return t(e,0,r,s)},entries:function(n){return e(t(n,0,r,s),0)},key:function(t){return c.push(t),l},sortKeys:function(t){return h[c.length-1]=t,l},sortValues:function(t){return a=t,l},rollup:function(t){return u=t,l}}},h=n.prototype;a.prototype=u.prototype={constructor:a,has:h.has,add:function(t){return t+="",this[l+t]=t,this},remove:h.remove,clear:h.clear,values:h.keys,size:h.size,empty:h.empty,each:h.each};var p=function(t){var e=[];for(var n in t)e.push(n);return e},d=function(t){var e=[];for(var n in t)e.push(t[n]);return e},f=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e};t.nest=c,t.set=u,t.map=n,t.keys=p,t.values=d,t.entries=f,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,i){i(e,n(157))}(this,function(t,e){"use strict";function n(t,e,n,i,o){var r=t*t,s=r*t;return((1-3*t+3*r-s)*e+(4-6*r+3*s)*n+(1+3*t+3*r-3*s)*i+s*o)/6}function i(t,e){return function(n){return t+n*e}}function o(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function r(t,e){
var n=e-t;return n?i(t,n>180||n<-180?n-360*Math.round(n/360):n):O(isNaN(t)?e:t)}function s(t){return 1===(t=+t)?a:function(e,n){return n-e?o(e,n,t):O(isNaN(e)?n:e)}}function a(t,e){var n=e-t;return n?i(t,n):O(isNaN(t)?e:t)}function u(t){return function(n){var i,o,r=n.length,s=new Array(r),a=new Array(r),u=new Array(r);for(i=0;i<r;++i)o=e.rgb(n[i]),s[i]=o.r||0,a[i]=o.g||0,u[i]=o.b||0;return s=t(s),a=t(a),u=t(u),o.opacity=1,function(t){return o.r=s(t),o.g=a(t),o.b=u(t),o+""}}}function l(t){return function(){return t}}function c(t){return function(e){return t(e)+""}}function h(t){return"none"===t?Q:(x||(x=document.createElement("DIV"),C=document.documentElement,E=document.defaultView),x.style.transform=t,t=E.getComputedStyle(C.appendChild(x),null).getPropertyValue("transform"),C.removeChild(x),t=t.slice(7,-1).split(","),V(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function p(t){return null==t?Q:(w||(w=document.createElementNS("http://www.w3.org/2000/svg","g")),w.setAttribute("transform",t),(t=w.transform.baseVal.consolidate())?(t=t.matrix,V(t.a,t.b,t.c,t.d,t.e,t.f)):Q)}function d(t,e,n,i){function o(t){return t.length?t.pop()+" ":""}function r(t,i,o,r,s,a){if(t!==o||i!==r){var u=s.push("translate(",null,e,null,n);a.push({i:u-4,x:I(t,o)},{i:u-2,x:I(i,r)})}else(o||r)&&s.push("translate("+o+e+r+n)}function s(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(o(n)+"rotate(",null,i)-2,x:I(t,e)})):e&&n.push(o(n)+"rotate("+e+i)}function a(t,e,n,r){t!==e?r.push({i:n.push(o(n)+"skewX(",null,i)-2,x:I(t,e)}):e&&n.push(o(n)+"skewX("+e+i)}function u(t,e,n,i,r,s){if(t!==n||e!==i){var a=r.push(o(r)+"scale(",null,",",null,")");s.push({i:a-4,x:I(t,n)},{i:a-2,x:I(e,i)})}else 1===n&&1===i||r.push(o(r)+"scale("+n+","+i+")")}return function(e,n){var i=[],o=[];return e=t(e),n=t(n),r(e.translateX,e.translateY,n.translateX,n.translateY,i,o),s(e.rotate,n.rotate,i,o),a(e.skewX,n.skewX,i,o),u(e.scaleX,e.scaleY,n.scaleX,n.scaleY,i,o),e=n=null,function(t){for(var e,n=-1,r=o.length;++n<r;)i[(e=o[n]).i]=e.x(t);return i.join("")}}}function f(t){return((t=Math.exp(t))+1/t)/2}function g(t){return((t=Math.exp(t))-1/t)/2}function m(t){return((t=Math.exp(2*t))-1)/(t+1)}function v(t){return function(n,i){var o=t((n=e.hsl(n)).h,(i=e.hsl(i)).h),r=a(n.s,i.s),s=a(n.l,i.l),u=a(n.opacity,i.opacity);return function(t){return n.h=o(t),n.s=r(t),n.l=s(t),n.opacity=u(t),n+""}}}function y(t,n){var i=a((t=e.lab(t)).l,(n=e.lab(n)).l),o=a(t.a,n.a),r=a(t.b,n.b),s=a(t.opacity,n.opacity);return function(e){return t.l=i(e),t.a=o(e),t.b=r(e),t.opacity=s(e),t+""}}function b(t){return function(n,i){var o=t((n=e.hcl(n)).h,(i=e.hcl(i)).h),r=a(n.c,i.c),s=a(n.l,i.l),u=a(n.opacity,i.opacity);return function(t){return n.h=o(t),n.c=r(t),n.l=s(t),n.opacity=u(t),n+""}}}function S(t){return function n(i){function o(n,o){var r=t((n=e.cubehelix(n)).h,(o=e.cubehelix(o)).h),s=a(n.s,o.s),u=a(n.l,o.l),l=a(n.opacity,o.opacity);return function(t){return n.h=r(t),n.s=s(t),n.l=u(Math.pow(t,i)),n.opacity=l(t),n+""}}return i=+i,o.gamma=n,o}(1)}var x,C,E,w,A=function(t){var e=t.length-1;return function(i){var o=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[o],s=t[o+1],a=o>0?t[o-1]:2*r-s,u=o<e-1?t[o+2]:2*s-r;return n((i-o/e)*e,a,r,s,u)}},T=function(t){var e=t.length;return function(i){var o=Math.floor(((i%=1)<0?++i:i)*e),r=t[(o+e-1)%e],s=t[o%e],a=t[(o+1)%e],u=t[(o+2)%e];return n((i-o/e)*e,r,s,a,u)}},O=function(t){return function(){return t}},_=function t(n){function i(t,n){var i=o((t=e.rgb(t)).r,(n=e.rgb(n)).r),r=o(t.g,n.g),s=o(t.b,n.b),a=o(t.opacity,n.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=a(e),t+""}}var o=s(n);return i.gamma=t,i}(1),M=u(A),N=u(T),R=function(t,e){var n,i=e?e.length:0,o=t?Math.min(i,t.length):0,r=new Array(i),s=new Array(i);for(n=0;n<o;++n)r[n]=U(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<o;++n)s[n]=r[n](t);return s}},D=function(t,e){var n=new Date;return t=+t,e-=t,function(i){return n.setTime(t+e*i),n}},I=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},F=function(t,e){var n,i={},o={};null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={});for(n in e)n in t?i[n]=U(t[n],e[n]):o[n]=e[n];return function(t){for(n in i)o[n]=i[n](t);return o}},k=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$=new RegExp(k.source,"g"),L=function(t,e){var n,i,o,r=k.lastIndex=$.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=k.exec(t))&&(i=$.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:I(n,i)})),r=$.lastIndex;return r<e.length&&(o=e.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?c(u[0].x):l(e):(e=u.length,function(t){for(var n,i=0;i<e;++i)a[(n=u[i]).i]=n.x(t);return a.join("")})},U=function(t,n){var i,o=typeof n;return null==n||"boolean"===o?O(n):("number"===o?I:"string"===o?(i=e.color(n))?(n=i,_):L:n instanceof e.color?_:n instanceof Date?D:Array.isArray(n)?R:isNaN(n)?F:I)(t,n)},B=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}},P=180/Math.PI,Q={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},V=function(t,e,n,i,o,r){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),t*i<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:o,translateY:r,rotate:Math.atan2(e,t)*P,skewX:Math.atan(u)*P,scaleX:s,scaleY:a}},H=d(h,"px, ","px)","deg)"),q=d(p,", ",")",")"),j=Math.SQRT2,z=2,W=4,Y=1e-12,G=function(t,e){var n,i,o=t[0],r=t[1],s=t[2],a=e[0],u=e[1],l=e[2],c=a-o,h=u-r,p=c*c+h*h;if(p<Y)i=Math.log(l/s)/j,n=function(t){return[o+t*c,r+t*h,s*Math.exp(j*t*i)]};else{var d=Math.sqrt(p),v=(l*l-s*s+W*p)/(2*s*z*d),y=(l*l-s*s-W*p)/(2*l*z*d),b=Math.log(Math.sqrt(v*v+1)-v),S=Math.log(Math.sqrt(y*y+1)-y);i=(S-b)/j,n=function(t){var e=t*i,n=f(b),a=s/(z*d)*(n*m(j*e+b)-g(b));return[o+a*c,r+a*h,s*n/f(j*e+b)]}}return n.duration=1e3*i,n},K=v(r),X=v(a),J=b(r),Z=b(a),tt=S(r),et=S(a),nt=function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n};t.interpolate=U,t.interpolateArray=R,t.interpolateBasis=A,t.interpolateBasisClosed=T,t.interpolateDate=D,t.interpolateNumber=I,t.interpolateObject=F,t.interpolateRound=B,t.interpolateString=L,t.interpolateTransformCss=H,t.interpolateTransformSvg=q,t.interpolateZoom=G,t.interpolateRgb=_,t.interpolateRgbBasis=M,t.interpolateRgbBasisClosed=N,t.interpolateHsl=K,t.interpolateHslLong=X,t.interpolateLab=y,t.interpolateHcl=J,t.interpolateHclLong=Z,t.interpolateCubehelix=tt,t.interpolateCubehelixLong=et,t.quantize=nt,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function n(){}function i(t){var e;return t=(t+"").trim().toLowerCase(),(e=I.exec(t))?(e=parseInt(e[1],16),new u(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=F.exec(t))?o(parseInt(e[1],16)):(e=k.exec(t))?new u(e[1],e[2],e[3],1):(e=$.exec(t))?new u(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=L.exec(t))?r(e[1],e[2],e[3],e[4]):(e=U.exec(t))?r(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=B.exec(t))?l(e[1],e[2]/100,e[3]/100,1):(e=P.exec(t))?l(e[1],e[2]/100,e[3]/100,e[4]):Q.hasOwnProperty(t)?o(Q[t]):"transparent"===t?new u(NaN,NaN,NaN,0):null}function o(t){return new u(t>>16&255,t>>8&255,255&t,1)}function r(t,e,n,i){return i<=0&&(t=e=n=NaN),new u(t,e,n,i)}function s(t){return t instanceof n||(t=i(t)),t?(t=t.rgb(),new u(t.r,t.g,t.b,t.opacity)):new u}function a(t,e,n,i){return 1===arguments.length?s(t):new u(t,e,n,null==i?1:i)}function u(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function l(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new p(t,e,n,i)}function c(t){if(t instanceof p)return new p(t.h,t.s,t.l,t.opacity);if(t instanceof n||(t=i(t)),!t)return new p;if(t instanceof p)return t;t=t.rgb();var e=t.r/255,o=t.g/255,r=t.b/255,s=Math.min(e,o,r),a=Math.max(e,o,r),u=NaN,l=a-s,c=(a+s)/2;return l?(u=e===a?(o-r)/l+6*(o<r):o===a?(r-e)/l+2:(e-o)/l+4,l/=c<.5?a+s:2-a-s,u*=60):l=c>0&&c<1?0:u,new p(u,l,c,t.opacity)}function h(t,e,n,i){return 1===arguments.length?c(t):new p(t,e,n,null==i?1:i)}function p(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function d(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function f(t){if(t instanceof m)return new m(t.l,t.a,t.b,t.opacity);if(t instanceof E){var e=t.h*V;return new m(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof u||(t=s(t));var n=S(t.r),i=S(t.g),o=S(t.b),r=v((.4124564*n+.3575761*i+.1804375*o)/j),a=v((.2126729*n+.7151522*i+.072175*o)/z),l=v((.0193339*n+.119192*i+.9503041*o)/W);return new m(116*a-16,500*(r-a),200*(a-l),t.opacity)}function g(t,e,n,i){return 1===arguments.length?f(t):new m(t,e,n,null==i?1:i)}function m(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function v(t){return t>X?Math.pow(t,1/3):t/K+Y}function y(t){return t>G?t*t*t:K*(t-Y)}function b(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function S(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function x(t){if(t instanceof E)return new E(t.h,t.c,t.l,t.opacity);t instanceof m||(t=f(t));var e=Math.atan2(t.b,t.a)*H;return new E(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function C(t,e,n,i){return 1===arguments.length?x(t):new E(t,e,n,null==i?1:i)}function E(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function w(t){if(t instanceof T)return new T(t.h,t.s,t.l,t.opacity);t instanceof u||(t=s(t));var e=t.r/255,n=t.g/255,i=t.b/255,o=(rt*i+it*e-ot*n)/(rt+it-ot),r=i-o,a=(nt*(n-o)-tt*r)/et,l=Math.sqrt(a*a+r*r)/(nt*o*(1-o)),c=l?Math.atan2(a,r)*H-120:NaN;return new T(c<0?c+360:c,l,o,t.opacity)}function A(t,e,n,i){return 1===arguments.length?w(t):new T(t,e,n,null==i?1:i)}function T(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}var O=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},_=.7,M=1/_,N="\\s*([+-]?\\d+)\\s*",R="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",I=/^#([0-9a-f]{3})$/,F=/^#([0-9a-f]{6})$/,k=new RegExp("^rgb\\("+[N,N,N]+"\\)$"),$=new RegExp("^rgb\\("+[D,D,D]+"\\)$"),L=new RegExp("^rgba\\("+[N,N,N,R]+"\\)$"),U=new RegExp("^rgba\\("+[D,D,D,R]+"\\)$"),B=new RegExp("^hsl\\("+[R,D,D]+"\\)$"),P=new RegExp("^hsla\\("+[R,D,D,R]+"\\)$"),Q={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};O(n,i,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),O(u,a,e(n,{brighter:function(t){return t=null==t?M:Math.pow(M,t),new u(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?_:Math.pow(_,t),new u(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),O(p,h,e(n,{brighter:function(t){return t=null==t?M:Math.pow(M,t),new p(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?_:Math.pow(_,t),new p(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new u(d(t>=240?t-240:t+120,o,i),d(t,o,i),d(t<120?t+240:t-120,o,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var V=Math.PI/180,H=180/Math.PI,q=18,j=.95047,z=1,W=1.08883,Y=4/29,G=6/29,K=3*G*G,X=G*G*G;O(m,g,e(n,{brighter:function(t){return new m(this.l+q*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new m(this.l-q*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=z*y(t),e=j*y(e),n=W*y(n),new u(b(3.2404542*e-1.5371385*t-.4985314*n),b(-.969266*e+1.8760108*t+.041556*n),b(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),O(E,C,e(n,{brighter:function(t){return new E(this.h,this.c,this.l+q*(null==t?1:t),this.opacity)},darker:function(t){return new E(this.h,this.c,this.l-q*(null==t?1:t),this.opacity)},rgb:function(){return f(this).rgb()}}));var J=-.14861,Z=1.78277,tt=-.29227,et=-.90649,nt=1.97294,it=nt*et,ot=nt*Z,rt=Z*tt-et*J;O(T,A,e(n,{brighter:function(t){return t=null==t?M:Math.pow(M,t),new T(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?_:Math.pow(_,t),new T(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*V,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),o=Math.sin(t);return new u(255*(e+n*(J*i+Z*o)),255*(e+n*(tt*i+et*o)),255*(e+n*(nt*i)),this.opacity)}})),t.color=i,t.rgb=a,t.hsl=h,t.lab=g,t.hcl=C,t.cubehelix=A,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function n(t){return t=e(Math.abs(t)),t?t[1]:NaN}function i(t,e){return function(n,i){for(var o=n.length,r=[],s=0,a=t[0],u=0;o>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),r.push(n.substring(o-=a,o+a)),!((u+=a+1)>i));)a=t[s=(s+1)%t.length];return r.reverse().join(e)}}function o(t,e){t=t.toPrecision(e);t:for(var n,i=t.length,o=1,r=-1;o<i;++o)switch(t[o]){case".":r=n=o;break;case"0":0===r&&(r=o),n=o;break;case"e":break t;default:r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(n+1):t}function r(t,n){var i=e(t,n);if(!i)return t+"";var o=i[0],r=i[1],s=r-(g=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=o.length;return s===a?o:s>a?o+new Array(s-a+1).join("0"):s>0?o.slice(0,s)+"."+o.slice(s):"0."+new Array(1-s).join("0")+e(t,Math.max(0,n+s-1))[0]}function s(t,n){var i=e(t,n);if(!i)return t+"";var o=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+o:o.length>r+1?o.slice(0,r+1)+"."+o.slice(r+1):o+new Array(r-o.length+2).join("0")}function a(t){return new u(t)}function u(t){if(!(e=v.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",i=e[2]||">",o=e[3]||"-",r=e[4]||"",s=!!e[5],a=e[6]&&+e[6],u=!!e[7],l=e[8]&&+e[8].slice(1),c=e[9]||"";"n"===c?(u=!0,c="g"):m[c]||(c=""),(s||"0"===n&&"="===i)&&(s=!0,n="0",i="="),this.fill=n,this.align=i,this.sign=o,this.symbol=r,this.zero=s,this.width=a,this.comma=u,this.precision=l,this.type=c}function l(t){return t}function c(t){function e(t){function e(t){var e,s,a,l=v,m=y;if("c"===f)m=S(t)+m,t="";else{t=+t;var C=(t<0||1/t<0)&&(t*=-1,!0);if(t=S(t,d),C)for(e=-1,s=t.length,C=!1;++e<s;)if(a=t.charCodeAt(e),48<a&&a<58||"x"===f&&96<a&&a<103||"X"===f&&64<a&&a<71){C=!0;break}if(l=(C?"("===o?o:"-":"-"===o||"("===o?"":o)+l,m=m+("s"===f?b[8+g/3]:"")+(C&&"("===o?")":""),x)for(e=-1,s=t.length;++e<s;)if(a=t.charCodeAt(e),48>a||a>57){m=(46===a?u+t.slice(e+1):t.slice(e))+m,t=t.slice(0,e);break}}p&&!c&&(t=r(t,1/0));var E=l.length+t.length+m.length,w=E<h?new Array(h-E+1).join(n):"";switch(p&&c&&(t=r(w+t,w.length?h-m.length:1/0),w=""),i){case"<":return l+t+m+w;case"=":return l+w+t+m;case"^":return w.slice(0,E=w.length>>1)+l+t+m+w.slice(E)}return w+l+t+m}t=a(t);var n=t.fill,i=t.align,o=t.sign,l=t.symbol,c=t.zero,h=t.width,p=t.comma,d=t.precision,f=t.type,v="$"===l?s[0]:"#"===l&&/[boxX]/.test(f)?"0"+f.toLowerCase():"",y="$"===l?s[1]:/[%p]/.test(f)?"%":"",S=m[f],x=!f||/[defgprs%]/.test(f);return d=null==d?f?6:12:/[gprs]/.test(f)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),e.toString=function(){return t+""},e}function o(t,i){var o=e((t=a(t),t.type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(n(i)/3))),s=Math.pow(10,-r),u=b[8+r/3];return function(t){return o(s*t)+u}}var r=t.grouping&&t.thousands?i(t.grouping,t.thousands):l,s=t.currency,u=t.decimal;return{format:e,formatPrefix:o}}function h(e){return y=c(e),t.format=y.format,t.formatPrefix=y.formatPrefix,y}function p(t){return Math.max(0,-n(Math.abs(t)))}function d(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(e)/3)))-n(Math.abs(t)))}function f(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,n(e)-n(t))+1}var g,m={"":o,"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return s(100*t,e)},r:s,s:r,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},v=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;u.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var y,b=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];h({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),t.formatDefaultLocale=h,t.formatLocale=c,t.formatSpecifier=a,t.precisionFixed=p,t.precisionPrefix=d,t.precisionRound=f,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t,n,i,s){function a(e){return t(e=new Date(+e)),e}return a.floor=a,a.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},a.round=function(t){var e=a(t),n=a.ceil(t);return t-e<n-t?e:n},a.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},a.range=function(e,i,o){var r=[];if(e=a.ceil(e),o=null==o?1:Math.floor(o),!(e<i&&o>0))return r;do r.push(new Date(+e));while(n(e,o),t(e),e<i);return r},a.filter=function(i){return e(function(e){if(e>=e)for(;t(e),!i(e);)e.setTime(e-1)},function(t,e){if(t>=t)for(;--e>=0;)for(;n(t,1),!i(t););})},i&&(a.count=function(e,n){return o.setTime(+e),r.setTime(+n),t(o),t(r),Math.floor(i(o,r))},a.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?a.filter(s?function(e){return s(e)%t===0}:function(e){return a.count(0,e)%t===0}):a:null}),a}function n(t){return e(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*l)/p})}function i(t){return e(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/p})}var o=new Date,r=new Date,s=e(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});s.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?e(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):s:null};var a=s.range,u=1e3,l=6e4,c=36e5,h=864e5,p=6048e5,d=e(function(t){t.setTime(Math.floor(t/u)*u)},function(t,e){t.setTime(+t+e*u)},function(t,e){return(e-t)/u},function(t){return t.getUTCSeconds()}),f=d.range,g=e(function(t){t.setTime(Math.floor(t/l)*l)},function(t,e){t.setTime(+t+e*l)},function(t,e){return(e-t)/l},function(t){return t.getMinutes()}),m=g.range,v=e(function(t){var e=t.getTimezoneOffset()*l%c;e<0&&(e+=c),t.setTime(Math.floor((+t-e)/c)*c+e)},function(t,e){t.setTime(+t+e*c)},function(t,e){return(e-t)/c},function(t){return t.getHours()}),y=v.range,b=e(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*l)/h},function(t){return t.getDate()-1}),S=b.range,x=n(0),C=n(1),E=n(2),w=n(3),A=n(4),T=n(5),O=n(6),_=x.range,M=C.range,N=E.range,R=w.range,D=A.range,I=T.range,F=O.range,k=e(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),$=k.range,L=e(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});L.every=function(t){return isFinite(t=Math.floor(t))&&t>0?e(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var U=L.range,B=e(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*l)},function(t,e){return(e-t)/l},function(t){return t.getUTCMinutes()}),P=B.range,Q=e(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*c)},function(t,e){return(e-t)/c},function(t){return t.getUTCHours()}),V=Q.range,H=e(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/h},function(t){return t.getUTCDate()-1}),q=H.range,j=i(0),z=i(1),W=i(2),Y=i(3),G=i(4),K=i(5),X=i(6),J=j.range,Z=z.range,tt=W.range,et=Y.range,nt=G.range,it=K.range,ot=X.range,rt=e(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),st=rt.range,at=e(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});at.every=function(t){return isFinite(t=Math.floor(t))&&t>0?e(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var ut=at.range;t.timeInterval=e,t.timeMillisecond=s,t.timeMilliseconds=a,t.utcMillisecond=s,t.utcMilliseconds=a,t.timeSecond=d,t.timeSeconds=f,t.utcSecond=d,t.utcSeconds=f,t.timeMinute=g,t.timeMinutes=m,t.timeHour=v,t.timeHours=y,t.timeDay=b,t.timeDays=S,t.timeWeek=x,t.timeWeeks=_,t.timeSunday=x,t.timeSundays=_,t.timeMonday=C,t.timeMondays=M,t.timeTuesday=E,t.timeTuesdays=N,t.timeWednesday=w,t.timeWednesdays=R,t.timeThursday=A,t.timeThursdays=D,t.timeFriday=T,t.timeFridays=I,t.timeSaturday=O,t.timeSaturdays=F,t.timeMonth=k,t.timeMonths=$,t.timeYear=L,t.timeYears=U,t.utcMinute=B,t.utcMinutes=P,t.utcHour=Q,t.utcHours=V,t.utcDay=H,t.utcDays=q,t.utcWeek=j,t.utcWeeks=J,t.utcSunday=j,t.utcSundays=J,t.utcMonday=z,t.utcMondays=Z,t.utcTuesday=W,t.utcTuesdays=tt,t.utcWednesday=Y,t.utcWednesdays=et,t.utcThursday=G,t.utcThursdays=nt,t.utcFriday=K,t.utcFridays=it,t.utcSaturday=X,t.utcSaturdays=ot,t.utcMonth=rt,t.utcMonths=st,t.utcYear=at,t.utcYears=ut,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,i){i(e,n(159))}(this,function(t,e){"use strict";function n(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function i(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function o(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function r(t){function e(t,e){return function(n){var i,o,r,s=[],a=-1,u=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++a<l;)37===t.charCodeAt(a)&&(s.push(t.slice(u,a)),null!=(o=it[i=t.charAt(++a)])?i=t.charAt(++a):o="e"===i?" ":"0",(r=e[i])&&(i=r(n,o)),s.push(i),u=a+1);return s.push(t.slice(u,a)),s.join("")}}function r(t,e){return function(n){var r=o(1900),a=s(r,t,n+="",0);if(a!=n.length)return null;if("p"in r&&(r.H=r.H%12+12*r.p),"W"in r||"U"in r){"w"in r||(r.w="W"in r?1:0);var u="Z"in r?i(o(r.y)).getUTCDay():e(o(r.y)).getDay();r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(u+5)%7:r.w+7*r.U-(u+6)%7}return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,i(r)):e(r)}}function s(t,e,n,i){for(var o,r,s=0,a=e.length,u=n.length;s<a;){if(i>=u)return-1;if(o=e.charCodeAt(s++),37===o){if(o=e.charAt(s++),r=Lt[o in it?e.charAt(s++):o],!r||(i=r(t,n,i))<0)return-1}else if(o!=n.charCodeAt(i++))return-1}return i}function a(t,e,n){var i=At.exec(e.slice(n));return i?(t.p=Tt[i[0].toLowerCase()],n+i[0].length):-1}function Z(t,e,n){var i=Mt.exec(e.slice(n));return i?(t.w=Nt[i[0].toLowerCase()],n+i[0].length):-1}function tt(t,e,n){var i=Ot.exec(e.slice(n));return i?(t.w=_t[i[0].toLowerCase()],n+i[0].length):-1}function et(t,e,n){var i=It.exec(e.slice(n));return i?(t.m=Ft[i[0].toLowerCase()],n+i[0].length):-1}function nt(t,e,n){var i=Rt.exec(e.slice(n));return i?(t.m=Dt[i[0].toLowerCase()],n+i[0].length):-1}function ot(t,e,n){return s(t,vt,e,n)}function rt(t,e,n){return s(t,yt,e,n)}function st(t,e,n){return s(t,bt,e,n)}function at(t){return Ct[t.getDay()]}function ut(t){return xt[t.getDay()]}function lt(t){return wt[t.getMonth()]}function ct(t){return Et[t.getMonth()]}function ht(t){return St[+(t.getHours()>=12)]}function pt(t){return Ct[t.getUTCDay()]}function dt(t){return xt[t.getUTCDay()]}function ft(t){return wt[t.getUTCMonth()]}function gt(t){return Et[t.getUTCMonth()]}function mt(t){return St[+(t.getUTCHours()>=12)]}var vt=t.dateTime,yt=t.date,bt=t.time,St=t.periods,xt=t.days,Ct=t.shortDays,Et=t.months,wt=t.shortMonths,At=u(St),Tt=l(St),Ot=u(xt),_t=l(xt),Mt=u(Ct),Nt=l(Ct),Rt=u(Et),Dt=l(Et),It=u(wt),Ft=l(wt),kt={a:at,A:ut,b:lt,B:ct,c:null,d:w,e:w,H:A,I:T,j:O,L:_,m:M,M:N,p:ht,S:R,U:D,w:I,W:F,x:null,X:null,y:k,Y:$,Z:L,"%":J},$t={a:pt,A:dt,b:ft,B:gt,c:null,d:U,e:U,H:B,I:P,j:Q,L:V,m:H,M:q,p:mt,S:j,U:z,w:W,W:Y,x:null,X:null,y:G,Y:K,Z:X,"%":J},Lt={a:Z,A:tt,b:et,B:nt,c:ot,d:v,e:v,H:b,I:b,j:y,L:C,m:m,M:S,p:a,S:x,U:h,w:c,W:p,x:rt,X:st,y:f,Y:d,Z:g,"%":E};return kt.x=e(yt,kt),kt.X=e(bt,kt),kt.c=e(vt,kt),$t.x=e(yt,$t),$t.X=e(bt,$t),$t.c=e(vt,$t),{format:function(t){var n=e(t+="",kt);return n.toString=function(){return t},n},parse:function(t){var e=r(t+="",n);return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",$t);return n.toString=function(){return t},n},utcParse:function(t){var e=r(t,i);return e.toString=function(){return t},e}}}function s(t,e,n){var i=t<0?"-":"",o=(i?-t:t)+"",r=o.length;return i+(r<n?new Array(n-r+1).join(e)+o:o)}function a(t){return t.replace(st,"\\$&")}function u(t){return new RegExp("^(?:"+t.map(a).join("|")+")","i")}function l(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function c(t,e,n){var i=ot.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function h(t,e,n){var i=ot.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function p(t,e,n){var i=ot.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function d(t,e,n){var i=ot.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function f(t,e,n){var i=ot.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function g(t,e,n){var i=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function m(t,e,n){var i=ot.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function v(t,e,n){var i=ot.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function y(t,e,n){var i=ot.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function b(t,e,n){var i=ot.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function S(t,e,n){var i=ot.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function x(t,e,n){var i=ot.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function C(t,e,n){var i=ot.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function E(t,e,n){var i=rt.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function w(t,e){return s(t.getDate(),e,2)}function A(t,e){return s(t.getHours(),e,2)}function T(t,e){return s(t.getHours()%12||12,e,2)}function O(t,n){return s(1+e.timeDay.count(e.timeYear(t),t),n,3)}function _(t,e){return s(t.getMilliseconds(),e,3)}function M(t,e){return s(t.getMonth()+1,e,2)}function N(t,e){return s(t.getMinutes(),e,2)}function R(t,e){return s(t.getSeconds(),e,2)}function D(t,n){return s(e.timeSunday.count(e.timeYear(t),t),n,2)}function I(t){return t.getDay()}function F(t,n){return s(e.timeMonday.count(e.timeYear(t),t),n,2)}function k(t,e){return s(t.getFullYear()%100,e,2)}function $(t,e){return s(t.getFullYear()%1e4,e,4)}function L(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+s(e/60|0,"0",2)+s(e%60,"0",2)}function U(t,e){return s(t.getUTCDate(),e,2)}function B(t,e){return s(t.getUTCHours(),e,2)}function P(t,e){return s(t.getUTCHours()%12||12,e,2)}function Q(t,n){return s(1+e.utcDay.count(e.utcYear(t),t),n,3)}function V(t,e){return s(t.getUTCMilliseconds(),e,3)}function H(t,e){return s(t.getUTCMonth()+1,e,2)}function q(t,e){return s(t.getUTCMinutes(),e,2)}function j(t,e){return s(t.getUTCSeconds(),e,2)}function z(t,n){return s(e.utcSunday.count(e.utcYear(t),t),n,2)}function W(t){return t.getUTCDay()}function Y(t,n){return s(e.utcMonday.count(e.utcYear(t),t),n,2)}function G(t,e){return s(t.getUTCFullYear()%100,e,2)}function K(t,e){return s(t.getUTCFullYear()%1e4,e,4)}function X(){return"+0000"}function J(){return"%"}function Z(e){return nt=r(e),t.timeFormat=nt.format,t.timeParse=nt.parse,t.utcFormat=nt.utcFormat,t.utcParse=nt.utcParse,nt}function tt(t){return t.toISOString();
}function et(t){var e=new Date(t);return isNaN(e)?null:e}var nt,it={"-":"",_:" ",0:"0"},ot=/^\s*\d+/,rt=/^%/,st=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;Z({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var at="%Y-%m-%dT%H:%M:%S.%LZ",ut=Date.prototype.toISOString?tt:t.utcFormat(at),lt=+new Date("2000-01-01T00:00:00.000Z")?et:t.utcParse(at);t.timeFormatDefaultLocale=Z,t.timeFormatLocale=r,t.isoFormat=ut,t.isoParse=lt,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t){return function(e,n){return El(t(e),n)}}function n(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/o;return r>=Bl?o*=10:r>=Pl?o*=5:r>=Ql&&(o*=2),e<t?-o:o}function i(t){return t.length}function o(){}function r(t,e){var n=new o;if(t instanceof o)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,r=-1,s=t.length;if(null==e)for(;++r<s;)n.set(r,t[r]);else for(;++r<s;)n.set(e(i=t[r],r,t),i)}else if(t)for(var a in t)n.set(a,t[a]);return n}function s(){return{}}function a(t,e,n){t[e]=n}function u(){return r()}function l(t,e,n){t.set(e,n)}function c(){}function h(t,e){var n=new c;if(t instanceof c)t.each(function(t){n.add(t)});else if(t){var i=-1,o=t.length;if(null==e)for(;++i<o;)n.add(t[i]);else for(;++i<o;)n.add(e(t[i],i,t))}return n}function p(t){return+t}function d(t){return t*t}function f(t){return t*(2-t)}function g(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function m(t){return t*t*t}function v(t){return--t*t*t+1}function y(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function b(t){return 1-Math.cos(t*Ec)}function S(t){return Math.sin(t*Ec)}function x(t){return(1-Math.cos(Cc*t))/2}function C(t){return Math.pow(2,10*t-10)}function E(t){return 1-Math.pow(2,-10*t)}function w(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function A(t){return 1-Math.sqrt(1-t*t)}function T(t){return Math.sqrt(1- --t*t)}function O(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function _(t){return 1-M(1-t)}function M(t){return(t=+t)<wc?Ic*t*t:t<Tc?Ic*(t-=Ac)*t+Oc:t<Mc?Ic*(t-=_c)*t+Nc:Ic*(t-=Rc)*t+Dc}function N(t){return((t*=2)<=1?1-M(1-t):M(t-1)+1)/2}function R(t,e){return t[0]-e[0]||t[1]-e[1]}function D(t){for(var e=t.length,n=[0,1],i=2,o=2;o<e;++o){for(;i>1&&zc(t[n[i-2]],t[n[i-1]],t[o])<=0;)--i;n[i++]=o}return n.slice(0,i)}function I(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function F(){return new I}function k(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var o,r,s,a,u,l,c,h,p,d=t._root,f={data:i},g=t._x0,m=t._y0,v=t._x1,y=t._y1;if(!d)return t._root=f,t;for(;d.length;)if((l=e>=(r=(g+v)/2))?g=r:v=r,(c=n>=(s=(m+y)/2))?m=s:y=s,o=d,!(d=d[h=c<<1|l]))return o[h]=f,t;if(a=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===a&&n===u)return f.next=d,o?o[h]=f:t._root=f,t;do o=o?o[h]=new Array(4):t._root=new Array(4),(l=e>=(r=(g+v)/2))?g=r:v=r,(c=n>=(s=(m+y)/2))?m=s:y=s;while((h=c<<1|l)===(p=(u>=s)<<1|a>=r));return o[p]=d,o[h]=f,t}function $(t){var e,n,i,o,r=t.length,s=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-(1/0),h=-(1/0);for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(s[n]=i,a[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>h&&(h=o));for(c<u&&(u=this._x0,c=this._x1),h<l&&(l=this._y0,h=this._y1),this.cover(u,l).cover(c,h),n=0;n<r;++n)k(this,s[n],a[n],t[n]);return this}function L(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function U(t){return t[0]}function B(t){return t[1]}function P(t,e,n){var i=new Q(null==e?U:e,null==n?B:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Q(t,e,n,i,o,r){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=o,this._y1=r,this._root=void 0}function V(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}function H(t){if(!(t>=1))throw new Error;this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function q(t){if(!t._start)try{j(t)}catch(e){if(t._tasks[t._ended+t._active-1])W(t,e);else if(!t._data)throw e}}function j(t){for(;t._start=t._waiting&&t._active<t._size;){var e=t._ended+t._active,n=t._tasks[e],i=n.length-1,o=n[i];n[i]=z(t,e),--t._waiting,++t._active,n=o.apply(null,n),t._tasks[e]&&(t._tasks[e]=n||gh)}}function z(t,e){return function(n,i){t._tasks[e]&&(--t._active,++t._ended,t._tasks[e]=null,null==t._error&&(null!=n?W(t,n):(t._data[e]=i,t._waiting?q(t):Y(t))))}}function W(t,e){var n,i=t._tasks.length;for(t._error=e,t._data=void 0,t._waiting=NaN;--i>=0;)if((n=t._tasks[i])&&(t._tasks[i]=null,n.abort))try{n.abort()}catch(t){}t._active=NaN,Y(t)}function Y(t){if(!t._active&&t._call){var e=t._data;t._data=void 0,t._call(t._error,e)}}function G(t){return new H(arguments.length?+t:1/0)}function K(t){return t.innerRadius}function X(t){return t.outerRadius}function J(t){return t.startAngle}function Z(t){return t.endAngle}function tt(t){return t&&t.padAngle}function et(t){return t>=1?bh:t<=-1?-bh:Math.asin(t)}function nt(t,e,n,i,o,r,s,a){var u=n-t,l=i-e,c=s-o,h=a-r,p=(c*(e-r)-h*(t-o))/(h*u-c*l);return[t+p*u,e+p*l]}function it(t,e,n,i,o,r,s){var a=t-n,u=e-i,l=(s?r:-r)/Math.sqrt(a*a+u*u),c=l*u,h=-l*a,p=t+c,d=e+h,f=n+c,g=i+h,m=(p+f)/2,v=(d+g)/2,y=f-p,b=g-d,S=y*y+b*b,x=o-r,C=p*g-f*d,E=(b<0?-1:1)*Math.sqrt(Math.max(0,x*x*S-C*C)),w=(C*b-y*E)/S,A=(-C*y-b*E)/S,T=(C*b+y*E)/S,O=(-C*y+b*E)/S,_=w-m,M=A-v,N=T-m,R=O-v;return _*_+M*M>N*N+R*R&&(w=T,A=O),{cx:w,cy:A,x01:-c,y01:-h,x11:w*(o/x-1),y11:A*(o/x-1)}}function ot(t){this._context=t}function rt(t){return t[0]}function st(t){return t[1]}function at(t){this._curve=t}function ut(t){function e(e){return new at(t(e))}return e._curve=t,e}function lt(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(ut(t)):e()._curve},t}function ct(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function ht(t){this._context=t}function pt(t){this._context=t}function dt(t){this._context=t}function ft(t,e){this._basis=new ht(t),this._beta=e}function gt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function mt(t,e){this._context=t,this._k=(1-e)/6}function vt(t,e){this._context=t,this._k=(1-e)/6}function yt(t,e){this._context=t,this._k=(1-e)/6}function bt(t,e,n){var i=t._x1,o=t._y1,r=t._x2,s=t._y2;if(t._l01_a>vh){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,o=(o*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>vh){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);r=(r*l+t._x1*t._l23_2a-e*t._l12_2a)/c,s=(s*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(i,o,r,s,t._x2,t._y2)}function St(t,e){this._context=t,this._alpha=e}function xt(t,e){this._context=t,this._alpha=e}function Ct(t,e){this._context=t,this._alpha=e}function Et(t){this._context=t}function wt(t){return t<0?-1:1}function At(t,e,n){var i=t._x1-t._x0,o=e-t._x1,r=(t._y1-t._y0)/(i||o<0&&-0),s=(n-t._y1)/(o||i<0&&-0),a=(r*o+s*i)/(i+o);return(wt(r)+wt(s))*Math.min(Math.abs(r),Math.abs(s),.5*Math.abs(a))||0}function Tt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Ot(t,e,n){var i=t._x0,o=t._y0,r=t._x1,s=t._y1,a=(r-i)/3;t._context.bezierCurveTo(i+a,o+a*e,r-a,s-a*n,r,s)}function _t(t){this._context=t}function Mt(t){this._context=new Nt(t)}function Nt(t){this._context=t}function Rt(t){return new _t(t)}function Dt(t){return new Mt(t)}function It(t){this._context=t}function Ft(t){var e,n,i=t.length-1,o=new Array(i),r=new Array(i),s=new Array(i);for(o[0]=0,r[0]=2,s[0]=t[0]+2*t[1],e=1;e<i-1;++e)o[e]=1,r[e]=4,s[e]=4*t[e]+2*t[e+1];for(o[i-1]=2,r[i-1]=7,s[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=o[e]/r[e-1],r[e]-=n,s[e]-=n*s[e-1];for(o[i-1]=s[i-1]/r[i-1],e=i-2;e>=0;--e)o[e]=(s[e]-o[e+1])/r[e];for(r[i-1]=(t[i]+o[i-1])/2,e=0;e<i-1;++e)r[e]=2*t[e+1]-o[e+1];return[o,r]}function kt(t,e){this._context=t,this._t=e}function $t(t){return new kt(t,0)}function Lt(t){return new kt(t,1)}function Ut(t,e){return t[e]}function Bt(t){for(var e,n=0,i=-1,o=t.length;++i<o;)(e=+t[i][1])&&(n+=e);return n}function Pt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Qt(){}function Vt(t){var e;return t=(t+"").trim().toLowerCase(),(e=_p.exec(t))?(e=parseInt(e[1],16),new Wt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=Mp.exec(t))?Ht(parseInt(e[1],16)):(e=Np.exec(t))?new Wt(e[1],e[2],e[3],1):(e=Rp.exec(t))?new Wt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Dp.exec(t))?qt(e[1],e[2],e[3],e[4]):(e=Ip.exec(t))?qt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Fp.exec(t))?Yt(e[1],e[2]/100,e[3]/100,1):(e=kp.exec(t))?Yt(e[1],e[2]/100,e[3]/100,e[4]):$p.hasOwnProperty(t)?Ht($p[t]):"transparent"===t?new Wt(NaN,NaN,NaN,0):null}function Ht(t){return new Wt(t>>16&255,t>>8&255,255&t,1)}function qt(t,e,n,i){return i<=0&&(t=e=n=NaN),new Wt(t,e,n,i)}function jt(t){return t instanceof Qt||(t=Vt(t)),t?(t=t.rgb(),new Wt(t.r,t.g,t.b,t.opacity)):new Wt}function zt(t,e,n,i){return 1===arguments.length?jt(t):new Wt(t,e,n,null==i?1:i)}function Wt(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Yt(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Xt(t,e,n,i)}function Gt(t){if(t instanceof Xt)return new Xt(t.h,t.s,t.l,t.opacity);if(t instanceof Qt||(t=Vt(t)),!t)return new Xt;if(t instanceof Xt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,o=Math.min(e,n,i),r=Math.max(e,n,i),s=NaN,a=r-o,u=(r+o)/2;return a?(s=e===r?(n-i)/a+6*(n<i):n===r?(i-e)/a+2:(e-n)/a+4,a/=u<.5?r+o:2-r-o,s*=60):a=u>0&&u<1?0:s,new Xt(s,a,u,t.opacity)}function Kt(t,e,n,i){return 1===arguments.length?Gt(t):new Xt(t,e,n,null==i?1:i)}function Xt(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Jt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Zt(t){if(t instanceof ee)return new ee(t.l,t.a,t.b,t.opacity);if(t instanceof ue){var e=t.h*Lp;return new ee(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Wt||(t=jt(t));var n=re(t.r),i=re(t.g),o=re(t.b),r=ne((.4124564*n+.3575761*i+.1804375*o)/Pp),s=ne((.2126729*n+.7151522*i+.072175*o)/Qp),a=ne((.0193339*n+.119192*i+.9503041*o)/Vp);return new ee(116*s-16,500*(r-s),200*(s-a),t.opacity)}function te(t,e,n,i){return 1===arguments.length?Zt(t):new ee(t,e,n,null==i?1:i)}function ee(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function ne(t){return t>zp?Math.pow(t,1/3):t/jp+Hp}function ie(t){return t>qp?t*t*t:jp*(t-Hp)}function oe(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function re(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function se(t){if(t instanceof ue)return new ue(t.h,t.c,t.l,t.opacity);t instanceof ee||(t=Zt(t));var e=Math.atan2(t.b,t.a)*Up;return new ue(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function ae(t,e,n,i){return 1===arguments.length?se(t):new ue(t,e,n,null==i?1:i)}function ue(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function le(t){if(t instanceof he)return new he(t.h,t.s,t.l,t.opacity);t instanceof Wt||(t=jt(t));var e=t.r/255,n=t.g/255,i=t.b/255,o=(td*i+Jp*e-Zp*n)/(td+Jp-Zp),r=i-o,s=(Xp*(n-o)-Gp*r)/Kp,a=Math.sqrt(s*s+r*r)/(Xp*o*(1-o)),u=a?Math.atan2(s,r)*Up-120:NaN;return new he(u<0?u+360:u,a,o,t.opacity)}function ce(t,e,n,i){return 1===arguments.length?le(t):new he(t,e,n,null==i?1:i)}function he(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function pe(t,e,n,i,o){var r=t*t,s=r*t;return((1-3*t+3*r-s)*e+(4-6*r+3*s)*n+(1+3*t+3*r-3*s)*i+s*o)/6}function de(t,e){return function(n){return t+n*e}}function fe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function ge(t,e){var n=e-t;return n?de(t,n>180||n<-180?n-360*Math.round(n/360):n):ad(isNaN(t)?e:t)}function me(t){return 1===(t=+t)?ve:function(e,n){return n-e?fe(e,n,t):ad(isNaN(e)?n:e)}}function ve(t,e){var n=e-t;return n?de(t,n):ad(isNaN(t)?e:t)}function ye(t){return function(e){var n,i,o=e.length,r=new Array(o),s=new Array(o),a=new Array(o);for(n=0;n<o;++n)i=zt(e[n]),r[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return r=t(r),s=t(s),a=t(a),i.opacity=1,function(t){return i.r=r(t),i.g=s(t),i.b=a(t),i+""}}}function be(t){return function(){return t}}function Se(t){return function(e){return t(e)+""}}function xe(t){return"none"===t?xd:(ed||(ed=document.createElement("DIV"),nd=document.documentElement,id=document.defaultView),ed.style.transform=t,t=id.getComputedStyle(nd.appendChild(ed),null).getPropertyValue("transform"),nd.removeChild(ed),t=t.slice(7,-1).split(","),Cd(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function Ce(t){return null==t?xd:(od||(od=document.createElementNS("http://www.w3.org/2000/svg","g")),od.setAttribute("transform",t),(t=od.transform.baseVal.consolidate())?(t=t.matrix,Cd(t.a,t.b,t.c,t.d,t.e,t.f)):xd)}function Ee(t,e,n,i){function o(t){return t.length?t.pop()+" ":""}function r(t,i,o,r,s,a){if(t!==o||i!==r){var u=s.push("translate(",null,e,null,n);a.push({i:u-4,x:dd(t,o)},{i:u-2,x:dd(i,r)})}else(o||r)&&s.push("translate("+o+e+r+n)}function s(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(o(n)+"rotate(",null,i)-2,x:dd(t,e)})):e&&n.push(o(n)+"rotate("+e+i)}function a(t,e,n,r){t!==e?r.push({i:n.push(o(n)+"skewX(",null,i)-2,x:dd(t,e)}):e&&n.push(o(n)+"skewX("+e+i)}function u(t,e,n,i,r,s){if(t!==n||e!==i){var a=r.push(o(r)+"scale(",null,",",null,")");s.push({i:a-4,x:dd(t,n)},{i:a-2,x:dd(e,i)})}else 1===n&&1===i||r.push(o(r)+"scale("+n+","+i+")")}return function(e,n){var i=[],o=[];return e=t(e),n=t(n),r(e.translateX,e.translateY,n.translateX,n.translateY,i,o),s(e.rotate,n.rotate,i,o),a(e.skewX,n.skewX,i,o),u(e.scaleX,e.scaleY,n.scaleX,n.scaleY,i,o),e=n=null,function(t){for(var e,n=-1,r=o.length;++n<r;)i[(e=o[n]).i]=e.x(t);return i.join("")}}}function we(t){return((t=Math.exp(t))+1/t)/2}function Ae(t){return((t=Math.exp(t))-1/t)/2}function Te(t){return((t=Math.exp(2*t))-1)/(t+1)}function Oe(t){return function(e,n){var i=t((e=Kt(e)).h,(n=Kt(n)).h),o=ve(e.s,n.s),r=ve(e.l,n.l),s=ve(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=r(t),e.opacity=s(t),e+""}}}function _e(t,e){var n=ve((t=te(t)).l,(e=te(e)).l),i=ve(t.a,e.a),o=ve(t.b,e.b),r=ve(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=o(e),t.opacity=r(e),t+""}}function Me(t){return function(e,n){var i=t((e=ae(e)).h,(n=ae(n)).h),o=ve(e.c,n.c),r=ve(e.l,n.l),s=ve(e.opacity,n.opacity);return function(t){return e.h=i(t),e.c=o(t),e.l=r(t),e.opacity=s(t),e+""}}}function Ne(t){return function e(n){function i(e,i){var o=t((e=ce(e)).h,(i=ce(i)).h),r=ve(e.s,i.s),s=ve(e.l,i.l),a=ve(e.opacity,i.opacity);return function(t){return e.h=o(t),e.s=r(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,i.gamma=e,i}(1)}function Re(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i)throw new Error("illegal type: "+t);i[t]=[]}return new De(i)}function De(t){this._=t}function Ie(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function Fe(t,e){for(var n,i=0,o=t.length;i<o;++i)if((n=t[i]).name===e)return n.value}function ke(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=Ld,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}function $e(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}function Le(t,e){var n=$e(t);return function(i,o){return e(n(i),o,t)}}function Ue(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var i in t)i in e||n.push(e[i]=i)}),n}function Be(t){return function(e,n){t(null==e?n:null)}}function Pe(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Qe(t,e){return function(n){return t(n.responseText,e)}}function Ve(){return pf||(gf(He),pf=ff.now()+df)}function He(){pf=0}function qe(){this._call=this._time=this._next=null}function je(t,e,n){var i=new qe;return i.restart(t,e,n),i}function ze(){Ve(),++af;for(var t,e=Ud;e;)(t=pf-e._time)>=0&&e._call.call(null,t),e=e._next;--af}function We(){pf=(hf=ff.now())+df,af=uf=0;try{ze()}finally{af=0,Ge(),pf=0}}function Ye(){var t=ff.now(),e=t-hf;e>cf&&(df-=e,hf=t)}function Ge(){for(var t,e,n=Ud,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ud=e);Bd=t,Ke(i)}function Ke(t){if(!af){uf&&(uf=clearTimeout(uf));var e=t-pf;e>24?(t<1/0&&(uf=setTimeout(We,e)),lf&&(lf=clearInterval(lf))):(lf||(lf=setInterval(Ye,cf)),af=1,gf(We))}}function Xe(t,e,n,i){function o(e){return t(e=new Date(+e)),e}return o.floor=o,o.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},o.round=function(t){var e=o(t),n=o.ceil(t);return t-e<n-t?e:n},o.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},o.range=function(n,i,r){var s=[];if(n=o.ceil(n),r=null==r?1:Math.floor(r),!(n<i&&r>0))return s;do s.push(new Date(+n));while(e(n,r),t(n),n<i);return s},o.filter=function(n){return Xe(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,i){if(t>=t)for(;--i>=0;)for(;e(t,1),!n(t););})},n&&(o.count=function(e,i){return yf.setTime(+e),bf.setTime(+i),t(yf),t(bf),Math.floor(n(yf,bf))},o.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?o.filter(i?function(e){return i(e)%t===0}:function(e){return o.count(0,e)%t===0}):o:null}),o}function Je(t){return Xe(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ef)/Tf})}function Ze(t){return Xe(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Tf})}function tn(t){if(!(e=Rg.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",i=e[2]||">",o=e[3]||"-",r=e[4]||"",s=!!e[5],a=e[6]&&+e[6],u=!!e[7],l=e[8]&&+e[8].slice(1),c=e[9]||"";"n"===c?(u=!0,c="g"):Ng[c]||(c=""),(s||"0"===n&&"="===i)&&(s=!0,n="0",i="="),this.fill=n,this.align=i,this.sign=o,this.symbol=r,this.zero=s,this.width=a,this.comma=u,this.precision=l,this.type=c}function en(t){return t}function nn(e){return Ig=kg(e),t.format=Ig.format,t.formatPrefix=Ig.formatPrefix,Ig}function on(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function rn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function sn(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function an(t){function e(t,e){return function(n){var i,o,r,s=[],a=-1,u=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++a<l;)37===t.charCodeAt(a)&&(s.push(t.slice(u,a)),null!=(o=Pg[i=t.charAt(++a)])?i=t.charAt(++a):o="e"===i?" ":"0",(r=e[i])&&(i=r(n,o)),s.push(i),u=a+1);return s.push(t.slice(u,a)),s.join("")}}function n(t,e){return function(n){var o=sn(1900),r=i(o,t,n+="",0);if(r!=n.length)return null;if("p"in o&&(o.H=o.H%12+12*o.p),"W"in o||"U"in o){"w"in o||(o.w="W"in o?1:0);var s="Z"in o?rn(sn(o.y)).getUTCDay():e(sn(o.y)).getDay();o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(s+5)%7:o.w+7*o.U-(s+6)%7}return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,rn(o)):e(o)}}function i(t,e,n,i){for(var o,r,s=0,a=e.length,u=n.length;s<a;){if(i>=u)return-1;if(o=e.charCodeAt(s++),37===o){if(o=e.charAt(s++),r=V[o in Pg?e.charAt(s++):o],!r||(i=r(t,n,i))<0)return-1}else if(o!=n.charCodeAt(i++))return-1}return i}function o(t,e,n){var i=N.exec(e.slice(n));return i?(t.p=R[i[0].toLowerCase()],n+i[0].length):-1}function r(t,e,n){var i=F.exec(e.slice(n));return i?(t.w=k[i[0].toLowerCase()],n+i[0].length):-1}function s(t,e,n){var i=D.exec(e.slice(n));return i?(t.w=I[i[0].toLowerCase()],n+i[0].length):-1}function a(t,e,n){var i=U.exec(e.slice(n));return i?(t.m=B[i[0].toLowerCase()],n+i[0].length):-1}function u(t,e,n){var i=$.exec(e.slice(n));return i?(t.m=L[i[0].toLowerCase()],n+i[0].length):-1}function l(t,e,n){return i(t,C,e,n)}function c(t,e,n){return i(t,E,e,n)}function h(t,e,n){return i(t,w,e,n)}function p(t){return O[t.getDay()]}function d(t){return T[t.getDay()]}function f(t){return M[t.getMonth()]}function g(t){return _[t.getMonth()]}function m(t){return A[+(t.getHours()>=12)]}function v(t){return O[t.getUTCDay()]}function y(t){return T[t.getUTCDay()]}function b(t){return M[t.getUTCMonth()]}function S(t){return _[t.getUTCMonth()]}function x(t){return A[+(t.getUTCHours()>=12)]}var C=t.dateTime,E=t.date,w=t.time,A=t.periods,T=t.days,O=t.shortDays,_=t.months,M=t.shortMonths,N=cn(A),R=hn(A),D=cn(T),I=hn(T),F=cn(O),k=hn(O),$=cn(_),L=hn(_),U=cn(M),B=hn(M),P={a:p,A:d,b:f,B:g,c:null,d:Tn,e:Tn,H:On,I:_n,j:Mn,L:Nn,m:Rn,M:Dn,p:m,S:In,U:Fn,w:kn,W:$n,x:null,X:null,y:Ln,Y:Un,Z:Bn,"%":ti},Q={a:v,A:y,b:b,B:S,c:null,d:Pn,e:Pn,H:Qn,I:Vn,j:Hn,L:qn,m:jn,M:zn,p:x,S:Wn,U:Yn,w:Gn,W:Kn,x:null,X:null,y:Xn,Y:Jn,Z:Zn,"%":ti},V={a:r,A:s,b:a,B:u,c:l,d:bn,e:bn,H:xn,I:xn,j:Sn,L:wn,m:yn,M:Cn,p:o,S:En,U:dn,w:pn,W:fn,x:c,X:h,y:mn,Y:gn,Z:vn,"%":An};return P.x=e(E,P),P.X=e(w,P),P.c=e(C,P),Q.x=e(E,Q),Q.X=e(w,Q),Q.c=e(C,Q),{format:function(t){var n=e(t+="",P);return n.toString=function(){return t},n},parse:function(t){var e=n(t+="",on);return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",Q);return n.toString=function(){return t},n},utcParse:function(t){var e=n(t,rn);return e.toString=function(){return t},e}}}function un(t,e,n){var i=t<0?"-":"",o=(i?-t:t)+"",r=o.length;return i+(r<n?new Array(n-r+1).join(e)+o:o)}function ln(t){return t.replace(Hg,"\\$&")}function cn(t){return new RegExp("^(?:"+t.map(ln).join("|")+")","i")}function hn(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function pn(t,e,n){var i=Qg.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function dn(t,e,n){var i=Qg.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function fn(t,e,n){var i=Qg.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function gn(t,e,n){var i=Qg.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function mn(t,e,n){var i=Qg.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function vn(t,e,n){var i=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function yn(t,e,n){var i=Qg.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function bn(t,e,n){var i=Qg.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Sn(t,e,n){var i=Qg.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function xn(t,e,n){var i=Qg.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Cn(t,e,n){var i=Qg.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function En(t,e,n){var i=Qg.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function wn(t,e,n){var i=Qg.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function An(t,e,n){var i=Vg.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function Tn(t,e){return un(t.getDate(),e,2)}function On(t,e){return un(t.getHours(),e,2)}function _n(t,e){return un(t.getHours()%12||12,e,2)}function Mn(t,e){return un(1+If.count(Xf(t),t),e,3)}function Nn(t,e){return un(t.getMilliseconds(),e,3)}function Rn(t,e){return un(t.getMonth()+1,e,2)}function Dn(t,e){return un(t.getMinutes(),e,2)}function In(t,e){return un(t.getSeconds(),e,2)}function Fn(t,e){return un(kf.count(Xf(t),t),e,2)}function kn(t){return t.getDay()}function $n(t,e){return un($f.count(Xf(t),t),e,2)}function Ln(t,e){return un(t.getFullYear()%100,e,2)}function Un(t,e){return un(t.getFullYear()%1e4,e,4)}function Bn(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+un(e/60|0,"0",2)+un(e%60,"0",2)}function Pn(t,e){return un(t.getUTCDate(),e,2)}function Qn(t,e){return un(t.getUTCHours(),e,2)}function Vn(t,e){return un(t.getUTCHours()%12||12,e,2)}function Hn(t,e){return un(1+ig.count(xg(t),t),e,3)}function qn(t,e){return un(t.getUTCMilliseconds(),e,3)}function jn(t,e){return un(t.getUTCMonth()+1,e,2)}function zn(t,e){return un(t.getUTCMinutes(),e,2)}function Wn(t,e){return un(t.getUTCSeconds(),e,2)}function Yn(t,e){return un(rg.count(xg(t),t),e,2)}function Gn(t){return t.getUTCDay()}function Kn(t,e){return un(sg.count(xg(t),t),e,2)}function Xn(t,e){return un(t.getUTCFullYear()%100,e,2)}function Jn(t,e){return un(t.getUTCFullYear()%1e4,e,4)}function Zn(){return"+0000"}function ti(){return"%"}function ei(e){return $g=an(e),t.timeFormat=$g.format,t.timeParse=$g.parse,t.utcFormat=$g.utcFormat,t.utcParse=$g.utcParse,$g}function ni(t){return t.toISOString()}function ii(t){var e=new Date(t);return isNaN(e)?null:e}function oi(t){function e(e){var r=e+"",s=n.get(r);if(!s){if(o!==Kg)return o;n.set(r,s=i.push(e))}return t[(s-1)%t.length]}var n=r(),i=[],o=Kg;return t=null==t?[]:Gg.call(t),e.domain=function(t){if(!arguments.length)return i.slice();i=[],n=r();for(var o,s,a=-1,u=t.length;++a<u;)n.has(s=(o=t[a])+"")||n.set(s,i.push(o));return e},e.range=function(n){return arguments.length?(t=Gg.call(n),e):t.slice()},e.unknown=function(t){return arguments.length?(o=t,e):o},e.copy=function(){return oi().domain(i).range(t).unknown(o)},e}function ri(){function t(){var t=o().length,i=s[1]<s[0],h=s[i-0],p=s[1-i];e=(p-h)/Math.max(1,t-u+2*l),a&&(e=Math.floor(e)),h+=(p-h-e*(t-u))*c,n=e*(1-u),a&&(h=Math.round(h),n=Math.round(n));var d=Ul(t).map(function(t){return h+e*t});return r(i?d.reverse():d)}var e,n,i=oi().unknown(void 0),o=i.domain,r=i.range,s=[0,1],a=!1,u=0,l=0,c=.5;return delete i.unknown,i.domain=function(e){return arguments.length?(o(e),t()):o()},i.range=function(e){return arguments.length?(s=[+e[0],+e[1]],t()):s.slice()},i.rangeRound=function(e){return s=[+e[0],+e[1]],a=!0,t()},i.bandwidth=function(){return n},i.step=function(){return e},i.round=function(e){return arguments.length?(a=!!e,t()):a},i.padding=function(e){return arguments.length?(u=l=Math.max(0,Math.min(1,e)),t()):u},i.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),t()):u},i.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),t()):l},i.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),t()):c},i.copy=function(){return ri().domain(o()).range(s).round(a).paddingInner(u).paddingOuter(l).align(c)},t()}function si(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return si(e())},t}function ai(){return si(ri().paddingInner(1))}function ui(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Xg(e)}function li(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:i(t)}}}function ci(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:i(t)}}}function hi(t,e,n,i){var o=t[0],r=t[1],s=e[0],a=e[1];return r<o?(o=n(r,o),s=i(a,s)):(o=n(o,r),s=i(s,a)),function(t){return s(o(t))}}function pi(t,e,n,i){var o=Math.min(t.length,e.length)-1,r=new Array(o),s=new Array(o),a=-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<o;)r[a]=n(t[a],t[a+1]),s[a]=i(e[a],e[a+1]);return function(e){var n=Tl(t,e,1,o)-1;return s[n](r[n](e))}}function di(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function fi(t,e){function n(){return o=Math.min(a.length,u.length)>2?pi:hi,r=s=null,i}function i(e){return(r||(r=o(a,u,c?li(t):t,l)))(+e)}var o,r,s,a=Zg,u=Zg,l=yd,c=!1;return i.invert=function(t){return(s||(s=o(u,a,ui,c?ci(e):e)))(+t)},i.domain=function(t){return arguments.length?(a=Yg.call(t,Jg),n()):a.slice()},i.range=function(t){return arguments.length?(u=Gg.call(t),n()):u.slice()},i.rangeRound=function(t){return u=Gg.call(t),l=bd,n()},i.clamp=function(t){return arguments.length?(c=!!t,n()):c},i.interpolate=function(t){return arguments.length?(l=t,n()):l},n()}function gi(t){var e=t.domain;return t.ticks=function(t){var n=e();return Vl(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return tm(e(),t,n)},t.nice=function(i){var o=e(),r=o.length-1,s=null==i?10:i,a=o[0],u=o[r],l=n(a,u,s);return l&&(l=n(Math.floor(a/l)*l,Math.ceil(u/l)*l,s),o[0]=Math.floor(a/l)*l,o[r]=Math.ceil(u/l)*l,e(o)),t},t}function mi(){var t=fi(ui,dd);return t.copy=function(){return di(t,mi())},gi(t)}function vi(){function t(t){return+t}var e=[0,1];return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=Yg.call(n,Jg),t):e.slice()},t.copy=function(){return vi().domain(e)},gi(t)}function yi(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:Xg(e)}function bi(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function Si(t){return isFinite(t)?+("1e"+t):t<0?0:t}function xi(t){return 10===t?Si:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Ci(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Ei(t){return function(e){return-t(-e)}}function wi(){function e(){return r=Ci(o),s=xi(o),i()[0]<0&&(r=Ei(r),s=Ei(s)),n}var n=fi(yi,bi).domain([1,10]),i=n.domain,o=10,r=Ci(10),s=xi(10);return n.base=function(t){return arguments.length?(o=+t,e()):o},n.domain=function(t){return arguments.length?(i(t),e()):i()},n.ticks=function(t){var e,n=i(),a=n[0],u=n[n.length-1];(e=u<a)&&(p=a,a=u,u=p);var l,c,h,p=r(a),d=r(u),f=null==t?10:+t,g=[];if(!(o%1)&&d-p<f){if(p=Math.round(p)-1,d=Math.round(d)+1,a>0){for(;p<d;++p)for(c=1,l=s(p);c<o;++c)if(h=l*c,!(h<a)){if(h>u)break;g.push(h)}}else for(;p<d;++p)for(c=o-1,l=s(p);c>=1;--c)if(h=l*c,!(h<a)){if(h>u)break;g.push(h)}}else g=Vl(p,d,Math.min(d-p,f)).map(s);return e?g.reverse():g},n.tickFormat=function(e,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=t.format(i)),e===1/0)return i;null==e&&(e=10);var a=Math.max(1,o*e/n.ticks().length);return function(t){var e=t/s(Math.round(r(t)));return e*o<o-.5&&(e*=o),e<=a?i(t):""}},n.nice=function(){return i(em(i(),{floor:function(t){return s(Math.floor(r(t)))},ceil:function(t){return s(Math.ceil(r(t)))}}))},n.copy=function(){return di(n,wi().base(o))},n}function Ai(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function Ti(){function t(t,e){return(e=Ai(e,n)-(t=Ai(t,n)))?function(i){return(Ai(i,n)-t)/e}:Xg(e)}function e(t,e){return e=Ai(e,n)-(t=Ai(t,n)),function(i){return Ai(t+e*i,1/n)}}var n=1,i=fi(t,e),o=i.domain;return i.exponent=function(t){return arguments.length?(n=+t,o(o())):n},i.copy=function(){return di(i,Ti().exponent(n))},gi(i)}function Oi(){return Ti().exponent(.5)}function _i(){function t(){var t=0,r=Math.max(1,i.length);for(o=new Array(r-1);++t<r;)o[t-1]=jl(n,t/r);return e}function e(t){if(!isNaN(t=+t))return i[Tl(o,t)]}var n=[],i=[],o=[];return e.invertExtent=function(t){var e=i.indexOf(t);return e<0?[NaN,NaN]:[e>0?o[e-1]:n[0],e<o.length?o[e]:n[n.length-1]]},e.domain=function(e){if(!arguments.length)return n.slice();n=[];for(var i,o=0,r=e.length;o<r;++o)i=e[o],null==i||isNaN(i=+i)||n.push(i);return n.sort(El),t()},e.range=function(e){return arguments.length?(i=Gg.call(e),t()):i.slice()},e.quantiles=function(){return o.slice()},e.copy=function(){return _i().domain(n).range(i)},e}function Mi(){function t(t){if(t<=t)return s[Tl(r,t,0,o)]}function e(){var e=-1;for(r=new Array(o);++e<o;)r[e]=((e+1)*i-(e-o)*n)/(o+1);return t}var n=0,i=1,o=1,r=[.5],s=[0,1];return t.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],
e()):[n,i]},t.range=function(t){return arguments.length?(o=(s=Gg.call(t)).length-1,e()):s.slice()},t.invertExtent=function(t){var e=s.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,r[0]]:e>=o?[r[o-1],i]:[r[e-1],r[e]]},t.copy=function(){return Mi().domain([n,i]).range(s)},gi(t)}function Ni(){function t(t){if(t<=t)return n[Tl(e,t,0,i)]}var e=[.5],n=[0,1],i=1;return t.domain=function(o){return arguments.length?(e=Gg.call(o),i=Math.min(e.length,n.length-1),t):e.slice()},t.range=function(o){return arguments.length?(n=Gg.call(o),i=Math.min(e.length,n.length-1),t):n.slice()},t.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},t.copy=function(){return Ni().domain(e).range(n)},t}function Ri(t){return new Date(t)}function Di(t){return t instanceof Date?+t:+new Date(+t)}function Ii(t,e,i,o,r,s,a,u,l){function c(n){return(a(n)<n?g:s(n)<n?m:r(n)<n?v:o(n)<n?y:e(n)<n?i(n)<n?b:S:t(n)<n?x:C)(n)}function h(e,i,o,r){if(null==e&&(e=10),"number"==typeof e){var s=Math.abs(o-i)/e,a=wl(function(t){return t[2]}).right(E,s);a===E.length?(r=n(i/um,o/um,e),e=t):a?(a=E[s/E[a-1][2]<E[a][2]/s?a-1:a],r=a[1],e=a[0]):(r=n(i,o,e),e=u)}return null==r?e:e.every(r)}var p=fi(ui,dd),d=p.invert,f=p.domain,g=l(".%L"),m=l(":%S"),v=l("%I:%M"),y=l("%I %p"),b=l("%a %d"),S=l("%b %d"),x=l("%B"),C=l("%Y"),E=[[a,1,nm],[a,5,5*nm],[a,15,15*nm],[a,30,30*nm],[s,1,im],[s,5,5*im],[s,15,15*im],[s,30,30*im],[r,1,om],[r,3,3*om],[r,6,6*om],[r,12,12*om],[o,1,rm],[o,2,2*rm],[i,1,sm],[e,1,am],[e,3,3*am],[t,1,um]];return p.invert=function(t){return new Date(d(t))},p.domain=function(t){return arguments.length?f(Yg.call(t,Di)):f().map(Ri)},p.ticks=function(t,e){var n,i=f(),o=i[0],r=i[i.length-1],s=r<o;return s&&(n=o,o=r,r=n),n=h(t,o,r,e),n=n?n.range(o,r+1):[],s?n.reverse():n},p.tickFormat=function(t,e){return null==e?c:l(e)},p.nice=function(t,e){var n=f();return(t=h(t,n[0],n[n.length-1],e))?f(em(n,t)):p},p.copy=function(){return di(p,Ii(t,e,i,o,r,s,a,u,l))},p}function Fi(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function ki(t){function e(e){var r=(e-n)/(i-n);return t(o?Math.max(0,Math.min(1,r)):r)}var n=0,i=1,o=!1;return e.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.clamp=function(t){return arguments.length?(o=!!t,e):o},e.interpolator=function(n){return arguments.length?(t=n,e):t},e.copy=function(){return ki(t).domain([n,i]).clamp(o)},gi(e)}function $i(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Am&&e.documentElement.namespaceURI===Am?e.createElement(t):e.createElementNS(n,t)}}function Li(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ui(){return new Bi}function Bi(){this._="@"+(++Mm).toString(36)}function Pi(t,e,n){return t=Qi(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Qi(e,n,i){return function(o){var r=t.event;t.event=o;try{e.call(this,this.__data__,n,i)}finally{t.event=r}}}function Vi(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function Hi(t){return function(){var e=this.__on;if(e){for(var n,i=0,o=-1,r=e.length;i<r;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?e.length=o:delete this.__on}}}function qi(t,e,n){var i=Fm.hasOwnProperty(t.type)?Pi:Qi;return function(o,r,s){var a,u=this.__on,l=i(e,r,s);if(u)for(var c=0,h=u.length;c<h;++c)if((a=u[c]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=l,a.capture=n),void(a.value=e);this.addEventListener(t.type,l,n),a={type:t.type,name:t.name,value:e,listener:l,capture:n},u?u.push(a):this.__on=[a]}}function ji(e,n,i,o){var r=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(i,o)}finally{t.event=r}}function zi(){}function Wi(){return[]}function Yi(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Gi(t,e,n,i,o,r){for(var s,a=0,u=e.length,l=r.length;a<l;++a)(s=e[a])?(s.__data__=r[a],i[a]=s):n[a]=new Yi(t,r[a]);for(;a<u;++a)(s=e[a])&&(o[a]=s)}function Ki(t,e,n,i,o,r,s){var a,u,l,c={},h=e.length,p=r.length,d=new Array(h);for(a=0;a<h;++a)(u=e[a])&&(d[a]=l=Ym+s.call(u,u.__data__,a,e),l in c?o[a]=u:c[l]=u);for(a=0;a<p;++a)l=Ym+s.call(t,r[a],a,r),(u=c[l])?(i[a]=u,u.__data__=r[a],c[l]=null):n[a]=new Yi(t,r[a]);for(a=0;a<h;++a)(u=e[a])&&c[d[a]]===u&&(o[a]=u)}function Xi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ji(t){return function(){this.removeAttribute(t)}}function Zi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function to(t,e){return function(){this.setAttribute(t,e)}}function eo(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function no(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function io(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function oo(t){return function(){this.style.removeProperty(t)}}function ro(t,e,n){return function(){this.style.setProperty(t,e,n)}}function so(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function ao(t){return function(){delete this[t]}}function uo(t,e){return function(){this[t]=e}}function lo(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function co(t){return t.trim().split(/^|\s+/)}function ho(t){return t.classList||new po(t)}function po(t){this._node=t,this._names=co(t.getAttribute("class")||"")}function fo(t,e){for(var n=ho(t),i=-1,o=e.length;++i<o;)n.add(e[i])}function go(t,e){for(var n=ho(t),i=-1,o=e.length;++i<o;)n.remove(e[i])}function mo(t){return function(){fo(this,t)}}function vo(t){return function(){go(this,t)}}function yo(t,e){return function(){(e.apply(this,arguments)?fo:go)(this,t)}}function bo(){this.textContent=""}function So(t){return function(){this.textContent=t}}function xo(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Co(){this.innerHTML=""}function Eo(t){return function(){this.innerHTML=t}}function wo(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ao(){this.nextSibling&&this.parentNode.appendChild(this)}function To(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Oo(){return null}function _o(){var t=this.parentNode;t&&t.removeChild(this)}function Mo(t,e,n){var i=av(t),o=i.CustomEvent;o?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function No(t,e){return function(){return Mo(this,t,e)}}function Ro(t,e){return function(){return Mo(this,t,e.apply(this,arguments))}}function Do(t,e){this._groups=t,this._parents=e}function Io(){return new Do([[document.documentElement]],Sv)}function Fo(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Ov)throw new Error("too late");return n}function ko(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>Mv)throw new Error("too late");return n}function $o(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("too late");return n}function Lo(t,e,n){function i(t){n.state=_v,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(i){var l,c,h,p;if(n.state!==_v)return s();for(l in u)if(p=u[l],p.name===n.name){if(p.state===Nv)return mf(o);p.state===Rv?(p.state=Iv,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete u[l]):+l<e&&(p.state=Iv,p.timer.stop(),delete u[l])}if(mf(function(){n.state===Nv&&(n.state=Rv,n.timer.restart(r,n.delay,n.time),r(i))}),n.state=Mv,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Mv){for(n.state=Nv,a=new Array(h=n.tween.length),l=0,c=-1;l<h;++l)(p=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(a[++c]=p);a.length=c+1}}function r(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=Dv,1),o=-1,r=a.length;++o<r;)a[o].call(null,i);n.state===Dv&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){n.state=Iv,n.timer.stop(),delete u[e];for(var i in u)return;delete t.__transition}var a,u=t.__transition;u[e]=n,n.timer=je(i,0,n.time)}function Uo(t,e){var n,i;return function(){var o=ko(this,t),r=o.tween;if(r!==n){i=n=r;for(var s=0,a=i.length;s<a;++s)if(i[s].name===e){i=i.slice(),i.splice(s,1);break}}o.tween=i}}function Bo(t,e,n){var i,o;if("function"!=typeof n)throw new Error;return function(){var r=ko(this,t),s=r.tween;if(s!==i){o=(i=s).slice();for(var a={name:e,value:n},u=0,l=o.length;u<l;++u)if(o[u].name===e){o[u]=a;break}u===l&&o.push(a)}r.tween=o}}function Po(t,e,n){var i=t._id;return t.each(function(){var t=ko(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return $o(t,i).value[e]}}function Qo(t){return function(){this.removeAttribute(t)}}function Vo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ho(t,e,n){var i,o;return function(){var r=this.getAttribute(t);return r===n?null:r===i?o:o=e(i=r,n)}}function qo(t,e,n){var i,o;return function(){var r=this.getAttributeNS(t.space,t.local);return r===n?null:r===i?o:o=e(i=r,n)}}function jo(t,e,n){var i,o,r;return function(){var s,a=n(this);return null==a?void this.removeAttribute(t):(s=this.getAttribute(t),s===a?null:s===i&&a===o?r:r=e(i=s,o=a))}}function zo(t,e,n){var i,o,r;return function(){var s,a=n(this);return null==a?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),s===a?null:s===i&&a===o?r:r=e(i=s,o=a))}}function Wo(t,e){function n(){var n=this,i=e.apply(n,arguments);return i&&function(e){n.setAttributeNS(t.space,t.local,i(e))}}return n._value=e,n}function Yo(t,e){function n(){var n=this,i=e.apply(n,arguments);return i&&function(e){n.setAttribute(t,i(e))}}return n._value=e,n}function Go(t,e){return function(){Fo(this,t).delay=+e.apply(this,arguments)}}function Ko(t,e){return e=+e,function(){Fo(this,t).delay=e}}function Xo(t,e){return function(){ko(this,t).duration=+e.apply(this,arguments)}}function Jo(t,e){return e=+e,function(){ko(this,t).duration=e}}function Zo(t,e){if("function"!=typeof e)throw new Error;return function(){ko(this,t).ease=e}}function tr(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}function er(t,e,n){var i,o,r=tr(e)?Fo:ko;return function(){var s=r(this,t),a=s.on;a!==i&&(o=(i=a).copy()).on(e,n),s.on=o}}function nr(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function ir(t,e){var n,i,o;return function(){var r=av(this).getComputedStyle(this,null),s=r.getPropertyValue(t),a=(this.style.removeProperty(t),r.getPropertyValue(t));return s===a?null:s===n&&a===i?o:o=e(n=s,i=a)}}function or(t){return function(){this.style.removeProperty(t)}}function rr(t,e,n){var i,o;return function(){var r=av(this).getComputedStyle(this,null).getPropertyValue(t);return r===n?null:r===i?o:o=e(i=r,n)}}function sr(t,e,n){var i,o,r;return function(){var s=av(this).getComputedStyle(this,null),a=s.getPropertyValue(t),u=n(this);return null==u&&(this.style.removeProperty(t),u=s.getPropertyValue(t)),a===u?null:a===i&&u===o?r:r=e(i=a,o=u)}}function ar(t,e,n){function i(){var i=this,o=e.apply(i,arguments);return o&&function(e){i.style.setProperty(t,o(e),n)}}return i._value=e,i}function ur(t){return function(){this.textContent=t}}function lr(t){return function(){var e=t(this);this.textContent=null==e?"":e}}function cr(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function hr(t){return Io().transition(t)}function pr(){return++ny}function dr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return oy.time=Ve(),oy;return n}function fr(t,e,n){var i=t(n);return"translate("+(isFinite(i)?i:e(n))+",0)"}function gr(t,e,n){var i=t(n);return"translate(0,"+(isFinite(i)?i:e(n))+")"}function mr(t){var e=t.bandwidth()/2;return t.round()&&(e=Math.round(e)),function(n){return t(n)+e}}function vr(){return!this.__axis}function yr(t,e){function n(n){var l,c=null==o?e.ticks?e.ticks.apply(e,i):e.domain():o,h=null==r?e.tickFormat?e.tickFormat.apply(e,i):ly:r,p=Math.max(s,0)+u,d=t===cy||t===py?fr:gr,f=e.range(),g=f[0]+.5,m=f[f.length-1]+.5,v=(e.bandwidth?mr:ly)(e.copy()),y=n.selection?n.selection():n,b=y.selectAll(".domain").data([null]),S=y.selectAll(".tick").data(c,e).order(),x=S.exit(),C=S.enter().append("g").attr("class","tick"),E=S.select("line"),w=S.select("text"),A=t===cy||t===dy?-1:1,T=t===dy||t===hy?(l="x","y"):(l="y","x");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),S=S.merge(C),E=E.merge(C.append("line").attr("stroke","#000").attr(l+"2",A*s).attr(T+"1",.5).attr(T+"2",.5)),w=w.merge(C.append("text").attr("fill","#000").attr(l,A*p).attr(T,.5).attr("dy",t===cy?"0em":t===py?"0.71em":"0.32em")),n!==y&&(b=b.transition(n),S=S.transition(n),E=E.transition(n),w=w.transition(n),x=x.transition(n).attr("opacity",fy).attr("transform",function(t){return d(v,this.parentNode.__axis||v,t)}),C.attr("opacity",fy).attr("transform",function(t){return d(this.parentNode.__axis||v,v,t)})),x.remove(),b.attr("d",t===dy||t==hy?"M"+A*a+","+g+"H0.5V"+m+"H"+A*a:"M"+g+","+A*a+"V0.5H"+m+"V"+A*a),S.attr("opacity",1).attr("transform",function(t){return d(v,v,t)}),E.attr(l+"2",A*s),w.attr(l,A*p).text(h),y.filter(vr).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===hy?"start":t===dy?"end":"middle"),y.each(function(){this.__axis=v})}var i=[],o=null,r=null,s=6,a=6,u=3;return n.scale=function(t){return arguments.length?(e=t,n):e},n.ticks=function(){return i=uy.call(arguments),n},n.tickArguments=function(t){return arguments.length?(i=null==t?[]:uy.call(t),n):i.slice()},n.tickValues=function(t){return arguments.length?(o=null==t?null:uy.call(t),n):o&&o.slice()},n.tickFormat=function(t){return arguments.length?(r=t,n):r},n.tickSize=function(t){return arguments.length?(s=a=+t,n):s},n.tickSizeInner=function(t){return arguments.length?(s=+t,n):s},n.tickSizeOuter=function(t){return arguments.length?(a=+t,n):a},n.tickPadding=function(t){return arguments.length?(u=+t,n):u},n}function br(t){return yr(cy,t)}function Sr(t){return yr(hy,t)}function xr(t){return yr(py,t)}function Cr(t){return yr(dy,t)}function Er(t,e){return t.parent===e.parent?1:2}function wr(t){return t.reduce(Ar,0)/t.length}function Ar(t,e){return t+e.x}function Tr(t){return 1+t.reduce(Or,0)}function Or(t,e){return Math.max(t,e.y)}function _r(t){for(var e;e=t.children;)t=e[0];return t}function Mr(t){for(var e;e=t.children;)t=e[e.length-1];return t}function Nr(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),o=null;for(t=n.pop(),e=i.pop();t===e;)o=t,t=n.pop(),e=i.pop();return o}function Rr(t,e){var n,i,o,r,s,a=new $r(t),u=+t.value&&(a.value=t.value),l=[a];for(null==e&&(e=Ir);n=l.pop();)if(u&&(n.value=+n.data.value),(o=e(n.data))&&(s=o.length))for(n.children=new Array(s),r=s-1;r>=0;--r)l.push(i=n.children[r]=new $r(o[r])),i.parent=n,i.depth=n.depth+1;return a.eachBefore(kr)}function Dr(){return Rr(this).eachBefore(Fr)}function Ir(t){return t.children}function Fr(t){t.data=t.data.data}function kr(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function $r(t){this.data=t,this.depth=this.height=0,this.parent=null}function Lr(t){this._=t,this.next=null}function Ur(t,e){var n=e.x-t.x,i=e.y-t.y,o=t.r-e.r;return o*o+1e-6>n*n+i*i}function Br(t,e){var n,i,o,r=null,s=t.head;switch(e.length){case 1:n=Pr(e[0]);break;case 2:n=Qr(e[0],e[1]);break;case 3:n=Vr(e[0],e[1],e[2])}for(;s;)o=s._,i=s.next,n&&Ur(n,o)?r=s:(r?(t.tail=r,r.next=null):t.head=t.tail=null,e.push(o),n=Br(t,e),e.pop(),t.head?(s.next=t.head,t.head=s):(s.next=null,t.head=t.tail=s),r=t.tail,r.next=i),s=i;return t.tail=r,n}function Pr(t){return{x:t.x,y:t.y,r:t.r}}function Qr(t,e){var n=t.x,i=t.y,o=t.r,r=e.x,s=e.y,a=e.r,u=r-n,l=s-i,c=a-o,h=Math.sqrt(u*u+l*l);return{x:(n+r+u/h*c)/2,y:(i+s+l/h*c)/2,r:(h+o+a)/2}}function Vr(t,e,n){var i=t.x,o=t.y,r=t.r,s=e.x,a=e.y,u=e.r,l=n.x,c=n.y,h=n.r,p=2*(i-s),d=2*(o-a),f=2*(u-r),g=i*i+o*o-r*r-s*s-a*a+u*u,m=2*(i-l),v=2*(o-c),y=2*(h-r),b=i*i+o*o-r*r-l*l-c*c+h*h,S=m*d-p*v,x=(d*b-v*g)/S-i,C=(v*f-d*y)/S,E=(m*g-p*b)/S-o,w=(p*y-m*f)/S,A=C*C+w*w-1,T=2*(x*C+E*w+r),O=x*x+E*E-r*r,_=(-T-Math.sqrt(T*T-4*A*O))/(2*A);return{x:x+C*_+i,y:E+w*_+o,r:_}}function Hr(t,e,n){var i=t.x,o=t.y,r=e.r+n.r,s=t.r+n.r,a=e.x-i,u=e.y-o,l=a*a+u*u;if(l){var c=.5+((s*=s)-(r*=r))/(2*l),h=Math.sqrt(Math.max(0,2*r*(s+l)-(s-=l)*s-r*r))/(2*l);n.x=i+c*a+h*u,n.y=o+c*u-h*a}else n.x=i+s,n.y=o}function qr(t,e){var n=e.x-t.x,i=e.y-t.y,o=t.r+e.r;return o*o>n*n+i*i}function jr(t,e,n){var i=t.x-e,o=t.y-n;return i*i+o*o}function zr(t){this._=t,this.next=null,this.previous=null}function Wr(t){if(!(o=t.length))return 0;var e,n,i,o;if(e=t[0],e.x=0,e.y=0,!(o>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(o>2))return e.r+n.r;Hr(n,e,i=t[2]);var r,s,a,u,l,c,h,p=e.r*e.r,d=n.r*n.r,f=i.r*i.r,g=p+d+f,m=p*e.x+d*n.x+f*i.x,v=p*e.y+d*n.y+f*i.y;e=new zr(e),n=new zr(n),i=new zr(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(a=3;a<o;++a){if(Hr(e._,n._,i=t[a]),i=new zr(i),(l=e.previous)===(u=n.next)){if(qr(u._,i._)){e=n,n=u,--a;continue t}}else{c=u._.r,h=l._.r;do if(c<=h){if(qr(u._,i._)){n=u,e.next=n,n.previous=e,--a;continue t}u=u.next,c+=u._.r}else{if(qr(l._,i._)){e=l,e.next=n,n.previous=e,--a;continue t}l=l.previous,h+=l._.r}while(u!==l.next)}for(i.previous=e,i.next=n,e.next=n.previous=n=i,g+=f=i._.r*i._.r,m+=f*i._.x,v+=f*i._.y,p=jr(e._,r=m/g,s=v/g);(i=i.next)!==n;)(f=jr(i._,r,s))<p&&(e=i,p=f);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=Oy(e),a=0;a<o;++a)e=t[a],e.x-=i.x,e.y-=i.y;return i.r}function Yr(t){return null==t?null:Gr(t)}function Gr(t){if("function"!=typeof t)throw new Error;return t}function Kr(){return 0}function Xr(t){return Math.sqrt(t.value)}function Jr(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Zr(t,e){return function(n){if(i=n.children){var i,o,r,s=i.length,a=t(n)*e||0;if(a)for(o=0;o<s;++o)i[o].r+=a;if(r=Wr(i),a)for(o=0;o<s;++o)i[o].r-=a;n.r=r+a}}}function ts(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function es(t){return t.id}function ns(t){return t.parentId}function is(t,e){return t.parent===e.parent?1:2}function os(t){var e=t.children;return e?e[0]:t.t}function rs(t){var e=t.children;return e?e[e.length-1]:t.t}function ss(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function as(t){for(var e,n=0,i=0,o=t.children,r=o.length;--r>=0;)e=o[r],e.z+=n,e.m+=n,n+=e.s+(i+=e.c)}function us(t,e,n){return t.a.parent===e.parent?t.a:n}function ls(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function cs(t){for(var e,n,i,o,r,s=new ls(t,0),a=[s];e=a.pop();)if(i=e._.children)for(e.children=new Array(r=i.length),o=r-1;o>=0;--o)a.push(n=e.children[o]=new ls(i[o],o)),n.parent=e;return(s.parent=new ls(null,0)).children=[s],s}function hs(t,e,n,i,o,r){for(var s,a,u,l,c,h,p,d,f,g,m,v=[],y=e.children,b=0,S=0,x=y.length,C=e.value;b<x;){u=o-n,l=r-i;do c=y[S++].value;while(!c&&S<x);for(h=p=c,g=Math.max(l/u,u/l)/(C*t),m=c*c*g,f=Math.max(p/m,m/h);S<x;++S){if(c+=a=y[S].value,a<h&&(h=a),a>p&&(p=a),m=c*c*g,d=Math.max(p/m,m/h),d>f){c-=a;break}f=d}v.push(s={value:c,dice:u<l,children:y.slice(b,S)}),s.dice?Dy(s,n,i,o,C?i+=l*c/C:r):By(s,n,i,C?n+=u*c/C:o,r),C-=c,b=S}return v}function ps(t){return t.x+t.vx}function ds(t){return t.y+t.vy}function fs(t){return t.index}function gs(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function ms(t){return t.x}function vs(t){return t.y}function ys(){t.event.stopImmediatePropagation()}function bs(t,e){var n=t.document.documentElement,i=xv(t).on("dragstart.drag",null);e&&(i.on("click.drag",ib,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Ss(t,e,n,i,o,r,s,a,u,l){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=o,this.x=r,this.y=s,this.dx=a,this.dy=u,this._=l}function xs(){return!t.event.button}function Cs(){return this.parentNode}function Es(e){return null==e?{x:t.event.x,y:t.event.y}:e}function ws(t){return t[0]}function As(t){return t[1]}function Ts(){this._=null}function Os(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function _s(t,e){var n=e,i=e.R,o=n.U;o?o.L===n?o.L=i:o.R=i:t._=i,i.U=o,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Ms(t,e){var n=e,i=e.L,o=n.U;o?o.L===n?o.L=i:o.R=i:t._=i,i.U=o,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Ns(t){for(;t.L;)t=t.L;return t}function Rs(t,e,n,i){var o=[null,null],r=pb.push(o)-1;return o.left=t,o.right=e,n&&Is(o,t,e,n),i&&Is(o,e,t,i),cb[t.index].halfedges.push(r),cb[e.index].halfedges.push(r),o}function Ds(t,e,n){var i=[e,n];return i.left=t,i}function Is(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Fs(t,e,n,i,o){var r,s=t[0],a=t[1],u=s[0],l=s[1],c=a[0],h=a[1],p=0,d=1,f=c-u,g=h-l;if(r=e-u,f||!(r>0)){if(r/=f,f<0){if(r<p)return;r<d&&(d=r)}else if(f>0){if(r>d)return;r>p&&(p=r)}if(r=i-u,f||!(r<0)){if(r/=f,f<0){if(r>d)return;r>p&&(p=r)}else if(f>0){if(r<p)return;r<d&&(d=r)}if(r=n-l,g||!(r>0)){if(r/=g,g<0){if(r<p)return;r<d&&(d=r)}else if(g>0){if(r>d)return;r>p&&(p=r)}if(r=o-l,g||!(r<0)){if(r/=g,g<0){if(r>d)return;r>p&&(p=r)}else if(g>0){if(r<p)return;r<d&&(d=r)}return!(p>0||d<1)||(p>0&&(t[0]=[u+p*f,l+p*g]),d<1&&(t[1]=[u+d*f,l+d*g]),!0)}}}}}function ks(t,e,n,i,o){var r=t[1];if(r)return!0;var s,a,u=t[0],l=t.left,c=t.right,h=l[0],p=l[1],d=c[0],f=c[1],g=(h+d)/2,m=(p+f)/2;if(f===p){if(g<e||g>=i)return;if(h>d){if(u){if(u[1]>=o)return}else u=[g,n];r=[g,o]}else{if(u){if(u[1]<n)return}else u=[g,o];r=[g,n]}}else if(s=(h-d)/(f-p),a=m-s*g,s<-1||s>1)if(h>d){if(u){if(u[1]>=o)return}else u=[(n-a)/s,n];r=[(o-a)/s,o]}else{if(u){if(u[1]<n)return}else u=[(o-a)/s,o];r=[(n-a)/s,n]}else if(p<f){if(u){if(u[0]>=i)return}else u=[e,s*e+a];r=[i,s*i+a]}else{if(u){if(u[0]<e)return}else u=[i,s*i+a];r=[e,s*e+a]}return t[0]=u,t[1]=r,!0}function $s(t,e,n,i){for(var o,r=pb.length;r--;)ks(o=pb[r],t,e,n,i)&&Fs(o,t,e,n,i)&&(Math.abs(o[0][0]-o[1][0])>gb||Math.abs(o[0][1]-o[1][1])>gb)||delete pb[r]}function Ls(t){return cb[t.index]={site:t,halfedges:[]}}function Us(t,e){var n=t.site,i=e.left,o=e.right;return n===o&&(o=i,i=n),o?Math.atan2(o[1]-i[1],o[0]-i[0]):(n===i?(i=e[1],o=e[0]):(i=e[0],o=e[1]),Math.atan2(i[0]-o[0],o[1]-i[1]))}function Bs(t,e){return e[+(e.left!==t.site)]}function Ps(t,e){return e[+(e.left===t.site)]}function Qs(){for(var t,e,n,i,o=0,r=cb.length;o<r;++o)if((t=cb[o])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=Us(t,pb[e[n]]);for(s.sort(function(t,e){return a[e]-a[t]}),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}}function Vs(t,e,n,i){var o,r,s,a,u,l,c,h,p,d,f,g,m=cb.length,v=!0;for(o=0;o<m;++o)if(r=cb[o]){for(s=r.site,u=r.halfedges,a=u.length;a--;)pb[u[a]]||u.splice(a,1);for(a=0,l=u.length;a<l;)d=Ps(r,pb[u[a]]),f=d[0],g=d[1],c=Bs(r,pb[u[++a%l]]),h=c[0],p=c[1],(Math.abs(f-h)>gb||Math.abs(g-p)>gb)&&(u.splice(a,0,pb.push(Ds(s,d,Math.abs(f-t)<gb&&i-g>gb?[t,Math.abs(h-t)<gb?p:i]:Math.abs(g-i)<gb&&n-f>gb?[Math.abs(p-i)<gb?h:n,i]:Math.abs(f-n)<gb&&g-e>gb?[n,Math.abs(h-n)<gb?p:e]:Math.abs(g-e)<gb&&f-t>gb?[Math.abs(p-e)<gb?h:t,e]:null))-1),++l);l&&(v=!1)}if(v){var y,b,S,x=1/0;for(o=0,v=null;o<m;++o)(r=cb[o])&&(s=r.site,y=s[0]-t,b=s[1]-e,S=y*y+b*b,S<x&&(x=S,v=r));if(v){var C=[t,e],E=[t,i],w=[n,i],A=[n,e];v.halfedges.push(pb.push(Ds(s=v.site,C,E))-1,pb.push(Ds(s,E,w))-1,pb.push(Ds(s,w,A))-1,pb.push(Ds(s,A,C))-1)}}for(o=0;o<m;++o)(r=cb[o])&&(r.halfedges.length||delete cb[o])}function Hs(){Os(this),this.x=this.y=this.arc=this.site=this.cy=null}function qs(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,o=t.site,r=n.site;if(i!==r){var s=o[0],a=o[1],u=i[0]-s,l=i[1]-a,c=r[0]-s,h=r[1]-a,p=2*(u*h-l*c);if(!(p>=-mb)){var d=u*u+l*l,f=c*c+h*h,g=(h*d-l*f)/p,m=(u*f-c*d)/p,v=db.pop()||new Hs;v.arc=t,v.site=o,v.x=g+s,v.y=(v.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=v;for(var y=null,b=hb._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}hb.insert(y,v),y||(ub=v)}}}}function js(t){var e=t.circle;e&&(e.P||(ub=e.N),hb.remove(e),db.push(e),Os(e),t.circle=null)}function zs(){Os(this),this.edge=this.site=this.circle=null}function Ws(t){var e=fb.pop()||new zs;return e.site=t,e}function Ys(t){js(t),lb.remove(t),fb.push(t),Os(t)}function Gs(t){var e=t.circle,n=e.x,i=e.cy,o=[n,i],r=t.P,s=t.N,a=[t];Ys(t);for(var u=r;u.circle&&Math.abs(n-u.circle.x)<gb&&Math.abs(i-u.circle.cy)<gb;)r=u.P,a.unshift(u),Ys(u),u=r;a.unshift(u),js(u);for(var l=s;l.circle&&Math.abs(n-l.circle.x)<gb&&Math.abs(i-l.circle.cy)<gb;)s=l.N,a.push(l),Ys(l),l=s;a.push(l),js(l);var c,h=a.length;for(c=1;c<h;++c)l=a[c],u=a[c-1],Is(l.edge,u.site,l.site,o);u=a[0],l=a[h-1],l.edge=Rs(u.site,l.site,null,o),qs(u),qs(l)}function Ks(t){for(var e,n,i,o,r=t[0],s=t[1],a=lb._;a;)if(i=Xs(a,s)-r,i>gb)a=a.L;else{if(o=r-Js(a,s),!(o>gb)){i>-gb?(e=a.P,n=a):o>-gb?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}Ls(t);var u=Ws(t);if(lb.insert(e,u),e||n){if(e===n)return js(e),n=Ws(e.site),lb.insert(u,n),u.edge=n.edge=Rs(e.site,u.site),qs(e),void qs(n);if(!n)return void(u.edge=Rs(e.site,u.site));js(e),js(n);var l=e.site,c=l[0],h=l[1],p=t[0]-c,d=t[1]-h,f=n.site,g=f[0]-c,m=f[1]-h,v=2*(p*m-d*g),y=p*p+d*d,b=g*g+m*m,S=[(m*y-d*b)/v+c,(p*b-g*y)/v+h];Is(n.edge,l,f,S),u.edge=Rs(l,t,null,S),n.edge=Rs(t,f,null,S),qs(e),qs(n)}}function Xs(t,e){var n=t.site,i=n[0],o=n[1],r=o-e;if(!r)return i;var s=t.P;if(!s)return-(1/0);n=s.site;var a=n[0],u=n[1],l=u-e;if(!l)return a;var c=a-i,h=1/r-1/l,p=c/l;return h?(-p+Math.sqrt(p*p-2*h*(c*c/(-2*l)-u+l/2+o-r/2)))/h+i:(i+a)/2}function Js(t,e){var n=t.N;if(n)return Xs(n,e);var i=t.site;return i[1]===e?i[0]:1/0}function Zs(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function ta(t,e){return e[1]-t[1]||e[0]-t[0]}function ea(t,e){var n,i,o,r=t.sort(ta).pop();for(pb=[],cb=new Array(t.length),lb=new Ts,hb=new Ts;;)if(o=ub,r&&(!o||r[1]<o.y||r[1]===o.y&&r[0]<o.x))r[0]===n&&r[1]===i||(Ks(r),n=r[0],i=r[1]),r=t.pop();else{if(!o)break;Gs(o.arc)}if(Qs(),e){var s=+e[0][0],a=+e[0][1],u=+e[1][0],l=+e[1][1];$s(s,a,u,l),Vs(s,a,u,l)}this.edges=pb,this.cells=cb,lb=hb=pb=cb=null}function na(t,e,n){this.target=t,this.type=e,this.transform=n}function ia(t,e,n){this.k=t,this.x=e,this.y=n}function oa(t){return t.__zoom||bb}function ra(){t.event.stopImmediatePropagation()}function sa(){return!t.event.button}function aa(){var t,e,n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,t=n.width.baseVal.value,e=n.height.baseVal.value):(t=n.clientWidth,e=n.clientHeight),[[0,0],[t,e]]}function ua(){return this.__zoom||bb}function la(){t.event.stopImmediatePropagation()}function ca(t){return{type:t}}function ha(){return!t.event.button}function pa(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function da(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function fa(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ga(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function ma(){return ya(Mb)}function va(){return ya(Nb)}function ya(e){function n(t){var n=t.property("__brush",a).selectAll(".overlay").data([ca("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Db.overlay).merge(n).each(function(){var t=da(this).extent;xv(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([ca("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Db.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var o=t.selectAll(".handle").data(e.handles,function(t){return t.type});o.exit().remove(),o.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return Db[t.type]}),t.each(i).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",s)}function i(){var t=xv(this),e=da(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-p/2:e[0][0]-p/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-p/2:e[0][1]-p/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+p:p}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+p:p})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function o(t,e){return t.__brush.emitter||new r(t,e)}function r(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function s(){function n(){var t=Bm(w);!$||C||E||(Math.abs(t[0]-U[0])>Math.abs(t[1]-U[1])?E=!0:C=!0),U=t,x=!0,wb(),r()}function r(){var t;switch(b=U[0]-L[0],S=U[1]-L[1],T){case Tb:case Ab:O&&(b=Math.max(D-h,Math.min(F-g,b)),p=h+b,m=g+b),_&&(S=Math.max(I-d,Math.min(k-v,S)),f=d+S,y=v+S);break;case Ob:O<0?(b=Math.max(D-h,Math.min(F-h,b)),p=h+b,m=g):O>0&&(b=Math.max(D-g,Math.min(F-g,b)),p=h,m=g+b),_<0?(S=Math.max(I-d,Math.min(k-d,S)),f=d+S,y=v):_>0&&(S=Math.max(I-v,Math.min(k-v,S)),f=d,y=v+S);break;case _b:O&&(p=Math.max(D,Math.min(F,h-b*O)),m=Math.max(D,Math.min(F,g+b*O))),_&&(f=Math.max(I,Math.min(k,d-S*_)),y=Math.max(I,Math.min(k,v+S*_)))}m<p&&(O*=-1,t=h,h=g,g=t,t=p,p=m,m=t,A in Ib&&Q.attr("cursor",Db[A=Ib[A]])),y<f&&(_*=-1,t=d,d=v,v=t,t=f,f=y,y=t,A in Fb&&Q.attr("cursor",Db[A=Fb[A]])),M.selection&&(R=M.selection),C&&(p=R[0][0],m=R[1][0]),E&&(f=R[0][1],y=R[1][1]),R[0][0]===p&&R[0][1]===f&&R[1][0]===m&&R[1][1]===y||(M.selection=[[p,f],[m,y]],i.call(w),B.brush())}function s(){if(la(),t.event.touches){if(t.event.touches.length)return;u&&clearTimeout(u),u=setTimeout(function(){u=null},500),P.on("touchmove.brush touchend.brush touchcancel.brush",null)}else bs(t.event.view,x),V.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);P.attr("pointer-events","all"),Q.attr("cursor",Db.overlay),M.selection&&(R=M.selection),fa(R)&&(M.selection=null,i.call(w)),B.end()}function a(){switch(t.event.keyCode){case 16:$=O&&_;break;case 18:T===Ob&&(O&&(g=m-b*O,h=p+b*O),_&&(v=y-S*_,d=f+S*_),T=_b,r());break;case 32:T!==Ob&&T!==_b||(O<0?g=m-b:O>0&&(h=p-b),_<0?v=y-S:_>0&&(d=f-S),T=Tb,Q.attr("cursor",Db.selection),r());break;default:return}wb()}function l(){switch(t.event.keyCode){case 16:$&&(C=E=$=!1,r());break;case 18:T===_b&&(O<0?g=m:O>0&&(h=p),_<0?v=y:_>0&&(d=f),T=Ob,r());break;case 32:T===Tb&&(t.event.altKey?(O&&(g=m-b*O,h=p+b*O),_&&(v=y-S*_,d=f+S*_),T=_b):(O<0?g=m:O>0&&(h=p),_<0?v=y:_>0&&(d=f),T=Ob),Q.attr("cursor",Db[A]),r());break;default:return}wb()}if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return wb()}else if(u)return;if(c.apply(this,arguments)){var h,p,d,f,g,m,v,y,b,S,x,C,E,w=this,A=t.event.target.__data__.type,T="selection"===(t.event.metaKey?A="overlay":A)?Ab:t.event.altKey?_b:Ob,O=e===Nb?null:kb[A],_=e===Mb?null:$b[A],M=da(w),N=M.extent,R=M.selection,D=N[0][0],I=N[0][1],F=N[1][0],k=N[1][1],$=O&&_&&t.event.shiftKey,L=Bm(w),U=L,B=o(w,arguments).beforestart();"overlay"===A?M.selection=R=[[h=e===Nb?D:L[0],d=e===Mb?I:L[1]],[g=e===Nb?F:h,v=e===Mb?k:d]]:(h=R[0][0],d=R[0][1],g=R[1][0],v=R[1][1]),p=h,f=d,m=g,y=v;var P=xv(w).attr("pointer-events","none"),Q=P.selectAll(".overlay").attr("cursor",Db[A]);if(t.event.touches)P.on("touchmove.brush",n,!0).on("touchend.brush touchcancel.brush",s,!0);else{
var V=xv(t.event.view).on("keydown.brush",a,!0).on("keyup.brush",l,!0).on("mousemove.brush",n,!0).on("mouseup.brush",s,!0);ob(t.event.view)}la(),kv(w),i.call(w),B.start()}}function a(){var t=this.__brush||{selection:null};return t.extent=l.apply(this,arguments),t.dim=e,t}var u,l=pa,c=ha,h=Re(n,"start","brush","end"),p=6;return n.move=function(t,n){t.selection?t.on("start.brush",function(){o(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){o(this,arguments).end()}).tween("brush",function(){function t(t){s.selection=1===t&&fa(l)?null:c(t),i.call(r),a.brush()}var r=this,s=r.__brush,a=o(r,arguments),u=s.selection,l=e.input("function"==typeof n?n.apply(this,arguments):n,s.extent),c=yd(u,l);return u&&l?t:t(1)}):t.each(function(){var t=this,r=arguments,s=t.__brush,a=e.input("function"==typeof n?n.apply(t,r):n,s.extent),u=o(t,r).beforestart();kv(t),s.selection=null==a||fa(a)?null:a,i.call(t),u.start().brush().end()})},r.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0===--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){ji(new Eb(n,t,e.output(this.state.selection)),h.apply,h,[t,this.that,this.args])}},n.extent=function(t){return arguments.length?(l="function"==typeof t?t:Cb([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),n):l},n.filter=function(t){return arguments.length?(c="function"==typeof t?t:Cb(!!t),n):c},n.handleSize=function(t){return arguments.length?(p=+t,n):p},n.on=function(){var t=h.on.apply(h,arguments);return t===h?n:t},n}function ba(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}function Sa(t){return t.source}function xa(t){return t.target}function Ca(t){return t.radius}function Ea(t){return t.startAngle}function wa(t){return t.endAngle}function Aa(){this.reset()}function Ta(t,e,n){var i=t.s=e+n,o=i-e,r=i-o;t.t=e-r+(n-o)}function Oa(t){return t>1?0:t<-1?MS:Math.acos(t)}function _a(t){return t>1?NS:t<-1?-NS:Math.asin(t)}function Ma(t){return(t=HS(t/2))*t}function Na(){}function Ra(t,e){t&&YS.hasOwnProperty(t.type)&&YS[t.type](t,e)}function Da(t,e,n){var i,o=-1,r=t.length-n;for(e.lineStart();++o<r;)i=t[o],e.point(i[0],i[1],i[2]);e.lineEnd()}function Ia(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Da(t[n],e,1);e.polygonEnd()}function Fa(){JS.point=$a}function ka(){La(Gb,Kb)}function $a(t,e){JS.point=La,Gb=t,Kb=e,t*=FS,e*=FS,Xb=t,Jb=US(e=e/2+RS),Zb=HS(e)}function La(t,e){t*=FS,e*=FS,e=e/2+RS;var n=t-Xb,i=n>=0?1:-1,o=i*n,r=US(e),s=HS(e),a=Zb*s,u=Jb*r+a*US(o),l=a*i*HS(o);KS.add(LS(l,u)),Xb=t,Jb=r,Zb=s}function Ua(t){return[LS(t[1],t[0]),_a(t[2])]}function Ba(t){var e=t[0],n=t[1],i=US(n);return[i*US(e),i*HS(e),HS(n)]}function Pa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Qa(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Va(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ha(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function qa(t){var e=jS(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function ja(t,e){uS.push(lS=[tS=t,nS=t]),e<eS&&(eS=e),e>iS&&(iS=e)}function za(t,e){var n=Ba([t*FS,e*FS]);if(aS){var i=Qa(aS,n),o=[i[1],-i[0],0],r=Qa(o,i);qa(r),r=Ua(r);var s,a=t-oS,u=a>0?1:-1,l=r[0]*IS*u,c=kS(a)>180;c^(u*oS<l&&l<u*t)?(s=r[1]*IS,s>iS&&(iS=s)):(l=(l+360)%360-180,c^(u*oS<l&&l<u*t)?(s=-r[1]*IS,s<eS&&(eS=s)):(e<eS&&(eS=e),e>iS&&(iS=e))),c?t<oS?Ja(tS,t)>Ja(tS,nS)&&(nS=t):Ja(t,nS)>Ja(tS,nS)&&(tS=t):nS>=tS?(t<tS&&(tS=t),t>nS&&(nS=t)):t>oS?Ja(tS,t)>Ja(tS,nS)&&(nS=t):Ja(t,nS)>Ja(tS,nS)&&(tS=t)}else ja(t,e);aS=n,oS=t}function Wa(){ex.point=za}function Ya(){lS[0]=tS,lS[1]=nS,ex.point=ja,aS=null}function Ga(t,e){if(aS){var n=t-oS;tx.add(kS(n)>180?n+(n>0?360:-360):n)}else rS=t,sS=e;JS.point(t,e),za(t,e)}function Ka(){JS.lineStart()}function Xa(){Ga(rS,sS),JS.lineEnd(),kS(tx)>OS&&(tS=-(nS=180)),lS[0]=tS,lS[1]=nS,aS=null}function Ja(t,e){return(e-=t)<0?e+360:e}function Za(t,e){return t[0]-e[0]}function tu(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function eu(t,e){t*=FS,e*=FS;var n=US(e);nu(n*US(t),n*HS(t),HS(e))}function nu(t,e,n){++cS,pS+=(t-pS)/cS,dS+=(e-dS)/cS,fS+=(n-fS)/cS}function iu(){ix.point=ou}function ou(t,e){t*=FS,e*=FS;var n=US(e);ES=n*US(t),wS=n*HS(t),AS=HS(e),ix.point=ru,nu(ES,wS,AS)}function ru(t,e){t*=FS,e*=FS;var n=US(e),i=n*US(t),o=n*HS(t),r=HS(e),s=LS(jS((s=wS*r-AS*o)*s+(s=AS*i-ES*r)*s+(s=ES*o-wS*i)*s),ES*i+wS*o+AS*r);hS+=s,gS+=s*(ES+(ES=i)),mS+=s*(wS+(wS=o)),vS+=s*(AS+(AS=r)),nu(ES,wS,AS)}function su(){ix.point=eu}function au(){ix.point=lu}function uu(){cu(xS,CS),ix.point=eu}function lu(t,e){xS=t,CS=e,t*=FS,e*=FS,ix.point=cu;var n=US(e);ES=n*US(t),wS=n*HS(t),AS=HS(e),nu(ES,wS,AS)}function cu(t,e){t*=FS,e*=FS;var n=US(e),i=n*US(t),o=n*HS(t),r=HS(e),s=wS*r-AS*o,a=AS*i-ES*r,u=ES*o-wS*i,l=jS(s*s+a*a+u*u),c=ES*i+wS*o+AS*r,h=l&&-Oa(c)/l,p=LS(l,c);yS+=h*s,bS+=h*a,SS+=h*u,hS+=p,gS+=p*(ES+(ES=i)),mS+=p*(wS+(wS=o)),vS+=p*(AS+(AS=r)),nu(ES,wS,AS)}function hu(t,e){return[t>MS?t-DS:t<-MS?t+DS:t,e]}function pu(t,e,n){return(t%=DS)?e||n?sx(fu(t),gu(e,n)):fu(t):e||n?gu(e,n):hu}function du(t){return function(e,n){return e+=t,[e>MS?e-DS:e<-MS?e+DS:e,n]}}function fu(t){var e=du(t);return e.invert=du(-t),e}function gu(t,e){function n(t,e){var n=US(e),a=US(t)*n,u=HS(t)*n,l=HS(e),c=l*i+a*o;return[LS(u*r-c*s,a*i-l*o),_a(c*r+u*s)]}var i=US(t),o=HS(t),r=US(e),s=HS(e);return n.invert=function(t,e){var n=US(e),a=US(t)*n,u=HS(t)*n,l=HS(e),c=l*r-u*s;return[LS(u*r+l*s,a*i+c*o),_a(c*i-a*o)]},n}function mu(t,e,n,i,o,r){if(n){var s=US(e),a=HS(e),u=i*n;null==o?(o=e+i*DS,r=e-u/2):(o=vu(s,o),r=vu(s,r),(i>0?o<r:o>r)&&(o+=i*DS));for(var l,c=o;i>0?c>r:c<r;c-=u)l=Ua([s,-a*US(c),-a*HS(c)]),t.point(l[0],l[1])}}function vu(t,e){e=Ba(e),e[0]-=t,qa(e);var n=Oa(-e[1]);return((-e[2]<0?-n:n)+DS-OS)%DS}function yu(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function bu(t){if(e=t.length){for(var e,n,i=0,o=t[0];++i<e;)o.n=n=t[i],n.p=o,o=n;o.n=n=t[0],n.p=o}}function Su(t,e,n,i){function o(o,r){return t<=o&&o<=n&&e<=r&&r<=i}function r(o,r,a,l){var c=0,h=0;if(null==o||(c=s(o,a))!==(h=s(r,a))||u(o,r)<0^a>0){do l.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+a+4)%4)!==h)}else l.point(r[0],r[1])}function s(i,o){return kS(i[0]-t)<OS?o>0?0:3:kS(i[0]-n)<OS?o>0?2:1:kS(i[1]-e)<OS?o>0?1:0:o>0?3:2}function a(t,e){return u(t.x,e.x)}function u(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function u(t,e){o(t,e)&&T.point(t,e)}function l(){for(var e=0,n=0,o=m.length;n<o;++n)for(var r,s,a=m[n],u=1,l=a.length,c=a[0],h=c[0],p=c[1];u<l;++u)r=h,s=p,c=a[u],h=c[0],p=c[1],s<=i?p>i&&(h-r)*(i-s)>(p-s)*(t-r)&&++e:p<=i&&(h-r)*(i-s)<(p-s)*(t-r)&&--e;return e}function c(){T=O,g=[],m=[],A=!0}function h(){var t=l(),e=A&&t,n=(g=Xl(g)).length;(e||n)&&(s.polygonStart(),e&&(s.lineStart(),r(null,null,1,s),s.lineEnd()),n&&Ex(g,a,t,r,s),s.polygonEnd()),T=s,g=m=v=null}function p(){_.point=f,m&&m.push(v=[]),w=!0,E=!1,x=C=NaN}function d(){g&&(f(y,b),S&&E&&O.rejoin(),g.push(O.result())),_.point=u,E&&T.lineEnd()}function f(r,s){var a=o(r,s);if(m&&v.push([r,s]),w)y=r,b=s,S=a,w=!1,a&&(T.lineStart(),T.point(r,s));else if(a&&E)T.point(r,s);else{var u=[x=Math.max(Ax,Math.min(wx,x)),C=Math.max(Ax,Math.min(wx,C))],l=[r=Math.max(Ax,Math.min(wx,r)),s=Math.max(Ax,Math.min(wx,s))];xx(u,l,t,e,n,i)?(E||(T.lineStart(),T.point(u[0],u[1])),T.point(l[0],l[1]),a||T.lineEnd(),A=!1):a&&(T.lineStart(),T.point(r,s),A=!1)}x=r,C=s,E=a}var g,m,v,y,b,S,x,C,E,w,A,T=s,O=Sx(),_={point:u,lineStart:p,lineEnd:d,polygonStart:c,polygonEnd:h};return _}}function xu(){_x.point=Eu,_x.lineEnd=Cu}function Cu(){_x.point=_x.lineEnd=Na}function Eu(t,e){t*=FS,e*=FS,ax=t,ux=HS(e),lx=US(e),_x.point=wu}function wu(t,e){t*=FS,e*=FS;var n=HS(e),i=US(e),o=kS(t-ax),r=US(o),s=HS(o),a=i*s,u=lx*n-ux*i*r,l=ux*n+lx*i*r;Ox.add(LS(jS(a*a+u*u),l)),ax=t,ux=n,lx=i}function Au(t,e,n){var i=Ul(t,e-OS,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function Tu(t,e,n){var i=Ul(t,e-OS,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function Ou(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Ul(BS(r/m)*m,o,m).map(p).concat(Ul(BS(l/v)*v,u,v).map(d)).concat(Ul(BS(i/f)*f,n,f).filter(function(t){return kS(t%m)>OS}).map(c)).concat(Ul(BS(a/g)*g,s,g).filter(function(t){return kS(t%v)>OS}).map(h))}var n,i,o,r,s,a,u,l,c,h,p,d,f=10,g=f,m=90,v=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(d(u).slice(1),p(o).reverse().slice(1),d(l).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.extentMajor(e).extentMinor(e):t.extentMinor()},t.extentMajor=function(e){return arguments.length?(r=+e[0][0],o=+e[1][0],l=+e[0][1],u=+e[1][1],r>o&&(e=r,r=o,o=e),l>u&&(e=l,l=u,u=e),t.precision(y)):[[r,l],[o,u]]},t.extentMinor=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],a=+e[0][1],s=+e[1][1],i>n&&(e=i,i=n,n=e),a>s&&(e=a,a=s,s=e),t.precision(y)):[[i,a],[n,s]]},t.step=function(e){return arguments.length?t.stepMajor(e).stepMinor(e):t.stepMinor()},t.stepMajor=function(e){return arguments.length?(m=+e[0],v=+e[1],t):[m,v]},t.stepMinor=function(e){return arguments.length?(f=+e[0],g=+e[1],t):[f,g]},t.precision=function(e){return arguments.length?(y=+e,c=Au(a,s,90),h=Tu(i,n,y),p=Au(l,u,90),d=Tu(r,o,y),t):y},t.extentMajor([[-180,-90+OS],[180,90-OS]]).extentMinor([[-180,-80-OS],[180,80+OS]])}function _u(){return Ou()()}function Mu(){Lx.point=Nu}function Nu(t,e){Lx.point=Ru,cx=px=t,hx=dx=e}function Ru(t,e){$x.add(dx*t-px*e),px=t,dx=e}function Du(){Ru(cx,hx)}function Iu(t,e){t<Ux&&(Ux=t),t>Px&&(Px=t),e<Bx&&(Bx=e),e>Qx&&(Qx=e)}function Fu(t,e){Hx+=t,qx+=e,++jx}function ku(){Jx.point=$u}function $u(t,e){Jx.point=Lu,Fu(mx=t,vx=e)}function Lu(t,e){var n=t-mx,i=e-vx,o=jS(n*n+i*i);zx+=o*(mx+t)/2,Wx+=o*(vx+e)/2,Yx+=o,Fu(mx=t,vx=e)}function Uu(){Jx.point=Fu}function Bu(){Jx.point=Qu}function Pu(){Vu(fx,gx)}function Qu(t,e){Jx.point=Vu,Fu(fx=mx=t,gx=vx=e)}function Vu(t,e){var n=t-mx,i=e-vx,o=jS(n*n+i*i);zx+=o*(mx+t)/2,Wx+=o*(vx+e)/2,Yx+=o,o=vx*t-mx*e,Gx+=o*(mx+t),Kx+=o*(vx+e),Xx+=3*o,Fu(mx=t,vx=e)}function Hu(t){this._context=t}function qu(){this._string=[]}function ju(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function zu(t){return t.length>1}function Wu(t,e){return((t=t.x)[0]<0?t[1]-NS-OS:NS-t[1])-((e=e.x)[0]<0?e[1]-NS-OS:NS-e[1])}function Yu(t){var e,n=NaN,i=NaN,o=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(r,s){var a=r>0?MS:-MS,u=kS(r-n);kS(u-MS)<OS?(t.point(n,i=(i+s)/2>0?NS:-NS),t.point(o,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(r,i),e=0):o!==a&&u>=MS&&(kS(n-o)<OS&&(n-=o*OS),kS(r-a)<OS&&(r-=a*OS),i=Gu(n,i,r,s),t.point(o,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=r,i=s),o=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}function Gu(t,e,n,i){var o,r,s=HS(t-n);return kS(s)>OS?$S((HS(e)*(r=US(i))*HS(n)-HS(i)*(o=US(e))*HS(t))/(o*r*s)):(e+i)/2}function Ku(t,e,n,i){var o;if(null==t)o=n*NS,i.point(-MS,o),i.point(0,o),i.point(MS,o),i.point(MS,0),i.point(MS,-o),i.point(0,-o),i.point(-MS,-o),i.point(-MS,0),i.point(-MS,o);else if(kS(t[0]-e[0])>OS){var r=t[0]<e[0]?MS:-MS;o=n*r/2,i.point(-r,o),i.point(0,o),i.point(r,o)}else i.point(e[0],e[1])}function Xu(t){return function(e){var n=new Ju;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Ju(){}function Zu(t,e,n){var i=e[1][0]-e[0][0],o=e[1][1]-e[0][1],r=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),GS(n,t.stream(Vx));var s=Vx.result(),a=Math.min(i/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),u=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,l=+e[0][1]+(o-a*(s[1][1]+s[0][1]))/2;return null!=r&&t.clipExtent(r),t.scale(150*a).translate([u,l])}function tl(t,e,n){return Zu(t,[[0,0],e],n)}function el(t){return Xu({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function nl(t,e){function n(i,o,r,s,a,u,l,c,h,p,d,f,g,m){var v=l-i,y=c-o,b=v*v+y*y;if(b>4*e&&g--){var S=s+p,x=a+d,C=u+f,E=jS(S*S+x*x+C*C),w=_a(C/=E),A=kS(kS(C)-1)<OS||kS(r-h)<OS?(r+h)/2:LS(x,S),T=t(A,w),O=T[0],_=T[1],M=O-i,N=_-o,R=y*M-v*N;(R*R/b>e||kS((v*M+y*N)/b-.5)>.3||s*p+a*d+u*f<aC)&&(n(i,o,r,s,a,u,O,_,A,S/=E,x/=E,C,g,m),m.point(O,_),n(O,_,A,S,x,C,l,c,h,p,d,f,g,m))}}return function(e){function i(n,i){n=t(n,i),e.point(n[0],n[1])}function o(){v=NaN,C.point=r,e.lineStart()}function r(i,o){var r=Ba([i,o]),s=t(i,o);n(v,y,m,b,S,x,v=s[0],y=s[1],m=i,b=r[0],S=r[1],x=r[2],sC,e),e.point(v,y)}function s(){C.point=i,e.lineEnd()}function a(){o(),C.point=u,C.lineEnd=l}function u(t,e){r(c=t,e),h=v,p=y,d=b,f=S,g=x,C.point=r}function l(){n(v,y,m,b,S,x,h,p,c,d,f,g,sC,e),C.lineEnd=s,s()}var c,h,p,d,f,g,m,v,y,b,S,x,C={point:i,lineStart:o,lineEnd:s,polygonStart:function(){e.polygonStart(),C.lineStart=a},polygonEnd:function(){e.polygonEnd(),C.lineStart=o}};return C}}function il(t){return ol(function(){return t})()}function ol(t){function e(t){return t=c(t[0]*FS,t[1]*FS),[t[0]*m+a,u-t[1]*m]}function n(t){return t=c.invert((t[0]-a)/m,(u-t[1])/m),t&&[t[0]*IS,t[1]*IS]}function i(t,e){return t=s(t,e),[t[0]*m+a,u-t[1]*m]}function o(){c=sx(l=pu(x,C,E),s);var t=s(b,S);return a=v-t[0]*m,u=y+t[1]*m,r()}function r(){return f=g=null,e}var s,a,u,l,c,h,p,d,f,g,m=150,v=480,y=250,b=0,S=0,x=0,C=0,E=0,w=null,A=iC,T=null,O=Fx,_=.5,M=uC(i,_);return e.stream=function(t){return f&&g===t?f:f=lC(A(l,M(O(g=t))))},e.clipAngle=function(t){return arguments.length?(A=+t?oC(w=t*FS,6*FS):(w=null,iC),r()):w*IS},e.clipExtent=function(t){return arguments.length?(O=null==t?(T=h=p=d=null,Fx):Su(T=+t[0][0],h=+t[0][1],p=+t[1][0],d=+t[1][1]),r()):null==T?null:[[T,h],[p,d]]},e.scale=function(t){return arguments.length?(m=+t,o()):m},e.translate=function(t){return arguments.length?(v=+t[0],y=+t[1],o()):[v,y]},e.center=function(t){return arguments.length?(b=t[0]%360*FS,S=t[1]%360*FS,o()):[b*IS,S*IS]},e.rotate=function(t){return arguments.length?(x=t[0]%360*FS,C=t[1]%360*FS,E=t.length>2?t[2]%360*FS:0,o()):[x*IS,C*IS,E*IS]},e.precision=function(t){return arguments.length?(M=uC(i,_=t*t),r()):jS(_)},e.fitExtent=function(t,n){return Zu(e,t,n)},e.fitSize=function(t,n){return tl(e,t,n)},function(){return s=t.apply(this,arguments),e.invert=s.invert&&n,o()}}function rl(t){var e=0,n=MS/3,i=ol(t),o=i(e,n);return o.parallels=function(t){return arguments.length?i(e=t[0]*FS,n=t[1]*FS):[e*IS,n*IS]},o}function sl(t){function e(t,e){return[t*n,HS(e)/n]}var n=US(t);return e.invert=function(t,e){return[t/n,_a(e*n)]},e}function al(t,e){function n(t,e){var n=jS(r-2*o*HS(e))/o;return[n*HS(t*=o),s-n*US(t)]}var i=HS(t),o=(i+HS(e))/2;if(kS(o)<OS)return sl(t);var r=1+i*(2*o-i),s=jS(r)/o;return n.invert=function(t,e){var n=s-e;return[LS(t,kS(n))/o*qS(n),_a((r-(t*t+n*n)*o*o)/(2*o))]},n}function ul(t){var e=t.length;return{point:function(n,i){for(var o=-1;++o<e;)t[o].point(n,i)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function ll(t){return function(e,n){var i=US(e),o=US(n),r=t(i*o);return[r*o*HS(e),r*HS(n)]}}function cl(t){return function(e,n){var i=jS(e*e+n*n),o=t(i),r=HS(o),s=US(o);return[LS(e*r,i*s),_a(i&&n*r/i)]}}function hl(t,e){return[t,QS(zS((NS+e)/2))]}function pl(t){var e,n=il(t),i=n.scale,o=n.translate,r=n.clipExtent;return n.scale=function(t){return arguments.length?(i(t),e&&n.clipExtent(null),n):i()},n.translate=function(t){return arguments.length?(o(t),e&&n.clipExtent(null),n):o()},n.clipExtent=function(t){if(!arguments.length)return e?null:r();if(e=null==t){var s=MS*i(),a=o();t=[[a[0]-s,a[1]-s],[a[0]+s,a[1]+s]]}return r(t),n},n.clipExtent(null)}function dl(t){return zS((NS+t)/2)}function fl(t,e){function n(t,e){r>0?e<-NS+OS&&(e=-NS+OS):e>NS-OS&&(e=NS-OS);var n=r/VS(dl(e),o);return[n*HS(o*t),r-n*US(o*t)]}var i=US(t),o=t===e?HS(t):QS(i/US(e))/QS(dl(e)/dl(t)),r=i*VS(dl(t),o)/o;return o?(n.invert=function(t,e){var n=r-e,i=qS(o)*jS(t*t+n*n);return[LS(t,kS(n))/o*qS(n),2*$S(VS(r/i,1/o))-NS]},n):hl}function gl(t,e){return[t,e]}function ml(t,e){function n(t,e){var n=r-e,i=o*t;return[n*HS(i),r-n*US(i)]}var i=US(t),o=t===e?HS(t):(i-US(e))/(e-t),r=i/o+t;return kS(o)<OS?gl:(n.invert=function(t,e){var n=r-e;return[LS(t,kS(n))/o*qS(n),r-qS(o)*jS(t*t+n*n)]},n)}function vl(t,e){var n=US(e),i=US(t)*n;return[n*HS(t)/i,HS(e)/i]}function yl(t,e,n,i){return 1===t&&1===e&&0===n&&0===i?Fx:Xu({point:function(o,r){this.stream.point(o*t+n,r*e+i)}})}function bl(t,e){return[US(e)*HS(t),HS(e)]}function Sl(t,e){var n=US(e),i=1+US(t)*n;return[n*HS(t)/i,HS(e)/i]}function xl(t,e){return[QS(zS((NS+e)/2)),-t]}var Cl="4.4.0",El=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},wl=function(t){return 1===t.length&&(t=e(t)),{left:function(e,n,i,o){for(null==i&&(i=0),null==o&&(o=e.length);i<o;){var r=i+o>>>1;t(e[r],n)<0?i=r+1:o=r}return i},right:function(e,n,i,o){for(null==i&&(i=0),null==o&&(o=e.length);i<o;){var r=i+o>>>1;t(e[r],n)>0?o=r:i=r+1}return i}}},Al=wl(El),Tl=Al.right,Ol=Al.left,_l=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Ml=function(t){return null===t?NaN:+t},Nl=function(t,e){var n,i,o=t.length,r=0,s=0,a=-1,u=0;if(null==e)for(;++a<o;)isNaN(n=Ml(t[a]))||(i=n-r,r+=i/++u,s+=i*(n-r));else for(;++a<o;)isNaN(n=Ml(e(t[a],a,t)))||(i=n-r,r+=i/++u,s+=i*(n-r));if(u>1)return s/(u-1)},Rl=function(t,e){var n=Nl(t,e);return n?Math.sqrt(n):n},Dl=function(t,e){var n,i,o,r=-1,s=t.length;if(null==e){for(;++r<s;)if(null!=(i=t[r])&&i>=i){n=o=i;break}for(;++r<s;)null!=(i=t[r])&&(n>i&&(n=i),o<i&&(o=i))}else{for(;++r<s;)if(null!=(i=e(t[r],r,t))&&i>=i){n=o=i;break}for(;++r<s;)null!=(i=e(t[r],r,t))&&(n>i&&(n=i),o<i&&(o=i))}return[n,o]},Il=Array.prototype,Fl=Il.slice,kl=Il.map,$l=function(t){return function(){return t}},Ll=function(t){return t},Ul=function(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var i=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),r=new Array(o);++i<o;)r[i]=t+i*n;return r},Bl=Math.sqrt(50),Pl=Math.sqrt(10),Ql=Math.sqrt(2),Vl=function(t,e,i){var o=n(t,e,i);return Ul(Math.ceil(t/o)*o,Math.floor(e/o)*o+o/2,o)},Hl=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},ql=function(){function t(t){var o,r,s=t.length,a=new Array(s);for(o=0;o<s;++o)a[o]=e(t[o],o,t);var u=n(a),l=u[0],c=u[1],h=i(a,l,c);Array.isArray(h)||(h=Vl(l,c,h));for(var p=h.length;h[0]<=l;)h.shift(),--p;for(;h[p-1]>=c;)h.pop(),--p;var d,f=new Array(p+1);for(o=0;o<=p;++o)d=f[o]=[],d.x0=o>0?h[o-1]:l,d.x1=o<p?h[o]:c;for(o=0;o<s;++o)r=a[o],l<=r&&r<=c&&f[Tl(h,r,0,p)].push(t[o]);return f}var e=Ll,n=Dl,i=Hl;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:$l(n),t):e},t.domain=function(e){return arguments.length?(n="function"==typeof e?e:$l([e[0],e[1]]),t):n},t.thresholds=function(e){return arguments.length?(i="function"==typeof e?e:$l(Array.isArray(e)?Fl.call(e):e),t):i},t},jl=function(t,e,n){if(null==n&&(n=Ml),i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,o=(i-1)*e,r=Math.floor(o),s=+n(t[r],r,t),a=+n(t[r+1],r+1,t);return s+(a-s)*(o-r)}},zl=function(t,e,n){return t=kl.call(t,Ml).sort(El),Math.ceil((n-e)/(2*(jl(t,.75)-jl(t,.25))*Math.pow(t.length,-1/3)))},Wl=function(t,e,n){return Math.ceil((n-e)/(3.5*Rl(t)*Math.pow(t.length,-1/3)))},Yl=function(t,e){var n,i,o=-1,r=t.length;if(null==e){for(;++o<r;)if(null!=(i=t[o])&&i>=i){n=i;break}for(;++o<r;)null!=(i=t[o])&&i>n&&(n=i)}else{for(;++o<r;)if(null!=(i=e(t[o],o,t))&&i>=i){n=i;break}for(;++o<r;)null!=(i=e(t[o],o,t))&&i>n&&(n=i)}return n},Gl=function(t,e){var n,i=0,o=t.length,r=-1,s=o;if(null==e)for(;++r<o;)isNaN(n=Ml(t[r]))?--s:i+=n;else for(;++r<o;)isNaN(n=Ml(e(t[r],r,t)))?--s:i+=n;if(s)return i/s},Kl=function(t,e){var n,i=[],o=t.length,r=-1;if(null==e)for(;++r<o;)isNaN(n=Ml(t[r]))||i.push(n);else for(;++r<o;)isNaN(n=Ml(e(t[r],r,t)))||i.push(n);return jl(i.sort(El),.5)},Xl=function(t){for(var e,n,i,o=t.length,r=-1,s=0;++r<o;)s+=t[r].length;for(n=new Array(s);--o>=0;)for(i=t[o],e=i.length;--e>=0;)n[--s]=i[e];return n},Jl=function(t,e){var n,i,o=-1,r=t.length;if(null==e){for(;++o<r;)if(null!=(i=t[o])&&i>=i){n=i;break}for(;++o<r;)null!=(i=t[o])&&n>i&&(n=i)}else{for(;++o<r;)if(null!=(i=e(t[o],o,t))&&i>=i){n=i;break}for(;++o<r;)null!=(i=e(t[o],o,t))&&n>i&&(n=i)}return n},Zl=function(t){for(var e=0,n=t.length-1,i=t[0],o=new Array(n<0?0:n);e<n;)o[e]=[i,i=t[++e]];return o},tc=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},ec=function(t,e){if(n=t.length){var n,i,o=0,r=0,s=t[r];for(e||(e=El);++o<n;)(e(i=t[o],s)<0||0!==e(s,s))&&(s=i,r=o);return 0===e(s,s)?r:void 0}},nc=function(t,e,n){for(var i,o,r=(null==n?t.length:n)-(e=null==e?0:+e);r;)o=Math.random()*r--|0,i=t[r+e],t[r+e]=t[o+e],t[o+e]=i;return t},ic=function(t,e){var n,i=0,o=t.length,r=-1;if(null==e)for(;++r<o;)(n=+t[r])&&(i+=n);else for(;++r<o;)(n=+e(t[r],r,t))&&(i+=n);return i},oc=function(t){if(!(r=t.length))return[];for(var e=-1,n=Jl(t,i),o=new Array(n);++e<n;)for(var r,s=-1,a=o[e]=new Array(r);++s<r;)a[s]=t[s][e];return o},rc=function(){return oc(arguments)},sc="$";o.prototype=r.prototype={constructor:o,has:function(t){return sc+t in this},get:function(t){return this[sc+t]},set:function(t,e){return this[sc+t]=e,this},remove:function(t){var e=sc+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===sc&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===sc&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===sc&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===sc&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===sc&&++t;return t},empty:function(){for(var t in this)if(t[0]===sc)return!1;return!0},each:function(t){for(var e in this)e[0]===sc&&t(this[e],e.slice(1),this)}};var ac=function(){function t(e,o,s,a){if(o>=c.length)return null!=i?i(e):null!=n?e.sort(n):e;for(var u,l,h,p=-1,d=e.length,f=c[o++],g=r(),m=s();++p<d;)(h=g.get(u=f(l=e[p])+""))?h.push(l):g.set(u,[l]);return g.each(function(e,n){a(m,n,t(e,o,s,a))}),m}function e(t,n){if(++n>c.length)return t;var o,r=h[n-1];return null!=i&&n>=c.length?o=t.entries():(o=[],t.each(function(t,i){o.push({key:i,values:e(t,n)})})),null!=r?o.sort(function(t,e){return r(t.key,e.key)}):o}var n,i,o,c=[],h=[];return o={object:function(e){return t(e,0,s,a)},map:function(e){return t(e,0,u,l)},entries:function(n){return e(t(n,0,u,l),0)},key:function(t){return c.push(t),o},sortKeys:function(t){return h[c.length-1]=t,o},sortValues:function(t){return n=t,o},rollup:function(t){return i=t,o}}},uc=r.prototype;c.prototype=h.prototype={constructor:c,has:uc.has,add:function(t){return t+="",this[sc+t]=t,this},remove:uc.remove,clear:uc.clear,values:uc.keys,size:uc.size,empty:uc.empty,each:uc.each};var lc=function(t){var e=[];for(var n in t)e.push(n);return e},cc=function(t){var e=[];for(var n in t)e.push(t[n]);return e},hc=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},pc=function(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return Math.random()*e+t}},dc=function(t,e){var n,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var o;if(null!=n)o=n,n=null;else do n=2*Math.random()-1,o=2*Math.random()-1,i=n*n+o*o;while(!i||i>1);return t+e*o*Math.sqrt(-2*Math.log(i)/i)}},fc=function(){var t=dc.apply(this,arguments);return function(){return Math.exp(t())}},gc=function(t){return function(){for(var e=0,n=0;n<t;++n)e+=Math.random();return e}},mc=function(t){var e=gc(t);return function(){return e()/t}},vc=function(t){return function(){return-Math.log(1-Math.random())/t}},yc=3,bc=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(yc),Sc=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(yc),xc=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(yc),Cc=Math.PI,Ec=Cc/2,wc=4/11,Ac=6/11,Tc=8/11,Oc=.75,_c=9/11,Mc=10/11,Nc=.9375,Rc=21/22,Dc=63/64,Ic=1/wc/wc,Fc=1.70158,kc=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(Fc),$c=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(Fc),Lc=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(Fc),Uc=2*Math.PI,Bc=1,Pc=.3,Qc=function t(e,n){function i(t){return e*Math.pow(2,10*--t)*Math.sin((o-t)/n)}var o=Math.asin(1/(e=Math.max(1,e)))*(n/=Uc);return i.amplitude=function(e){return t(e,n*Uc)},i.period=function(n){return t(e,n)},i}(Bc,Pc),Vc=function t(e,n){function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+o)/n)}var o=Math.asin(1/(e=Math.max(1,e)))*(n/=Uc);return i.amplitude=function(e){return t(e,n*Uc)},i.period=function(n){return t(e,n)},i}(Bc,Pc),Hc=function t(e,n){function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((o-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((o+t)/n))/2}var o=Math.asin(1/(e=Math.max(1,e)))*(n/=Uc);return i.amplitude=function(e){return t(e,n*Uc)},i.period=function(n){return t(e,n)},i}(Bc,Pc),qc=function(t){for(var e,n=-1,i=t.length,o=t[i-1],r=0;++n<i;)e=o,o=t[n],r+=e[1]*o[0]-e[0]*o[1];return r/2},jc=function(t){for(var e,n,i=-1,o=t.length,r=0,s=0,a=t[o-1],u=0;++i<o;)e=a,a=t[i],u+=n=e[0]*a[1]-a[0]*e[1],r+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return u*=3,[r/u,s/u]},zc=function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])},Wc=function(t){if((n=t.length)<3)return null;var e,n,i=new Array(n),o=new Array(n);for(e=0;e<n;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(R),e=0;e<n;++e)o[e]=[i[e][0],-i[e][1]];var r=D(i),s=D(o),a=s[0]===r[0],u=s[s.length-1]===r[r.length-1],l=[];for(e=r.length-1;e>=0;--e)l.push(t[i[r[e]][2]]);for(e=+a;e<s.length-u;++e)l.push(t[i[s[e]][2]]);return l},Yc=function(t,e){for(var n,i,o=t.length,r=t[o-1],s=e[0],a=e[1],u=r[0],l=r[1],c=!1,h=0;h<o;++h)r=t[h],n=r[0],i=r[1],i>a!=l>a&&s<(u-n)*(a-i)/(l-i)+n&&(c=!c),u=n,l=i;return c},Gc=function(t){for(var e,n,i=-1,o=t.length,r=t[o-1],s=r[0],a=r[1],u=0;++i<o;)e=s,n=a,r=t[i],s=r[0],a=r[1],e-=s,n-=a,u+=Math.sqrt(e*e+n*n);return u},Kc=Math.PI,Xc=2*Kc,Jc=1e-6,Zc=Xc-Jc;I.prototype=F.prototype={constructor:I,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,o,r){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+o)+","+(this._y1=+r)},arcTo:function(t,e,n,i,o){t=+t,e=+e,n=+n,i=+i,o=+o;var r=this._x1,s=this._y1,a=n-t,u=i-e,l=r-t,c=s-e,h=l*l+c*c;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Jc)if(Math.abs(c*a-u*l)>Jc&&o){var p=n-r,d=i-s,f=a*a+u*u,g=p*p+d*d,m=Math.sqrt(f),v=Math.sqrt(h),y=o*Math.tan((Kc-Math.acos((f+h-g)/(2*m*v)))/2),b=y/v,S=y/m;Math.abs(b-1)>Jc&&(this._+="L"+(t+b*l)+","+(e+b*c)),this._+="A"+o+","+o+",0,0,"+ +(c*p>l*d)+","+(this._x1=t+S*a)+","+(this._y1=e+S*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,o,r){t=+t,e=+e,n=+n;var s=n*Math.cos(i),a=n*Math.sin(i),u=t+s,l=e+a,c=1^r,h=r?i-o:o-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Jc||Math.abs(this._y1-l)>Jc)&&(this._+="L"+u+","+l),n&&(h>Zc?this._+="A"+n+","+n+",0,1,"+c+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):(h<0&&(h=h%Xc+Xc),this._+="A"+n+","+n+",0,"+ +(h>=Kc)+","+c+","+(this._x1=t+n*Math.cos(o))+","+(this._y1=e+n*Math.sin(o))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var th=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return k(this.cover(e,n),e,n,t)},eh=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,o=this._x1,r=this._y1;if(isNaN(n))o=(n=Math.floor(t))+1,r=(i=Math.floor(e))+1;else{if(!(n>t||t>o||i>e||e>r))return this;var s,a,u=o-n,l=this._root;switch(a=(e<(i+r)/2)<<1|t<(n+o)/2){case 0:do s=new Array(4),s[a]=l,l=s;while(u*=2,o=n+u,r=i+u,t>o||e>r);break;case 1:do s=new Array(4),s[a]=l,l=s;while(u*=2,n=o-u,r=i+u,n>t||e>r);break;case 2:do s=new Array(4),s[a]=l,l=s;while(u*=2,o=n+u,i=r-u,t>o||i>e);break;case 3:do s=new Array(4),s[a]=l,l=s;while(u*=2,n=o-u,i=r-u,n>t||i>e)}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=o,this._y1=r,this},nh=function(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t},ih=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},oh=function(t,e,n,i,o){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=o},rh=function(t,e,n){var i,o,r,s,a,u,l,c=this._x0,h=this._y0,p=this._x1,d=this._y1,f=[],g=this._root;for(g&&f.push(new oh(g,c,h,p,d)),null==n?n=1/0:(c=t-n,h=e-n,p=t+n,d=e+n,n*=n);u=f.pop();)if(!(!(g=u.node)||(o=u.x0)>p||(r=u.y0)>d||(s=u.x1)<c||(a=u.y1)<h))if(g.length){var m=(o+s)/2,v=(r+a)/2;f.push(new oh(g[3],m,v,s,a),new oh(g[2],o,v,m,a),new oh(g[1],m,r,s,v),new oh(g[0],o,r,m,v)),(l=(e>=v)<<1|t>=m)&&(u=f[f.length-1],f[f.length-1]=f[f.length-1-l],f[f.length-1-l]=u)}else{var y=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),S=y*y+b*b;if(S<n){var x=Math.sqrt(n=S);c=t-x,h=e-x,p=t+x,d=e+x,i=g.data}}return i},sh=function(t){if(isNaN(r=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,i,o,r,s,a,u,l,c,h,p,d=this._root,f=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((l=r>=(a=(f+m)/2))?f=a:m=a,(c=s>=(u=(g+v)/2))?g=u:v=u,e=d,!(d=d[h=c<<1|l]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,p=h)}for(;d.data!==t;)if(i=d,!(d=d.next))return this;return(o=d.next)&&delete d.next,i?(o?i.next=o:delete i.next,this):e?(o?e[h]=o:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[p]=d:this._root=d),this):(this._root=o,this)},ah=function(){return this._root},uh=function(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t},lh=function(t){var e,n,i,o,r,s,a=[],u=this._root;for(u&&a.push(new oh(u,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(u=e.node,i=e.x0,o=e.y0,r=e.x1,s=e.y1)&&u.length){var l=(i+r)/2,c=(o+s)/2;(n=u[3])&&a.push(new oh(n,l,c,r,s)),(n=u[2])&&a.push(new oh(n,i,c,l,s)),(n=u[1])&&a.push(new oh(n,l,o,r,c)),(n=u[0])&&a.push(new oh(n,i,o,l,c))}return this},ch=function(t){var e,n=[],i=[];for(this._root&&n.push(new oh(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var o=e.node;if(o.length){var r,s=e.x0,a=e.y0,u=e.x1,l=e.y1,c=(s+u)/2,h=(a+l)/2;(r=o[0])&&n.push(new oh(r,s,a,c,h)),(r=o[1])&&n.push(new oh(r,c,a,u,h)),(r=o[2])&&n.push(new oh(r,s,h,c,l)),(r=o[3])&&n.push(new oh(r,c,h,u,l))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},hh=function(t){return arguments.length?(this._x=t,this):this._x},ph=function(t){return arguments.length?(this._y=t,this):this._y},dh=P.prototype=Q.prototype;dh.copy=function(){var t,e,n=new Q(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=V(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var o=0;o<4;++o)(e=i.source[o])&&(e.length?t.push({source:e,target:i.target[o]=new Array(4)}):i.target[o]=V(e));return n},dh.add=th,dh.addAll=$,dh.cover=eh,dh.data=nh,dh.extent=ih,
dh.find=rh,dh.remove=sh,dh.removeAll=L,dh.root=ah,dh.size=uh,dh.visit=lh,dh.visitAfter=ch,dh.x=hh,dh.y=ph;var fh=[].slice,gh={};H.prototype=G.prototype={constructor:H,defer:function(t){if("function"!=typeof t||this._call)throw new Error;if(null!=this._error)return this;var e=fh.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),q(this),this},abort:function(){return null==this._error&&W(this,new Error("abort")),this},await:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=function(e,n){t.apply(null,[e].concat(n))},Y(this),this},awaitAll:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=t,Y(this),this}};var mh=function(t){return function(){return t}},vh=1e-12,yh=Math.PI,bh=yh/2,Sh=2*yh,xh=function(){function t(){var t,l,c=+e.apply(this,arguments),h=+n.apply(this,arguments),p=r.apply(this,arguments)-bh,d=s.apply(this,arguments)-bh,f=Math.abs(d-p),g=d>p;if(u||(u=t=F()),h<c&&(l=h,h=c,c=l),h>vh)if(f>Sh-vh)u.moveTo(h*Math.cos(p),h*Math.sin(p)),u.arc(0,0,h,p,d,!g),c>vh&&(u.moveTo(c*Math.cos(d),c*Math.sin(d)),u.arc(0,0,c,d,p,g));else{var m,v,y=p,b=d,S=p,x=d,C=f,E=f,w=a.apply(this,arguments)/2,A=w>vh&&(o?+o.apply(this,arguments):Math.sqrt(c*c+h*h)),T=Math.min(Math.abs(h-c)/2,+i.apply(this,arguments)),O=T,_=T;if(A>vh){var M=et(A/c*Math.sin(w)),N=et(A/h*Math.sin(w));(C-=2*M)>vh?(M*=g?1:-1,S+=M,x-=M):(C=0,S=x=(p+d)/2),(E-=2*N)>vh?(N*=g?1:-1,y+=N,b-=N):(E=0,y=b=(p+d)/2)}var R=h*Math.cos(y),D=h*Math.sin(y),I=c*Math.cos(x),k=c*Math.sin(x);if(T>vh){var $=h*Math.cos(b),L=h*Math.sin(b),U=c*Math.cos(S),B=c*Math.sin(S);if(f<yh){var P=C>vh?nt(R,D,U,B,$,L,I,k):[I,k],Q=R-P[0],V=D-P[1],H=$-P[0],q=L-P[1],j=1/Math.sin(Math.acos((Q*H+V*q)/(Math.sqrt(Q*Q+V*V)*Math.sqrt(H*H+q*q)))/2),z=Math.sqrt(P[0]*P[0]+P[1]*P[1]);O=Math.min(T,(c-z)/(j-1)),_=Math.min(T,(h-z)/(j+1))}}E>vh?_>vh?(m=it(U,B,R,D,h,_,g),v=it($,L,I,k,h,_,g),u.moveTo(m.cx+m.x01,m.cy+m.y01),_<T?u.arc(m.cx,m.cy,_,Math.atan2(m.y01,m.x01),Math.atan2(v.y01,v.x01),!g):(u.arc(m.cx,m.cy,_,Math.atan2(m.y01,m.x01),Math.atan2(m.y11,m.x11),!g),u.arc(0,0,h,Math.atan2(m.cy+m.y11,m.cx+m.x11),Math.atan2(v.cy+v.y11,v.cx+v.x11),!g),u.arc(v.cx,v.cy,_,Math.atan2(v.y11,v.x11),Math.atan2(v.y01,v.x01),!g))):(u.moveTo(R,D),u.arc(0,0,h,y,b,!g)):u.moveTo(R,D),c>vh&&C>vh?O>vh?(m=it(I,k,$,L,c,-O,g),v=it(R,D,U,B,c,-O,g),u.lineTo(m.cx+m.x01,m.cy+m.y01),O<T?u.arc(m.cx,m.cy,O,Math.atan2(m.y01,m.x01),Math.atan2(v.y01,v.x01),!g):(u.arc(m.cx,m.cy,O,Math.atan2(m.y01,m.x01),Math.atan2(m.y11,m.x11),!g),u.arc(0,0,c,Math.atan2(m.cy+m.y11,m.cx+m.x11),Math.atan2(v.cy+v.y11,v.cx+v.x11),g),u.arc(v.cx,v.cy,O,Math.atan2(v.y11,v.x11),Math.atan2(v.y01,v.x01),!g))):u.arc(0,0,c,x,S,g):u.lineTo(I,k)}else u.moveTo(0,0);if(u.closePath(),t)return u=null,t+""||null}var e=K,n=X,i=mh(0),o=null,r=J,s=Z,a=tt,u=null;return t.centroid=function(){var t=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-yh/2;return[Math.cos(i)*t,Math.sin(i)*t]},t.innerRadius=function(n){return arguments.length?(e="function"==typeof n?n:mh(+n),t):e},t.outerRadius=function(e){return arguments.length?(n="function"==typeof e?e:mh(+e),t):n},t.cornerRadius=function(e){return arguments.length?(i="function"==typeof e?e:mh(+e),t):i},t.padRadius=function(e){return arguments.length?(o=null==e?null:"function"==typeof e?e:mh(+e),t):o},t.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:mh(+e),t):r},t.endAngle=function(e){return arguments.length?(s="function"==typeof e?e:mh(+e),t):s},t.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:mh(+e),t):a},t.context=function(e){return arguments.length?(u=null==e?null:e,t):u},t};ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Ch=function(t){return new ot(t)},Eh=function(){function t(t){var a,u,l,c=t.length,h=!1;for(null==o&&(s=r(l=F())),a=0;a<=c;++a)!(a<c&&i(u=t[a],a,t))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(u,a,t),+n(u,a,t));if(l)return s=null,l+""||null}var e=rt,n=st,i=mh(!0),o=null,r=Ch,s=null;return t.x=function(n){return arguments.length?(e="function"==typeof n?n:mh(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:mh(+e),t):n},t.defined=function(e){return arguments.length?(i="function"==typeof e?e:mh(!!e),t):i},t.curve=function(e){return arguments.length?(r=e,null!=o&&(s=r(o)),t):r},t.context=function(e){return arguments.length?(null==e?o=s=null:s=r(o=e),t):o},t},wh=function(){function t(t){var e,c,h,p,d,f=t.length,g=!1,m=new Array(f),v=new Array(f);for(null==a&&(l=u(d=F())),e=0;e<=f;++e){if(!(e<f&&s(p=t[e],e,t))===g)if(g=!g)c=e,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=e-1;h>=c;--h)l.point(m[h],v[h]);l.lineEnd(),l.areaEnd()}g&&(m[e]=+n(p,e,t),v[e]=+o(p,e,t),l.point(i?+i(p,e,t):m[e],r?+r(p,e,t):v[e]))}if(d)return l=null,d+""||null}function e(){return Eh().defined(s).curve(u).context(a)}var n=rt,i=null,o=mh(0),r=st,s=mh(!0),a=null,u=Ch,l=null;return t.x=function(e){return arguments.length?(n="function"==typeof e?e:mh(+e),i=null,t):n},t.x0=function(e){return arguments.length?(n="function"==typeof e?e:mh(+e),t):n},t.x1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:mh(+e),t):i},t.y=function(e){return arguments.length?(o="function"==typeof e?e:mh(+e),r=null,t):o},t.y0=function(e){return arguments.length?(o="function"==typeof e?e:mh(+e),t):o},t.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:mh(+e),t):r},t.lineX0=t.lineY0=function(){return e().x(n).y(o)},t.lineY1=function(){return e().x(n).y(r)},t.lineX1=function(){return e().x(i).y(o)},t.defined=function(e){return arguments.length?(s="function"==typeof e?e:mh(!!e),t):s},t.curve=function(e){return arguments.length?(u=e,null!=a&&(l=u(a)),t):u},t.context=function(e){return arguments.length?(null==e?a=l=null:l=u(a=e),t):a},t},Ah=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Th=function(t){return t},Oh=function(){function t(t){var a,u,l,c,h,p=t.length,d=0,f=new Array(p),g=new Array(p),m=+o.apply(this,arguments),v=Math.min(Sh,Math.max(-Sh,r.apply(this,arguments)-m)),y=Math.min(Math.abs(v)/p,s.apply(this,arguments)),b=y*(v<0?-1:1);for(a=0;a<p;++a)(h=g[f[a]=a]=+e(t[a],a,t))>0&&(d+=h);for(null!=n?f.sort(function(t,e){return n(g[t],g[e])}):null!=i&&f.sort(function(e,n){return i(t[e],t[n])}),a=0,l=d?(v-p*b)/d:0;a<p;++a,m=c)u=f[a],h=g[u],c=m+(h>0?h*l:0)+b,g[u]={data:t[u],index:a,value:h,startAngle:m,endAngle:c,padAngle:y};return g}var e=Th,n=Ah,i=null,o=mh(0),r=mh(Sh),s=mh(0);return t.value=function(n){return arguments.length?(e="function"==typeof n?n:mh(+n),t):e},t.sortValues=function(e){return arguments.length?(n=e,i=null,t):n},t.sort=function(e){return arguments.length?(i=e,n=null,t):i},t.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:mh(+e),t):o},t.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:mh(+e),t):r},t.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:mh(+e),t):s},t},_h=ut(Ch);at.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var Mh=function(){return lt(Eh().curve(_h))},Nh=function(){var t=wh().curve(_h),e=t.curve,n=t.lineX0,i=t.lineX1,o=t.lineY0,r=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return lt(n())},delete t.lineX0,t.lineEndAngle=function(){return lt(i())},delete t.lineX1,t.lineInnerRadius=function(){return lt(o())},delete t.lineY0,t.lineOuterRadius=function(){return lt(r())},delete t.lineY1,t.curve=function(t){return arguments.length?e(ut(t)):e()._curve},t},Rh={draw:function(t,e){var n=Math.sqrt(e/yh);t.moveTo(n,0),t.arc(0,0,n,0,Sh)}},Dh={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Ih=Math.sqrt(1/3),Fh=2*Ih,kh={draw:function(t,e){var n=Math.sqrt(e/Fh),i=n*Ih;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},$h=.8908130915292852,Lh=Math.sin(yh/10)/Math.sin(7*yh/10),Uh=Math.sin(Sh/10)*Lh,Bh=-Math.cos(Sh/10)*Lh,Ph={draw:function(t,e){var n=Math.sqrt(e*$h),i=Uh*n,o=Bh*n;t.moveTo(0,-n),t.lineTo(i,o);for(var r=1;r<5;++r){var s=Sh*r/5,a=Math.cos(s),u=Math.sin(s);t.lineTo(u*n,-a*n),t.lineTo(a*i-u*o,u*i+a*o)}t.closePath()}},Qh={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},Vh=Math.sqrt(3),Hh={draw:function(t,e){var n=-Math.sqrt(e/(3*Vh));t.moveTo(0,2*n),t.lineTo(-Vh*n,-n),t.lineTo(Vh*n,-n),t.closePath()}},qh=-.5,jh=Math.sqrt(3)/2,zh=1/Math.sqrt(12),Wh=3*(zh/2+1),Yh={draw:function(t,e){var n=Math.sqrt(e/Wh),i=n/2,o=n*zh,r=i,s=n*zh+n,a=-r,u=s;t.moveTo(i,o),t.lineTo(r,s),t.lineTo(a,u),t.lineTo(qh*i-jh*o,jh*i+qh*o),t.lineTo(qh*r-jh*s,jh*r+qh*s),t.lineTo(qh*a-jh*u,jh*a+qh*u),t.lineTo(qh*i+jh*o,qh*o-jh*i),t.lineTo(qh*r+jh*s,qh*s-jh*r),t.lineTo(qh*a+jh*u,qh*u-jh*a),t.closePath()}},Gh=[Rh,Dh,kh,Qh,Ph,Hh,Yh],Kh=function(){function t(){var t;if(i||(i=t=F()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),t)return i=null,t+""||null}var e=mh(Rh),n=mh(64),i=null;return t.type=function(n){return arguments.length?(e="function"==typeof n?n:mh(n),t):e},t.size=function(e){return arguments.length?(n="function"==typeof e?e:mh(+e),t):n},t.context=function(e){return arguments.length?(i=null==e?null:e,t):i},t},Xh=function(){};ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ct(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ct(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Jh=function(t){return new ht(t)};pt.prototype={areaStart:Xh,areaEnd:Xh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ct(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Zh=function(t){return new pt(t)};dt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:ct(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var tp=function(t){return new dt(t)};ft.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,o=t[0],r=e[0],s=t[n]-o,a=e[n]-r,u=-1;++u<=n;)i=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(o+i*s),this._beta*e[u]+(1-this._beta)*(r+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var ep=function t(e){function n(t){return 1===e?new ht(t):new ft(t,e)}return n.beta=function(e){return t(+e)},n}(.85);mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:gt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:gt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var np=function t(e){function n(t){return new mt(t,e)}return n.tension=function(e){return t(+e)},n}(0);vt.prototype={areaStart:Xh,areaEnd:Xh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:gt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ip=function t(e){function n(t){return new vt(t,e)}return n.tension=function(e){return t(+e)},n}(0);yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:gt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var op=function t(e){function n(t){return new yt(t,e)}return n.tension=function(e){return t(+e)},n}(0);St.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:bt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var rp=function t(e){function n(t){return e?new St(t,e):new mt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);xt.prototype={areaStart:Xh,areaEnd:Xh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:bt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var sp=function t(e){function n(t){return e?new xt(t,e):new vt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);Ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:bt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ap=function t(e){function n(t){return e?new Ct(t,e):new yt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);Et.prototype={areaStart:Xh,areaEnd:Xh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var up=function(t){return new Et(t)};_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ot(this,this._t0,Tt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ot(this,Tt(this,n=At(this,t,e)),n);break;default:Ot(this,this._t0,n=At(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Mt.prototype=Object.create(_t.prototype)).point=function(t,e){_t.prototype.point.call(this,e,t)},Nt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,o,r){this._context.bezierCurveTo(e,t,i,n,r,o)}},It.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=Ft(t),o=Ft(e),r=0,s=1;s<n;++r,++s)this._context.bezierCurveTo(i[0][r],o[0][r],i[1][r],o[1][r],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var lp=function(t){return new It(t)};kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var cp=function(t){return new kt(t,.5)},hp=Array.prototype.slice,pp=function(t,e){if((i=t.length)>1)for(var n,i,o=1,r=t[e[0]],s=r.length;o<i;++o){n=r,r=t[e[o]];for(var a=0;a<s;++a)r[a][1]+=r[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}},dp=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n},fp=function(){function t(t){var r,s,a=e.apply(this,arguments),u=t.length,l=a.length,c=new Array(l);for(r=0;r<l;++r){for(var h,p=a[r],d=c[r]=new Array(u),f=0;f<u;++f)d[f]=h=[0,+o(t[f],p,f,t)],h.data=t[f];d.key=p}for(r=0,s=n(c);r<l;++r)c[s[r]].index=r;return i(c,s),c}var e=mh([]),n=dp,i=pp,o=Ut;return t.keys=function(n){return arguments.length?(e="function"==typeof n?n:mh(hp.call(n)),t):e},t.value=function(e){return arguments.length?(o="function"==typeof e?e:mh(+e),t):o},t.order=function(e){return arguments.length?(n=null==e?dp:"function"==typeof e?e:mh(hp.call(e)),t):n},t.offset=function(e){return arguments.length?(i=null==e?pp:e,t):i},t},gp=function(t,e){if((i=t.length)>0){for(var n,i,o,r=0,s=t[0].length;r<s;++r){for(o=n=0;n<i;++n)o+=t[n][r][1]||0;if(o)for(n=0;n<i;++n)t[n][r][1]/=o}pp(t,e)}},mp=function(t,e){if((n=t.length)>0){for(var n,i=0,o=t[e[0]],r=o.length;i<r;++i){for(var s=0,a=0;s<n;++s)a+=t[s][i][1]||0;o[i][1]+=o[i][0]=-a/2}pp(t,e)}},vp=function(t,e){if((o=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,o,r=0,s=1;s<i;++s){for(var a=0,u=0,l=0;a<o;++a){for(var c=t[e[a]],h=c[s][1]||0,p=c[s-1][1]||0,d=(h-p)/2,f=0;f<a;++f){var g=t[e[f]],m=g[s][1]||0,v=g[s-1][1]||0;d+=m-v}u+=h,l+=d*h}n[s-1][1]+=n[s-1][0]=r,u&&(r-=l/u)}n[s-1][1]+=n[s-1][0]=r,pp(t,e)}},yp=function(t){var e=t.map(Bt);return dp(t).sort(function(t,n){return e[t]-e[n]})},bp=function(t){return yp(t).reverse()},Sp=function(t){var e,n,i=t.length,o=t.map(Bt),r=dp(t).sort(function(t,e){return o[e]-o[t]}),s=0,a=0,u=[],l=[];for(e=0;e<i;++e)n=r[e],s<a?(s+=o[n],u.push(n)):(a+=o[n],l.push(n));return l.reverse().concat(u)},xp=function(t){return dp(t).reverse()},Cp=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},Ep=.7,wp=1/Ep,Ap="\\s*([+-]?\\d+)\\s*",Tp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Op="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_p=/^#([0-9a-f]{3})$/,Mp=/^#([0-9a-f]{6})$/,Np=new RegExp("^rgb\\("+[Ap,Ap,Ap]+"\\)$"),Rp=new RegExp("^rgb\\("+[Op,Op,Op]+"\\)$"),Dp=new RegExp("^rgba\\("+[Ap,Ap,Ap,Tp]+"\\)$"),Ip=new RegExp("^rgba\\("+[Op,Op,Op,Tp]+"\\)$"),Fp=new RegExp("^hsl\\("+[Tp,Op,Op]+"\\)$"),kp=new RegExp("^hsla\\("+[Tp,Op,Op,Tp]+"\\)$"),$p={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Cp(Qt,Vt,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),Cp(Wt,zt,Pt(Qt,{brighter:function(t){return t=null==t?wp:Math.pow(wp,t),new Wt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Ep:Math.pow(Ep,t),new Wt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Cp(Xt,Kt,Pt(Qt,{brighter:function(t){return t=null==t?wp:Math.pow(wp,t),new Xt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ep:Math.pow(Ep,t),new Xt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new Wt(Jt(t>=240?t-240:t+120,o,i),Jt(t,o,i),Jt(t<120?t+240:t-120,o,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Lp=Math.PI/180,Up=180/Math.PI,Bp=18,Pp=.95047,Qp=1,Vp=1.08883,Hp=4/29,qp=6/29,jp=3*qp*qp,zp=qp*qp*qp;Cp(ee,te,Pt(Qt,{brighter:function(t){return new ee(this.l+Bp*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ee(this.l-Bp*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=Qp*ie(t),e=Pp*ie(e),n=Vp*ie(n),new Wt(oe(3.2404542*e-1.5371385*t-.4985314*n),oe(-.969266*e+1.8760108*t+.041556*n),oe(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),Cp(ue,ae,Pt(Qt,{brighter:function(t){return new ue(this.h,this.c,this.l+Bp*(null==t?1:t),this.opacity)},darker:function(t){return new ue(this.h,this.c,this.l-Bp*(null==t?1:t),this.opacity)},rgb:function(){return Zt(this).rgb()}}));var Wp=-.14861,Yp=1.78277,Gp=-.29227,Kp=-.90649,Xp=1.97294,Jp=Xp*Kp,Zp=Xp*Yp,td=Yp*Gp-Kp*Wp;Cp(he,ce,Pt(Qt,{brighter:function(t){return t=null==t?wp:Math.pow(wp,t),new he(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ep:Math.pow(Ep,t),new he(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Lp,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),o=Math.sin(t);return new Wt(255*(e+n*(Wp*i+Yp*o)),255*(e+n*(Gp*i+Kp*o)),255*(e+n*(Xp*i)),this.opacity)}}));var ed,nd,id,od,rd=function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],r=t[i+1],s=i>0?t[i-1]:2*o-r,a=i<e-1?t[i+2]:2*r-o;return pe((n-i/e)*e,s,o,r,a)}},sd=function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=t[(i+e-1)%e],r=t[i%e],s=t[(i+1)%e],a=t[(i+2)%e];return pe((n-i/e)*e,o,r,s,a)}},ad=function(t){return function(){return t}},ud=function t(e){function n(t,e){var n=i((t=zt(t)).r,(e=zt(e)).r),o=i(t.g,e.g),r=i(t.b,e.b),s=i(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=o(e),t.b=r(e),t.opacity=s(e),t+""}}var i=me(e);return n.gamma=t,n}(1),ld=ye(rd),cd=ye(sd),hd=function(t,e){var n,i=e?e.length:0,o=t?Math.min(i,t.length):0,r=new Array(i),s=new Array(i);for(n=0;n<o;++n)r[n]=yd(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<o;++n)s[n]=r[n](t);return s}},pd=function(t,e){var n=new Date;return t=+t,e-=t,function(i){return n.setTime(t+e*i),n}},dd=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},fd=function(t,e){var n,i={},o={};null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={});for(n in e)n in t?i[n]=yd(t[n],e[n]):o[n]=e[n];return function(t){for(n in i)o[n]=i[n](t);return o}},gd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,md=new RegExp(gd.source,"g"),vd=function(t,e){var n,i,o,r=gd.lastIndex=md.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=gd.exec(t))&&(i=md.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:dd(n,i)})),r=md.lastIndex;return r<e.length&&(o=e.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?Se(u[0].x):be(e):(e=u.length,function(t){for(var n,i=0;i<e;++i)a[(n=u[i]).i]=n.x(t);return a.join("")})},yd=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?ad(e):("number"===i?dd:"string"===i?(n=Vt(e))?(e=n,ud):vd:e instanceof Vt?ud:e instanceof Date?pd:Array.isArray(e)?hd:isNaN(e)?fd:dd)(t,e)},bd=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}},Sd=180/Math.PI,xd={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Cd=function(t,e,n,i,o,r){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),t*i<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:o,translateY:r,rotate:Math.atan2(e,t)*Sd,skewX:Math.atan(u)*Sd,scaleX:s,scaleY:a}},Ed=Ee(xe,"px, ","px)","deg)"),wd=Ee(Ce,", ",")",")"),Ad=Math.SQRT2,Td=2,Od=4,_d=1e-12,Md=function(t,e){var n,i,o=t[0],r=t[1],s=t[2],a=e[0],u=e[1],l=e[2],c=a-o,h=u-r,p=c*c+h*h;
if(p<_d)i=Math.log(l/s)/Ad,n=function(t){return[o+t*c,r+t*h,s*Math.exp(Ad*t*i)]};else{var d=Math.sqrt(p),f=(l*l-s*s+Od*p)/(2*s*Td*d),g=(l*l-s*s-Od*p)/(2*l*Td*d),m=Math.log(Math.sqrt(f*f+1)-f),v=Math.log(Math.sqrt(g*g+1)-g);i=(v-m)/Ad,n=function(t){var e=t*i,n=we(m),a=s/(Td*d)*(n*Te(Ad*e+m)-Ae(m));return[o+a*c,r+a*h,s*n/we(Ad*e+m)]}}return n.duration=1e3*i,n},Nd=Oe(ge),Rd=Oe(ve),Dd=Me(ge),Id=Me(ve),Fd=Ne(ge),kd=Ne(ve),$d=function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},Ld={value:function(){}};De.prototype=Re.prototype={constructor:De,on:function(t,e){var n,i=this._,o=Ie(t+"",i),r=-1,s=o.length;{if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<s;)if(n=(t=o[r]).type)i[n]=ke(i[n],t.name,e);else if(null==e)for(n in i)i[n]=ke(i[n],t.name,null);return this}for(;++r<s;)if((n=(t=o[r]).type)&&(n=Fe(i[n],t.name)))return n}},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new De(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,o=new Array(n),r=0;r<n;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,n=i.length;r<n;++r)i[r].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],o=0,r=i.length;o<r;++o)i[o].value.apply(e,n)}};var Ud,Bd,Pd=function(t){function e(t,e){var i,o,r=n(t,function(t,n){return i?i(t,n-1):(o=t,void(i=e?Le(t,e):$e(t)))});return r.columns=o,r}function n(t,e){function n(){if(c>=l)return s;if(o)return o=!1,r;var e,n=c;if(34===t.charCodeAt(n)){for(var i=n;i++<l;)if(34===t.charCodeAt(i)){if(34!==t.charCodeAt(i+1))break;++i}return c=i+2,e=t.charCodeAt(i+1),13===e?(o=!0,10===t.charCodeAt(i+2)&&++c):10===e&&(o=!0),t.slice(n+1,i).replace(/""/g,'"')}for(;c<l;){var a=1;if(e=t.charCodeAt(c++),10===e)o=!0;else if(13===e)o=!0,10===t.charCodeAt(c)&&(++c,++a);else if(e!==u)continue;return t.slice(n,c-a)}return t.slice(n)}for(var i,o,r={},s={},a=[],l=t.length,c=0,h=0;(i=n())!==s;){for(var p=[];i!==r&&i!==s;)p.push(i),i=n();e&&null==(p=e(p,h++))||a.push(p)}return a}function i(e,n){return null==n&&(n=Ue(e)),[n.map(s).join(t)].concat(e.map(function(e){return n.map(function(t){return s(e[t])}).join(t)})).join("\n")}function o(t){return t.map(r).join("\n")}function r(e){return e.map(s).join(t)}function s(t){return null==t?"":a.test(t+="")?'"'+t.replace(/\"/g,'""')+'"':t}var a=new RegExp('["'+t+"\n]"),u=t.charCodeAt(0);return{parse:e,parseRows:n,format:i,formatRows:o}},Qd=Pd(","),Vd=Qd.parse,Hd=Qd.parseRows,qd=Qd.format,jd=Qd.formatRows,zd=Pd("\t"),Wd=zd.parse,Yd=zd.parseRows,Gd=zd.format,Kd=zd.formatRows,Xd=function(t,e){function n(t){var e,n=c.status;if(!n&&Pe(c)||n>=200&&n<300||304===n){if(s)try{e=s.call(i,c)}catch(t){return void u.call("error",i,t)}else e=c;u.call("load",i,e)}else u.call("error",i,t)}var i,o,s,a,u=Re("beforesend","progress","load","error"),l=r(),c=new XMLHttpRequest,h=null,p=null,d=0;if("undefined"==typeof XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(t)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=c.ontimeout=n:c.onreadystatechange=function(t){c.readyState>3&&n(t)},c.onprogress=function(t){u.call("progress",i,t)},i={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l.get(t):(null==e?l.remove(t):l.set(t,e+""),i)},mimeType:function(t){return arguments.length?(o=null==t?null:t+"",i):o},responseType:function(t){return arguments.length?(a=t,i):a},timeout:function(t){return arguments.length?(d=+t,i):d},user:function(t){return arguments.length<1?h:(h=null==t?null:t+"",i)},password:function(t){return arguments.length<1?p:(p=null==t?null:t+"",i)},response:function(t){return s=t,i},get:function(t,e){return i.send("GET",t,e)},post:function(t,e){return i.send("POST",t,e)},send:function(e,n,r){return c.open(e,t,!0,h,p),null==o||l.has("accept")||l.set("accept",o+",*/*"),c.setRequestHeader&&l.each(function(t,e){c.setRequestHeader(e,t)}),null!=o&&c.overrideMimeType&&c.overrideMimeType(o),null!=a&&(c.responseType=a),d>0&&(c.timeout=d),null==r&&"function"==typeof n&&(r=n,n=null),null!=r&&1===r.length&&(r=Be(r)),null!=r&&i.on("error",r).on("load",function(t){r(null,t)}),u.call("beforesend",i,c),c.send(null==n?null:n),i},abort:function(){return c.abort(),i},on:function(){var t=u.on.apply(u,arguments);return t===u?i:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return i.get(e)}return i},Jd=function(t,e){return function(n,i){var o=Xd(n).mimeType(t).response(e);if(null!=i){if("function"!=typeof i)throw new Error("invalid callback: "+i);return o.get(i)}return o}},Zd=Jd("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),tf=Jd("application/json",function(t){return JSON.parse(t.responseText)}),ef=Jd("text/plain",function(t){return t.responseText}),nf=Jd("application/xml",function(t){var e=t.responseXML;if(!e)throw new Error("parse error");return e}),of=function(t,e){return function(n,i,o){arguments.length<3&&(o=i,i=null);var r=Xd(n).mimeType(t);return r.row=function(t){return arguments.length?r.response(Qe(e,i=t)):i},r.row(i),o?r.get(o):r}},rf=of("text/csv",Vd),sf=of("text/tab-separated-values",Wd),af=0,uf=0,lf=0,cf=1e3,hf=0,pf=0,df=0,ff="object"==typeof performance&&performance.now?performance:Date,gf="function"==typeof requestAnimationFrame?requestAnimationFrame:function(t){setTimeout(t,17)};qe.prototype=je.prototype={constructor:qe,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ve():+n)+(null==e?0:+e),this._next||Bd===this||(Bd?Bd._next=this:Ud=this,Bd=this),this._call=t,this._time=n,Ke()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ke())}};var mf=function(t,e,n){var i=new qe;return e=null==e?0:+e,i.restart(function(n){i.stop(),t(n+e)},e,n),i},vf=function(t,e,n){var i=new qe,o=e;return null==e?(i.restart(t,e,n),i):(e=+e,n=null==n?Ve():+n,i.restart(function r(s){s+=o,i.restart(r,o+=e,n),t(s)},e,n),i)},yf=new Date,bf=new Date,Sf=Xe(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Sf.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Xe(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Sf:null};var xf=Sf.range,Cf=1e3,Ef=6e4,wf=36e5,Af=864e5,Tf=6048e5,Of=Xe(function(t){t.setTime(Math.floor(t/Cf)*Cf)},function(t,e){t.setTime(+t+e*Cf)},function(t,e){return(e-t)/Cf},function(t){return t.getUTCSeconds()}),_f=Of.range,Mf=Xe(function(t){t.setTime(Math.floor(t/Ef)*Ef)},function(t,e){t.setTime(+t+e*Ef)},function(t,e){return(e-t)/Ef},function(t){return t.getMinutes()}),Nf=Mf.range,Rf=Xe(function(t){var e=t.getTimezoneOffset()*Ef%wf;e<0&&(e+=wf),t.setTime(Math.floor((+t-e)/wf)*wf+e)},function(t,e){t.setTime(+t+e*wf)},function(t,e){return(e-t)/wf},function(t){return t.getHours()}),Df=Rf.range,If=Xe(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ef)/Af},function(t){return t.getDate()-1}),Ff=If.range,kf=Je(0),$f=Je(1),Lf=Je(2),Uf=Je(3),Bf=Je(4),Pf=Je(5),Qf=Je(6),Vf=kf.range,Hf=$f.range,qf=Lf.range,jf=Uf.range,zf=Bf.range,Wf=Pf.range,Yf=Qf.range,Gf=Xe(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),Kf=Gf.range,Xf=Xe(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Xf.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Xe(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Jf=Xf.range,Zf=Xe(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Ef)},function(t,e){return(e-t)/Ef},function(t){return t.getUTCMinutes()}),tg=Zf.range,eg=Xe(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*wf)},function(t,e){return(e-t)/wf},function(t){return t.getUTCHours()}),ng=eg.range,ig=Xe(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/Af},function(t){return t.getUTCDate()-1}),og=ig.range,rg=Ze(0),sg=Ze(1),ag=Ze(2),ug=Ze(3),lg=Ze(4),cg=Ze(5),hg=Ze(6),pg=rg.range,dg=sg.range,fg=ag.range,gg=ug.range,mg=lg.range,vg=cg.range,yg=hg.range,bg=Xe(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),Sg=bg.range,xg=Xe(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});xg.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Xe(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Cg,Eg=xg.range,wg=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]},Ag=function(t){return t=wg(Math.abs(t)),t?t[1]:NaN},Tg=function(t,e){return function(n,i){for(var o=n.length,r=[],s=0,a=t[0],u=0;o>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),r.push(n.substring(o-=a,o+a)),!((u+=a+1)>i));)a=t[s=(s+1)%t.length];return r.reverse().join(e)}},Og=function(t,e){t=t.toPrecision(e);t:for(var n,i=t.length,o=1,r=-1;o<i;++o)switch(t[o]){case".":r=n=o;break;case"0":0===r&&(r=o),n=o;break;case"e":break t;default:r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(n+1):t},_g=function(t,e){var n=wg(t,e);if(!n)return t+"";var i=n[0],o=n[1],r=o-(Cg=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=i.length;return r===s?i:r>s?i+new Array(r-s+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+wg(t,Math.max(0,e+r-1))[0]},Mg=function(t,e){var n=wg(t,e);if(!n)return t+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")},Ng={"":Og,"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Mg(100*t,e)},r:Mg,s:_g,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Rg=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,Dg=function(t){return new tn(t)};tn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Ig,Fg=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],kg=function(t){function e(t){function e(t){var e,o,u,y=f,b=g;if("c"===d)b=m(t)+b,t="";else{t=+t;var S=(t<0||1/t<0)&&(t*=-1,!0);if(t=m(t,p),S)for(e=-1,o=t.length,S=!1;++e<o;)if(u=t.charCodeAt(e),48<u&&u<58||"x"===d&&96<u&&u<103||"X"===d&&64<u&&u<71){S=!0;break}if(y=(S?"("===a?a:"-":"-"===a||"("===a?"":a)+y,b=b+("s"===d?Fg[8+Cg/3]:"")+(S&&"("===a?")":""),v)for(e=-1,o=t.length;++e<o;)if(u=t.charCodeAt(e),48>u||u>57){b=(46===u?r+t.slice(e+1):t.slice(e))+b,t=t.slice(0,e);break}}h&&!l&&(t=i(t,1/0));var x=y.length+t.length+b.length,C=x<c?new Array(c-x+1).join(n):"";switch(h&&l&&(t=i(C+t,C.length?c-b.length:1/0),C=""),s){case"<":return y+t+b+C;case"=":return y+C+t+b;case"^":return C.slice(0,x=C.length>>1)+y+t+b+C.slice(x)}return C+y+t+b}t=Dg(t);var n=t.fill,s=t.align,a=t.sign,u=t.symbol,l=t.zero,c=t.width,h=t.comma,p=t.precision,d=t.type,f="$"===u?o[0]:"#"===u&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",g="$"===u?o[1]:/[%p]/.test(d)?"%":"",m=Ng[d],v=!d||/[defgprs%]/.test(d);return p=null==p?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),e.toString=function(){return t+""},e}function n(t,n){var i=e((t=Dg(t),t.type="f",t)),o=3*Math.max(-8,Math.min(8,Math.floor(Ag(n)/3))),r=Math.pow(10,-o),s=Fg[8+o/3];return function(t){return i(r*t)+s}}var i=t.grouping&&t.thousands?Tg(t.grouping,t.thousands):en,o=t.currency,r=t.decimal;return{format:e,formatPrefix:n}};nn({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var $g,Lg=function(t){return Math.max(0,-Ag(Math.abs(t)))},Ug=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ag(e)/3)))-Ag(Math.abs(t)))},Bg=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ag(e)-Ag(t))+1},Pg={"-":"",_:" ",0:"0"},Qg=/^\s*\d+/,Vg=/^%/,Hg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;ei({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var qg="%Y-%m-%dT%H:%M:%S.%LZ",jg=Date.prototype.toISOString?ni:t.utcFormat(qg),zg=+new Date("2000-01-01T00:00:00.000Z")?ii:t.utcParse(qg),Wg=Array.prototype,Yg=Wg.map,Gg=Wg.slice,Kg={name:"implicit"},Xg=function(t){return function(){return t}},Jg=function(t){return+t},Zg=[0,1],tm=function(e,i,o){var r,s=e[0],a=e[e.length-1],u=n(s,a,null==i?10:i);switch(o=Dg(null==o?",f":o),o.type){case"s":var l=Math.max(Math.abs(s),Math.abs(a));return null!=o.precision||isNaN(r=Ug(u,l))||(o.precision=r),t.formatPrefix(o,l);case"":case"e":case"g":case"p":case"r":null!=o.precision||isNaN(r=Bg(u,Math.max(Math.abs(s),Math.abs(a))))||(o.precision=r-("e"===o.type));break;case"f":case"%":null!=o.precision||isNaN(r=Lg(u))||(o.precision=r-2*("%"===o.type))}return t.format(o)},em=function(t,e){t=t.slice();var n,i=0,o=t.length-1,r=t[i],s=t[o];return s<r&&(n=i,i=o,o=n,n=r,r=s,s=n),t[i]=e.floor(r),t[o]=e.ceil(s),t},nm=1e3,im=60*nm,om=60*im,rm=24*om,sm=7*rm,am=30*rm,um=365*rm,lm=function(){return Ii(Xf,Gf,kf,If,Rf,Mf,Of,Sf,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},cm=function(){return Ii(xg,bg,rg,ig,eg,Zf,Of,Sf,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},hm=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},pm=hm("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),dm=hm("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),fm=hm("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),gm=hm("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),mm=kd(ce(300,.5,0),ce(-240,.5,1)),vm=kd(ce(-100,.75,.35),ce(80,1.5,.8)),ym=kd(ce(260,.75,.35),ce(80,1.5,.8)),bm=ce(),Sm=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return bm.h=360*t-100,bm.s=1.5-1.5*e,bm.l=.8-.9*e,bm+""},xm=Fi(hm("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Cm=Fi(hm("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Em=Fi(hm("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),wm=Fi(hm("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Am="http://www.w3.org/1999/xhtml",Tm={svg:"http://www.w3.org/2000/svg",xhtml:Am,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Om=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Tm.hasOwnProperty(e)?{space:Tm[e],local:t}:t},_m=function(t){var e=Om(t);return(e.local?Li:$i)(e)},Mm=0;Bi.prototype=Ui.prototype={constructor:Bi,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var Nm=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var Rm=document.documentElement;if(!Rm.matches){var Dm=Rm.webkitMatchesSelector||Rm.msMatchesSelector||Rm.mozMatchesSelector||Rm.oMatchesSelector;Nm=function(t){return function(){return Dm.call(this,t)}}}}var Im=Nm,Fm={};if(t.event=null,"undefined"!=typeof document){var km=document.documentElement;"onmouseenter"in km||(Fm={mouseenter:"mouseover",mouseleave:"mouseout"})}var $m=function(t,e,n){var i,o,r=Vi(t+""),s=r.length;{if(!(arguments.length<2)){for(a=e?qi:Hi,null==n&&(n=!1),i=0;i<s;++i)this.each(a(r[i],e,n));return this}var a=this.node().__on;if(a)for(var u,l=0,c=a.length;l<c;++l)for(i=0,u=a[l];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}},Lm=function(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n},Um=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]},Bm=function(t){var e=Lm();return e.changedTouches&&(e=e.changedTouches[0]),Um(t,e)},Pm=function(t){return null==t?zi:function(){return this.querySelector(t)}},Qm=function(t){"function"!=typeof t&&(t=Pm(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s,a=e[o],u=a.length,l=i[o]=new Array(u),c=0;c<u;++c)(r=a[c])&&(s=t.call(r,r.__data__,c,a))&&("__data__"in r&&(s.__data__=r.__data__),l[c]=s);return new Do(i,this._parents)},Vm=function(t){return null==t?Wi:function(){return this.querySelectorAll(t)}},Hm=function(t){"function"!=typeof t&&(t=Vm(t));for(var e=this._groups,n=e.length,i=[],o=[],r=0;r<n;++r)for(var s,a=e[r],u=a.length,l=0;l<u;++l)(s=a[l])&&(i.push(t.call(s,s.__data__,l,a)),o.push(s));return new Do(i,o)},qm=function(t){"function"!=typeof t&&(t=Im(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,u=i[o]=[],l=0;l<a;++l)(r=s[l])&&t.call(r,r.__data__,l,s)&&u.push(r);return new Do(i,this._parents)},jm=function(t){return new Array(t.length)},zm=function(){return new Do(this._enter||this._groups.map(jm),this._parents)};Yi.prototype={constructor:Yi,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Wm=function(t){return function(){return t}},Ym="$",Gm=function(t,e){if(!t)return d=new Array(this.size()),l=-1,this.each(function(t){d[++l]=t}),d;var n=e?Ki:Gi,i=this._parents,o=this._groups;"function"!=typeof t&&(t=Wm(t));for(var r=o.length,s=new Array(r),a=new Array(r),u=new Array(r),l=0;l<r;++l){var c=i[l],h=o[l],p=h.length,d=t.call(c,c&&c.__data__,l,i),f=d.length,g=a[l]=new Array(f),m=s[l]=new Array(f),v=u[l]=new Array(p);n(c,h,g,m,v,d,e);for(var y,b,S=0,x=0;S<f;++S)if(y=g[S]){for(S>=x&&(x=S+1);!(b=m[x])&&++x<f;);y._next=b||null}}return s=new Do(s,i),s._enter=a,s._exit=u,s},Km=function(){return new Do(this._exit||this._groups.map(jm),this._parents)},Xm=function(t){for(var e=this._groups,n=t._groups,i=e.length,o=n.length,r=Math.min(i,o),s=new Array(i),a=0;a<r;++a)for(var u,l=e[a],c=n[a],h=l.length,p=s[a]=new Array(h),d=0;d<h;++d)(u=l[d]||c[d])&&(p[d]=u);for(;a<i;++a)s[a]=e[a];return new Do(s,this._parents)},Jm=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,o=t[e],r=o.length-1,s=o[r];--r>=0;)(i=o[r])&&(s&&s!==i.nextSibling&&s.parentNode.insertBefore(i,s),s=i);return this},Zm=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Xi);for(var n=this._groups,i=n.length,o=new Array(i),r=0;r<i;++r){for(var s,a=n[r],u=a.length,l=o[r]=new Array(u),c=0;c<u;++c)(s=a[c])&&(l[c]=s);l.sort(e)}return new Do(o,this._parents).order()},tv=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},ev=function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},nv=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],o=0,r=i.length;o<r;++o){var s=i[o];if(s)return s}return null},iv=function(){var t=0;return this.each(function(){++t}),t},ov=function(){return!this.node()},rv=function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o,r=e[n],s=0,a=r.length;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this},sv=function(t,e){var n=Om(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?Zi:Ji:"function"==typeof e?n.local?io:no:n.local?eo:to)(n,e))},av=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView},uv=function(t,e,n){var i;return arguments.length>1?this.each((null==e?oo:"function"==typeof e?so:ro)(t,e,null==n?"":n)):av(i=this.node()).getComputedStyle(i,null).getPropertyValue(t)},lv=function(t,e){return arguments.length>1?this.each((null==e?ao:"function"==typeof e?lo:uo)(t,e)):this.node()[t]};po.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var cv=function(t,e){var n=co(t+"");if(arguments.length<2){for(var i=ho(this.node()),o=-1,r=n.length;++o<r;)if(!i.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?yo:e?mo:vo)(n,e))},hv=function(t){return arguments.length?this.each(null==t?bo:("function"==typeof t?xo:So)(t)):this.node().textContent},pv=function(t){return arguments.length?this.each(null==t?Co:("function"==typeof t?wo:Eo)(t)):this.node().innerHTML},dv=function(){return this.each(Ao)},fv=function(){return this.each(To)},gv=function(t){var e="function"==typeof t?t:_m(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},mv=function(t,e){var n="function"==typeof t?t:_m(t),i=null==e?Oo:"function"==typeof e?e:Pm(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},vv=function(){return this.each(_o)},yv=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},bv=function(t,e){return this.each(("function"==typeof e?Ro:No)(t,e))},Sv=[null];Do.prototype=Io.prototype={constructor:Do,select:Qm,selectAll:Hm,filter:qm,data:Gm,enter:zm,exit:Km,merge:Xm,order:Jm,sort:Zm,call:tv,nodes:ev,node:nv,size:iv,empty:ov,each:rv,attr:sv,style:uv,property:lv,classed:cv,text:hv,html:pv,raise:dv,lower:fv,append:gv,insert:mv,remove:vv,datum:yv,on:$m,dispatch:bv};var xv=function(t){return"string"==typeof t?new Do([[document.querySelector(t)]],[document.documentElement]):new Do([[t]],Sv)},Cv=function(t){return"string"==typeof t?new Do([document.querySelectorAll(t)],[document.documentElement]):new Do([null==t?[]:t],Sv)},Ev=function(t,e,n){arguments.length<3&&(n=e,e=Lm().changedTouches);for(var i,o=0,r=e?e.length:0;o<r;++o)if((i=e[o]).identifier===n)return Um(t,i);return null},wv=function(t,e){null==e&&(e=Lm().touches);for(var n=0,i=e?e.length:0,o=new Array(i);n<i;++n)o[n]=Um(t,e[n]);return o},Av=Re("start","end","interrupt"),Tv=[],Ov=0,_v=1,Mv=2,Nv=3,Rv=4,Dv=5,Iv=6,Fv=function(t,e,n,i,o,r){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};Lo(t,n,{name:e,index:i,group:o,on:Av,tween:Tv,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:Ov})},kv=function(t,e){var n,i,o,r=t.__transition,s=!0;if(r){e=null==e?null:e+"";for(o in r)(n=r[o]).name===e?(i=n.state>Mv&&n.state<Dv,n.state=Iv,n.timer.stop(),i&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete r[o]):s=!1;s&&delete t.__transition}},$v=function(t){return this.each(function(){kv(this,t)})},Lv=function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,o=$o(this.node(),n).tween,r=0,s=o.length;r<s;++r)if((i=o[r]).name===t)return i.value;return null}return this.each((null==e?Uo:Bo)(n,t,e))},Uv=function(t,e){var n;return("number"==typeof e?dd:e instanceof Vt?ud:(n=Vt(e))?(e=n,ud):vd)(t,e)},Bv=function(t,e){var n=Om(t),i="transform"===n?wd:Uv;return this.attrTween(t,"function"==typeof e?(n.local?zo:jo)(n,i,Po(this,"attr."+t,e)):null==e?(n.local?Vo:Qo)(n):(n.local?qo:Ho)(n,i,e))},Pv=function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=Om(t);return this.tween(n,(i.local?Wo:Yo)(i,e))},Qv=function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Go:Ko)(e,t)):$o(this.node(),e).delay},Vv=function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Xo:Jo)(e,t)):$o(this.node(),e).duration},Hv=function(t){var e=this._id;return arguments.length?this.each(Zo(e,t)):$o(this.node(),e).ease},qv=function(t){"function"!=typeof t&&(t=Im(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,u=i[o]=[],l=0;l<a;++l)(r=s[l])&&t.call(r,r.__data__,l,s)&&u.push(r);return new cr(i,this._parents,this._name,this._id)},jv=function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,o=n.length,r=Math.min(i,o),s=new Array(i),a=0;a<r;++a)for(var u,l=e[a],c=n[a],h=l.length,p=s[a]=new Array(h),d=0;d<h;++d)(u=l[d]||c[d])&&(p[d]=u);for(;a<i;++a)s[a]=e[a];return new cr(s,this._parents,this._name,this._id)},zv=function(t,e){var n=this._id;return arguments.length<2?$o(this.node(),n).on.on(t):this.each(er(n,t,e));
},Wv=function(){return this.on("end.remove",nr(this._id))},Yv=function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Pm(t));for(var i=this._groups,o=i.length,r=new Array(o),s=0;s<o;++s)for(var a,u,l=i[s],c=l.length,h=r[s]=new Array(c),p=0;p<c;++p)(a=l[p])&&(u=t.call(a,a.__data__,p,l))&&("__data__"in a&&(u.__data__=a.__data__),h[p]=u,Fv(h[p],e,n,p,h,$o(a,n)));return new cr(r,this._parents,e,n)},Gv=function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Vm(t));for(var i=this._groups,o=i.length,r=[],s=[],a=0;a<o;++a)for(var u,l=i[a],c=l.length,h=0;h<c;++h)if(u=l[h]){for(var p,d=t.call(u,u.__data__,h,l),f=$o(u,n),g=0,m=d.length;g<m;++g)(p=d[g])&&Fv(p,e,n,g,d,f);r.push(d),s.push(u)}return new cr(r,s,e,n)},Kv=Io.prototype.constructor,Xv=function(){return new Kv(this._groups,this._parents)},Jv=function(t,e,n){var i="transform"==(t+="")?Ed:Uv;return null==e?this.styleTween(t,ir(t,i)).on("end.style."+t,or(t)):this.styleTween(t,"function"==typeof e?sr(t,i,Po(this,"style."+t,e)):rr(t,i,e),n)},Zv=function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,ar(t,e,null==n?"":n))},ty=function(t){return this.tween("text","function"==typeof t?lr(Po(this,"text",t)):ur(null==t?"":t+""))},ey=function(){for(var t=this._name,e=this._id,n=pr(),i=this._groups,o=i.length,r=0;r<o;++r)for(var s,a=i[r],u=a.length,l=0;l<u;++l)if(s=a[l]){var c=$o(s,e);Fv(s,t,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new cr(i,this._parents,t,n)},ny=0,iy=Io.prototype;cr.prototype=hr.prototype={constructor:cr,select:Yv,selectAll:Gv,filter:qv,merge:jv,selection:Xv,transition:ey,call:iy.call,nodes:iy.nodes,node:iy.node,size:iy.size,empty:iy.empty,each:iy.each,on:zv,attr:Bv,attrTween:Pv,style:Jv,styleTween:Zv,text:ty,remove:Wv,tween:Lv,delay:Qv,duration:Vv,ease:Hv};var oy={time:null,delay:0,duration:250,ease:y},ry=function(t){var e,n;t instanceof cr?(e=t._id,t=t._name):(e=pr(),(n=oy).time=Ve(),t=null==t?null:t+"");for(var i=this._groups,o=i.length,r=0;r<o;++r)for(var s,a=i[r],u=a.length,l=0;l<u;++l)(s=a[l])&&Fv(s,t,e,l,a,n||dr(s,e));return new cr(i,this._parents,t,e)};Io.prototype.interrupt=$v,Io.prototype.transition=ry;var sy=[null],ay=function(t,e){var n,i,o=t.__transition;if(o){e=null==e?null:e+"";for(i in o)if((n=o[i]).state>_v&&n.name===e)return new cr([[t]],sy,e,+i)}return null},uy=Array.prototype.slice,ly=function(t){return t},cy=1,hy=2,py=3,dy=4,fy=1e-6,gy=function(){function t(t){var r,s=0;t.eachAfter(function(t){var n=t.children;n?(t.x=wr(n),t.y=Tr(n)):(t.x=r?s+=e(t,r):0,t.y=0,r=t)});var a=_r(t),u=Mr(t),l=a.x-e(a,u)/2,c=u.x+e(u,a)/2;return t.eachAfter(o?function(e){e.x=(e.x-t.x)*n,e.y=(t.y-e.y)*i}:function(e){e.x=(e.x-l)/(c-l)*n,e.y=(1-(t.y?e.y/t.y:1))*i})}var e=Er,n=1,i=1,o=!1;return t.separation=function(n){return arguments.length?(e=n,t):e},t.size=function(e){return arguments.length?(o=!1,n=+e[0],i=+e[1],t):o?null:[n,i]},t.nodeSize=function(e){return arguments.length?(o=!0,n=+e[0],i=+e[1],t):o?[n,i]:null},t},my=function(t){var e,n,i,o,r=this,s=[r];do for(e=s.reverse(),s=[];r=e.pop();)if(t(r),n=r.children)for(i=0,o=n.length;i<o;++i)s.push(n[i]);while(s.length);return this},vy=function(t){for(var e,n,i=this,o=[i];i=o.pop();)if(t(i),e=i.children)for(n=e.length-1;n>=0;--n)o.push(e[n]);return this},yy=function(t){for(var e,n,i,o=this,r=[o],s=[];o=r.pop();)if(s.push(o),e=o.children)for(n=0,i=e.length;n<i;++n)r.push(e[n]);for(;o=s.pop();)t(o);return this},by=function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,o=i&&i.length;--o>=0;)n+=i[o].value;e.value=n})},Sy=function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},xy=function(t){for(var e=this,n=Nr(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var o=i.length;t!==n;)i.splice(o,0,t),t=t.parent;return i},Cy=function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},Ey=function(){var t=[];return this.each(function(e){t.push(e)}),t},wy=function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},Ay=function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e};$r.prototype=Rr.prototype={constructor:$r,each:my,eachAfter:yy,eachBefore:vy,sum:by,sort:Sy,path:xy,ancestors:Cy,descendants:Ey,leaves:wy,links:Ay,copy:Dr};var Ty=function(t){for(var e,n=(t=t.slice()).length,i=null,o=i;n;){var r=new Lr(t[n-1]);o=o?o.next=r:i=r,t[e]=t[--n]}return{head:i,tail:o}},Oy=function(t){return Br(Ty(t),[])},_y=function(t){return Wr(t),t},My=function(t){return function(){return t}},Ny=function(){function t(t){return t.x=n/2,t.y=i/2,e?t.eachBefore(Jr(e)).eachAfter(Zr(o,.5)).eachBefore(ts(1)):t.eachBefore(Jr(Xr)).eachAfter(Zr(Kr,1)).eachAfter(Zr(o,t.r/Math.min(n,i))).eachBefore(ts(Math.min(n,i)/(2*t.r))),t}var e=null,n=1,i=1,o=Kr;return t.radius=function(n){return arguments.length?(e=Yr(n),t):e},t.size=function(e){return arguments.length?(n=+e[0],i=+e[1],t):[n,i]},t.padding=function(e){return arguments.length?(o="function"==typeof e?e:My(+e),t):o},t},Ry=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Dy=function(t,e,n,i,o){for(var r,s=t.children,a=-1,u=s.length,l=t.value&&(i-e)/t.value;++a<u;)r=s[a],r.y0=n,r.y1=o,r.x0=e,r.x1=e+=r.value*l},Iy=function(){function t(t){var s=t.height+1;return t.x0=t.y0=o,t.x1=n,t.y1=i/s,t.eachBefore(e(i,s)),r&&t.eachBefore(Ry),t}function e(t,e){return function(n){n.children&&Dy(n,n.x0,t*(n.depth+1)/e,n.x1,t*(n.depth+2)/e);var i=n.x0,r=n.y0,s=n.x1-o,a=n.y1-o;s<i&&(i=s=(i+s)/2),a<r&&(r=a=(r+a)/2),n.x0=i,n.y0=r,n.x1=s,n.y1=a}}var n=1,i=1,o=0,r=!1;return t.round=function(e){return arguments.length?(r=!!e,t):r},t.size=function(e){return arguments.length?(n=+e[0],i=+e[1],t):[n,i]},t.padding=function(e){return arguments.length?(o=+e,t):o},t},Fy="$",ky={depth:-1},$y={},Ly=function(){function t(t){var i,o,r,s,a,u,l,c=t.length,h=new Array(c),p={};for(o=0;o<c;++o)i=t[o],a=h[o]=new $r(i),null!=(u=e(i,o,t))&&(u+="")&&(l=Fy+(a.id=u),p[l]=l in p?$y:a);for(o=0;o<c;++o)if(a=h[o],u=n(t[o],o,t),null!=u&&(u+="")){if(s=p[Fy+u],!s)throw new Error("missing: "+u);if(s===$y)throw new Error("ambiguous: "+u);s.children?s.children.push(a):s.children=[a],a.parent=s}else{if(r)throw new Error("multiple roots");r=a}if(!r)throw new Error("no root");if(r.parent=ky,r.eachBefore(function(t){t.depth=t.parent.depth+1,--c}).eachBefore(kr),r.parent=null,c>0)throw new Error("cycle");return r}var e=es,n=ns;return t.id=function(n){return arguments.length?(e=Gr(n),t):e},t.parentId=function(e){return arguments.length?(n=Gr(e),t):n},t};ls.prototype=Object.create($r.prototype);var Uy=function(){function t(t){var i=cs(t);if(i.eachAfter(e),i.parent.m=-i.z,i.eachBefore(n),u)t.eachBefore(o);else{var l=t,c=t,h=t;t.eachBefore(function(t){t.x<l.x&&(l=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)});var p=l===c?1:r(l,c)/2,d=p-l.x,f=s/(c.x+p+d),g=a/(h.depth||1);t.eachBefore(function(t){t.x=(t.x+d)*f,t.y=t.depth*g})}return t}function e(t){var e=t.children,n=t.parent.children,o=t.i?n[t.i-1]:null;if(e){as(t);var s=(e[0].z+e[e.length-1].z)/2;o?(t.z=o.z+r(t._,o._),t.m=t.z-s):t.z=s}else o&&(t.z=o.z+r(t._,o._));t.parent.A=i(t,o,t.parent.A||n[0])}function n(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function i(t,e,n){if(e){for(var i,o=t,s=t,a=e,u=o.parent.children[0],l=o.m,c=s.m,h=a.m,p=u.m;a=rs(a),o=os(o),a&&o;)u=os(u),s=rs(s),s.a=t,i=a.z+h-o.z-l+r(a._,o._),i>0&&(ss(us(a,t,n),t,i),l+=i,c+=i),h+=a.m,l+=o.m,p+=u.m,c+=s.m;a&&!rs(s)&&(s.t=a,s.m+=h-c),o&&!os(u)&&(u.t=o,u.m+=l-p,n=t)}return n}function o(t){t.x*=s,t.y=t.depth*a}var r=is,s=1,a=1,u=null;return t.separation=function(e){return arguments.length?(r=e,t):r},t.size=function(e){return arguments.length?(u=!1,s=+e[0],a=+e[1],t):u?null:[s,a]},t.nodeSize=function(e){return arguments.length?(u=!0,s=+e[0],a=+e[1],t):u?[s,a]:null},t},By=function(t,e,n,i,o){for(var r,s=t.children,a=-1,u=s.length,l=t.value&&(o-n)/t.value;++a<u;)r=s[a],r.x0=e,r.x1=i,r.y0=n,r.y1=n+=r.value*l},Py=(1+Math.sqrt(5))/2,Qy=function t(e){function n(t,n,i,o,r){hs(e,t,n,i,o,r)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Py),Vy=function(){function t(t){return t.x0=t.y0=0,t.x1=o,t.y1=r,t.eachBefore(e),s=[0],i&&t.eachBefore(Ry),t}function e(t){var e=s[t.depth],i=t.x0+e,o=t.y0+e,r=t.x1-e,p=t.y1-e;r<i&&(i=r=(i+r)/2),p<o&&(o=p=(o+p)/2),t.x0=i,t.y0=o,t.x1=r,t.y1=p,t.children&&(e=s[t.depth+1]=a(t)/2,i+=h(t)-e,o+=u(t)-e,r-=l(t)-e,p-=c(t)-e,r<i&&(i=r=(i+r)/2),p<o&&(o=p=(o+p)/2),n(t,i,o,r,p))}var n=Qy,i=!1,o=1,r=1,s=[0],a=Kr,u=Kr,l=Kr,c=Kr,h=Kr;return t.round=function(e){return arguments.length?(i=!!e,t):i},t.size=function(e){return arguments.length?(o=+e[0],r=+e[1],t):[o,r]},t.tile=function(e){return arguments.length?(n=Gr(e),t):n},t.padding=function(e){return arguments.length?t.paddingInner(e).paddingOuter(e):t.paddingInner()},t.paddingInner=function(e){return arguments.length?(a="function"==typeof e?e:My(+e),t):a},t.paddingOuter=function(e){return arguments.length?t.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):t.paddingTop()},t.paddingTop=function(e){return arguments.length?(u="function"==typeof e?e:My(+e),t):u},t.paddingRight=function(e){return arguments.length?(l="function"==typeof e?e:My(+e),t):l},t.paddingBottom=function(e){return arguments.length?(c="function"==typeof e?e:My(+e),t):c},t.paddingLeft=function(e){return arguments.length?(h="function"==typeof e?e:My(+e),t):h},t},Hy=function(t,e,n,i,o){function r(t,e,n,i,o,s,a){if(t>=e-1){var l=u[t];return l.x0=i,l.y0=o,l.x1=s,l.y1=a,void 0}for(var h=c[t],p=n/2+h,d=t+1,f=e-1;d<f;){var g=d+f>>>1;c[g]<p?d=g+1:f=g}var m=c[d]-h,v=n-m;if(a-o>s-i){var y=(o*v+a*m)/n;r(t,d,m,i,o,s,y),r(d,e,v,i,y,s,a)}else{var b=(i*v+s*m)/n;r(t,d,m,i,o,b,a),r(d,e,v,b,o,s,a)}}var s,a,u=t.children,l=u.length,c=new Array(l+1);for(c[0]=a=s=0;s<l;++s)c[s+1]=a+=u[s].value;r(0,l,t.value,e,n,i,o)},qy=function(t,e,n,i,o){(1&t.depth?By:Dy)(t,e,n,i,o)},jy=function t(e){function n(t,n,i,o,r){if((s=t._squarify)&&s.ratio===e)for(var s,a,u,l,c,h=-1,p=s.length,d=t.value;++h<p;){for(a=s[h],u=a.children,l=a.value=0,c=u.length;l<c;++l)a.value+=u[l].value;a.dice?Dy(a,n,i,o,i+=(r-i)*a.value/d):By(a,n,i,n+=(o-n)*a.value/d,r),d-=a.value}else t._squarify=s=hs(e,t,n,i,o,r),s.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Py),zy=function(t,e){function n(){var n,o,r=i.length,s=0,a=0;for(n=0;n<r;++n)o=i[n],s+=o.x,a+=o.y;for(s=s/r-t,a=a/r-e,n=0;n<r;++n)o=i[n],o.x-=s,o.y-=a}var i;return null==t&&(t=0),null==e&&(e=0),n.initialize=function(t){i=t},n.x=function(e){return arguments.length?(t=+e,n):t},n.y=function(t){return arguments.length?(e=+t,n):e},n},Wy=function(t){return function(){return t}},Yy=function(){return 1e-6*(Math.random()-.5)},Gy=function(t){function e(){function t(t,e,n,i,o){var r=t.data,a=t.r,d=h+a;{if(!r)return e>l+d||i<l-d||n>c+d||o<c-d;if(r.index>u.index){var f=l-r.x-r.vx,g=c-r.y-r.vy,m=f*f+g*g;m<d*d&&(0===f&&(f=Yy(),m+=f*f),0===g&&(g=Yy(),m+=g*g),m=(d-(m=Math.sqrt(m)))/m*s,u.vx+=(f*=m)*(d=(a*=a)/(p+a)),u.vy+=(g*=m)*d,r.vx-=f*(d=1-d),r.vy-=g*d)}}}for(var e,i,u,l,c,h,p,d=o.length,f=0;f<a;++f)for(i=P(o,ps,ds).visitAfter(n),e=0;e<d;++e)u=o[e],h=r[u.index],p=h*h,l=u.x+u.vx,c=u.y+u.vy,i.visit(t)}function n(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function i(){if(o){var e,n,i=o.length;for(r=new Array(i),e=0;e<i;++e)n=o[e],r[n.index]=+t(n,e,o)}}var o,r,s=1,a=1;return"function"!=typeof t&&(t=Wy(null==t?1:+t)),e.initialize=function(t){o=t,i()},e.iterations=function(t){return arguments.length?(a=+t,e):a},e.strength=function(t){return arguments.length?(s=+t,e):s},e.radius=function(n){return arguments.length?(t="function"==typeof n?n:Wy(+n),i(),e):t},e},Ky=function(t){function e(t){return 1/Math.min(c[t.source.index],c[t.target.index])}function n(e){for(var n=0,i=t.length;n<g;++n)for(var o,r,s,l,c,p,d,f=0;f<i;++f)o=t[f],r=o.source,s=o.target,l=s.x+s.vx-r.x-r.vx||Yy(),c=s.y+s.vy-r.y-r.vy||Yy(),p=Math.sqrt(l*l+c*c),p=(p-u[f])/p*e*a[f],l*=p,c*=p,s.vx-=l*(d=h[f]),s.vy-=c*d,r.vx+=l*(d=1-d),r.vy+=c*d}function i(){if(l){var e,n,i=l.length,d=t.length,f=r(l,p);for(e=0,c=new Array(i);e<d;++e)n=t[e],n.index=e,"object"!=typeof n.source&&(n.source=gs(f,n.source)),"object"!=typeof n.target&&(n.target=gs(f,n.target)),c[n.source.index]=(c[n.source.index]||0)+1,c[n.target.index]=(c[n.target.index]||0)+1;for(e=0,h=new Array(d);e<d;++e)n=t[e],h[e]=c[n.source.index]/(c[n.source.index]+c[n.target.index]);a=new Array(d),o(),u=new Array(d),s()}}function o(){if(l)for(var e=0,n=t.length;e<n;++e)a[e]=+d(t[e],e,t)}function s(){if(l)for(var e=0,n=t.length;e<n;++e)u[e]=+f(t[e],e,t)}var a,u,l,c,h,p=fs,d=e,f=Wy(30),g=1;return null==t&&(t=[]),n.initialize=function(t){l=t,i()},n.links=function(e){return arguments.length?(t=e,i(),n):t},n.id=function(t){return arguments.length?(p=t,n):p},n.iterations=function(t){return arguments.length?(g=+t,n):g},n.strength=function(t){return arguments.length?(d="function"==typeof t?t:Wy(+t),o(),n):d},n.distance=function(t){return arguments.length?(f="function"==typeof t?t:Wy(+t),s(),n):f},n},Xy=10,Jy=Math.PI*(3-Math.sqrt(5)),Zy=function(t){function e(){n(),f.call("tick",s),a<u&&(d.stop(),f.call("end",s))}function n(){var e,n,i=t.length;for(a+=(c-a)*l,p.each(function(t){t(a)}),e=0;e<i;++e)n=t[e],null==n.fx?n.x+=n.vx*=h:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=h:(n.y=n.fy,n.vy=0)}function i(){for(var e,n=0,i=t.length;n<i;++n){if(e=t[n],e.index=n,isNaN(e.x)||isNaN(e.y)){var o=Xy*Math.sqrt(n),r=n*Jy;e.x=o*Math.cos(r),e.y=o*Math.sin(r)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function o(e){return e.initialize&&e.initialize(t),e}var s,a=1,u=.001,l=1-Math.pow(u,1/300),c=0,h=.6,p=r(),d=je(e),f=Re("tick","end");return null==t&&(t=[]),i(),s={tick:n,restart:function(){return d.restart(e),s},stop:function(){return d.stop(),s},nodes:function(e){return arguments.length?(t=e,i(),p.each(o),s):t},alpha:function(t){return arguments.length?(a=+t,s):a},alphaMin:function(t){return arguments.length?(u=+t,s):u},alphaDecay:function(t){return arguments.length?(l=+t,s):+l},alphaTarget:function(t){return arguments.length?(c=+t,s):c},velocityDecay:function(t){return arguments.length?(h=1-t,s):1-h},force:function(t,e){return arguments.length>1?(null==e?p.remove(t):p.set(t,o(e)),s):p.get(t)},find:function(e,n,i){var o,r,s,a,u,l=0,c=t.length;for(null==i?i=1/0:i*=i,l=0;l<c;++l)a=t[l],o=e-a.x,r=n-a.y,s=o*o+r*r,s<i&&(u=a,i=s);return u},on:function(t,e){return arguments.length>1?(f.on(t,e),s):f.on(t)}}},tb=function(){function t(t){var e,a=o.length,u=P(o,ms,vs).visitAfter(n);for(s=t,e=0;e<a;++e)r=o[e],u.visit(i)}function e(){if(o){var t,e,n=o.length;for(a=new Array(n),t=0;t<n;++t)e=o[t],a[e.index]=+u(e,t,o)}}function n(t){var e,n,i,o,r,s=0;if(t.length){for(i=o=r=0;r<4;++r)(e=t[r])&&(n=e.value)&&(s+=n,i+=n*e.x,o+=n*e.y);t.x=i/s,t.y=o/s}else{e=t,e.x=e.data.x,e.y=e.data.y;do s+=a[e.data.index];while(e=e.next)}t.value=s}function i(t,e,n,i){if(!t.value)return!0;var o=t.x-r.x,u=t.y-r.y,p=i-e,d=o*o+u*u;if(p*p/h<d)return d<c&&(0===o&&(o=Yy(),d+=o*o),0===u&&(u=Yy(),d+=u*u),d<l&&(d=Math.sqrt(l*d)),r.vx+=o*t.value*s/d,r.vy+=u*t.value*s/d),!0;if(!(t.length||d>=c)){(t.data!==r||t.next)&&(0===o&&(o=Yy(),d+=o*o),0===u&&(u=Yy(),d+=u*u),d<l&&(d=Math.sqrt(l*d)));do t.data!==r&&(p=a[t.data.index]*s/d,r.vx+=o*p,r.vy+=u*p);while(t=t.next)}}var o,r,s,a,u=Wy(-30),l=1,c=1/0,h=.81;return t.initialize=function(t){o=t,e()},t.strength=function(n){return arguments.length?(u="function"==typeof n?n:Wy(+n),e(),t):u},t.distanceMin=function(e){return arguments.length?(l=e*e,t):Math.sqrt(l)},t.distanceMax=function(e){return arguments.length?(c=e*e,t):Math.sqrt(c)},t.theta=function(e){return arguments.length?(h=e*e,t):Math.sqrt(h)},t},eb=function(t){function e(t){for(var e,n=0,s=i.length;n<s;++n)e=i[n],e.vx+=(r[n]-e.x)*o[n]*t}function n(){if(i){var e,n=i.length;for(o=new Array(n),r=new Array(n),e=0;e<n;++e)o[e]=isNaN(r[e]=+t(i[e],e,i))?0:+s(i[e],e,i)}}var i,o,r,s=Wy(.1);return"function"!=typeof t&&(t=Wy(null==t?0:+t)),e.initialize=function(t){i=t,n()},e.strength=function(t){return arguments.length?(s="function"==typeof t?t:Wy(+t),n(),e):s},e.x=function(i){return arguments.length?(t="function"==typeof i?i:Wy(+i),n(),e):t},e},nb=function(t){function e(t){for(var e,n=0,s=i.length;n<s;++n)e=i[n],e.vy+=(r[n]-e.y)*o[n]*t}function n(){if(i){var e,n=i.length;for(o=new Array(n),r=new Array(n),e=0;e<n;++e)o[e]=isNaN(r[e]=+t(i[e],e,i))?0:+s(i[e],e,i)}}var i,o,r,s=Wy(.1);return"function"!=typeof t&&(t=Wy(null==t?0:+t)),e.initialize=function(t){i=t,n()},e.strength=function(t){return arguments.length?(s="function"==typeof t?t:Wy(+t),n(),e):s},e.y=function(i){return arguments.length?(t="function"==typeof i?i:Wy(+i),n(),e):t},e},ib=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},ob=function(t){var e=t.document.documentElement,n=xv(t).on("dragstart.drag",ib,!0);"onselectstart"in e?n.on("selectstart.drag",ib,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")},rb=function(t){return function(){return t}};Ss.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var sb=function(){function e(t){t.on("mousedown.drag",n).on("touchstart.drag",r).on("touchmove.drag",s).on("touchend.drag touchcancel.drag",a).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function n(){if(!c&&h.apply(this,arguments)){var e=u("mouse",p.apply(this,arguments),Bm,this,arguments);e&&(xv(t.event.view).on("mousemove.drag",i,!0).on("mouseup.drag",o,!0),ob(t.event.view),ys(),l=!1,e("start"))}}function i(){ib(),l=!0,f.mouse("drag")}function o(){xv(t.event.view).on("mousemove.drag mouseup.drag",null),bs(t.event.view,l),ib(),f.mouse("end")}function r(){if(h.apply(this,arguments)){var e,n,i=t.event.changedTouches,o=p.apply(this,arguments),r=i.length;for(e=0;e<r;++e)(n=u(i[e].identifier,o,Ev,this,arguments))&&(ys(),n("start"))}}function s(){var e,n,i=t.event.changedTouches,o=i.length;for(e=0;e<o;++e)(n=f[i[e].identifier])&&(ib(),n("drag"))}function a(){var e,n,i=t.event.changedTouches,o=i.length;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),e=0;e<o;++e)(n=f[i[e].identifier])&&(ys(),n("end"))}function u(n,i,o,r,s){var a,u,l,c=o(i,n),h=g.copy();if(ji(new Ss(e,"beforestart",a,n,m,c[0],c[1],0,0,h),function(){return null!=(t.event.subject=a=d.apply(r,s))&&(u=a.x-c[0]||0,l=a.y-c[1]||0,!0)}))return function t(p){var d,g=c;switch(p){case"start":f[n]=t,d=m++;break;case"end":delete f[n],--m;case"drag":c=o(i,n),d=m}ji(new Ss(e,p,a,n,d,c[0]+u,c[1]+l,c[0]-g[0],c[1]-g[1],h),h.apply,h,[p,r,s])}}var l,c,h=xs,p=Cs,d=Es,f={},g=Re("start","drag","end"),m=0;return e.filter=function(t){return arguments.length?(h="function"==typeof t?t:rb(!!t),e):h},e.container=function(t){return arguments.length?(p="function"==typeof t?t:rb(t),e):p},e.subject=function(t){return arguments.length?(d="function"==typeof t?t:rb(t),e):d},e.on=function(){var t=g.on.apply(g,arguments);return t===g?e:t},e},ab=function(t){return function(){return t}};Ts.prototype={constructor:Ts,insert:function(t,e){var n,i,o;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Ns(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(o=i.R,o&&o.C?(n.C=o.C=!1,i.C=!0,t=i):(t===n.R&&(_s(this,n),t=n,n=t.U),n.C=!1,i.C=!0,Ms(this,i))):(o=i.L,o&&o.C?(n.C=o.C=!1,i.C=!0,t=i):(t===n.L&&(Ms(this,n),t=n,n=t.U),n.C=!1,i.C=!0,_s(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,o=t.U,r=t.L,s=t.R;if(n=r?s?Ns(s):r:s,o?o.L===t?o.L=n:o.R=n:this._=n,r&&s?(i=n.C,n.C=t.C,n.L=r,r.U=n,n!==s?(o=n.U,n.U=t.U,t=n.R,o.L=t,n.R=s,s.U=n):(n.U=o,o=n,t=n.R)):(i=t.C,t=n),t&&(t.U=o),!i){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===o.L){if(e=o.R,e.C&&(e.C=!1,o.C=!0,_s(this,o),e=o.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Ms(this,e),e=o.R),e.C=o.C,o.C=e.R.C=!1,_s(this,o),t=this._;break}}else if(e=o.L,e.C&&(e.C=!1,o.C=!0,Ms(this,o),e=o.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,_s(this,e),e=o.L),e.C=o.C,o.C=e.L.C=!1,Ms(this,o),t=this._;break}e.C=!0,t=o,o=o.U}while(!t.C);t&&(t.C=!1)}}};var ub,lb,cb,hb,pb,db=[],fb=[],gb=1e-6,mb=1e-12;ea.prototype={constructor:ea,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return Bs(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){for(var o,r=n.site,s=n.halfedges,a=-1,u=s.length,l=e[s[u-1]],c=l.left===r?l.right:l.left;++a<u;)o=c,l=e[s[a]],c=l.left===r?l.right:l.left,o&&c&&i<o.index&&i<c.index&&Zs(r,o,c)<0&&t.push([r.data,o.data,c.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){var i,o=this,r=o._found||0,s=o.cells[r]||o.cells[r=0],a=t-s.site[0],u=e-s.site[1],l=a*a+u*u;do s=o.cells[i=r],r=null,s.halfedges.forEach(function(n){var i=o.edges[n],a=i.left;if(a!==s.site&&a||(a=i.right)){var u=t-a[0],c=e-a[1],h=u*u+c*c;h<l&&(l=h,r=a.index)}});while(null!==r);return o._found=i,null==n||l<=n*n?s.site:null}};var vb=function(){function t(t){return new ea(t.map(function(i,o){var r=[Math.round(e(i,o,t)/gb)*gb,Math.round(n(i,o,t)/gb)*gb];return r.index=o,r.data=i,r}),i)}var e=ws,n=As,i=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(e="function"==typeof n?n:ab(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:ab(+e),t):n},t.extent=function(e){return arguments.length?(i=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):i&&[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},t.size=function(e){return arguments.length?(i=null==e?null:[[0,0],[+e[0],+e[1]]],t):i&&[i[1][0]-i[0][0],i[1][1]-i[0][1]]},t},yb=function(t){return function(){return t}};ia.prototype={constructor:ia,scale:function(t){return 1===t?this:new ia(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new ia(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bb=new ia(1,0,0);oa.prototype=ia.prototype;var Sb=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},xb=function(){function e(t){t.on("wheel.zoom",l).on("mousedown.zoom",c).on("dblclick.zoom",h).on("touchstart.zoom",p).on("touchmove.zoom",d).on("touchend.zoom touchcancel.zoom",f).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",ua)}function n(t,e){return e=Math.max(b,Math.min(S,e)),e===t.k?t:new ia(e,t.x,t.y)}function i(t,e,n){var i=e[0]-n[0]*t.k,o=e[1]-n[1]*t.k;return i===t.x&&o===t.y?t:new ia(t.k,i,o)}function o(t,e){var n=t.invertX(e[0][0])-x,i=t.invertX(e[1][0])-C,o=t.invertY(e[0][1])-E,r=t.invertY(e[1][1])-w;return t.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r))}function r(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function s(t,e,n){t.on("start.zoom",function(){a(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){a(this,arguments).end()}).tween("zoom",function(){var t=this,i=arguments,o=a(t,i),s=y.apply(t,i),u=n||r(s),l=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,i):e,p=T(c.invert(u).concat(l/c.k),h.invert(u).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=p(t),n=l/e[2];t=new ia(n,u[0]-e[0]*n,u[1]-e[1]*n)}o.zoom(null,t)}})}function a(t,e){for(var n,i=0,o=O.length;i<o;++i)if((n=O[i]).that===t)return n;return new u(t,e)}function u(t,e){this.that=t,this.args=e,this.index=-1,this.active=0,this.extent=y.apply(t,e)}function l(){function e(){r.wheel=null,r.end()}if(v.apply(this,arguments)){var r=a(this,arguments),s=this.__zoom,u=Math.max(b,Math.min(S,s.k*Math.pow(2,-t.event.deltaY*(t.event.deltaMode?120:1)/500))),l=Bm(this);if(r.wheel)r.mouse[0][0]===l[0]&&r.mouse[0][1]===l[1]||(r.mouse[1]=s.invert(r.mouse[0]=l)),clearTimeout(r.wheel);else{if(s.k===u)return;r.mouse=[l,s.invert(l)],kv(this),r.start()}Sb(),r.wheel=setTimeout(e,N),r.zoom("mouse",o(i(n(s,u),r.mouse[0],r.mouse[1]),r.extent))}}function c(){function e(){Sb(),r.moved=!0,r.zoom("mouse",o(i(r.that.__zoom,r.mouse[0]=Bm(r.that),r.mouse[1]),r.extent))}function n(){s.on("mousemove.zoom mouseup.zoom",null),bs(t.event.view,r.moved),Sb(),r.end()}if(!m&&v.apply(this,arguments)){var r=a(this,arguments),s=xv(t.event.view).on("mousemove.zoom",e,!0).on("mouseup.zoom",n,!0),u=Bm(this);ob(t.event.view),ra(),r.mouse=[u,this.__zoom.invert(u)],kv(this),r.start()}}function h(){if(v.apply(this,arguments)){var r=this.__zoom,a=Bm(this),u=r.invert(a),l=r.k*(t.event.shiftKey?.5:2),c=o(i(n(r,l),a,u),y.apply(this,arguments));Sb(),A>0?xv(this).transition().duration(A).call(s,c,a):xv(this).call(e.transform,c)}}function p(){if(v.apply(this,arguments)){var e,n,i,o=a(this,arguments),r=t.event.changedTouches,s=r.length;for(ra(),e=0;e<s;++e)n=r[e],i=Ev(this,r,n.identifier),i=[i,this.__zoom.invert(i),n.identifier],o.touch0?o.touch1||(o.touch1=i):o.touch0=i;return g&&(g=clearTimeout(g),!o.touch1)?(o.end(),i=xv(this).on("dblclick.zoom"),void(i&&i.apply(this,arguments))):void(t.event.touches.length===s&&(g=setTimeout(function(){g=null},M),kv(this),o.start()))}}function d(){var e,r,s,u,l=a(this,arguments),c=t.event.changedTouches,h=c.length;for(Sb(),g&&(g=clearTimeout(g)),e=0;e<h;++e)r=c[e],s=Ev(this,c,r.identifier),l.touch0&&l.touch0[2]===r.identifier?l.touch0[0]=s:l.touch1&&l.touch1[2]===r.identifier&&(l.touch1[0]=s);if(r=l.that.__zoom,l.touch1){var p=l.touch0[0],d=l.touch0[1],f=l.touch1[0],m=l.touch1[1],v=(v=f[0]-p[0])*v+(v=f[1]-p[1])*v,y=(y=m[0]-d[0])*y+(y=m[1]-d[1])*y;r=n(r,Math.sqrt(v/y)),s=[(p[0]+f[0])/2,(p[1]+f[1])/2],u=[(d[0]+m[0])/2,(d[1]+m[1])/2]}else{if(!l.touch0)return;s=l.touch0[0],u=l.touch0[1]}l.zoom("touch",o(i(r,s,u),l.extent))}function f(){var e,n,i=a(this,arguments),o=t.event.changedTouches,r=o.length;for(ra(),m&&clearTimeout(m),m=setTimeout(function(){m=null},M),e=0;e<r;++e)n=o[e],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0||i.end()}var g,m,v=sa,y=aa,b=0,S=1/0,x=-S,C=S,E=x,w=C,A=250,T=Md,O=[],_=Re("start","zoom","end"),M=500,N=150;return e.transform=function(t,e){var n=t.selection?t.selection():t;n.property("__zoom",ua),t!==n?s(t,e):n.interrupt().each(function(){a(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},e.scaleBy=function(t,n){e.scaleTo(t,function(){var t=this.__zoom.k,e="function"==typeof n?n.apply(this,arguments):n;return t*e})},e.scaleTo=function(t,s){e.transform(t,function(){var t=y.apply(this,arguments),e=this.__zoom,a=r(t),u=e.invert(a),l="function"==typeof s?s.apply(this,arguments):s;return o(i(n(e,l),a,u),t)})},e.translateBy=function(t,n,i){e.transform(t,function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof i?i.apply(this,arguments):i),y.apply(this,arguments))})},u.prototype={start:function(){return 1===++this.active&&(this.index=O.push(this)-1,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(O.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){ji(new na(e,t,this.that.__zoom),_.apply,_,[t,this.that,this.args])}},e.filter=function(t){return arguments.length?(v="function"==typeof t?t:yb(!!t),e):v},e.extent=function(t){return arguments.length?(y="function"==typeof t?t:yb([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),e):y},e.scaleExtent=function(t){return arguments.length?(b=+t[0],S=+t[1],e):[b,S]},e.translateExtent=function(t){return arguments.length?(x=+t[0][0],C=+t[1][0],E=+t[0][1],w=+t[1][1],e):[[x,E],[C,w]]},e.duration=function(t){return arguments.length?(A=+t,e):A},e.interpolate=function(t){return arguments.length?(T=t,e):T},e.on=function(){var t=_.on.apply(_,arguments);return t===_?e:t},e},Cb=function(t){return function(){return t}},Eb=function(t,e,n){this.target=t,this.type=e,this.selection=n},wb=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},Ab={name:"drag"},Tb={name:"space"},Ob={name:"handle"},_b={name:"center"},Mb={name:"x",handles:["e","w"].map(ca),input:function(t,e){return t&&[[t[0],e[0][1]],[t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Nb={name:"y",handles:["n","s"].map(ca),input:function(t,e){return t&&[[e[0][0],t[0]],[e[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Rb={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(ca),input:function(t){return t},output:function(t){return t}},Db={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ib={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Fb={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},kb={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},$b={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},Lb=function(){return ya(Rb)},Ub=Math.cos,Bb=Math.sin,Pb=Math.PI,Qb=Pb/2,Vb=2*Pb,Hb=Math.max,qb=function(){function t(t){var r,s,a,u,l,c,h=t.length,p=[],d=Ul(h),f=[],g=[],m=g.groups=new Array(h),v=new Array(h*h);for(r=0,l=-1;++l<h;){for(s=0,c=-1;++c<h;)s+=t[l][c];p.push(s),f.push(Ul(h)),r+=s}for(n&&d.sort(function(t,e){return n(p[t],p[e])}),i&&f.forEach(function(e,n){e.sort(function(e,o){return i(t[n][e],t[n][o])})}),r=Hb(0,Vb-e*h)/r,u=r?e:Vb/h,s=0,l=-1;++l<h;){for(a=s,c=-1;++c<h;){var y=d[l],b=f[y][c],S=t[y][b],x=s,C=s+=S*r;v[b*h+y]={index:y,subindex:b,startAngle:x,endAngle:C,value:S}}m[y]={index:y,startAngle:a,endAngle:s,value:p[y]},s+=u}for(l=-1;++l<h;)for(c=l-1;++c<h;){var E=v[c*h+l],w=v[l*h+c];(E.value||w.value)&&g.push(E.value<w.value?{source:w,target:E}:{source:E,target:w})}return o?g.sort(o):g}var e=0,n=null,i=null,o=null;return t.padAngle=function(n){return arguments.length?(e=Hb(0,n),t):e},t.sortGroups=function(e){return arguments.length?(n=e,t):n},t.sortSubgroups=function(e){return arguments.length?(i=e,t):i},t.sortChords=function(e){return arguments.length?(null==e?o=null:(o=ba(e))._=e,t):o&&o._},t},jb=Array.prototype.slice,zb=function(t){return function(){return t}},Wb=function(){function t(){var t,a=jb.call(arguments),u=e.apply(this,a),l=n.apply(this,a),c=+i.apply(this,(a[0]=u,a)),h=o.apply(this,a)-Qb,p=r.apply(this,a)-Qb,d=c*Ub(h),f=c*Bb(h),g=+i.apply(this,(a[0]=l,a)),m=o.apply(this,a)-Qb,v=r.apply(this,a)-Qb;if(s||(s=t=F()),s.moveTo(d,f),s.arc(0,0,c,h,p),h===m&&p===v||(s.quadraticCurveTo(0,0,g*Ub(m),g*Bb(m)),s.arc(0,0,g,m,v)),s.quadraticCurveTo(0,0,d,f),s.closePath(),t)return s=null,t+""||null}var e=Sa,n=xa,i=Ca,o=Ea,r=wa,s=null;return t.radius=function(e){return arguments.length?(i="function"==typeof e?e:zb(+e),t):i},t.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:zb(+e),t):o},t.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:zb(+e),t):r},t.source=function(n){return arguments.length?(e=n,t):e},t.target=function(e){
return arguments.length?(n=e,t):n},t.context=function(e){return arguments.length?(s=null==e?null:e,t):s},t},Yb=function(){return new Aa};Aa.prototype={constructor:Aa,reset:function(){this.s=this.t=0},add:function(t){Ta(TS,t,this.t),Ta(this,TS.s,this.s),this.s?this.t+=TS.t:this.s=TS.t},valueOf:function(){return this.s}};var Gb,Kb,Xb,Jb,Zb,tS,eS,nS,iS,oS,rS,sS,aS,uS,lS,cS,hS,pS,dS,fS,gS,mS,vS,yS,bS,SS,xS,CS,ES,wS,AS,TS=new Aa,OS=1e-6,_S=1e-12,MS=Math.PI,NS=MS/2,RS=MS/4,DS=2*MS,IS=180/MS,FS=MS/180,kS=Math.abs,$S=Math.atan,LS=Math.atan2,US=Math.cos,BS=Math.ceil,PS=Math.exp,QS=Math.log,VS=Math.pow,HS=Math.sin,qS=Math.sign||function(t){return t>0?1:t<0?-1:0},jS=Math.sqrt,zS=Math.tan,WS={Feature:function(t,e){Ra(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,o=n.length;++i<o;)Ra(n[i].geometry,e)}},YS={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,o=n.length;++i<o;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Da(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,o=n.length;++i<o;)Da(n[i],e,0)},Polygon:function(t,e){Ia(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,o=n.length;++i<o;)Ia(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,o=n.length;++i<o;)Ra(n[i],e)}},GS=function(t,e){t&&WS.hasOwnProperty(t.type)?WS[t.type](t,e):Ra(t,e)},KS=Yb(),XS=Yb(),JS={point:Na,lineStart:Na,lineEnd:Na,polygonStart:function(){KS.reset(),JS.lineStart=Fa,JS.lineEnd=ka},polygonEnd:function(){var t=+KS;XS.add(t<0?DS+t:t),this.lineStart=this.lineEnd=this.point=Na},sphere:function(){XS.add(DS)}},ZS=function(t){return XS.reset(),GS(t,JS),2*XS},tx=Yb(),ex={point:ja,lineStart:Wa,lineEnd:Ya,polygonStart:function(){ex.point=Ga,ex.lineStart=Ka,ex.lineEnd=Xa,tx.reset(),JS.polygonStart()},polygonEnd:function(){JS.polygonEnd(),ex.point=ja,ex.lineStart=Wa,ex.lineEnd=Ya,KS<0?(tS=-(nS=180),eS=-(iS=90)):tx>OS?iS=90:tx<-OS&&(eS=-90),lS[0]=tS,lS[1]=nS}},nx=function(t){var e,n,i,o,r,s,a;if(iS=nS=-(tS=eS=1/0),uS=[],GS(t,ex),n=uS.length){for(uS.sort(Za),e=1,i=uS[0],r=[i];e<n;++e)o=uS[e],tu(i,o[0])||tu(i,o[1])?(Ja(i[0],o[1])>Ja(i[0],i[1])&&(i[1]=o[1]),Ja(o[0],i[1])>Ja(i[0],i[1])&&(i[0]=o[0])):r.push(i=o);for(s=-(1/0),n=r.length-1,e=0,i=r[n];e<=n;i=o,++e)o=r[e],(a=Ja(i[1],o[0]))>s&&(s=a,tS=o[0],nS=i[1])}return uS=lS=null,tS===1/0||eS===1/0?[[NaN,NaN],[NaN,NaN]]:[[tS,eS],[nS,iS]]},ix={sphere:Na,point:eu,lineStart:iu,lineEnd:su,polygonStart:function(){ix.lineStart=au,ix.lineEnd=uu},polygonEnd:function(){ix.lineStart=iu,ix.lineEnd=su}},ox=function(t){cS=hS=pS=dS=fS=gS=mS=vS=yS=bS=SS=0,GS(t,ix);var e=yS,n=bS,i=SS,o=e*e+n*n+i*i;return o<_S&&(e=gS,n=mS,i=vS,hS<OS&&(e=pS,n=dS,i=fS),o=e*e+n*n+i*i,o<_S)?[NaN,NaN]:[LS(n,e)*IS,_a(i/jS(o))*IS]},rx=function(t){return function(){return t}},sx=function(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n};hu.invert=hu;var ax,ux,lx,cx,hx,px,dx,fx,gx,mx,vx,yx=function(t){function e(e){return e=t(e[0]*FS,e[1]*FS),e[0]*=IS,e[1]*=IS,e}return t=pu(t[0]*FS,t[1]*FS,t.length>2?t[2]*FS:0),e.invert=function(e){return e=t.invert(e[0]*FS,e[1]*FS),e[0]*=IS,e[1]*=IS,e},e},bx=function(){function t(t,e){n.push(t=i(t,e)),t[0]*=IS,t[1]*=IS}function e(){var t=o.apply(this,arguments),e=r.apply(this,arguments)*FS,u=s.apply(this,arguments)*FS;return n=[],i=pu(-t[0]*FS,-t[1]*FS,0).invert,mu(a,e,u,1),t={type:"Polygon",coordinates:[n]},n=i=null,t}var n,i,o=rx([0,0]),r=rx(90),s=rx(6),a={point:t};return e.center=function(t){return arguments.length?(o="function"==typeof t?t:rx([+t[0],+t[1]]),e):o},e.radius=function(t){return arguments.length?(r="function"==typeof t?t:rx(+t),e):r},e.precision=function(t){return arguments.length?(s="function"==typeof t?t:rx(+t),e):s},e},Sx=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Na,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},xx=function(t,e,n,i,o,r){var s,a=t[0],u=t[1],l=e[0],c=e[1],h=0,p=1,d=l-a,f=c-u;if(s=n-a,d||!(s>0)){if(s/=d,d<0){if(s<h)return;s<p&&(p=s)}else if(d>0){if(s>p)return;s>h&&(h=s)}if(s=o-a,d||!(s<0)){if(s/=d,d<0){if(s>p)return;s>h&&(h=s)}else if(d>0){if(s<h)return;s<p&&(p=s)}if(s=i-u,f||!(s>0)){if(s/=f,f<0){if(s<h)return;s<p&&(p=s)}else if(f>0){if(s>p)return;s>h&&(h=s)}if(s=r-u,f||!(s<0)){if(s/=f,f<0){if(s>p)return;s>h&&(h=s)}else if(f>0){if(s<h)return;s<p&&(p=s)}return h>0&&(t[0]=a+h*d,t[1]=u+h*f),p<1&&(e[0]=a+p*d,e[1]=u+p*f),!0}}}}},Cx=function(t,e){return kS(t[0]-e[0])<OS&&kS(t[1]-e[1])<OS},Ex=function(t,e,n,i,o){var r,s,a=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],s=t[e];if(Cx(i,s)){for(o.lineStart(),r=0;r<e;++r)o.point((i=t[r])[0],i[1]);return void o.lineEnd()}a.push(n=new yu(i,t,null,!0)),u.push(n.o=new yu(i,null,n,!1)),a.push(n=new yu(s,t,null,!1)),u.push(n.o=new yu(s,null,n,!0))}}),a.length){for(u.sort(e),bu(a),bu(u),r=0,s=u.length;r<s;++r)u[r].e=n=!n;for(var l,c,h=a[0];;){for(var p=h,d=!0;p.v;)if((p=p.n)===h)return;l=p.z,o.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(r=0,s=l.length;r<s;++r)o.point((c=l[r])[0],c[1]);else i(p.x,p.n.x,1,o);p=p.n}else{if(d)for(l=p.p.z,r=l.length-1;r>=0;--r)o.point((c=l[r])[0],c[1]);else i(p.x,p.p.x,-1,o);p=p.p}p=p.o,l=p.z,d=!d}while(!p.v);o.lineEnd()}}},wx=1e9,Ax=-wx,Tx=function(){var t,e,n,i=0,o=0,r=960,s=500;return n={stream:function(n){return t&&e===n?t:t=Su(i,o,r,s)(e=n)},extent:function(a){return arguments.length?(i=+a[0][0],o=+a[0][1],r=+a[1][0],s=+a[1][1],t=e=null,n):[[i,o],[r,s]]}}},Ox=Yb(),_x={sphere:Na,point:Na,lineStart:xu,lineEnd:Na,polygonStart:Na,polygonEnd:Na},Mx=function(t){return Ox.reset(),GS(t,_x),+Ox},Nx=[null,null],Rx={type:"LineString",coordinates:Nx},Dx=function(t,e){return Nx[0]=t,Nx[1]=e,Mx(Rx)},Ix=function(t,e){var n=t[0]*FS,i=t[1]*FS,o=e[0]*FS,r=e[1]*FS,s=US(i),a=HS(i),u=US(r),l=HS(r),c=s*US(n),h=s*HS(n),p=u*US(o),d=u*HS(o),f=2*_a(jS(Ma(r-i)+s*u*Ma(o-n))),g=HS(f),m=f?function(t){var e=HS(t*=f)/g,n=HS(f-t)/g,i=n*c+e*p,o=n*h+e*d,r=n*a+e*l;return[LS(o,i)*IS,LS(r,jS(i*i+o*o))*IS]}:function(){return[n*IS,i*IS]};return m.distance=f,m},Fx=function(t){return t},kx=Yb(),$x=Yb(),Lx={point:Na,lineStart:Na,lineEnd:Na,polygonStart:function(){Lx.lineStart=Mu,Lx.lineEnd=Du},polygonEnd:function(){Lx.lineStart=Lx.lineEnd=Lx.point=Na,kx.add(kS($x)),$x.reset()},result:function(){var t=kx/2;return kx.reset(),t}},Ux=1/0,Bx=Ux,Px=-Ux,Qx=Px,Vx={point:Iu,lineStart:Na,lineEnd:Na,polygonStart:Na,polygonEnd:Na,result:function(){var t=[[Ux,Bx],[Px,Qx]];return Px=Qx=-(Bx=Ux=1/0),t}},Hx=0,qx=0,jx=0,zx=0,Wx=0,Yx=0,Gx=0,Kx=0,Xx=0,Jx={point:Fu,lineStart:ku,lineEnd:Uu,polygonStart:function(){Jx.lineStart=Bu,Jx.lineEnd=Pu},polygonEnd:function(){Jx.point=Fu,Jx.lineStart=ku,Jx.lineEnd=Uu},result:function(){var t=Xx?[Gx/Xx,Kx/Xx]:Yx?[zx/Yx,Wx/Yx]:jx?[Hx/jx,qx/jx]:[NaN,NaN];return Hx=qx=jx=zx=Wx=Yx=Gx=Kx=Xx=0,t}};Hu.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,DS)}},result:Na},qu.prototype={_circle:ju(4.5),pointRadius:function(t){return this._circle=ju(t),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}}};var Zx=function(t,e){function n(t){return t&&("function"==typeof r&&o.pointRadius(+r.apply(this,arguments)),GS(t,i(o))),o.result()}var i,o,r=4.5;return n.area=function(t){return GS(t,i(Lx)),Lx.result()},n.bounds=function(t){return GS(t,i(Vx)),Vx.result()},n.centroid=function(t){return GS(t,i(Jx)),Jx.result()},n.projection=function(e){return arguments.length?(i=null==e?(t=null,Fx):(t=e).stream,n):t},n.context=function(t){return arguments.length?(o=null==t?(e=null,new qu):new Hu(e=t),"function"!=typeof r&&o.pointRadius(r),n):e},n.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(o.pointRadius(+t),+t),n):r},n.projection(t).context(e)},tC=Yb(),eC=function(t,e){var n=e[0],i=e[1],o=[HS(n),-US(n),0],r=0,s=0;tC.reset();for(var a=0,u=t.length;a<u;++a)if(c=(l=t[a]).length)for(var l,c,h=l[c-1],p=h[0],d=h[1]/2+RS,f=HS(d),g=US(d),m=0;m<c;++m,p=y,f=S,g=x,h=v){var v=l[m],y=v[0],b=v[1]/2+RS,S=HS(b),x=US(b),C=y-p,E=C>=0?1:-1,w=E*C,A=w>MS,T=f*S;if(tC.add(LS(T*E*HS(w),g*x+T*US(w))),r+=A?C+E*DS:C,A^p>=n^y>=n){var O=Qa(Ba(h),Ba(v));qa(O);var _=Qa(o,O);qa(_);var M=(A^C>=0?-1:1)*_a(_[2]);(i>M||i===M&&(O[0]||O[1]))&&(s+=A^C>=0?1:-1)}}return(r<-OS||r<OS&&tC<-OS)^1&s},nC=function(t,e,n,i){return function(o,r){function s(e,n){var i=o(e,n);t(e=i[0],n=i[1])&&r.point(e,n)}function a(t,e){var n=o(t,e);m.point(n[0],n[1])}function u(){x.point=a,m.lineStart()}function l(){x.point=s,m.lineEnd()}function c(t,e){g.push([t,e]);var n=o(t,e);b.point(n[0],n[1])}function h(){b.lineStart(),g=[]}function p(){c(g[0][0],g[0][1]),b.lineEnd();var t,e,n,i,o=b.clean(),s=y.result(),a=s.length;if(g.pop(),d.push(g),g=null,a)if(1&o){if(n=s[0],(e=n.length-1)>0){for(S||(r.polygonStart(),S=!0),r.lineStart(),t=0;t<e;++t)r.point((i=n[t])[0],i[1]);r.lineEnd()}}else a>1&&2&o&&s.push(s.pop().concat(s.shift())),f.push(s.filter(zu))}var d,f,g,m=e(r),v=o.invert(i[0],i[1]),y=Sx(),b=e(y),S=!1,x={point:s,lineStart:u,lineEnd:l,polygonStart:function(){x.point=c,x.lineStart=h,x.lineEnd=p,f=[],d=[]},polygonEnd:function(){x.point=s,x.lineStart=u,x.lineEnd=l,f=Xl(f);var t=eC(d,v);f.length?(S||(r.polygonStart(),S=!0),Ex(f,Wu,t,n,r)):t&&(S||(r.polygonStart(),S=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),S&&(r.polygonEnd(),S=!1),f=d=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};return x}},iC=nC(function(){return!0},Yu,Ku,[-MS,-NS]),oC=function(t,e){function n(n,i,o,r){mu(r,t,e,o,n,i)}function i(t,e){return US(t)*US(e)>a}function o(t){var e,n,o,a,c;return{lineStart:function(){a=o=!1,c=1},point:function(h,p){var d,f=[h,p],g=i(h,p),m=u?g?0:s(h,p):g?s(h+(h<0?MS:-MS),p):0;if(!e&&(a=o=g)&&t.lineStart(),g!==o&&(d=r(e,f),(Cx(e,d)||Cx(f,d))&&(f[0]+=OS,f[1]+=OS,g=i(f[0],f[1]))),g!==o)c=0,g?(t.lineStart(),d=r(f,e),t.point(d[0],d[1])):(d=r(e,f),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(l&&e&&u^g){var v;m&n||!(v=r(f,e,!0))||(c=0,u?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||e&&Cx(e,f)||t.point(f[0],f[1]),e=f,o=g,n=m},lineEnd:function(){o&&t.lineEnd(),e=null},clean:function(){return c|(a&&o)<<1}}}function r(t,e,n){var i=Ba(t),o=Ba(e),r=[1,0,0],s=Qa(i,o),u=Pa(s,s),l=s[0],c=u-l*l;if(!c)return!n&&t;var h=a*u/c,p=-a*l/c,d=Qa(r,s),f=Ha(r,h),g=Ha(s,p);Va(f,g);var m=d,v=Pa(f,m),y=Pa(m,m),b=v*v-y*(Pa(f,f)-1);if(!(b<0)){var S=jS(b),x=Ha(m,(-v-S)/y);if(Va(x,f),x=Ua(x),!n)return x;var C,E=t[0],w=e[0],A=t[1],T=e[1];w<E&&(C=E,E=w,w=C);var O=w-E,_=kS(O-MS)<OS,M=_||O<OS;if(!_&&T<A&&(C=A,A=T,T=C),M?_?A+T>0^x[1]<(kS(x[0]-E)<OS?A:T):A<=x[1]&&x[1]<=T:O>MS^(E<=x[0]&&x[0]<=w)){var N=Ha(m,(-v+S)/y);return Va(N,f),[x,Ua(N)]}}}function s(e,n){var i=u?t:MS-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}var a=US(t),u=a>0,l=kS(a)>OS;return nC(i,o,n,u?[0,-t]:[-MS,t-MS])},rC=function(t){return{stream:Xu(t)}};Ju.prototype={constructor:Ju,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var sC=16,aC=US(30*FS),uC=function(t,e){return+e?nl(t,e):el(t)},lC=Xu({point:function(t,e){this.stream.point(t*FS,e*FS)}}),cC=function(){return rl(al).scale(155.424).center([0,33.6442])},hC=function(){return cC().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},pC=function(){function t(t){var e=t[0],n=t[1];return a=null,o.point(e,n),a||(r.point(e,n),a)||(s.point(e,n),a)}function e(){return n=i=null,t}var n,i,o,r,s,a,u=hC(),l=cC().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=cC().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){a=[t,e]}};return t.invert=function(t){var e=u.scale(),n=u.translate(),i=(t[0]-n[0])/e,o=(t[1]-n[1])/e;return(o>=.12&&o<.234&&i>=-.425&&i<-.214?l:o>=.166&&o<.234&&i>=-.214&&i<-.115?c:u).invert(t)},t.stream=function(t){return n&&i===t?n:n=ul([u.stream(i=t),l.stream(t),c.stream(t)])},t.precision=function(t){return arguments.length?(u.precision(t),l.precision(t),c.precision(t),e()):u.precision()},t.scale=function(e){return arguments.length?(u.scale(e),l.scale(.35*e),c.scale(e),t.translate(u.translate())):u.scale()},t.translate=function(t){if(!arguments.length)return u.translate();var n=u.scale(),i=+t[0],a=+t[1];return o=u.translate(t).clipExtent([[i-.455*n,a-.238*n],[i+.455*n,a+.238*n]]).stream(h),r=l.translate([i-.307*n,a+.201*n]).clipExtent([[i-.425*n+OS,a+.12*n+OS],[i-.214*n-OS,a+.234*n-OS]]).stream(h),s=c.translate([i-.205*n,a+.212*n]).clipExtent([[i-.214*n+OS,a+.166*n+OS],[i-.115*n-OS,a+.234*n-OS]]).stream(h),e()},t.fitExtent=function(e,n){return Zu(t,e,n)},t.fitSize=function(e,n){return tl(t,e,n)},t.scale(1070)},dC=ll(function(t){return jS(2/(1+t))});dC.invert=cl(function(t){return 2*_a(t/2)});var fC=function(){return il(dC).scale(124.75).clipAngle(179.999)},gC=ll(function(t){return(t=Oa(t))&&t/HS(t)});gC.invert=cl(function(t){return t});var mC=function(){return il(gC).scale(79.4188).clipAngle(179.999)};hl.invert=function(t,e){return[t,2*$S(PS(e))-NS]};var vC=function(){return pl(hl).scale(961/DS)},yC=function(){return rl(fl).scale(109.5).parallels([30,30])};gl.invert=gl;var bC=function(){return il(gl).scale(152.63)},SC=function(){return rl(ml).scale(131.154).center([0,13.9389])};vl.invert=cl($S);var xC=function(){return il(vl).scale(144.049).clipAngle(60)},CC=function(){function t(){return o=r=null,s}var e,n,i,o,r,s,a=1,u=0,l=0,c=1,h=1,p=Fx,d=null,f=Fx;return s={stream:function(t){return o&&r===t?o:o=p(f(r=t))},clipExtent:function(o){return arguments.length?(f=null==o?(d=e=n=i=null,Fx):Su(d=+o[0][0],e=+o[0][1],n=+o[1][0],i=+o[1][1]),t()):null==d?null:[[d,e],[n,i]]},scale:function(e){return arguments.length?(p=yl((a=+e)*c,a*h,u,l),t()):a},translate:function(e){return arguments.length?(p=yl(a*c,a*h,u=+e[0],l=+e[1]),t()):[u,l]},reflectX:function(e){return arguments.length?(p=yl(a*(c=e?-1:1),a*h,u,l),t()):c<0},reflectY:function(e){return arguments.length?(p=yl(a*c,a*(h=e?-1:1),u,l),t()):h<0},fitExtent:function(t,e){return Zu(s,t,e)},fitSize:function(t,e){return tl(s,t,e)}}};bl.invert=cl(_a);var EC=function(){return il(bl).scale(249.5).clipAngle(90+OS)};Sl.invert=cl(function(t){return 2*$S(t)});var wC=function(){return il(Sl).scale(250).clipAngle(142)};xl.invert=function(t,e){return[-e,2*$S(PS(t))-NS]};var AC=function(){var t=pl(xl),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90]).scale(159.155)};t.version=Cl,t.bisect=Tl,t.bisectRight=Tl,t.bisectLeft=Ol,t.ascending=El,t.bisector=wl,t.descending=_l,t.deviation=Rl,t.extent=Dl,t.histogram=ql,t.thresholdFreedmanDiaconis=zl,t.thresholdScott=Wl,t.thresholdSturges=Hl,t.max=Yl,t.mean=Gl,t.median=Kl,t.merge=Xl,t.min=Jl,t.pairs=Zl,t.permute=tc,t.quantile=jl,t.range=Ul,t.scan=ec,t.shuffle=nc,t.sum=ic,t.ticks=Vl,t.tickStep=n,t.transpose=oc,t.variance=Nl,t.zip=rc,t.entries=hc,t.keys=lc,t.values=cc,t.map=r,t.set=h,t.nest=ac,t.randomUniform=pc,t.randomNormal=dc,t.randomLogNormal=fc,t.randomBates=mc,t.randomIrwinHall=gc,t.randomExponential=vc,t.easeLinear=p,t.easeQuad=g,t.easeQuadIn=d,t.easeQuadOut=f,t.easeQuadInOut=g,t.easeCubic=y,t.easeCubicIn=m,t.easeCubicOut=v,t.easeCubicInOut=y,t.easePoly=xc,t.easePolyIn=bc,t.easePolyOut=Sc,t.easePolyInOut=xc,t.easeSin=x,t.easeSinIn=b,t.easeSinOut=S,t.easeSinInOut=x,t.easeExp=w,t.easeExpIn=C,t.easeExpOut=E,t.easeExpInOut=w,t.easeCircle=O,t.easeCircleIn=A,t.easeCircleOut=T,t.easeCircleInOut=O,t.easeBounce=M,t.easeBounceIn=_,t.easeBounceOut=M,t.easeBounceInOut=N,t.easeBack=Lc,t.easeBackIn=kc,t.easeBackOut=$c,t.easeBackInOut=Lc,t.easeElastic=Vc,t.easeElasticIn=Qc,t.easeElasticOut=Vc,t.easeElasticInOut=Hc,t.polygonArea=qc,t.polygonCentroid=jc,t.polygonHull=Wc,t.polygonContains=Yc,t.polygonLength=Gc,t.path=F,t.quadtree=P,t.queue=G,t.arc=xh,t.area=wh,t.line=Eh,t.pie=Oh,t.radialArea=Nh,t.radialLine=Mh,t.symbol=Kh,t.symbols=Gh,t.symbolCircle=Rh,t.symbolCross=Dh,t.symbolDiamond=kh,t.symbolSquare=Qh,t.symbolStar=Ph,t.symbolTriangle=Hh,t.symbolWye=Yh,t.curveBasisClosed=Zh,t.curveBasisOpen=tp,t.curveBasis=Jh,t.curveBundle=ep,t.curveCardinalClosed=ip,t.curveCardinalOpen=op,t.curveCardinal=np,t.curveCatmullRomClosed=sp,t.curveCatmullRomOpen=ap,t.curveCatmullRom=rp,t.curveLinearClosed=up,t.curveLinear=Ch,t.curveMonotoneX=Rt,t.curveMonotoneY=Dt,t.curveNatural=lp,t.curveStep=cp,t.curveStepAfter=Lt,t.curveStepBefore=$t,t.stack=fp,t.stackOffsetExpand=gp,t.stackOffsetNone=pp,t.stackOffsetSilhouette=mp,t.stackOffsetWiggle=vp,t.stackOrderAscending=yp,t.stackOrderDescending=bp,t.stackOrderInsideOut=Sp,t.stackOrderNone=dp,t.stackOrderReverse=xp,t.color=Vt,t.rgb=zt,t.hsl=Kt,t.lab=te,t.hcl=ae,t.cubehelix=ce,t.interpolate=yd,t.interpolateArray=hd,t.interpolateDate=pd,t.interpolateNumber=dd,t.interpolateObject=fd,t.interpolateRound=bd,t.interpolateString=vd,t.interpolateTransformCss=Ed,t.interpolateTransformSvg=wd,t.interpolateZoom=Md,t.interpolateRgb=ud,t.interpolateRgbBasis=ld,t.interpolateRgbBasisClosed=cd,t.interpolateHsl=Nd,t.interpolateHslLong=Rd,t.interpolateLab=_e,t.interpolateHcl=Dd,t.interpolateHclLong=Id,t.interpolateCubehelix=Fd,t.interpolateCubehelixLong=kd,t.interpolateBasis=rd,t.interpolateBasisClosed=sd,t.quantize=$d,t.dispatch=Re,t.dsvFormat=Pd,t.csvParse=Vd,t.csvParseRows=Hd,t.csvFormat=qd,t.csvFormatRows=jd,t.tsvParse=Wd,t.tsvParseRows=Yd,t.tsvFormat=Gd,t.tsvFormatRows=Kd,t.request=Xd,t.html=Zd,t.json=tf,t.text=ef,t.xml=nf,t.csv=rf,t.tsv=sf,t.now=Ve,t.timer=je,t.timerFlush=ze,t.timeout=mf,t.interval=vf,t.timeInterval=Xe,t.timeMillisecond=Sf,t.timeMilliseconds=xf,t.timeSecond=Of,t.timeSeconds=_f,t.timeMinute=Mf,t.timeMinutes=Nf,t.timeHour=Rf,t.timeHours=Df,t.timeDay=If,t.timeDays=Ff,t.timeWeek=kf,t.timeWeeks=Vf,t.timeSunday=kf,t.timeSundays=Vf,t.timeMonday=$f,t.timeMondays=Hf,t.timeTuesday=Lf,t.timeTuesdays=qf;t.timeWednesday=Uf;t.timeWednesdays=jf,t.timeThursday=Bf,t.timeThursdays=zf,t.timeFriday=Pf,t.timeFridays=Wf,t.timeSaturday=Qf,t.timeSaturdays=Yf,t.timeMonth=Gf,t.timeMonths=Kf,t.timeYear=Xf,t.timeYears=Jf,t.utcMillisecond=Sf,t.utcMilliseconds=xf,t.utcSecond=Of,t.utcSeconds=_f,t.utcMinute=Zf,t.utcMinutes=tg,t.utcHour=eg,t.utcHours=ng,t.utcDay=ig,t.utcDays=og,t.utcWeek=rg,t.utcWeeks=pg,t.utcSunday=rg,t.utcSundays=pg,t.utcMonday=sg,t.utcMondays=dg,t.utcTuesday=ag,t.utcTuesdays=fg,t.utcWednesday=ug,t.utcWednesdays=gg,t.utcThursday=lg,t.utcThursdays=mg,t.utcFriday=cg,t.utcFridays=vg,t.utcSaturday=hg,t.utcSaturdays=yg,t.utcMonth=bg,t.utcMonths=Sg,t.utcYear=xg,t.utcYears=Eg,t.formatLocale=kg,t.formatDefaultLocale=nn,t.formatSpecifier=Dg,t.precisionFixed=Lg,t.precisionPrefix=Ug,t.precisionRound=Bg,t.isoFormat=jg,t.isoParse=zg,t.timeFormatLocale=an,t.timeFormatDefaultLocale=ei,t.scaleBand=ri,t.scalePoint=ai,t.scaleIdentity=vi,t.scaleLinear=mi,t.scaleLog=wi,t.scaleOrdinal=oi,t.scaleImplicit=Kg,t.scalePow=Ti,t.scaleSqrt=Oi,t.scaleQuantile=_i,t.scaleQuantize=Mi,t.scaleThreshold=Ni,t.scaleTime=lm,t.scaleUtc=cm,t.schemeCategory10=pm,t.schemeCategory20b=dm,t.schemeCategory20c=fm,t.schemeCategory20=gm,t.scaleSequential=ki,t.interpolateCubehelixDefault=mm,t.interpolateRainbow=Sm,t.interpolateWarm=vm,t.interpolateCool=ym,t.interpolateViridis=xm,t.interpolateMagma=Cm,t.interpolateInferno=Em,t.interpolatePlasma=wm,t.creator=_m,t.customEvent=ji,t.local=Ui,t.matcher=Im,t.mouse=Bm,t.namespace=Om,t.namespaces=Tm,t.select=xv,t.selectAll=Cv,t.selection=Io,t.selector=Pm,t.selectorAll=Vm,t.touch=Ev,t.touches=wv,t.window=av,t.active=ay,t.interrupt=kv,t.transition=hr,t.axisTop=br,t.axisRight=Sr,t.axisBottom=xr,t.axisLeft=Cr,t.cluster=gy,t.hierarchy=Rr,t.pack=Ny,t.packSiblings=_y,t.packEnclose=Oy,t.partition=Iy,t.stratify=Ly,t.tree=Uy,t.treemap=Vy,t.treemapBinary=Hy,t.treemapDice=Dy,t.treemapSlice=By,t.treemapSliceDice=qy,t.treemapSquarify=Qy,t.treemapResquarify=jy,t.forceCenter=zy,t.forceCollide=Gy,t.forceLink=Ky,t.forceManyBody=tb,t.forceSimulation=Zy,t.forceX=eb,t.forceY=nb,t.drag=sb,t.dragDisable=ob,t.dragEnable=bs,t.voronoi=vb,t.zoom=xb,t.zoomIdentity=bb,t.zoomTransform=oa,t.brush=Lb,t.brushX=ma,t.brushY=va,t.brushSelection=ga,t.chord=qb,t.ribbon=Wb,t.geoAlbers=hC,t.geoAlbersUsa=pC,t.geoArea=ZS,t.geoAzimuthalEqualArea=fC,t.geoAzimuthalEqualAreaRaw=dC,t.geoAzimuthalEquidistant=mC,t.geoAzimuthalEquidistantRaw=gC,t.geoBounds=nx,t.geoCentroid=ox,t.geoCircle=bx,t.geoClipExtent=Tx,t.geoConicConformal=yC,t.geoConicConformalRaw=fl,t.geoConicEqualArea=cC,t.geoConicEqualAreaRaw=al,t.geoConicEquidistant=SC,t.geoConicEquidistantRaw=ml,t.geoDistance=Dx,t.geoEquirectangular=bC,t.geoEquirectangularRaw=gl,t.geoGnomonic=xC,t.geoGnomonicRaw=vl,t.geoGraticule=Ou,t.geoGraticule10=_u,t.geoIdentity=CC,t.geoInterpolate=Ix,t.geoLength=Mx,t.geoMercator=vC,t.geoMercatorRaw=hl,t.geoOrthographic=EC,t.geoOrthographicRaw=bl,t.geoPath=Zx,t.geoProjection=il,t.geoProjectionMutator=ol,t.geoRotation=yx,t.geoStereographic=wC,t.geoStereographicRaw=Sl,t.geoStream=GS,t.geoTransform=rC,t.geoTransverseMercator=AC,t.geoTransverseMercatorRaw=xl,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(136),r=function(){function e(t,e,n){this.dropdownContent=t,this.dropdownHeader=e,this.coveoRoot=n,this.isOpened=!1,this.onOpenHandlers=[],this.onCloseHandlers=[],this.popupBackgroundIsEnabled=!0,this.popupBackground=this.buildPopupBackground(),this.bindOnClickDropdownHeaderEvent(),this.saveContentPosition()}return e.prototype.registerOnOpenHandler=function(t,e){this.onOpenHandlers.push({handler:t,context:e})},e.prototype.registerOnCloseHandler=function(t,e){this.onCloseHandlers.push({handler:t,context:e})},e.prototype.cleanUp=function(){this.close(),this.dropdownHeader.cleanUp(),this.dropdownContent.cleanUp(),this.restoreContentPosition()},e.prototype.open=function(){this.isOpened=!0,this.dropdownHeader.open(),this.dropdownContent.positionDropdown(),t.each(this.onOpenHandlers,function(t){t.handler.apply(t.context)}),this.showPopupBackground()},e.prototype.close=function(){this.isOpened=!1,t.each(this.onCloseHandlers,function(t){t.handler.apply(t.context)}),this.dropdownHeader.close(),this.dropdownContent.hideDropdown(),this.hidePopupBackground()},e.prototype.disablePopupBackground=function(){this.popupBackgroundIsEnabled=!1},e.prototype.bindOnClickDropdownHeaderEvent=function(){var t=this;this.dropdownHeader.element.on("click",function(){t.isOpened?t.close():t.open()})},e.prototype.showPopupBackground=function(){this.popupBackgroundIsEnabled&&(this.coveoRoot.el.appendChild(this.popupBackground.el),window.getComputedStyle(this.popupBackground.el).opacity,this.popupBackground.el.style.opacity=e.TRANSPARENT_BACKGROUND_OPACITY)},e.prototype.hidePopupBackground=function(){this.popupBackgroundIsEnabled&&(window.getComputedStyle(this.popupBackground.el).opacity,this.popupBackground.el.style.opacity="0")},e.prototype.buildPopupBackground=function(){var t=this,n=i.$$("div",{className:e.DROPDOWN_BACKGROUND_CSS_CLASS_NAME});return o.EventsUtils.addPrefixedEvent(n.el,"TransitionEnd",function(){"0"==n.el.style.opacity&&n.detach()}),n.on("click",function(){return t.close()}),n},e.prototype.saveContentPosition=function(){var t=this.dropdownContent.element.el.previousSibling,e=this.dropdownContent.element.el.parentElement;this.previousSibling=t?i.$$(t):null,this.parent=i.$$(e)},e.prototype.restoreContentPosition=function(){this.previousSibling?this.dropdownContent.element.insertAfter(this.previousSibling.el):this.parent.prepend(this.dropdownContent.element.el)},e.TRANSPARENT_BACKGROUND_OPACITY="0.9",e.DROPDOWN_BACKGROUND_CSS_CLASS_NAME="coveo-dropdown-background",e}();e.ResponsiveDropdown=r}).call(e,n(10))},function(t,e,n){"use strict";var i=n(58),o=n(72),r=n(131),s=function(){function t(t,e,n,i,o){this.element=e,this.cssClassName="coveo-"+t+"-dropdown-content",this.coveoRoot=n,this.widthRatio=o,this.minWidth=i}return t.prototype.positionDropdown=function(){this.element.addClass(this.cssClassName),this.element.addClass(t.DEFAULT_CSS_CLASS_NAME),this.element.el.style.display="";var e=this.widthRatio*this.coveoRoot.width();e<=this.minWidth&&(e=this.minWidth),this.element.el.style.width=e.toString()+"px",o.PopupUtils.positionPopup(this.element.el,i.$$(this.coveoRoot.find("."+r.ResponsiveComponentsManager.DROPDOWN_HEADER_WRAPPER_CSS_CLASS)).el,this.coveoRoot.el,{horizontal:o.HorizontalAlignment.INNERRIGHT,vertical:o.VerticalAlignment.BOTTOM,verticalOffset:15},this.coveoRoot.el)},t.prototype.hideDropdown=function(){this.element.el.style.display="none",this.element.removeClass(this.cssClassName),this.element.removeClass(t.DEFAULT_CSS_CLASS_NAME)},t.prototype.cleanUp=function(){this.element.el.removeAttribute("style")},t.DEFAULT_CSS_CLASS_NAME="coveo-dropdown-content",t}();e.ResponsiveDropdownContent=s},function(t,e){"use strict";var n=function(){function t(e,n){this.element=n,this.element.addClass("coveo-"+e+"-dropdown-header"),this.element.addClass(t.DEFAULT_CSS_CLASS_NAME)}return t.prototype.open=function(){this.element.addClass(t.ACTIVE_HEADER_CSS_CLASS_NAME)},t.prototype.close=function(){this.element.removeClass(t.ACTIVE_HEADER_CSS_CLASS_NAME)},t.prototype.cleanUp=function(){this.element.detach()},t.DEFAULT_CSS_CLASS_NAME="coveo-dropdown-header",t.ACTIVE_HEADER_CSS_CLASS_NAME="coveo-dropdown-header-active",t}();e.ResponsiveDropdownHeader=n},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(166),r=n(107),s=n(109),a=n(98),u=n(48),l=n(101),c=n(121),h=n(9),p=n(106),d=n(15),f=n(14),g=n(58),m=n(69),v=function(e){function n(t,i,r){var c=this;e.call(this,t,n.ID,r),this.element=t,this.options=i,this.isFirstQuery=!0,this.options=s.ComponentOptions.initComponentOptions(t,n,i),this.bind.onRootElement(u.QueryEvents.buildingQuery,function(t){return c.handleBuildingQuery(t)}),this.bind.onQueryState(a.MODEL_EVENTS.CHANGE_ONE,l.QUERY_STATE_ATTRIBUTES.T,function(t){return c.handleQueryStateChanged(t)});var h=function(){return c.handleClick()};this.bind.on(t,"click",h),this.bind.on(t,"keyup",m.KeyboardUtils.keypressAction(m.KEYBOARD.ENTER,h)),this.render(),o.ResponsiveTabs.init(this.root,this,this.options)}return i(n,e),n.prototype.select=function(){this.disabled||(this.queryStateModel.setMultiple({t:this.options.id,sort:this.options.sort||l.QueryStateModel.defaultAttributes.sort}),this.usageAnalytics.logSearchEvent(c.analyticsActionCauseList.interfaceChange,{interfaceChangeTo:this.options.id}),this.queryController.executeQuery())},n.prototype.isElementIncludedInTab=function(e){f.Assert.exists(e);var n=this.splitListOfTabs(e.getAttribute("data-tab")),i=this.splitListOfTabs(e.getAttribute("data-tab-not"));return f.Assert.check(!(0!=n.length&&0!=i.length),"You cannot both explicity include and exclude an element from tabs"),0!=n.length&&t.indexOf(n,this.options.id)!=-1||0!=i.length&&t.indexOf(i,this.options.id)==-1||0==n.length&&0==i.length},n.prototype.handleClick=function(){this.select()},n.prototype.render=function(){var t=this.options.icon;if(d.Utils.isNonEmptyString(t)){var e=g.$$("span").el;g.$$(e).addClass(["coveo-icon",t]),this.element.insertBefore(e,this.element.firstChild)}var n=this.options.caption;if(d.Utils.isNonEmptyString(n)){var i=document.createElement("p");g.$$(i).text(n),this.element.appendChild(i)}this.element.setAttribute("tabindex","0")},n.prototype.handleBuildingQuery=function(t){f.Assert.exists(t),this.isFirstQuery=!1,!this.disabled&&this.isSelected()&&(t.queryBuilder.tab=this.options.id,d.Utils.isNonEmptyString(this.options.expression)&&(this.options.constant?t.queryBuilder.constantExpression.add(this.options.expression):t.queryBuilder.advancedExpression.add(this.options.expression)),this.options.enableDuplicateFiltering&&(t.queryBuilder.enableDuplicateFiltering=!0),null!=this.options.pipeline&&(t.queryBuilder.pipeline=this.options.pipeline),null!=this.options.maximumAge&&(t.queryBuilder.maximumAge=this.options.maximumAge))},n.prototype.handleQueryStateChanged=function(t){f.Assert.exists(t),!this.disabled&&this.isSelected()?(g.$$(this.element).addClass("coveo-selected"),this.queryController.setEndpoint(this.options.endpoint),this.showAndHideAppropriateElements()):g.$$(this.element).removeClass("coveo-selected")},n.prototype.isSelected=function(){var t=this.queryStateModel.get(l.QueryStateModel.attributesEnum.t);return t==this.options.id},n.prototype.showAndHideAppropriateElements=function(){var e=this,n=[],i=[];t.each(g.$$(this.root).findAll("[data-tab],[data-tab-not]"),function(t){e.isElementIncludedInTab(t)?(e.toggleAllComponentsUnder(t,!0),n.push(t)):(e.toggleAllComponentsUnder(t,!1),i.push(t))}),g.$$(this.root).one(u.QueryEvents.querySuccess,function(){t.each(n,function(t){return g.$$(t).removeClass("coveo-tab-disabled")}),t.each(i,function(t){return g.$$(t).addClass("coveo-tab-disabled")})})},n.prototype.splitListOfTabs=function(e){return d.Utils.exists(e)?t.map(e.split(","),function(t){return d.Utils.trim(t)}):[]},n.prototype.toggleAllComponentsUnder=function(e,n){f.Assert.exists(e);var i=function(t){var e=r.Component.get(t,void 0,!0);e&&(n?e.enable():e.disable())};i(e),t.each(g.$$(e).findAll("*"),function(t){i(t)})},n.prototype.enable=function(){e.prototype.enable.call(this),this.element.style.display=""},n.prototype.disable=function(){e.prototype.disable.call(this),this.element.style.display="none"},n.ID="Tab",n.options={id:s.ComponentOptions.buildStringOption({required:!0}),caption:s.ComponentOptions.buildLocalizedStringOption({required:!0}),icon:s.ComponentOptions.buildIconOption(),expression:s.ComponentOptions.buildStringOption(),endpoint:s.ComponentOptions.buildCustomOption(function(t){return null!=t?h.SearchEndpoint.endpoints[t]:null}),sort:s.ComponentOptions.buildStringOption(),constant:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableDuplicateFiltering:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),pipeline:s.ComponentOptions.buildStringOption(),maximumAge:s.ComponentOptions.buildNumberOption(),enableResponsiveMode:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),dropdownHeaderLabel:s.ComponentOptions.buildLocalizedStringOption()},n}(r.Component);e.Tab=v,p.Initialization.registerAutoCreateComponent(v)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(45),r=n(72),s=n(136),a=n(15),u=n(13),l=n(107),c=n(108),h=n(165),p=n(131),d=n(132),f=n(35),g=function(){function e(t,e){this.coveoRoot=t,this.ID=e,this.dropdownHeaderLabel=this.getDropdownHeaderLabel(),this.searchInterface=l.Component.get(this.coveoRoot.el,c.SearchInterface,!1),this.searchBoxElement=this.getSearchBoxElement(),
this.dropdownContent=this.buildDropdownContent(),this.dropdownHeader=this.buildDropdownHeader(),this.bindDropdownContentEvents(),this.bindDropdownHeaderEvents(),this.tabSection=i.$$(this.coveoRoot.find(".coveo-tab-section")),this.manageTabSwapping(),this.saveTabsPosition(),this.bindNukeEvents()}return e.init=function(t,n,o){return this.logger=new u.Logger("ResponsiveTabs"),i.$$(t).find(".coveo-tab-section")?void p.ResponsiveComponentsManager.register(e,i.$$(t),h.Tab.ID,n,o):void this.logger.info("No element with class coveo-tab-section. Responsive tabs cannot be enabled.")},e.prototype.handleResizeEvent=function(){this.needSmallMode()&&!d.ResponsiveComponentsUtils.isSmallTabsActivated(this.coveoRoot)?this.changeToSmallMode():!this.needSmallMode()&&d.ResponsiveComponentsUtils.isSmallTabsActivated(this.coveoRoot)&&this.changeToLargeMode();var t=this.getTabsInTabSection();this.shouldAddTabsToDropdown()?this.addTabsToDropdown(t):this.shouldRemoveTabsFromDropdown()&&this.removeTabsFromDropdown(t),this.dropdownHeader.hasClass("coveo-dropdown-header-active")&&this.positionPopup()},e.prototype.needSmallMode=function(){return this.coveoRoot.width()<=d.ResponsiveComponentsUtils.MEDIUM_MOBILE_WIDTH||(d.ResponsiveComponentsUtils.isSmallTabsActivated(this.coveoRoot)?this.isLargeFormatOverflowing():this.isOverflowing(this.tabSection.el))},e.prototype.changeToSmallMode=function(){d.ResponsiveComponentsUtils.activateSmallTabs(this.coveoRoot)},e.prototype.changeToLargeMode=function(){this.emptyDropdown(),this.cleanUpDropdown(),d.ResponsiveComponentsUtils.deactivateSmallTabs(this.coveoRoot)},e.prototype.shouldAddTabsToDropdown=function(){return this.isOverflowing(this.tabSection.el)&&d.ResponsiveComponentsUtils.isSmallTabsActivated(this.coveoRoot)},e.prototype.addTabsToDropdown=function(t){var e;if(!this.tabSection.find(".coveo-tab-dropdown-header")){var n=this.tabSection.find(".coveo-facet-dropdown-header");n?this.dropdownHeader.insertBefore(n):this.tabSection.el.appendChild(this.dropdownHeader.el)}for(var o=t.length-1;o>=0&&(e=t[o],i.$$(e).hasClass("coveo-selected")&&o>0&&(e=t[--o]),this.addToDropdown(e),this.isOverflowing(this.tabSection.el));o--);},e.prototype.shouldRemoveTabsFromDropdown=function(){return!this.isOverflowing(this.tabSection.el)&&d.ResponsiveComponentsUtils.isSmallTabsActivated(this.coveoRoot)&&!this.isDropdownEmpty()},e.prototype.removeTabsFromDropdown=function(e){var n,o,r=this.dropdownContent.findAll(".coveo-tab-dropdown");for(e&&(n=e.pop());!this.isOverflowing(this.tabSection.el)&&!this.isDropdownEmpty();)o=r.shift(),this.removeFromDropdown(o),this.fromDropdownToTabSection(i.$$(o),n),n=t.clone(o);if(this.isOverflowing(this.tabSection.el)){var s=this.getTabsInTabSection();this.addToDropdown(s.pop())}this.isDropdownEmpty()&&this.cleanUpDropdown()},e.prototype.emptyDropdown=function(){if(!this.isDropdownEmpty()){var e=this.dropdownContent.findAll(".coveo-tab-dropdown"),n=this.getTabsInTabSection(),o=void 0;for(n&&(o=n.pop());!this.isDropdownEmpty();){var r=e.shift();this.removeFromDropdown(r),i.$$(r).insertBefore(this.dropdownHeader.el),this.fromDropdownToTabSection(i.$$(r),o),o=t.clone(r)}}},e.prototype.isLargeFormatOverflowing=function(){var e=i.$$(this.tabSection.el.cloneNode(!0)),n=e.find(".coveo-tab-dropdown-header");n&&e.el.removeChild(n),e.el.style.position="absolute",e.el.style.visibility="hidden",this.isDropdownEmpty()||t.each(this.dropdownContent.findAll(".CoveoTab"),function(t){e.el.appendChild(t.cloneNode(!0))}),this.coveoRoot.append(e.el),d.ResponsiveComponentsUtils.deactivateSmallTabs(this.coveoRoot);var o=this.isOverflowing(e.el);return d.ResponsiveComponentsUtils.activateSmallTabs(this.coveoRoot),e.detach(),o},e.prototype.isOverflowing=function(t){return t.clientWidth<t.scrollWidth},e.prototype.buildDropdownHeader=function(){var t=i.$$("a",{className:"coveo-dropdown-header coveo-tab-dropdown-header"}),e=i.$$("p");return e.text(this.dropdownHeaderLabel),e.el.appendChild(i.$$("span",{className:"coveo-sprites-more-tabs"}).el),t.el.appendChild(e.el),t},e.prototype.bindDropdownHeaderEvents=function(){var t=this;this.dropdownHeader.on("click",function(){t.dropdownHeader.hasClass("coveo-dropdown-header-active")?t.closeDropdown():(t.positionPopup(),t.dropdownHeader.addClass("coveo-dropdown-header-active"))})},e.prototype.buildDropdownContent=function(){var t=i.$$("div",{className:"coveo-tab-list-container "+c.SearchInterface.SMALL_INTERFACE_CLASS_NAME}),e=i.$$("ol",{className:"coveo-tab-list"});return t.el.appendChild(e.el),t},e.prototype.bindDropdownContentEvents=function(){var t=this;this.documentClickListener=function(e){if(a.Utils.isHtmlElement(e.target)){var n=i.$$(e.target);n.closest("coveo-tab-list-container")||n.closest("coveo-tab-dropdown-header")||n.closest("coveo-tab-dropdown")||t.closeDropdown()}},i.$$(document.documentElement).on("click",this.documentClickListener)},e.prototype.closeDropdown=function(){this.dropdownContent.detach(),this.dropdownHeader.removeClass("coveo-dropdown-header-active")},e.prototype.addToDropdown=function(t){if(this.dropdownContent){i.$$(t).addClass("coveo-tab-dropdown");var e=this.dropdownContent.find("ol"),n=i.$$("li");n.el.appendChild(t),i.$$(e).prepend(n.el)}},e.prototype.removeFromDropdown=function(t){this.dropdownContent&&(i.$$(t).removeClass("coveo-tab-dropdown"),i.$$(t.parentElement).detach())},e.prototype.cleanUpDropdown=function(){this.dropdownHeader.removeClass("coveo-dropdown-header-active"),this.dropdownHeader.detach(),this.dropdownContent.detach()},e.prototype.isDropdownEmpty=function(){if(this.dropdownContent){var t=this.dropdownContent.findAll(".CoveoTab");return 0==t.length}return!1},e.prototype.manageTabSwapping=function(){var e=this;t.each(this.coveoRoot.findAll("."+l.Component.computeCssClassNameForType(this.ID)),function(t){var n=i.$$(t),o=function(t){var r=e.getTabsInTabSection(),a=r.pop(),u=a.previousSibling;"opacity"==t.propertyName&&("0"==n.el.style.opacity?(i.$$(a).addClass("coveo-tab-dropdown"),n.replaceWith(a),n.removeClass("coveo-tab-dropdown"),e.fromDropdownToTabSection(n,u),window.getComputedStyle(n.el).opacity,window.getComputedStyle(a).opacity,n.el.style.opacity=a.style.opacity="1"):"1"==n.el.style.opacity&&(e.closeDropdown(),s.EventsUtils.removePrefixedEvent(n.el,"TransitionEnd",o),e.handleResizeEvent()))};n.on("click",function(){if(n.hasClass("coveo-tab-dropdown")){var t=e.getTabsInTabSection(),i=t.pop();i&&(s.EventsUtils.addPrefixedEvent(n.el,"TransitionEnd",o),n.el.style.opacity=i.style.opacity="0")}})})},e.prototype.getSearchBoxElement=function(){var t=this.coveoRoot.find(".coveo-search-section");return t?t:this.coveoRoot.find(".CoveoSearchbox")},e.prototype.saveTabsPosition=function(){this.previousSibling=this.tabSection.el.previousSibling?i.$$(this.tabSection.el.previousSibling):null,this.parent=i.$$(this.tabSection.el.parentElement)},e.prototype.bindNukeEvents=function(){var t=this;i.$$(this.coveoRoot).on(o.InitializationEvents.nuke,function(){i.$$(document.documentElement).off("click",t.documentClickListener)})},e.prototype.positionPopup=function(){r.PopupUtils.positionPopup(this.dropdownContent.el,this.dropdownHeader.el,this.coveoRoot.el,{horizontal:r.HorizontalAlignment.INNERRIGHT,vertical:r.VerticalAlignment.BOTTOM},this.coveoRoot.el)},e.prototype.getTabsInTabSection=function(){var e=this,n=[];return t.each(this.tabSection.el.children,function(t){if(a.Utils.isHtmlElement(t)){var o=i.$$(t);!o.hasClass("coveo-tab-dropdown")&&o.hasClass(l.Component.computeCssClassNameForType(e.ID))&&n.push(o.el)}}),n},e.prototype.fromDropdownToTabSection=function(t,e){e?t.insertAfter(e):this.tabSection.prepend(t.el)},e.prototype.getDropdownHeaderLabel=function(){var n;return t.each(i.$$(this.coveoRoot.find(".coveo-tab-section")).findAll("."+l.Component.computeCssClassName(h.Tab)),function(t){var e=l.Component.get(t,h.Tab);!n&&e.options.dropdownHeaderLabel&&(n=e.options.dropdownHeaderLabel)}),n||(n=f.l(e.DROPDOWN_HEADER_LABEL_DEFAULT_VALUE)),n},e.DROPDOWN_HEADER_LABEL_DEFAULT_VALUE="More",e}();e.ResponsiveTabs=g}).call(e,n(10))},function(t,e,n){"use strict";var i=n(163),o=n(58),r=function(){function t(t,e,n){this.element=e,this.coveoRoot=n,this.cssClassName="coveo-"+t+"-dropdown-content",this.element.addClass(this.cssClassName),this.element.addClass(i.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME)}return t.prototype.positionDropdown=function(){this.element.el.style.display="";var e=this.coveoRoot.find(".coveo-results-column");o.$$(e).prepend(this.element.el),this.element.addClass(i.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME),this.element.addClass(this.cssClassName),window.getComputedStyle(this.element.el).maxHeight,this.element.addClass(t.OPENED_DROPDOWN_CSS_CLASS_NAME)},t.prototype.hideDropdown=function(){this.element.addClass(i.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME),this.element.addClass(this.cssClassName),this.element.removeClass(t.OPENED_DROPDOWN_CSS_CLASS_NAME)},t.prototype.cleanUp=function(){this.element.removeClass(this.cssClassName),this.element.removeClass(i.ResponsiveDropdownContent.DEFAULT_CSS_CLASS_NAME)},t.OPENED_DROPDOWN_CSS_CLASS_NAME="coveo-open-dropdown-content",t}();e.RecommendationDropdownContent=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(123),r=n(121),s=n(107),a=n(108),u=function(t){function e(e,n,i,o,r,s,a,u,l,c){t.call(this,e,n,i,o,r,s,a,u,l),this.endpoint=e,this.rootElement=n,this.userId=i,this.userDisplayName=o,this.anonymous=r,this.splitTestRunName=s,this.splitTestRunVersion=a,this.originLevel1=u,this.sendToCloud=l,this.bindings=c,this.recommendation=this.bindings.searchInterface}return i(e,t),e.prototype.logSearchEvent=function(e,n){e==r.analyticsActionCauseList.interfaceLoad&&(e=r.analyticsActionCauseList.recommendationInterfaceLoad),t.prototype.logSearchEvent.call(this,e,n)},e.prototype.logClickEvent=function(e,n,i,o){if(e==r.analyticsActionCauseList.documentOpen&&(e=r.analyticsActionCauseList.recommendationOpen),t.prototype.logClickEvent.call(this,e,n,i,o),this.recommendation.mainQuerySearchUID&&null!=this.recommendation.mainQueryPipeline){var u=s.Component.get(this.recommendation.options.mainSearchInterface,a.SearchInterface);i.queryUid=this.recommendation.mainQuerySearchUID,i.pipeline=this.recommendation.mainQueryPipeline,u.usageAnalytics.logClickEvent(e,n,i,o)}},e.prototype.getOriginLevel2=function(t){return this.recommendation.getId()},e}(o.LiveAnalyticsClient);e.RecommendationAnalyticsClient=u},function(t,e,n){(function(t){"use strict";function i(){return!!o()&&(e.jQueryInstance=a(),void 0==window.Coveo&&(window.Coveo={}),void 0==window.Coveo.$&&(window.Coveo.$=e.jQueryInstance),e.jQueryInstance.fn.coveo=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var i;return this.each(function(n,o){var r;if(t.isString(e[0])){var s=e[0];r=u.Initialization.dispatchNamedMethodCallOrComponentCreation(s,o,e.slice(1))}else r=u.Initialization.dispatchNamedMethodCall("get",o,e);i=i||r}),i},!0)}function o(){return s()||r()}function r(){return void 0!=window.Coveo&&void 0!=window.Coveo.$}function s(){return void 0!=window.$&&void 0!=window.$.fn&&void 0!=window.$.fn.jquery}function a(){var t;return t=window.$?window.$:window.Coveo.$}var u=n(106);i()||document.addEventListener("DOMContentLoaded",function(){i()}),e.initCoveoJQuery=i,e.jQueryIsDefined=o}).call(e,n(10))},function(t,e,n){"use strict";var i=n(171);e.TemplateHelpers=i.TemplateHelpers;var o=n(110);e.TemplateCache=o.TemplateCache;var r=n(113);e.HtmlTemplate=r.HtmlTemplate;var s=n(112);e.UnderscoreTemplate=s.UnderscoreTemplate},function(t,e,n){"use strict";var i=n(14),o=n(112),r=n(15),s=function(){function t(){}return t.registerFieldHelper=function(e,n){t.fieldHelpers.push(e),t.registerTemplateHelper(e,n)},t.registerTemplateHelper=function(e,n){i.Assert.isNonEmptyString(e),i.Assert.exists(n),t.registerTemplateHelperInUnderscore(e,n),t.helpers[e]=n},t.getHelper=function(e){return r.Utils.getCaseInsensitiveProperty(t.helpers,e)},t.getHelpers=function(){return t.helpers},t.registerTemplateHelperInUnderscore=function(t,e){i.Assert.isNonEmptyString(t),i.Assert.exists(e),o.UnderscoreTemplate.registerTemplateHelper(t,e)},t.helpers={},t.fieldHelpers=[],t}();e.TemplateHelpers=s},function(t,e,n){(function(t){"use strict";function i(){return C.ResultList.resultCurrentlyBeingRendered||A.Quickview.resultCurrentlyBeingRendered}function o(){var t=i();if(t)return t.termsToHighlight}function r(){var t=i();if(t)return t.phrasesToHighlight}var s=n(171),a=n(109),u=n(67),l=n(57),c=n(56),h=n(68),p=n(173),d=n(15),f=n(61),g=n(16),m=n(64),v=n(21),y=n(17),b=n(110),S=n(58),x=n(9),C=n(177),E=n(73),w=n(28),A=n(174),T=function(){function e(){}return e.exportAllHelpersGlobally=function(e){t.each(s.TemplateHelpers.getHelpers(),function(t,n){void 0==e[n]&&(e[n]=t)})},e}();e.CoreHelpers=T,s.TemplateHelpers.registerFieldHelper("javascriptEncode",function(t){return d.Utils.exists(t)?f.StringUtils.javascriptEncode(t):void 0}),s.TemplateHelpers.registerTemplateHelper("shorten",function(t,e,n,i){var o=u.StringAndHoles.shortenString(t,e,"...");return d.Utils.exists(n)?u.HighlightUtils.highlightString(o.value,n,o.holes,i||"highlight"):o.value}),s.TemplateHelpers.registerTemplateHelper("shortenPath",function(t,e,n,i){var o=u.StringAndHoles.shortenPath(t,e);return d.Utils.exists(n)?u.HighlightUtils.highlightString(o.value,n,o.holes,i||"highlight"):o.value}),s.TemplateHelpers.registerTemplateHelper("shortenUri",function(t,e,n,i){var o=u.StringAndHoles.shortenUri(t,e);return d.Utils.exists(n)?u.HighlightUtils.highlightString(o.value,n,o.holes,i||"highlight"):o.value}),s.TemplateHelpers.registerTemplateHelper("highlight",function(t,e,n){return d.Utils.exists(t)?d.Utils.exists(e)?u.HighlightUtils.highlightString(t,e,null,n||"highlight"):t:void 0}),s.TemplateHelpers.registerTemplateHelper("highlightStreamText",function(e,n,i,s){return void 0===n&&(n=o()),void 0===i&&(i=r()),d.Utils.exists(e)&&d.Utils.exists(n)&&d.Utils.exists(i)?d.Utils.isNonEmptyArray(t.keys(n))||d.Utils.isNonEmptyArray(t.keys(i))?E.StreamHighlightUtils.highlightStreamText(e,n,i,s):e:void 0}),s.TemplateHelpers.registerTemplateHelper("highlightStreamHTML",function(t,e,n,i){return void 0===e&&(e=o()),void 0===n&&(n=r()),d.Utils.exists(t)&&d.Utils.exists(e)&&d.Utils.exists(n)?d.Utils.isNonEmptyArray(e)?E.StreamHighlightUtils.highlightStreamHTML(t,e,n,i):t:void 0}),s.TemplateHelpers.registerFieldHelper("number",function(e,n){var i=Number(e);return d.Utils.exists(e)?t.isString(n)?f.StringUtils.htmlEncode(w.format(i,n)):f.StringUtils.htmlEncode(i.toString()):void 0}),s.TemplateHelpers.registerFieldHelper("date",function(t,e){return l.DateUtils.dateToString(l.DateUtils.convertFromJsonDateIfNeeded(t),e)}),s.TemplateHelpers.registerFieldHelper("time",function(t,e){return l.DateUtils.timeToString(l.DateUtils.convertFromJsonDateIfNeeded(t),e)}),s.TemplateHelpers.registerFieldHelper("dateTime",function(t,e){return l.DateUtils.dateTimeToString(l.DateUtils.convertFromJsonDateIfNeeded(t),e)}),s.TemplateHelpers.registerFieldHelper("emailDateTime",function(e,n){var i={};i.includeTimeIfThisWeek=!0;var o=t.extend(n,i);return e?l.DateUtils.dateTimeToString(l.DateUtils.convertFromJsonDateIfNeeded(e),o):void 0}),s.TemplateHelpers.registerFieldHelper("currency",function(t,e){return c.CurrencyUtils.currencyToString(t,e)}),s.TemplateHelpers.registerFieldHelper("timeSpan",function(t,e){return void 0===e&&(e={isMilliseconds:!1}),new g.TimeSpan(t,e.isMilliseconds).getHHMMSS()}),s.TemplateHelpers.registerFieldHelper("email",function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o,r,s,a;if(t.isObject(n[0])?(o=n[0].companyDomain,r=n[0].me,s=n[0].lengthLimit,a=n[0].truncateName):(o=n[0],r=n[1],s=n[2],a=n[3]),void 0==s&&(s=2),void 0==a&&(a=!1),t.isString(e)){var u=m.EmailUtils.splitSemicolonSeparatedListOfEmailAddresses(e);return m.EmailUtils.emailAddressesToHyperlinks(u,o,r,s,a)}return t.isArray(e)?m.EmailUtils.emailAddressesToHyperlinks(e,o,r,s,a):void 0}),s.TemplateHelpers.registerTemplateHelper("excessEmailToggle",function(e){S.$$(e).removeClass("coveo-active"),S.$$(e).hasClass("coveo-emails-excess-collapsed")?t.each(S.$$(e).siblings(".coveo-emails-excess-expanded"),function(t){S.$$(t).addClass("coveo-active")}):S.$$(e).hasClass("coveo-hide-expanded")&&(S.$$(e.parentElement).addClass("coveo-inactive"),t.each(S.$$(e.parentElement).siblings(".coveo-emails-excess-collapsed"),function(t){S.$$(t).addClass("coveo-active")}))}),s.TemplateHelpers.registerFieldHelper("anchor",function(t,e){return h.AnchorUtils.buildAnchor(t,e)}),s.TemplateHelpers.registerFieldHelper("image",function(t,e){return h.ImageUtils.buildImage(t,e)}),s.TemplateHelpers.registerTemplateHelper("thumbnail",function(t,e,n){if(void 0===t&&(t=i()),void 0===e&&(e="default"),v.QueryUtils.hasThumbnail(t))return h.ImageUtils.buildImageFromResult(t,x.SearchEndpoint.endpoints[e],n)}),s.TemplateHelpers.registerTemplateHelper("fromFileTypeToIcon",function(t,e){return void 0===t&&(t=i()),void 0===e&&(e={}),p.Icon.createIcon(t,e).outerHTML}),s.TemplateHelpers.registerTemplateHelper("attrEncode",function(t){return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/'/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),s.TemplateHelpers.registerTemplateHelper("templateFields",function(e){void 0===e&&(e=i());var n=[];return null!=e.fields&&t.forEach(e.fields,function(e){var i=S.$$("tr");return t.forEach(e,function(e,n){t.isObject(e)?i.setAttribute(a.ComponentOptions.attrNameFromName(n),JSON.stringify(e)):i.setAttribute(a.ComponentOptions.attrNameFromName(n),e)}),n.push(i.el.outerHTML)}),n.join("")}),s.TemplateHelpers.registerTemplateHelper("loadTemplates",function(e,n){void 0===n&&(n=!0);var o,r="",a=i(),u=!1,l=e;return t.each(e,function(t,e,n){"default"==t&&(o=e)}),void 0!=o&&(l=t.omit(e,o)),t.each(l,function(t,e,i){u&&n||(u=u||t,r+=s.TemplateHelpers.getHelper("loadTemplate")(e,t,a))}),u||void 0==o||(r+=s.TemplateHelpers.getHelper("loadTemplate")(o,!0,a)),r});var O=["B","KB","MB","GB","TB","PB","EB"];s.TemplateHelpers.registerFieldHelper("size",function(t,e){for(var n=Number(t),i=null!=e&&null!=e.presision?e.presision:2,o=null!=e&&null!=e.base?e.base:0;n>1024&&o+1<O.length;)n/=1024,o++;return n=Math.floor(n*Math.pow(10,i))/Math.pow(10,i),n+" "+O[o]}),s.TemplateHelpers.registerTemplateHelper("loadTemplate",function(t,e,n){return void 0===e&&(e=!0),d.Utils.isNullOrUndefined(n)&&(n=i()),e?b.TemplateCache.getTemplate(t).instantiateToString(n,!1):""}),s.TemplateHelpers.registerTemplateHelper("encodeCarriageReturn",function(t){return d.Utils.isNullOrUndefined(t)?void 0:f.StringUtils.encodeCarriageReturn(t)}),s.TemplateHelpers.registerTemplateHelper("isMobileDevice",function(){return y.DeviceUtils.isMobileDevice()?y.DeviceUtils.getDeviceName():null})}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(109),s=n(14),a=n(21),u=n(106),l=n(15),c=n(60),h=n(174),p=n(58),d=function(t){function e(n,i,u,c){t.call(this,n,e.ID,u),this.element=n,this.options=i,this.result=c,this.options=r.ComponentOptions.initComponentOptions(n,e,i),this.result=this.result||this.resolveResult(),s.Assert.exists(this.result);var d=p.$$(this.element).find("."+o.Component.computeCssClassNameForType(h.Quickview.ID));!l.Utils.isNullOrUndefined(d)&&a.QueryUtils.hasHTMLVersion(this.result)&&(p.$$(this.element).addClass("coveo-with-quickview"),p.$$(this.element).on("click",function(){var t=o.Component.get(d);t.open()})),e.createIcon(this.result,this.options,n,u)}return i(e,t),e.createIcon=function(t,n,i,o){void 0===n&&(n={}),void 0===i&&(i=p.$$("div").el);var r=c.FileTypes.get(t);return r=e.preprocessIconInfo(n,r),p.$$(i).toggleClass("coveo-small",n.small===!0),void 0!=n.value&&(n.small===!0&&n.value.indexOf("-small")==-1&&(r.icon+="-small"),n.small===!1&&n.value.indexOf("-small")!=-1&&(r.icon=r.icon.replace("-small",""))),p.$$(i).addClass(r.icon),i.setAttribute("title",r.caption),e.shouldDisplayLabel(n,o)&&(i.appendChild(p.$$("span",{className:"coveo-icon-caption-overlay"},r.caption).el),p.$$(i).addClass("coveo-icon-with-caption-overlay")),i},e.shouldDisplayLabel=function(t,e){return e&&e.searchInterface.isNewDesign()&&t.withLabel!==!1},e.preprocessIconInfo=function(t,e){return null!=t.labelValue&&(e.caption=t.labelValue),null!=t.value&&(e.icon="coveo-icon "+t.value),null==e.caption&&(e.caption=""),null==e.icon&&(e.icon="coveo-icon coveo-sprites-custom"),e},e.ID="Icon",e.options={value:r.ComponentOptions.buildIconOption(),small:r.ComponentOptions.buildBooleanOption(),withLabel:r.ComponentOptions.buildBooleanOption(),labelValue:r.ComponentOptions.buildLocalizedStringOption()},e.fields=["objecttype","filetype"],e}(o.Component);e.Icon=d,u.Initialization.registerAutoCreateComponent(d)},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(109),s=n(59),a=n(17),u=n(58),l=n(175),c=n(49),h=n(61),p=n(176),d=n(101),f=n(129),g=n(106),m=n(69),v=n(23),y=function(t){function e(n,i,o,s,a){var h=this;if(void 0===a&&(a=v.ModalBox),t.call(this,n,e.ID,o),this.element=n,this.options=i,this.bindings=o,this.result=s,this.ModalBox=a,this.bindedHandleEscapeEvent=this.handleEscapeEvent.bind(this),this.options=r.ComponentOptions.initComponentOptions(n,e,i),null==this.options.contentTemplate&&(this.options.contentTemplate=new l.DefaultQuickviewTemplate),/^\s*$/.test(this.element.innerHTML)){var p=u.$$("div");if(p.addClass("coveo-icon-for-quickview"),this.searchInterface.isNewDesign()){var d=u.$$("div",{className:"coveo-caption-for-quickview",tabindex:0},"Quickview".toLocaleString()).el,f=u.$$("div");f.append(p.el),f.append(d),u.$$(this.element).append(f.el)}else p.text("Quickview".toLocaleString()),u.$$(this.element).append(p.el)}this.bindClick(s),this.bindings.resultElement&&this.bind.on(this.bindings.resultElement,c.ResultListEvents.openQuickview,function(){return h.open()})}return i(e,t),e.prototype.open=function(){if(null==this.modalbox){e.resultCurrentlyBeingRendered=this.result,u.$$(document.activeElement).trigger("blur");var t=this.prepareOpenQuickviewObject();this.createModalBox(t),this.bindQuickviewEvents(t),this.animateAndOpen(),this.queryStateModel.set(d.QueryStateModel.attributesEnum.quickview,this.getHashId()),e.resultCurrentlyBeingRendered=null}},e.prototype.close=function(){null!=this.modalbox&&(this.modalbox.close(),this.modalbox=null,u.$$(document.body).off("keyup",this.bindedHandleEscapeEvent))},e.prototype.getHashId=function(){return this.result.queryUid+"."+this.result.index+"."+h.StringUtils.hashCode(this.result.uniqueId)},e.prototype.bindClick=function(t){var e=this;if("undefined"==typeof t.hasHtmlVersion||t.hasHtmlVersion||this.options.alwaysShow){var n=function(){return e.open()};u.$$(this.element).on("click",n),this.bind.on(this.element,"keyup",m.KeyboardUtils.keypressAction(m.KEYBOARD.ENTER,n))}else this.element.style.display="none"},e.prototype.bindQuickviewEvents=function(t){var e=this,n=u.$$(this.modalbox.wrapper).find(".coveo-quickview-close-button");u.$$(n).on("click",function(){e.closeQuickview(),e.close()}),u.$$(this.modalbox.overlay).on("click",function(){e.closeQuickview()}),u.$$(this.modalbox.content).on(f.QuickviewEvents.quickviewLoaded,function(){u.$$(t.loadingAnimation).remove(),e.bindIFrameEscape()}),this.bindEscape()},e.prototype.animateAndOpen=function(){var t=this,e=this.modalbox.wrapper.style.animationDuration,n=u.$$(this.modalbox.modalBox).find("."+o.Component.computeCssClassName(p.QuickviewDocument));if(n)if(e){var i=/^(.+)(ms|s)$/.exec(e),r=Number(i[1])*("s"==i[2]?1e3:1);setTimeout(function(){null!=t.modalbox&&g.Initialization.dispatchNamedMethodCallOrComponentCreation("open",n,null)},r)}else g.Initialization.dispatchNamedMethodCallOrComponentCreation("open",n,null)},e.prototype.createModalBox=function(t){var e=u.$$("div");e.append(t.content.el),this.modalbox=this.ModalBox.open(e.el,{title:s.DomUtils.getQuickviewHeader(this.result,{showDate:this.options.showDate,title:this.options.title},this.bindings).el.outerHTML,className:"coveo-quick-view",validation:function(){return!0},body:this.element.ownerDocument.body}),this.setQuickviewSize()},e.prototype.prepareOpenQuickviewObject=function(){var t=this.options.loadingAnimation;return{loadingAnimation:t,content:this.prepareQuickviewContent(t)}},e.prototype.prepareQuickviewContent=function(t){var e=u.$$(this.options.contentTemplate.instantiateToElement(this.result)),n=this.searchInterface.options,i={options:n,bindings:this.getBindings(),result:this.result};return g.Initialization.automaticallyCreateComponentsInside(e.el,i),void 0!=e.find("."+o.Component.computeCssClassName(p.QuickviewDocument))&&this.options.enableLoadingAnimation&&e.prepend(t),e},e.prototype.bindEscape=function(){u.$$(document.body).on("keyup",this.bindedHandleEscapeEvent)},e.prototype.bindIFrameEscape=function(){var t=u.$$(this.modalbox.content).find("."+o.Component.computeCssClassName(p.QuickviewDocument));t=u.$$(t).find("iframe");var e=t.contentWindow.document.body;u.$$(e).on("keyup",this.bindedHandleEscapeEvent)},e.prototype.closeQuickview=function(){this.queryStateModel.set(d.QueryStateModel.attributesEnum.quickview,"")},e.prototype.setQuickviewSize=function(){var t=u.$$(u.$$(this.modalbox.modalBox).find(".coveo-wrapper"));t.el.style.width=this.options.size,t.el.style.height=this.options.size,t.el.style.maxWidth=this.options.size,t.el.style.maxHeight=this.options.size},e.prototype.handleEscapeEvent=function(t){t.keyCode==m.KEYBOARD.ESCAPE&&(this.closeQuickview(),this.close())},e.ID="Quickview",e.fields=["urihash","collection","source","author"],e.options={alwaysShow:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),title:r.ComponentOptions.buildStringOption(),showDate:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableLoadingAnimation:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),contentTemplate:r.ComponentOptions.buildTemplateOption({selectorAttr:"data-template-selector",idAttr:"data-template-id"}),loadingAnimation:r.ComponentOptions.buildOption(r.ComponentOptionsType.NONE,function(t){var e=t.getAttribute("data-loading-animation-selector");if(null!=e){var n=u.$$(document.documentElement).find(e);if(null!=n)return u.$$(n).detach(),n}var i=t.getAttribute("data-loading-animation-template-id");if(null!=i){var o=r.ComponentOptions.loadResultTemplateFromId(i);if(o)return o.instantiateToElement({})}return s.DomUtils.getBasicLoadingAnimation()}),size:r.ComponentOptions.buildStringOption({defaultValue:a.DeviceUtils.isMobileDevice()?"100%":"95%"})},e.resultCurrentlyBeingRendered=null,e}(o.Component);e.Quickview=y,g.Initialization.registerAutoCreateComponent(y)},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(111),r=function(t){function e(){t.call(this)}return i(e,t),e.prototype.instantiateToString=function(t){return'<div class="coveo-quick-view-full-height"><div class="CoveoQuickviewDocument"></div></div>'},e}(o.Template);e.DefaultQuickviewTemplate=r},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(109),s=n(121),a=n(14),u=n(58),l=n(129),c=n(17),h=n(15),p=n(55),d=n(106),f=n(35),g="CoveoHighlight",m=function(e){function n(t,i,o,s){e.call(this,t,n.ID,o),this.element=t,this.options=i,this.result=s,this.options=r.ComponentOptions.initComponentOptions(t,n,i),this.result=s||this.resolveResult(),this.termsToHighlightWereModified=!1,a.Assert.exists(this.result)}return i(n,e),n.prototype.createDom=function(){var t=u.$$("div");t.addClass("coveo-quickview-document"),this.element.appendChild(t.el),this.header=this.buildHeader(),this.iframe=this.buildIFrame(),t.append(this.header.el),t.append(this.iframe.el)},n.prototype.open=function(){var e=this;this.ensureDom();var n=u.$$(this.element).getAttribute("href");void 0!=n&&""!=n||(n=this.result.clickUri),this.usageAnalytics.logClickEvent(s.analyticsActionCauseList.documentQuickview,{author:this.result.raw.author,documentURL:n,documentTitle:this.result.title},this.result,this.queryController.element);var i=(new Date).getTime(),o=this.iframe.find("iframe");o.src="about:blank";var r=this.queryController.getEndpoint(),a=t.keys(this.result.termsToHighlight),c={termsToHighlight:a};u.$$(this.element).trigger(l.QuickviewEvents.openQuickview,c),this.checkIfTermsToHighlightWereModified(c.termsToHighlight);var h=t.extend({},this.getBindings().queryController.getLastQuery());this.termsToHighlightWereModified&&this.handleTermsToHighlight(c.termsToHighlight,h);var p={queryObject:h,requestedOutputSize:this.options.maximumDocumentSize};r.getDocumentHtml(this.result.uniqueId,p).then(function(t){null!=o.contentDocument&&(e.renderHTMLDocument(o,t),e.triggerQuickviewLoaded(i))}).catch(function(t){null!=o.contentDocument&&(0!=t.status?(e.renderErrorReport(o,t.status),e.triggerQuickviewLoaded(i)):(o.onload=function(){e.triggerQuickviewLoaded(i)},o.src=r.getViewAsHtmlUri(e.result.uniqueId,p)))})},n.prototype.renderHTMLDocument=function(t,e){var n=this;t.onload=function(){if(n.computeHighlights(t.contentWindow),n.isNewQuickviewDocument(t.contentWindow)){var e=u.$$(n.element).closest(".coveo-body");e.style.padding="0";var i=u.$$(n.element).find(".coveo-quickview-header");i.style.paddingTop="10",i.style.paddingLeft="10"}""==u.$$(n.element).find(".coveo-quickview-header").innerHTML&&(u.$$(n.element).find(".coveo-quickview-header").style.display="none")},this.writeToIFrame(t,e),this.wrapPreElementsInIframe(t)},n.prototype.renderErrorReport=function(t,e){var n="";n=400==e?"NoQuickview":"OopsError";var i="<html><body style='font-family: Arimo, 'Helvetica Neue', Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none;' >"+f.l(n)+" </body></html>";this.writeToIFrame(t,i)},n.prototype.writeToIFrame=function(t,e){var n=e;"object"==typeof e&&(n=e.getElementsByTagName("html")[0].outerHTML),t.contentWindow.document.open(),t.contentWindow.document.write(n),t.contentWindow.document.close()},n.prototype.wrapPreElementsInIframe=function(t){try{var e=document.createElement("style");e.type="text/css";var n="html pre { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; }";n+="body, html { font-family: Arimo, 'Helvetica Neue', Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none; }",c.DeviceUtils.isIos()&&(n+="body, html { height: 1px !important; min-height: 100%; overflow: scroll; }",u.$$(t).setAttribute("scrolling","no"),n+="body, html {margin: auto}",t.parentElement.style.margin="0 0 5px 5px",t.style.position="relative"),"styleSheet"in e?e.styleSheet.cssText=n:e.appendChild(document.createTextNode(n));var i=t.contentWindow.document.head;i.appendChild(e)}catch(t){}},n.prototype.triggerQuickviewLoaded=function(t){var e=(new Date).getTime(),n={duration:e-t};u.$$(this.element).trigger(l.QuickviewEvents.quickviewLoaded,n)},n.prototype.computeHighlights=function(e){var n=this;u.$$(this.header).empty(),this.keywordsState=[];var i={},o=0;t.each(u.$$(e.document.body).findAll('[id^="'+g+'"]'),function(t,e){var r=n.getHighlightIdParts(t);if(r){var s=r[1],a=parseInt(r[2],10),u=parseInt(r[3],10),l=i[s];if(null==l&&1==u?i[s]=l={text:n.getHighlightInnerText(t),count:1,index:parseInt(s,10),termsCount:"coveotaggedword"==t.nodeName.toLowerCase()?0:1,
element:t,occurence:a}:l&&(l.occurence==a&&("coveotaggedword"==t.nodeName.toLowerCase()?l.text+=n.getHighlightInnerText(t):l.termsCount<u&&(l.text+=n.getHighlightInnerText(t),l.termsCount+=1)),l.count=Math.max(l.count,a),o+=1),l&&l.occurence==a&&"span"==t.nodeName.toLowerCase()){var c=n.getHightlightEmbeddedWordIdParts(t),h=c?i[c[1]]:null;h&&h.occurence==parseInt(c[2],10)&&(h.text+=t.childNodes[0].nodeValue||"")}}}),0==o&&(this.header.el.style.minHeight="0");var r=[];return t.each(i,function(t){t.text=n.resolveOriginalTermFromHighlight(t.text);var i={word:t,color:t.element.style.backgroundColor,currentIndex:0,index:t.index};n.keywordsState.push(i),u.$$(n.header).append(n.buildWordButton(i,e)),r.push(t.text)}),r},n.prototype.getHighlightIdParts=function(t){var e=t.id.substr(g.length+1).match(/^([0-9]+)\.([0-9]+)\.([0-9]+)$/);return e&&e.length>3?e:null},n.prototype.getHighlightInnerText=function(t){return"coveotaggedword"==t.nodeName.toLowerCase()?t.childNodes.length>=1?t.childNodes.item(0).textContent||"":"":t.textContent||""},n.prototype.getHightlightEmbeddedWordIdParts=function(t){var e=t.getElementsByTagName("coveotaggedword")[0];return e?this.getHighlightIdParts(e):null},n.prototype.resolveOriginalTermFromHighlight=function(e){var n=this,i=e;return this.result.termsToHighlight&&(i=t.find(t.keys(this.result.termsToHighlight),function(i){return i.toLowerCase()==e.toLowerCase()||void 0!=t.find(n.result.termsToHighlight[i],function(t){return t.toLowerCase()==e.toLowerCase()})})||i),i},n.prototype.buildWordButton=function(t,e){var n=this,i=u.$$("span");i.addClass("coveo-term-for-quickview");var o=u.$$("span");o.addClass("coveo-term-for-quickview-name"),o.setHtml(t.word.text),o.on("click",function(){n.navigate(t,!1,e)}),i.append(o.el);var r=u.$$("span");r.addClass("coveo-term-for-quickview-up-arrow");var s=u.$$("span");s.addClass("coveo-term-for-quickview-up-arrow-icon"),r.append(s.el),r.on("click",function(){n.navigate(t,!0,e)}),i.append(r.el);var a=u.$$("span");a.addClass("coveo-term-for-quickview-down-arrow");var l=u.$$("span");return l.addClass("coveo-term-for-quickview-down-arrow-icon"),a.append(l.el),a.on("click",function(){n.navigate(t,!1,e)}),i.append(a.el),i.el.style.backgroundColor=t.color,i.el.style.borderColor=this.getSaturatedColor(t.color),a.el.style.borderColor=this.getSaturatedColor(t.color),i.el},n.prototype.navigate=function(t,e,n){var i,o=t.currentIndex;i=e?o<=1?t.word.count:o-1:o==t.word.count?1:o+1;var r=this.getScrollingElement(n),s=u.$$(r).find('[id^="'+g+":"+t.word.index+"."+o+'"]');s&&(s.style.border="");var a=u.$$(n.document.body).find('[id^="'+g+":"+t.word.index+"."+i+'"]');if(a.style.border="1px dotted #333",t.currentIndex=i,this.isNewQuickviewDocument(n)){var l=u.$$(a).closest(".pc");u.$$(l).addClass("opened")}a.scrollIntoView();var c=this.iframe.closest(".coveo-body");c.scrollLeft=0,c.scrollTop=0},n.prototype.buildHeader=function(){var t=u.$$("div");return t.addClass("coveo-quickview-header"),t},n.prototype.buildIFrame=function(){var t=u.$$("iframe");t.setAttribute("sandbox","allow-same-origin");var e=u.$$("div");return e.addClass("coveo-iframeWrapper"),e.el.appendChild(t.el),e},n.prototype.getScrollingElement=function(t){var e;return this.isNewQuickviewDocument(t)&&(e=u.$$(t.document.body).find("#page-container")),e||(e=u.$$(t.document.body).el),e},n.prototype.isNewQuickviewDocument=function(t){var e=u.$$(t.document.head).find("meta[name='generator']");return e&&"pdf2htmlEX"==e.getAttribute("content")},n.prototype.handleTermsToHighlight=function(e,n){var i=this;for(var o in this.result.termsToHighlight)delete this.result.termsToHighlight[o];var r="";t.each(e,function(t){r+=t+" ",i.result.termsToHighlight[t]=new Array(t)}),r=r.substring(0,r.length-1),n.q=r},n.prototype.checkIfTermsToHighlightWereModified=function(e){h.Utils.arrayEqual(e,t.keys(this.result.termsToHighlight))||(this.termsToHighlightWereModified=!0)},n.prototype.getSaturatedColor=function(t){var e=parseInt(t.substring(4,7)),n=parseInt(t.substring(9,12)),i=parseInt(t.substring(14,17)),o=p.ColorUtils.rgbToHsv(e,n,i);o[1]*=2,o[1]>1&&(o[1]=1);var r=p.ColorUtils.hsvToRgb(o[0],o[1],o[2]);return"rgb("+r[0].toString()+", "+r[1].toString()+", "+r[2].toString()+")"},n.ID="QuickviewDocument",n.options={maximumDocumentSize:r.ComponentOptions.buildNumberOption({defaultValue:0,min:0})},n}(o.Component);e.QuickviewDocument=m,d.Initialization.registerAutoCreateComponent(m)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(115),r=n(107),s=n(109),a=n(14),u=n(48),l=n(98),c=n(101),h=n(21),p=n(58),d=n(121),f=n(106),g=n(32),m=n(17),v=n(49),y=n(15),b=n(59),S=n(128),x=n(178),C=function(e){function n(t,i,o,r){var h=this;void 0===r&&(r=n.ID),e.call(this,t,r,o),this.element=t,this.options=i,this.bindings=o,this.currentlyDisplayedResults=[],this.reachedTheEndOfResults=!1,this.options=s.ComponentOptions.initComponentOptions(t,n,i),a.Assert.exists(t),a.Assert.exists(this.options),a.Assert.exists(this.options.resultContainer),a.Assert.exists(this.options.resultTemplate),a.Assert.exists(this.options.waitAnimationContainer),a.Assert.exists(this.options.infiniteScrollContainer),this.showOrHideElementsDependingOnState(!1,!1),this.bind.onRootElement(u.QueryEvents.newQuery,function(t){return h.handleNewQuery()}),this.bind.onRootElement(u.QueryEvents.buildingQuery,function(t){return h.handleBuildingQuery(t)}),this.bind.onRootElement(u.QueryEvents.querySuccess,function(t){return h.handleQuerySuccess(t)}),this.bind.onRootElement(u.QueryEvents.duringQuery,function(t){return h.handleDuringQuery()}),this.bind.onRootElement(u.QueryEvents.queryError,function(t){return h.handleQueryError()}),this.options.enableInfiniteScroll&&(this.handlePageChanged(),this.bind.on(this.options.infiniteScrollContainer,"scroll",function(t){return h.handleScrollOfResultList()})),this.bind.onQueryState(l.MODEL_EVENTS.CHANGE_ONE,c.QUERY_STATE_ATTRIBUTES.FIRST,function(){return h.handlePageChanged()})}return i(n,e),n.prototype.renderResults=function(e,n){var i=this;void 0===n&&(n=!1),n||(this.options.resultContainer.innerHTML=""),t.each(e,function(t){i.options.resultContainer.appendChild(t),i.triggerNewResultDisplayed(r.Component.getResult(t),t)}),this.triggerNewResultsDisplayed()},n.prototype.buildResults=function(e){var i=this,o=[];return t.each(e.results,function(t){var e=i.buildResult(t);null!=e&&o.push(e)}),n.resultCurrentlyBeingRendered=null,o},n.prototype.buildResult=function(t){a.Assert.exists(t),h.QueryUtils.setStateObjectOnQueryResult(this.queryStateModel.get(),t),n.resultCurrentlyBeingRendered=t;var e=this.options.resultTemplate.instantiateToElement(t);return null!=e&&r.Component.bindResultToElement(e,t),this.autoCreateComponentsInsideResult(e,t),e},n.prototype.displayMoreResults=function(e){var n=this;return a.Assert.isLargerOrEqualsThan(1,e),this.isCurrentlyFetchingMoreResults()?void this.logger.warn("Ignoring request to display more results since we're already doing so"):this.hasPotentiallyMoreResultsToDisplay()?(this.options.enableInfiniteScrollWaitingAnimation&&this.showWaitingAnimationForInfiniteScrolling(),this.fetchingMoreResults=this.queryController.fetchMore(e),this.fetchingMoreResults.then(function(i){a.Assert.exists(i),n.usageAnalytics.logCustomEvent(d.analyticsActionCauseList.pagerScrolling,{},n.element);var o=i.results;n.reachedTheEndOfResults=e>i.results.length,n.renderResults(n.buildResults(i),!0),t.each(o,function(t){n.currentlyDisplayedResults.push(t)}),n.triggerNewResultsDisplayed()}),void this.fetchingMoreResults.then(function(){n.hideWaitingAnimationForInfiniteScrolling(),n.fetchingMoreResults=void 0,g.Defer.defer(function(){return n.handleScrollOfResultList()})})):void this.logger.warn("Ignoring request to display more results since we know there aren't more to display")},n.prototype.getDisplayedResults=function(){return this.currentlyDisplayedResults},n.prototype.getDisplayedResultsElements=function(){return p.$$(this.options.resultContainer).findAll(".CoveoResult")},n.prototype.autoCreateComponentsInsideResult=function(e,n){a.Assert.exists(e);var i=this.searchInterface.options.originalOptionsObject,o=t.extend({},this.getBindings(),{resultElement:e}),r={options:i,bindings:o,result:n};f.Initialization.automaticallyCreateComponentsInside(e,r)},n.prototype.triggerNewResultDisplayed=function(t,e){var n={result:t,item:e};p.$$(this.element).trigger(v.ResultListEvents.newResultDisplayed,n)},n.prototype.triggerNewResultsDisplayed=function(){p.$$(this.element).trigger(v.ResultListEvents.newResultsDisplayed,{})},n.prototype.handleDuringQuery=function(){this.logger.trace("Emptying the result container"),this.cancelFetchingMoreResultsIfNeeded(),this.showWaitingAnimation(),this.showOrHideElementsDependingOnState(!1,!1)},n.prototype.handleQueryError=function(){this.hideWaitingAnimation(),p.$$(this.options.resultContainer).empty(),this.currentlyDisplayedResults=[]},n.prototype.handleQuerySuccess=function(t){a.Assert.exists(t),a.Assert.exists(t.results);var e=t.results;this.logger.trace("Received query results from new query",e),this.hideWaitingAnimation(),n.resultCurrentlyBeingRendered=void 0,this.currentlyDisplayedResults=[],this.renderResults(this.buildResults(t.results)),this.currentlyDisplayedResults=e.results,this.reachedTheEndOfResults=!1,this.showOrHideElementsDependingOnState(!0,0!=this.currentlyDisplayedResults.length),m.DeviceUtils.isMobileDevice()&&void 0!=this.options.mobileScrollContainer&&(this.options.mobileScrollContainer.scrollTop=0),this.options.enableInfiniteScroll&&e.results.length==t.queryBuilder.numberOfResults&&(this.scrollBackToTop(),this.handleScrollOfResultList())},n.prototype.handleScrollOfResultList=function(){!this.isCurrentlyFetchingMoreResults()&&this.options.enableInfiniteScroll&&this.isScrollingOfResultListAlmostAtTheBottom()&&this.hasPotentiallyMoreResultsToDisplay()&&this.displayMoreResults(this.options.infiniteScrollPageSize)},n.prototype.handlePageChanged=function(){var t=this;this.bind.onRootElement(u.QueryEvents.deferredQuerySuccess,function(){setTimeout(function(){t.scrollBackToTop()},0)})},n.prototype.scrollBackToTop=function(){if(this.options.infiniteScrollContainer instanceof Window){var t=this.options.infiniteScrollContainer;t.scrollTo(0,0)}else{var e=this.options.infiniteScrollContainer;e.scrollTop=0}},n.prototype.handleNewQuery=function(){p.$$(this.element).show(),n.resultCurrentlyBeingRendered=void 0},n.prototype.handleBuildingQuery=function(e){null!=this.options.fieldsToInclude&&e.queryBuilder.addFieldsToInclude(t.map(this.options.fieldsToInclude,function(t){return t.substr(1)})),this.options.autoSelectFieldsToInclude&&(e.queryBuilder.addRequiredFields(this.getAutoSelectedFieldsToInclude()),e.queryBuilder.includeRequiredFields=!0)},n.prototype.getAutoSelectedFieldsToInclude=function(){return t.chain(this.options.resultTemplate.getFields()).compact().unique().value()},n.prototype.isCurrentlyFetchingMoreResults=function(){return y.Utils.exists(this.fetchingMoreResults)},n.prototype.isScrollingOfResultListAlmostAtTheBottom=function(){var t;try{t=this.options.infiniteScrollContainer instanceof Window}catch(e){t=!1}return t?this.isScrollAtBottomForWindowElement():this.isScrollAtBottomForHtmlElement()},n.prototype.isScrollAtBottomForWindowElement=function(){var t=new p.Win(window),e=t.height(),n=t.scrollY(),i=new p.Doc(document).height();return i-(e+n)<e/2},n.prototype.isScrollAtBottomForHtmlElement=function(){var t=this.options.infiniteScrollContainer,e=t.clientHeight,n=t.scrollHeight,i=t.scrollTop+e;return n-i<e/2},n.prototype.hasPotentiallyMoreResultsToDisplay=function(){return this.currentlyDisplayedResults.length>0&&!this.reachedTheEndOfResults},n.prototype.cancelFetchingMoreResultsIfNeeded=function(){this.isCurrentlyFetchingMoreResults()&&(this.logger.trace("Cancelling fetching more results"),Promise.reject(this.fetchingMoreResults),this.fetchingMoreResults=void 0)},n.prototype.showOrHideElementsDependingOnState=function(e,n){var i=p.$$(this.element).findAll(".coveo-show-if-query"),o=p.$$(this.element).findAll(".coveo-show-if-no-query"),r=p.$$(this.element).findAll(".coveo-show-if-results"),s=p.$$(this.element).findAll(".coveo-show-if-no-results");t.each(i,function(t){p.$$(t).toggle(e)}),t.each(o,function(t){p.$$(t).toggle(!e)}),t.each(r,function(t){p.$$(t).toggle(e&&n)}),t.each(s,function(t){p.$$(t).toggle(e&&!n)})},n.prototype.showWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":p.$$(this.options.waitAnimationContainer).addClass("coveo-fade-out");break;case"spinner":t.each(this.options.resultContainer.children,function(t){p.$$(t).hide()}),void 0==p.$$(this.options.waitAnimationContainer).find(".coveo-wait-animation")&&this.options.waitAnimationContainer.appendChild(b.DomUtils.getBasicLoadingAnimation())}},n.prototype.hideWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":p.$$(this.options.waitAnimationContainer).removeClass("coveo-fade-out");break;case"spinner":var t=p.$$(this.options.waitAnimationContainer).find(".coveo-loading-spinner");t&&p.$$(t).detach()}},n.prototype.showWaitingAnimationForInfiniteScrolling=function(){this.options.waitAnimationContainer.appendChild(b.DomUtils.getLoadingSpinner())},n.prototype.hideWaitingAnimationForInfiniteScrolling=function(){var t=p.$$(this.options.waitAnimationContainer).find(".coveo-loading-spinner");t&&p.$$(t).detach()},n.getDefaultTemplate=function(t){var e=r.Component.get(t);return e.searchInterface instanceof S.Recommendation?new x.DefaultRecommendationTemplate:new o.DefaultResultTemplate},n.ID="ResultList",n.options={resultContainer:s.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){var e=document.createElement("div");return t.appendChild(e),e}}),resultTemplate:s.ComponentOptions.buildTemplateOption({defaultFunction:n.getDefaultTemplate}),waitAnimation:s.ComponentOptions.buildStringOption({defaultValue:"none"}),waitAnimationContainer:s.ComponentOptions.buildChildHtmlElementOption({postProcessing:function(t,e){return t||e.resultContainer}}),enableInfiniteScroll:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),infiniteScrollPageSize:s.ComponentOptions.buildNumberOption({defaultValue:10,min:1,depend:"enableInfiniteScroll"}),infiniteScrollContainer:s.ComponentOptions.buildChildHtmlElementOption({depend:"enableInfiniteScroll",defaultFunction:function(t){return s.ComponentOptions.findParentScrolling(t)}}),enableInfiniteScrollWaitingAnimation:s.ComponentOptions.buildBooleanOption({depend:"enableInfiniteScroll",defaultValue:!0}),mobileScrollContainer:s.ComponentOptions.buildSelectorOption({defaultFunction:function(){return document.querySelector(".coveo-results-column")}}),fieldsToInclude:s.ComponentOptions.buildFieldsOption({includeInResults:!0}),autoSelectFieldsToInclude:s.ComponentOptions.buildBooleanOption({defaultValue:!1})},n.resultCurrentlyBeingRendered=null,n}(r.Component);e.ResultList=C,f.Initialization.registerAutoCreateComponent(C)}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(111),r=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.instantiateToString=function(t){var e='<div class="coveo-result-frame">\n        <div class="coveo-result-row">\n          <div class="coveo-result-cell" style="width:40px;text-align:center;vertical-align:middle;">\n            <span class="CoveoIcon" data-small="true">\n            </span>\n          </div>\n          <div class="coveo-result-cell" style="padding:0 0 3px 5px;vertical-align:middle">\n            <div class="coveo-result-row">\n              <div class="coveo-result-cell" style="font-size:10pt;">\n                <a class="CoveoResultLink" style="display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">\n                </a>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>';return e},e.prototype.instantiateToElement=function(t){var e=document.createElement("div");return e.innerHTML=this.instantiateToString(t),e},e}(o.Template);e.DefaultRecommendationTemplate=r},,function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(106),r=n(107),s=n(109),a=n(48),u=n(98),l=n(101),c=n(53),h=n(121),p=n(58),d=n(14),f=n(181),g=function(t){function e(n,i,o){var r=this;t.call(this,n,e.ID,o),this.element=n,this.options=i,this.bindings=o,n instanceof HTMLInputElement&&this.logger.error("QueryBox can't be use on a HTMLInputElement"),this.options=s.ComponentOptions.initComponentOptions(n,e,i),this.magicBox=Coveo.MagicBox.create(n,new Coveo.MagicBox.Grammar("Query",{Query:"[Term*][Spaces?]",Term:"[Spaces?][Word]",Spaces:/ +/,Word:/[^ ]+/}),{inline:!0}),this.bind.onRootElement(a.QueryEvents.buildingQuery,function(t){return r.handleBuildingQuery(t)}),this.bind.onRootElement(c.StandaloneSearchInterfaceEvents.beforeRedirect,function(){return r.updateQueryState()}),this.bind.onQueryState(u.MODEL_EVENTS.CHANGE_ONE,l.QUERY_STATE_ATTRIBUTES.Q,function(t){return r.handleQueryStateChanged(t)}),this.options.enableSearchAsYouType&&(p.$$(this.element).addClass("coveo-search-as-you-type"),this.magicBox.onchange=function(){r.searchAsYouType()}),this.magicBox.onsubmit=function(){r.submit()},this.magicBox.onblur=function(){r.updateQueryState()},this.magicBox.onclear=function(){r.updateQueryState(),r.options.triggerQueryOnClear&&(r.usageAnalytics.logSearchEvent(h.analyticsActionCauseList.searchboxClear,{}),r.triggerNewQuery(!1))},this.options.autoFocus&&this.magicBox.focus()}return i(e,t),e.prototype.submit=function(){this.magicBox.clearSuggestion(),this.updateQueryState(),this.usageAnalytics.logSearchEvent(h.analyticsActionCauseList.searchboxSubmit,{}),this.triggerNewQuery(!1)},e.prototype.setText=function(t){this.magicBox.setText(t),this.updateQueryState()},e.prototype.clear=function(){this.magicBox.clear()},e.prototype.getText=function(){return this.magicBox.getText()},e.prototype.getResult=function(){return this.magicBox.getResult()},e.prototype.getDisplayedResult=function(){return this.magicBox.getDisplayedResult()},e.prototype.getCursor=function(){return this.magicBox.getCursor()},e.prototype.resultAtCursor=function(t){return this.magicBox.resultAtCursor(t)},e.prototype.handleBuildingQuery=function(t){d.Assert.exists(t),d.Assert.exists(t.queryBuilder),this.updateQueryState(),this.lastQuery=this.magicBox.getText(),new f.QueryboxQueryParameters(this.options).addParameters(t.queryBuilder,this.lastQuery)},e.prototype.triggerNewQuery=function(t){clearTimeout(this.searchAsYouTypeTimeout);var e=this.magicBox.getText();this.lastQuery!=e&&null!=e&&(this.lastQuery=e,this.queryController.executeQuery({searchAsYouType:t,logInActionsHistory:!0}))},e.prototype.updateQueryState=function(){this.queryStateModel.set(l.QueryStateModel.attributesEnum.q,this.magicBox.getText())},e.prototype.handleQueryStateChanged=function(t){d.Assert.exists(t);var e=t.value;e!=this.magicBox.getText()&&this.magicBox.setText(e)},e.prototype.searchAsYouType=function(){var t=this;clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=setTimeout(function(){t.usageAnalytics.logSearchAsYouType(h.analyticsActionCauseList.searchboxAsYouType,{}),t.triggerNewQuery(!0)},this.options.searchAsYouTypeDelay)},e.ID="Querybox",e.options={enableSearchAsYouType:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:s.ComponentOptions.buildNumberOption({defaultValue:500,min:0}),enableQuerySyntax:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableWildcards:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:s.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:s.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),partialMatchThreshold:s.ComponentOptions.buildStringOption({defaultValue:"50%"}),triggerQueryOnClear:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),placeholder:s.ComponentOptions.buildStringOption(),autoFocus:s.ComponentOptions.buildBooleanOption({defaultValue:!0})},e}(r.Component);e.Querybox=g,o.Initialization.registerAutoCreateComponent(g)},function(t,e,n){(function(t){"use strict";var n=function(){function e(t){this.options=t}return e.prototype.addParameters=function(e,n){this.options.enableWildcards&&(e.enableWildcards=!0),this.options.enableQuestionMarks&&(e.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(e.enableLowercaseOperators=!0),t.isEmpty(n)||(e.disableQuerySyntax=!this.options.enableQuerySyntax,e.expression.add(n),this.options.enablePartialMatch&&(e.enablePartialMatch=this.options.enablePartialMatch,this.options.partialMatchKeywords&&(e.partialMatchKeywords=this.options.partialMatchKeywords),this.options.partialMatchThreshold&&(e.partialMatchThreshold=this.options.partialMatchThreshold)))},e}();e.QueryboxQueryParameters=n}).call(e,n(10))},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(15),s=n(58),a=n(35),u=n(121),l=n(106),c=function(t){function e(n,i,o){var u=this;t.call(this,n,e.ID,o),this.element=n,this.options=i,this.bind.on(n,"click",function(){return u.handleClick()}),""==r.Utils.trim(s.$$(this.element).text())&&(n.innerHTML="<span class='coveo-icon'>"+a.l("Search")+"</span>")}return i(e,t),e.prototype.click=function(){this.handleClick()},e.prototype.handleClick=function(){this.logger.debug("Performing query following button click"),this.usageAnalytics.logSearchEvent(u.analyticsActionCauseList.searchboxSubmit,{}),this.queryController.executeQuery()},e.ID="SearchButton",e.options={},e}(o.Component);e.SearchButton=c,l.Initialization.registerAutoCreateComponent(c)},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(184),s=n(109),a=n(182),u=n(180),l=n(58),c=n(106),h=function(t){function e(n,i,o){if(t.call(this,n,e.ID,o),this.element=n,this.options=i,this.options=s.ComponentOptions.initComponentOptions(n,e,i),this.options.inline&&l.$$(n).addClass("coveo-inline"),this.options.addSearchButton){var c=document.createElement("a");this.element.appendChild(c),this.searchButton=new a.SearchButton(c,void 0,o)}var h=document.createElement("div");this.element.appendChild(h),this.options.enableOmnibox?this.searchbox=new r.Omnibox(h,this.options,o):this.searchbox=new u.Querybox(h,this.options,o)}return i(e,t),e.ID="Searchbox",e.parent=r.Omnibox,e.options={addSearchButton:s.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableOmnibox:s.ComponentOptions.buildBooleanOption({defaultValue:!1})},e}(o.Component);e.Searchbox=h,h.options=t.extend({},h.options,r.Omnibox.options,u.Querybox.options),t.each(h.options,function(e,n){n in r.Omnibox.options&&!(n in u.Querybox.options)&&(h.options[n]=t.extend({depend:"enableOmnibox"},e))}),c.Initialization.registerAutoCreateComponent(h)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(107),r=n(109),s=n(48),a=n(53),u=n(98),l=n(101),c=n(121),h=n(46),p=n(58),d=n(14),f=n(101),g=n(106),m=n(180),v=n(185),y=n(186),b=n(187),S=n(188),x=n(181),C=n(126),E=n(15),w=n(23),A=n(108),T=.8,O=function(e){function n(i,o,c){var h=this;e.call(this,i,n.ID,c),this.element=i,this.options=o,this.partialQueries=[],this.lastSuggestions=[],this.movedOnce=!1,this.skipRevealAutoSuggest=!1,this.options=r.ComponentOptions.initComponentOptions(i,n,o);var p;this.options.enableQuerySyntax?(p=w.MagicBox.Grammars.Expressions(w.MagicBox.Grammars.Complete),this.options.enableFieldAddon&&new v.FieldAddon(this),null!=this.options.fieldAlias&&(this.options.listOfFields=this.options.listOfFields||[],this.options.listOfFields=this.options.listOfFields.concat(t.keys(this.options.fieldAlias))),this.options.enableQueryExtensionAddon&&new y.QueryExtensionAddon(this)):p={start:"Any",expressions:{Any:/.*/}},this.options.enableRevealQuerySuggestAddon&&new b.RevealQuerySuggestAddon(this),new S.OldOmniboxAddon(this),null!=this.options.grammar&&(p=this.options.grammar(p)),this.magicBox=w.MagicBox.create(i,new w.MagicBox.Grammar(p.start,p.expressions),{inline:this.options.inline,selectableSuggestionClass:"coveo-omnibox-selectable",selectedSuggestionClass:"coveo-omnibox-selected",suggestionTimeout:this.options.omniboxTimeout}),this.bind.onRootElement(s.QueryEvents.buildingQuery,function(t){return h.handleBuildingQuery(t)}),this.bind.onRootElement(a.StandaloneSearchInterfaceEvents.beforeRedirect,function(){return h.handleBeforeRedirect()}),this.bind.onRootElement(s.QueryEvents.querySuccess,function(){return h.handleQuerySuccess()}),this.bind.onQueryState(u.MODEL_EVENTS.CHANGE_ONE,l.QUERY_STATE_ATTRIBUTES.Q,function(t){return h.handleQueryStateChanged(t)}),this.isRevealAutoSuggestion()&&this.bind.onRootElement(s.QueryEvents.duringQuery,function(t){return h.handleDuringQuery(t)}),this.setupMagicBox()}return i(n,e),n.prototype.submit=function(){var t=this;this.magicBox.clearSuggestion(),this.updateQueryState(),this.triggerNewQuery(!1,function(){t.usageAnalytics.logSearchEvent(c.analyticsActionCauseList.searchboxSubmit,{})})},n.prototype.getText=function(){return this.magicBox.getText()},n.prototype.setText=function(t){this.magicBox.setText(t),this.updateQueryState()},n.prototype.clear=function(){this.magicBox.clear()},n.prototype.getInput=function(){return this.magicBox.element.querySelector("input")},n.prototype.getResult=function(){return this.magicBox.getResult()},n.prototype.getDisplayedResult=function(){return this.magicBox.getDisplayedResult()},n.prototype.getCursor=function(){return this.magicBox.getCursor()},n.prototype.resultAtCursor=function(t){return this.magicBox.resultAtCursor(t)},n.prototype.setupMagicBox=function(){var e=this;this.magicBox.onmove=function(){e.isRevealAutoSuggestion()&&(e.modifyEventTo=e.getOmniboxAnalyticsEventCause()),e.movedOnce=!0},this.magicBox.onfocus=function(){e.isRevealAutoSuggestion()&&(e.skipRevealAutoSuggest=!0)},this.magicBox.onsuggestions=function(t){E.Utils.isEmptyString(e.getText())&&(e.partialQueries=[]),e.movedOnce=!1,e.lastSuggestions=t,e.isRevealAutoSuggestion()&&!e.skipRevealAutoSuggest&&e.searchAsYouType()},this.options.enableSearchAsYouType&&p.$$(this.element).addClass("coveo-magicbox-search-as-you-type"),this.magicBox.onchange=function(){e.skipRevealAutoSuggest=!1;var t=e.getText();void 0!=t&&""!=t?e.isRevealAutoSuggestion()?e.movedOnce&&e.searchAsYouType(!0):e.options.enableSearchAsYouType&&e.searchAsYouType(!0):e.clear()},this.options.placeholder&&(this.magicBox.element.querySelector("input").placeholder=this.options.placeholder),this.magicBox.onsubmit=function(){e.magicBox.clearSuggestion(),e.updateQueryState(),e.triggerNewQuery(!1,function(){e.usageAnalytics.logSearchEvent(c.analyticsActionCauseList.searchboxSubmit,{})})},this.magicBox.onselect=function(n){var i=t.indexOf(e.lastSuggestions,n),o=t.compact(t.map(e.lastSuggestions,function(t){return t.text}));e.magicBox.clearSuggestion(),e.updateQueryState(),e.isRevealAutoSuggestion()?e.isRevealAutoSuggestion()&&e.movedOnce?e.handleRevealAutoSuggestionWithKeyboard(i,o):e.isRevealAutoSuggestion()&&!e.movedOnce&&e.handleRevealAutoSuggestionsWithMouse(i,o):(e.usageAnalytics.cancelAllPendingEvents(),e.triggerNewQuery(!1,function(){e.usageAnalytics.logSearchEvent(e.getOmniboxAnalyticsEventCause(),e.buildCustomDataForPartialQueries(i,o))})),e.isRevealAutoSuggestion()&&(e.partialQueries=[])},this.magicBox.onblur=function(){e.options.enableSearchAsYouType&&!e.options.inline?e.setText(e.lastQuery):e.updateQueryState(),e.isRevealAutoSuggestion()&&e.usageAnalytics.sendAllPendingEvents()},this.magicBox.onclear=function(){e.updateQueryState(),e.options.triggerQueryOnClear&&e.triggerNewQuery(!1,function(){e.usageAnalytics.logSearchEvent(c.analyticsActionCauseList.searchboxClear,{})})},this.options.autoFocus&&this.magicBox.focus(),this.magicBox.getSuggestions=function(){return e.handleSuggestions()}},n.prototype.handleRevealAutoSuggestionWithKeyboard=function(t,e){var n=this;this.searchAsYouTypeTimeout?(this.usageAnalytics.cancelAllPendingEvents(),clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0,this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(t,e))})):(this.modifyEventTo=this.getOmniboxAnalyticsEventCause(),this.modifyCustomDataOnPending(t,e),this.usageAnalytics.sendAllPendingEvents())},n.prototype.handleRevealAutoSuggestionsWithMouse=function(t,e){var n=this;this.searchAsYouTypeTimeout||0!=t?(this.clearSearchAsYouType(),this.usageAnalytics.cancelAllPendingEvents(),this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(t,e))})):(this.modifyEventTo=this.getOmniboxAnalyticsEventCause(),this.modifyCustomDataOnPending(t,e),this.usageAnalytics.sendAllPendingEvents())},n.prototype.modifyCustomDataOnPending=function(e,n){var i=this.usageAnalytics.getPendingSearchEvent();if(i instanceof C.PendingSearchAsYouTypeSearchEvent){var o=this.buildCustomDataForPartialQueries(e,n);t.each(t.keys(o),function(t){i.modifyCustomData(t,o[t])})}},n.prototype.buildCustomDataForPartialQueries=function(e,n){return{partialQueries:this.cleanCustomData(this.partialQueries),suggestionRanking:e,suggestions:this.cleanCustomData(n),partialQuery:t.last(this.partialQueries)}},n.prototype.cleanCustomData=function(e,n){void 0===n&&(n=256),e=t.compact(t.filter(e,function(t,e,n){return 0===e||t!==n[e-1]})),e=t.map(e,function(t){return t.replace(/;/g,"")});var i=[];t.reduceRight(e,function(t,e){var o=t+e.length;return o<=n&&i.push(e),o},0),e=i.reverse();var o=e.join(";");return o.length>=256?this.cleanCustomData(e,n-10):e.join(";")},n.prototype.handleSuggestions=function(){var e={suggestions:[],omnibox:this};this.bind.trigger(this.element,h.OmniboxEvents.populateOmniboxSuggestions,e);var n=this.getText();return E.Utils.isNullOrEmptyString(n)||this.partialQueries.push(n),t.compact(e.suggestions)},n.prototype.handleBeforeRedirect=function(){this.updateQueryState()},n.prototype.handleBuildingQuery=function(e){var n=this;d.Assert.exists(e),d.Assert.exists(e.queryBuilder),this.updateQueryState(),this.lastQuery=this.getQuery(e.searchAsYouType);var i=this.lastQuery==this.magicBox.getDisplayedResult().input?this.magicBox.getDisplayedResult().clone():this.magicBox.grammar.parse(this.lastQuery).clean(),o={result:i};if(this.options.enableQuerySyntax){var r=o.result.findAll("FieldValueNotQuoted");if(t.each(r,function(t){return t.value='"'+t.value.replace(/"|\u00A0/g," ")+'"'}),this.options.fieldAlias){var s=o.result.findAll(function(t){return"FieldName"==t.expression.id&&t.isSuccess()});t.each(s,function(e){var i=t.find(t.keys(n.options.fieldAlias),function(t){return t.toLowerCase()==e.value.toLowerCase()});null!=i&&(e.value=n.options.fieldAlias[i])})}}this.bind.trigger(this.element,h.OmniboxEvents.omniboxPreprocessResultForQuery,o);var a=o.result.toString();
new x.QueryboxQueryParameters(this.options).addParameters(e.queryBuilder,a)},n.prototype.triggerNewQuery=function(t,e){clearTimeout(this.searchAsYouTypeTimeout);var n=this.getQuery(t);this.shouldExecuteQuery(t)&&(this.lastQuery=n,e(),this.queryController.executeQuery({searchAsYouType:t,logInActionsHistory:!0}))},n.prototype.getQuery=function(e){var n;if(e&&(n=this.magicBox.getWordCompletion(),null==n&&null!=this.lastSuggestions&&this.lastSuggestions.length>0)){var i=t.find(this.lastSuggestions,function(t){return null!=t.text});null!=i&&(n=i.text)}return n||this.magicBox.getText()},n.prototype.updateQueryState=function(){this.queryStateModel.set(f.QueryStateModel.attributesEnum.q,this.magicBox.getText())},n.prototype.handleQueryStateChanged=function(t){d.Assert.exists(t);var e=t.value;e!=this.magicBox.getText()&&this.magicBox.setText(e)},n.prototype.handleQuerySuccess=function(){this.isRevealAutoSuggestion()||(this.partialQueries=[])},n.prototype.handleDuringQuery=function(t){var e=this;t.promise.then(function(){var n=e.usageAnalytics.getPendingSearchEvent();n instanceof C.PendingSearchAsYouTypeSearchEvent&&n.beforeResolve.then(function(n){t.promise.then(function(){e.modifyEventTo&&(n.modifyEventCause(e.modifyEventTo),e.modifyEventTo=null)})})})},n.prototype.searchAsYouType=function(e){var n=this;void 0===e&&(e=!1),this.clearSearchAsYouType(),this.shouldExecuteQuery(!0)&&(this.searchAsYouTypeTimeout=setTimeout(function(){if(n.suggestionShouldTriggerQuery()||e){var i=t.map(n.lastSuggestions,function(t){return t.text}),o=t.indexOf(i,n.magicBox.getWordCompletion());n.triggerNewQuery(!0,function(){n.usageAnalytics.logSearchAsYouType(c.analyticsActionCauseList.searchboxAsYouType,n.buildCustomDataForPartialQueries(o,i))}),n.clearSearchAsYouType()}},this.options.searchAsYouTypeDelay))},n.prototype.isRevealAutoSuggestion=function(){return this.options.enableSearchAsYouType&&this.options.enableRevealQuerySuggestAddon},n.prototype.shouldExecuteQuery=function(t){var e=this.getQuery(t);return this.lastQuery!=e&&null!=e},n.prototype.suggestionShouldTriggerQuery=function(t){if(void 0===t&&(t=this.lastSuggestions),this.shouldExecuteQuery(!0)&&t&&t[0]){var e=t[0];if(e&&void 0!=e.executableConfidence)return e.executableConfidence>=T;if(e.text&&0==e.text.indexOf(this.magicBox.getText()))return!0}return!1},n.prototype.clearSearchAsYouType=function(){clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0},n.prototype.getOmniboxAnalyticsEventCause=function(){return this.searchInterface instanceof A.StandaloneSearchInterface?c.analyticsActionCauseList.omniboxFromLink:c.analyticsActionCauseList.omniboxAnalytics},n.ID="Omnibox",n.options={inline:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableSearchAsYouType:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:r.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0,depend:"enableSearchAsYouType"}),enableFieldAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax"}),enableSimpleFieldAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableFieldAddon"}),listOfFields:r.ComponentOptions.buildFieldsOption({depend:"enableFieldAddon"}),enableRevealQuerySuggestAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,alias:"enableTopQueryAddon"}),enableQueryExtensionAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax"}),placeholder:r.ComponentOptions.buildStringOption(),omniboxTimeout:r.ComponentOptions.buildNumberOption({defaultValue:2e3})},n}(o.Component);e.Omnibox=O,O.options=t.extend({},O.options,m.Querybox.options),g.Initialization.registerAutoCreateComponent(O)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(46),o=n(23),r=function(){function e(t){var e=this;this.omnibox=t,this.cache={},this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(t){t.suggestions.push(e.getSuggestion())})}return e.prototype.getSuggestion=function(){var t=this,e=this.getHash();if(null==e)return null;var n=this.hashToString(e);if(null!=this.cache[n])return this.hashValueToSuggestion(e,this.cache[n]);var i;return"FieldName"==e.type&&(i=this.fieldNames(e.current)),"FieldValue"==e.type&&(i=this.fieldValues(e.field,e.current)),"SimpleFieldName"==e.type&&(i=this.simpleFieldNames(e.current)),this.cache[n]=i,i.catch(function(){delete t.cache[n]}),this.hashValueToSuggestion(e,i)},e.prototype.getHash=function(){var e=t.last(this.omnibox.resultAtCursor("FieldName"));if(null!=e){e=e.findParent("Field")||e;var n=e.toString(),i=e.before(),o=e.after();return{type:"FieldName",current:n,before:i,after:o}}var r=t.last(this.omnibox.resultAtCursor("FieldValue"));if(r){var s=r.findParent("FieldQuery")||this.omnibox.options.enableSimpleFieldAddon&&r.findParent("FieldSimpleQuery");if(s){var a=s.find("FieldName").toString();this.omnibox.options.fieldAlias&&a in this.omnibox.options.fieldAlias&&(a=this.omnibox.options.fieldAlias[a]);var u=r.toString(),i=r.before(),o=r.after();return{type:"FieldValue",field:a,current:u,before:i,after:o}}}if(this.omnibox.options.enableSimpleFieldAddon){var l=t.last(this.omnibox.resultAtCursor("Word"));if(null!=l){var n=l.toString(),i=l.before(),o=l.after();return{type:"SimpleFieldName",current:n,before:i,after:o}}}},e.prototype.hashToString=function(t){return null==t?null:t.type+t.current+(t.field||"")},e.prototype.hashValueToSuggestion=function(n,i){return i.then(function(i){var r=t.map(i,function(t,r){return{text:n.before+(0==n.current.toLowerCase().indexOf(t.toLowerCase())?n.current+t.substr(n.current.length):t)+n.after,html:o.MagicBox.Utils.highlightText(t,n.current,!0),index:e.INDEX-r/i.length}});return r})},e.prototype.getFields=function(){var e=this;return null==this.fields&&(this.fields=new Promise(function(n,i){if(null!=e.omnibox.options.listOfFields)n(e.omnibox.options.listOfFields);else{var o=e.omnibox.queryController.getEndpoint().listFields();o.then(function(e){var i=t.chain(e).filter(function(t){return t.includeInQuery&&t.groupByField}).map(function(t){return t.name.substr(1)}).value();n(i)}).catch(function(){i()})}})),this.fields},e.prototype.fieldNames=function(e){var n=e.length>0&&"@"==e[0],i=n?e.substr(1):e,o=i.toLowerCase();return this.getFields().then(function(i){var r=t.chain(i).map(function(t){return{index:t.toLowerCase().indexOf(o),field:n?t:"@"+t}}).filter(function(t){return t.index!=-1&&t.field.length>e.length}).sortBy("index").map(function(t){return t.field}).value();return r=t.first(r,5)})},e.prototype.fieldValues=function(e,n){return this.omnibox.queryController.getEndpoint().listFieldValues({pattern:".*"+n+".*",patternType:"RegularExpression",sortCriteria:"occurrences",field:"@"+e,maximumNumberOfValues:5}).then(function(e){return t.chain(e).map(function(t){return{index:t.value.toLowerCase().indexOf(n),value:t.value}}).filter(function(t){return t.value.length>n.length}).sortBy("index").map(function(t){return t.value.replace(/ /g," ")}).value()})},e.prototype.simpleFieldNames=function(e){var n=e,i=n.toLowerCase();return this.getFields().then(function(n){var o=t.chain(n).map(function(t){return{index:t.toLowerCase().indexOf(i),field:t+":"}}).filter(function(t){return t.index!=-1&&t.field.length>e.length}).sortBy("index").map(function(t){return t.field}).value();return o=t.first(o,5)})},e.INDEX=64,e}();e.FieldAddon=r}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(46),o=n(23),r=function(){function e(t){var e=this;this.omnibox=t,this.cache={},this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(t){t.suggestions.push(e.getSuggestion())})}return e.prototype.getSuggestion=function(){var t=this,e=this.getHash(this.omnibox.magicBox);if(null==e)return null;var n=this.hashToString(e);if(null!=this.cache[n])return this.hashValueToSuggestion(e,this.cache[n]);var i="QueryExtensionName"==e.type?this.names(e.current):this.attributeNames(e.name,e.current,e.used);return this.cache[n]=i,i.catch(function(){delete t.cache[n]}),this.hashValueToSuggestion(e,i)},e.prototype.getHash=function(e){var n=t.last(e.resultAtCursor("QueryExtension"));if(null!=n){var i=n.findAll("QueryExtensionArgument"),o=t.last(e.resultAtCursor("QueryExtensionName"));if(null!=o)return{type:"QueryExtensionName",current:o.toString(),before:o.before(),after:o.after()};if(o=t.last(e.resultAtCursor("QueryExtensionArgumentName")),null!=o){var r=t.chain(i).map(function(t){var e=t.find("QueryExtensionArgumentName");return e&&e.toString()}).compact().value(),s=n.find("QueryExtensionName").toString();return{type:"QueryExtensionArgumentName",current:o.toString(),before:o.before(),after:o.after(),name:s,used:r}}}return null},e.prototype.hashToString=function(t){return null==t?null:[t.type,t.current,t.name||"",t.used?t.used.join():""].join()},e.prototype.hashValueToSuggestion=function(n,i){return i.then(function(i){var r=t.map(i,function(t,r){return{html:o.MagicBox.Utils.highlightText(t,n.current,!0),text:n.before+t+n.after,index:e.INDEX-r/i.length}});return r})},e.prototype.getExtensions=function(){return null==this.extensions&&(this.extensions=this.omnibox.queryController.getEndpoint().extensions()),this.extensions},e.prototype.names=function(e){var n=e.toLowerCase();return this.getExtensions().then(function(e){var i=t.chain(e).map(function(t){return{index:t.name.toLowerCase().indexOf(n),extension:t.name}}).filter(function(t){return t.index!=-1&&t.extension.length>n.length}).sortBy("index").pluck("extension").value();return i=t.first(i,5)})},e.prototype.attributeNames=function(e,n,i){return this.getExtensions().then(function(o){var r=t.find(o,function(t){return t.name==e});return null==r?[]:t.filter(t.difference(r.argumentNames,i),function(t){return 0==t.indexOf(n)})})},e.prototype.hash=function(){},e.INDEX=62,e}();e.QueryExtensionAddon=r}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(58),o=n(102),r=n(46),s=n(61),a=function(){function e(t){var e=this;this.omnibox=t,this.cache={},i.$$(this.omnibox.element).on(r.OmniboxEvents.populateOmniboxSuggestions,function(t,n){n.suggestions.push(e.getSuggestion())})}return e.suggestiontHtml=function(t){return t.highlighted.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,function(t,n,i,o){var r="";return i&&(r="coveo-omnibox-hightlight"),o&&(r="coveo-omnibox-hightlight2"),e.suggestiontHtmlTemplate({className:r,text:n||i||o})})},e.isPartialMatch=function(e){var n=s.StringUtils.match(e.highlighted,/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g),i=t.find(n,function(t){return null!=t[1]});return null==i||t.every(t.last(n,t.indexOf(n,i)-n.length),function(t){return null!=t[1]})},e.prototype.getSuggestion=function(){var t=this,e=this.omnibox.magicBox.getText();if(0==e.length)return null;if(null!=this.cache[e])return this.cache[e];var n=this.getRevealQuerySuggest(e);return this.cache[e]=n,n.catch(function(){delete t.cache[e]}),this.cache[e]},e.prototype.getRevealQuerySuggest=function(n){var i={q:n},r=String.locale,s=this.omnibox.getBindings().componentOptionsModel.get(o.ComponentOptionsModel.attributesEnum.searchHub),a=this.omnibox.getBindings().searchInterface.options.pipeline;return r&&(i.language=r),s&&(i.searchHub=s),a&&(i.pipeline=a),this.omnibox.queryController.getEndpoint().getRevealQuerySuggest(i).then(function(n){var i=n.completions,o=t.map(i,function(t,n){return{html:e.suggestiontHtml(t),text:t.expression,index:e.INDEX-n/i.length,partial:e.isPartialMatch(t),executableConfidence:t.executableConfidence}});return o})},e.INDEX=60,e.suggestiontHtmlTemplate=t.template("<span<%= className? ' class=\"'+className+'\"':'' %>><%- text %></span>"),e}();e.RevealQuerySuggestAddon=a}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=n(46),o=n(58),r=n(15),s=function(){function e(e){var n=this;this.omnibox=e,this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(e){t.each(n.getSuggestion(),function(t){e.suggestions.push(t)})})}return e.prototype.getSuggestion=function(){var t=this.omnibox.magicBox.getText();if(0==t.length)return null;if(this.lastQuery==t)return this.lastSuggestions;this.lastQuery=t;var e=this.buildPopulateOmniboxEventArgs();return o.$$(this.omnibox.element).trigger(i.OmniboxEvents.populateOmnibox,e),this.lastSuggestions=this.rowsToSuggestions(e.rows)},e.prototype.getCurrentQueryExpression=function(){var t=this.omnibox.getCursor(),e=this.omnibox.getText(),n=e.length,i=t,o=t;for(" "==e[i]&&i--;i>0&&" "!=e[i];)i--;for(;o<n&&" "!=e[o];)o++;return e.substring(i,o)},e.prototype.getRegexToSearch=function(t){return null==t&&(t=this.omnibox.getText()),new RegExp(r.Utils.escapeRegexCharacter(t),"i")},e.prototype.getQueryExpressionBreakDown=function(){var e=this,n=[],i=this.omnibox.getText().split(" ");return t.each(i,function(t){n.push({word:t,regex:e.getRegexToSearch(t)})}),n},e.prototype.replace=function(t,e){this.omnibox.setText(this.omnibox.getText().replace(t,e))},e.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),"")},e.prototype.insertAt=function(t,e){var n=this.omnibox.getText(),i=[n.slice(0,t),e,n.slice(t)].join("");this.omnibox.setText(i)},e.prototype.replaceCurrentExpression=function(t){this.replace(this.getCurrentQueryExpression(),t)},e.prototype.buildPopulateOmniboxEventArgs=function(){var t=this,e=this.getCurrentQueryExpression(),n={rows:[],completeQueryExpression:{word:this.omnibox.getText(),regex:this.getRegexToSearch()},currentQueryExpression:{word:e,regex:this.getRegexToSearch(e)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:this.omnibox.getCursor(),clear:function(){t.omnibox.clear()},clearCurrentExpression:function(){t.clearCurrentExpression()},replace:function(e,n){t.replace(e,n)},replaceCurrentExpression:function(e){t.replaceCurrentExpression(e)},insertAt:function(e,n){t.insertAt(e,n)},closeOmnibox:function(){t.omnibox.magicBox.blur()}};return n},e.prototype.rowsToSuggestions=function(e){return t.map(e,function(t){return r.Utils.isNullOrUndefined(t.element)?r.Utils.isNullOrUndefined(t.deferred)?null:new Promise(function(e){t.deferred.then(function(t){e(null!=t.element?[{dom:t.element,index:t.zIndex}]:null)})}):new Promise(function(e){e([{dom:t.element,index:t.zIndex}])})})},e}();e.OldOmniboxAddon=s}).call(e,n(10))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){(function(t){"use strict";var i=n(59),o=n(58),r=function(){function e(t,e){this.structure=t,this.onSelect=e}return e.prototype.buildOmniboxElement=function(e,n){var i;if(0!=e.length){if(i=o.$$("div").el,this.structure.header){var r=this.buildElementHeader();i.appendChild(r)}var s=this.buildRowElements(e,n);t.each(s,function(t){i.appendChild(t)})}return i},e.prototype.buildElementHeader=function(){return o.$$("div",void 0,this.structure.header.template({headerTitle:this.structure.header.title})).el},e.prototype.buildRowElements=function(e,n){var r=this,s=[];return t.each(e,function(t){var e=o.$$("div",void 0,r.structure.row({rawValue:t.value,data:i.DomUtils.highlightElement(t.value,n.completeQueryExpression.word)})).el;o.$$(e).on("click",function(){r.onSelect.call(r,t.value,n)}),o.$$(e).on("keyboardSelect",function(){r.onSelect.call(r,t.value,n)}),s.push(e)}),s},e}();e.SuggestionForOmnibox=r}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(237),r=n(109),s=n(107),a=n(14),u=n(46),l=n(48),c=n(35),h=n(101),p=n(121),d=n(106),f=n(58),g=n(108),m=function(e){function n(i,s,a){var c=this;e.call(this,i,n.ID,a),this.options=s,this.partialQueries=[],this.lastSuggestions=[],this.resultsToBuildWith=[],this.options&&"omniboxSuggestionOptions"in this.options&&(this.options=t.extend(this.options,this.options.omniboxSuggestionOptions)),this.options=r.ComponentOptions.initComponentOptions(i,n,this.options);var h=t.template("<div class='magic-box-suggestion coveo-omnibox-selectable coveo-top-analytics-suggestion-row'><%= data %></div>");this.options.onSelect=this.options.onSelect||this.onRowSelection;var p;if(this.searchInterface.isNewDesign())p={row:h};else{var d=t.template("<div class='coveo-top-analytics-suggestion-header'><span class='coveo-icon-top-analytics'></span><span class='coveo-caption'><%= headerTitle %></span></div>");p={header:{template:d,title:this.options.headerTitle},row:h}}this.suggestionForOmnibox=new o.SuggestionForOmnibox(p,function(t,e){c.options.onSelect.call(c,t,e)}),this.bind.onRootElement(u.OmniboxEvents.populateOmnibox,function(t){return c.handlePopulateOmnibox(t)}),this.bind.onRootElement(l.QueryEvents.querySuccess,function(){return c.partialQueries=[]})}return i(n,e),n.prototype.selectSuggestion=function(e){if(this.currentlyDisplayedSuggestions)if(isNaN(e))this.currentlyDisplayedSuggestions[e]&&f.$$(this.currentlyDisplayedSuggestions[e].element).trigger("click");else{var n=t.findWhere(this.currentlyDisplayedSuggestions,{pos:e});n&&f.$$(n.element).trigger("click")}},n.prototype.handlePopulateOmnibox=function(e){var n=this;a.Assert.exists(e);var i=new Promise(function(i,o){var r=n.usageAnalytics.getTopQueries({pageSize:n.options.numberOfSuggestions,queryText:e.completeQueryExpression.word});r.then(function(o){n.resultsToBuildWith=t.map(o,function(t){return{value:t}}),n.lastSuggestions=o,t.isEmpty(n.resultsToBuildWith)||""==e.completeQueryExpression.word||n.partialQueries.push(e.completeQueryExpression.word);var r=n.suggestionForOmnibox.buildOmniboxElement(n.resultsToBuildWith,e);n.currentlyDisplayedSuggestions={},r&&t.map(f.$$(r).findAll(".coveo-omnibox-selectable"),function(t,e){n.currentlyDisplayedSuggestions[f.$$(t).text()]={element:t,pos:e}}),i({element:r,zIndex:n.options.omniboxZIndex})}),r.catch(function(){i({element:void 0})})});e.rows.push({deferred:i})},n.prototype.onRowSelection=function(e,n){n.clear(),n.closeOmnibox(),this.queryStateModel.set(h.QueryStateModel.attributesEnum.q,e),this.usageAnalytics.logSearchEvent(this.getOmniboxAnalyticsEventCause(),{partialQueries:this.cleanCustomData(this.partialQueries),suggestionRanking:t.indexOf(t.pluck(this.resultsToBuildWith,"value"),e),suggestions:this.cleanCustomData(this.lastSuggestions),partialQuery:n.completeQueryExpression.word}),this.queryController.executeQuery()},n.prototype.cleanCustomData=function(e,n){void 0===n&&(n=256),e=t.compact(t.filter(e,function(t,e,n){return 0===e||t!==n[e-1]})),e=t.map(e,function(t){return t.replace(/;/g,"")});var i=[];t.reduceRight(e,function(t,e){var o=t+e.length;return o<=n&&i.push(e),o},0),e=i.reverse();var o=e.join(";");return o.length>=256?this.cleanCustomData(e,n-10):e.join(";")},n.prototype.getOmniboxAnalyticsEventCause=function(){return this.searchInterface instanceof g.StandaloneSearchInterface?p.analyticsActionCauseList.omniboxFromLink:p.analyticsActionCauseList.omniboxAnalytics},n.ID="AnalyticsSuggestions",n.options={omniboxZIndex:r.ComponentOptions.buildNumberOption({defaultValue:52,min:0}),headerTitle:r.ComponentOptions.buildLocalizedStringOption({defaultValue:c.l("SuggestedQueries")}),numberOfSuggestions:r.ComponentOptions.buildNumberOption({defaultValue:5,min:1})},n}(s.Component);e.AnalyticsSuggestions=m,d.Initialization.registerAutoCreateComponent(m)}).call(e,n(10))},function(t,e,n){(function(t){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(237),r=n(107),s=n(109),a=n(14),u=n(15),l=n(46),c=n(101),h=n(106),p=n(121),d=n(35),f=n(58),g=function(e){function n(i,r,c){var h=this;e.call(this,i,n.ID,c),this.options=r,this.options&&"omniboxSuggestionOptions"in this.options&&(this.options=t.extend(this.options,this.options.omniboxSuggestionOptions)),this.options=s.ComponentOptions.initComponentOptions(i,n,r),a.Assert.check(u.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),this.options.onSelect=this.options.onSelect||this.onRowSelection;var p,d=t.template("<div class='magic-box-suggestion coveo-omnibox-selectable coveo-top-field-suggestion-row'><%= data %></div>");if(this.searchInterface.isNewDesign())p={row:d};else{var f=t.template("<div class='coveo-top-field-suggestion-header'><span class='coveo-icon-top-field'></span><span class='coveo-caption'><%= headerTitle %></span></div>");p={header:{template:f,title:this.options.headerTitle},row:d}}this.suggestionForOmnibox=new o.SuggestionForOmnibox(p,function(t,e){h.options.onSelect.call(h,t,e)}),this.bind.onRootElement(l.OmniboxEvents.populateOmnibox,function(t){return h.handlePopulateOmnibox(t)})}return i(n,e),n.prototype.selectSuggestion=function(e){if(this.currentlyDisplayedSuggestions)if(isNaN(e))this.currentlyDisplayedSuggestions[e]&&f.$$(this.currentlyDisplayedSuggestions[e].element).trigger("click");else{var n=t.findWhere(this.currentlyDisplayedSuggestions,{pos:e});n&&f.$$(n.element).trigger("click")}},n.prototype.handlePopulateOmnibox=function(e){var n=this;a.Assert.exists(e);var i=e.completeQueryExpression.word,o=new Promise(function(o){n.queryController.getEndpoint().listFieldValues(n.buildListFieldValueRequest(i)).then(function(i){var r=n.suggestionForOmnibox.buildOmniboxElement(i,e);n.currentlyDisplayedSuggestions={},t.map(f.$$(r).findAll(".coveo-omnibox-selectable"),function(t,e){n.currentlyDisplayedSuggestions[f.$$(t).text()]={element:t,pos:e}}),o({element:r,zIndex:n.options.omniboxZIndex})}).catch(function(){o({element:void 0})})});e.rows.push({deferred:o})},n.prototype.onRowSelection=function(t,e){e.clear(),e.closeOmnibox(),this.queryStateModel.set(c.QueryStateModel.attributesEnum.q,t),this.usageAnalytics.logSearchEvent(p.analyticsActionCauseList.omniboxField,{}),this.queryController.executeQuery()},n.prototype.buildListFieldValueRequest=function(t){return{field:this.options.field,ignoreAccents:!0,sortCriteria:"occurrences",maximumNumberOfValues:this.options.numberOfSuggestions,patternType:"Wildcards",pattern:"*"+t+"*",queryOverride:this.options.queryOverride}},n.ID="FieldSuggestions",n.options={field:s.ComponentOptions.buildFieldOption({required:!0}),queryOverride:s.ComponentOptions.buildStringOption({defaultValue:""}),omniboxZIndex:s.ComponentOptions.buildNumberOption({defaultValue:51,min:0}),headerTitle:s.ComponentOptions.buildLocalizedStringOption({defaultValue:d.l("SuggestedResults")}),numberOfSuggestions:s.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),onSelect:s.ComponentOptions.buildCustomOption(function(){return null})},n}(r.Component);e.FieldSuggestions=g,h.Initialization.registerAutoCreateComponent(g)}).call(e,n(10))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){(function(t){"use strict";function i(e){if(void 0==window.Coveo?window.Coveo=e:t.each(t.keys(e),function(t){window.Coveo[t]=e[t]}),o.CoreHelpers.exportAllHelpersGlobally(window.Coveo),void 0==window.__extends){var n=function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};window.__extends=n}}var o=n(172);e.swapVar=i}).call(e,n(10))}])});
//# sourceMappingURL=CoveoJsSearch.Searchbox.min.js.map
;
/*! jQuery UI - v1.10.2 - 2013-03-14
* http://jqueryui.com
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */
(function(t,e){var i="ui-effects-";t.effects={effect:{}},function(t,e){function i(t,e,i){var s=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:t>s.max?s.max:t)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(t,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[c[l].cache]=o[c[l].cache],n=s._rgba=o._rgba,!1):e}),n.length?("0,0,0,0"===n.join()&&t.extend(n,a.transparent),s):a[i]}function n(t,e,i){return i=(i+1)%1,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(n,o,r,h){if(n===e)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=t(n).css(o),o=e);var u=this,d=t.type(n),p=this._rgba=[];return o!==e&&(n=[n,o,r,h],d="array"),"string"===d?this.parse(s(n)||a._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(n[e.idx],e)}),this):"object"===d?(n instanceof l?f(c,function(t,e){n[e.cache]&&(u[e.cache]=n[e.cache].slice())}):f(c,function(e,s){var a=s.cache;f(s.props,function(t,e){if(!u[a]&&s.to){if("alpha"===t||null==n[t])return;u[a]=s.to(u._rgba)}u[a][e.idx]=i(n[t],e,!0)}),u[a]&&0>t.inArray(null,u[a].slice(0,3))&&(u[a][3]=1,s.from&&(u._rgba=s.from(u[a])))}),this):e},is:function(t){var i=l(t),s=!0,n=this;return f(c,function(t,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(t,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:e})),s}),s},_space:function(){var t=[],e=this;return f(c,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var s=l(t),n=s._space(),a=c[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(t,n){var a=n.idx,o=r[a],l=s[a],c=u[n.type]||{};null!==l&&(null===o?h[a]=l:(c.mod&&(l-o>c.mod/2?o+=c.mod:o-l>c.mod/2&&(o-=c.mod)),h[a]=i((l-o)*e+o,n)))}),this[n](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(e)._rgba;return l(t.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,a=t[2]/255,o=t[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,c=r+h,u=.5*c;return e=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=u?l/c:l/(2-c),[Math.round(e)%360,i,u,null==o?1:o]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],a=t[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,e+1/3)),Math.round(255*n(r,o,e)),Math.round(255*n(r,o,e-1/3)),a]},f(c,function(s,n){var a=n.props,o=n.cache,h=n.to,c=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===e)return this[o].slice();var n,r=t.type(s),u="array"===r||"object"===r?s:arguments,d=this[o].slice();return f(a,function(t,e){var s=u["object"===r?t:e.idx];null==s&&(s=d[e.idx]),d[e.idx]=i(s,e)}),c?(n=l(c(d)),n[o]=d,n):l(d)},f(a,function(e,i){l.fn[e]||(l.fn[e]=function(n){var a,o=t.type(n),h="alpha"===e?this._hsla?"hsla":"rgba":s,l=this[h](),c=l[i.idx];return"undefined"===o?c:("function"===o&&(n=n.call(this,c),o=t.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=c+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,n){var a,o,r="";if("transparent"!==n&&("string"!==t.type(n)||(a=s(n)))){if(n=l(a||n),!d.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&o&&o.style;)try{r=t.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(h){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(o),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},a=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(e){var i,s,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[t.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function s(e,i){var s,n,o={};for(s in i)n=i[s],e[s]!==n&&(a[s]||(t.fx.step[s]||!isNaN(parseFloat(n)))&&(o[s]=n));return o}var n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,a,o,r){var h=t.speed(a,o,r);return this.queue(function(){var a,o=t(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var e=t(this);return{el:e,start:i(this)}}),a=function(){t.each(n,function(t,i){e[i]&&o[i+"Class"](e[i])})},a(),l=l.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var e=this,i=t.Deferred(),s=t.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,l.get()).done(function(){a(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(o[0])})})},t.fn.extend({addClass:function(e){return function(i,s,n,a){return s?t.effects.animateClass.call(this,{add:i},s,n,a):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,s,n,a){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},s,n,a):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(i){return function(s,n,a,o,r){return"boolean"==typeof n||n===e?a?t.effects.animateClass.call(this,n?{add:s}:{remove:s},a,o,r):i.apply(this,arguments):t.effects.animateClass.call(this,{toggle:s},n,a,o)}}(t.fn.toggleClass),switchClass:function(e,i,s,n,a){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,a)}})}(),function(){function s(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function n(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.10.2",save:function(t,e){for(var s=0;e.length>s;s++)null!==e[s]&&t.data(i+e[s],t[0].style[e[s]])},restore:function(t,s){var n,a;for(a=0;s.length>a;a++)null!==s[a]&&(n=t.data(i+s[a]),n===e&&(n=""),t.css(s[a],n))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return e.wrap(s),(e[0]===a||t.contains(e[0],a))&&t(a).focus(),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var a=e.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),t.fn.extend({effect:function(){function e(e){function s(){t.isFunction(a)&&a.call(n[0]),t.isFunction(e)&&e()}var n=t(this),a=i.complete,r=i.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),s()):o.call(n[0],i,s)}var i=s.apply(this,arguments),n=i.mode,a=i.queue,o=t.effects.effect[i.effect];return t.fx.off||!o?n?this[n](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):a===!1?this.each(e):this.queue(a||"fx",e)},show:function(t){return function(e){if(n(e))return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(t.fn.show),hide:function(t){return function(e){if(n(e))return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(t.fn.hide),toggle:function(t){return function(e){if(n(e)||"boolean"==typeof e)return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}()})(jQuery);;
/*jslint browser: true */ /*global jQuery: true */

/**
 * jQuery Cookie plugin
 *
 * Copyright (c) 2010 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */

// TODO JsDoc

/**
 * Create a cookie with the given key and value and other optional parameters.
 *
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Set the value of a cookie.
 * @example $.cookie('the_cookie', 'the_value', { expires: 7, path: '/', domain: 'jquery.com', secure: true });
 * @desc Create a cookie with all available options.
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Create a session cookie.
 * @example $.cookie('the_cookie', null);
 * @desc Delete a cookie by passing null as value. Keep in mind that you have to use the same path and domain
 *       used when the cookie was set.
 *
 * @param String key The key of the cookie.
 * @param String value The value of the cookie.
 * @param Object options An object literal containing key/value pairs to provide optional cookie attributes.
 * @option Number|Date expires Either an integer specifying the expiration date from now on in days or a Date object.
 *                             If a negative value is specified (e.g. a date in the past), the cookie will be deleted.
 *                             If set to null or omitted, the cookie will be a session cookie and will not be retained
 *                             when the the browser exits.
 * @option String path The value of the path atribute of the cookie (default: path of page that created the cookie).
 * @option String domain The value of the domain attribute of the cookie (default: domain of page that created the cookie).
 * @option Boolean secure If true, the secure attribute of the cookie will be set and the cookie transmission will
 *                        require a secure protocol (like HTTPS).
 * @type undefined
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */

/**
 * Get the value of a cookie with the given key.
 *
 * @example $.cookie('the_cookie');
 * @desc Get the value of a cookie.
 *
 * @param String key The key of the cookie.
 * @return The value of the cookie.
 * @type String
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */
jQuery.cookie = function (key, value, options) {

    // key and value given, set cookie...
    if (arguments.length > 1 && (value === null || typeof value !== "object")) {
        options = jQuery.extend({}, options);

        if (value === null) {
            options.expires = -1;
        }

        if (typeof options.expires === 'number') {
            var days = options.expires, t = options.expires = new Date();
            t.setDate(t.getDate() + days);
        }

        return (document.cookie = [
            encodeURIComponent(key), '=',
            options.raw ? String(value) : encodeURIComponent(String(value)),
            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
            options.path ? '; path=' + options.path : '',
            options.domain ? '; domain=' + options.domain : '',
            options.secure ? '; secure' : ''
        ].join(''));
    }

    // key and possibly options given, get cookie...
    options = value || {};
    var result, decode = options.raw ? function (s) { return s; } : decodeURIComponent;
    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;
};
;
/**
 * Personalized replacement panes.
 *
 * @note Be sure to use selectors that wrap any contextual links.
 *
 * @todo Manage configs via component and Views settings #3126.
 * @todo Stash component relacement mapping in components #3126.
 *
 * @see https://github.com/tableau-mkt/www7/wiki/Personalization-Panes
 * @see personal.sources.js, personal.js
 *
 * @namespace Tabia.personalConfigs
 */

var Tabia = window.Tabia || {};
Tabia.personalConfigs = Tabia.personalConfigs || {};

(function (module) {
  // Note: Panes config moved to Personalization config under Sitewide Tweaks Settings.
  // Why? This separation allows the configuration to be used independently and earlier on
  // within the document.

  /**
   * Content item replacement patterns (data swap mapping), shared.
   *
   * @memberof Tabia.personalConfigs
   */
  module.replacements = {
    '.teaser-item': {
      '.thumbnail a, a.link': [{
        property: 'href',
        key: 'url'
      }],
      '.thumbnail img': [{
        property: 'src',
        key: module.helpers.personalThumb
      }],
      '.teaser-item__title a': [{
          property: 'href',
          key: 'url'
        }, {
          property: 'text',
          key: 'title'
      }],
      '.thumbnail': [{
        property: 'class',
        key: module.helpers.personalVideoIcon
      }]
    },
    '.card': {
      '.card__title a': [{
          property: 'href',
          key: 'url'
        }, {
          property: 'text',
          key: 'title'
      }],
      '.thumbnail a': [{
        property: 'href',
        key: 'url'
      }],
      '.thumbnail img': [{
        property: 'src',
        key: 'tile-path.src'
      }],
      '.card__label .text--label': [{
        property: 'text',
        key: 'bundle'
      }],
      '.card__tags .tags-list__tag': [{
        property: 'html',
        key: 'tags'
      }]
    },
    '.cta-wrapper': {
      'a': [{
        property: 'href',
        key: 'url'
      }]
    },
    '.p13n-individual-creator': {
      '.price-tag': [
        {
          property: 'html',
          key: 'secondary-cta-html'
        }
      ],
      '.p13n-buy-button': [
        {
          property: 'href',
          key: 'primary-cta-href'
        },
        {
          property: 'text',
          key: 'primary-cta-text'
        }
      ]
    },
    '.pricing-card': {
      '.price-tag': [
        {
          property: 'html',
          key: 'secondary-cta-html'
        }
      ]
    },
    '.p13n-server-2019-1': {
      '.price-tag': [
        {
          property: 'html',
          key: 'secondary-cta-html'
        }
      ]
    },
    '.p13n-online-2019-1': {
      '.price-tag': [
        {
          property: 'html',
          key: 'secondary-cta-html'
        }
      ]
    },
    '.p13n-server-ctas': {
      '.p13n-buy-button': [
        {
          property: 'href',
          key: 'primary-cta-href'
        },
        {
          property: 'text',
          key: 'primary-cta-text'
        }
      ]
    },
    // Allow a price mention to be "emptied out" for countries like Brazil.
    // RE: https://github.com/tableau-mkt/www7/issues/6367
    '.p13n-price-mention': {
      '.p13n-price-mention-span': [
        {
          property: 'html',
          key: 'price-mention'
        }
      ]
    },
    // @todo '.pricing-list__column' and '.pricing' can be removed after 4/24 (confirm with Joel)
    '.pricing-list__column': {
      '.pricing-list__price': [{
        property: 'text',
        key: 'price'
      }],
      '.pricing-list__price-unit': [{
        property: 'html',
        key: 'unit'
      }],
      '.pricing-list__bottom .cta': [{
        property: 'text',
        key: 'cta-text'
      }, {
        property: 'href',
        key: 'cta-destination'
      }]
    },
    // @todo Seriously, update the selectors when the page is unlocked.
    '.pricing': {
      '.pricing__price': [{
        property: 'html',
        key: 'unit'
      }],
      // @todo Can be removed when real prices are shown.
      '.cta': [{
        property: 'text',
        key: 'cta-text'
      }, {
        property: 'href',
        key: 'cta-destination'
      }],
      '.text--label': [{
        property: 'text',
        key: 'label'
      }]
    }
  };

// Accept A/B testing configs and provide data helpers.
})(_.extend(Tabia.personalConfigs, {helpers: {

  /**
   * Apply thumbnail icon class if content has video.
   *
   * @memberof Tabia.personalConfigs.helpers
   *
   * @param {object} data
   *   Single row of personalized results.
   */
  personalVideoIcon: function (data) {
    // Use JSON string number as boolean to set icon class.
    return !!Number(data.video) ? 'thumbnail thumbnail--play' : 'thumbnail';
  },

  /**
   * Pick between image options, prefer promo.
   *
   * @memberof Tabia.personalConfigs.helpers
   *
   * @param {object} data
   *   Single row of personalized results.
   */
  personalThumb: function (data) {
    var promo = 'promo-thumb-path',
        tile  = 'tile-thumb-path';
    return _.has(data[promo], 'src') ? data[promo].src : data[tile].src;
  },

  /**
   * Set exposed View region input with personal option.
   *
   * @memberof Tabia.personalConfigs.helpers
   *
   * @param {object} $form
   * @param {object} personal
   */
  setExposedRegion: function ($form, personal) {
    var target;
    if (_.has(personal, 'region')) {
      target = '#edit-field-region-tid .form-radio[value=' + personal.region + ']';
      $form.find(target).prop('checked', true).trigger('change');
    }
  },

  /**
   * Set exposed View industry input with personal option.
   *
   * @memberof Tabia.personalConfigs.helpers
   *
   * @param {element} $form
   * @param {object} personal
   */
  setExposedIndustry: function ($form, personal) {
    var target;
    if (_.has(personal, 'industry')) {
      target = '#edit-taxonomy-vocabulary-4-tid-selective .form-radio[value=' + personal.industry + ']';
      $form.find(target).prop('checked', true).trigger('change');
    }
  },

  /**
   * Use zip code to set location input for Google lookups.
   *
   * @param {element} $form
   * @param {object} personal
   */
  setLocation: function ($form, personal) {
    var $input = $form.find('.geofield-proximity-origin'),
        updateLocationInput = function () {
          $input.val(personal.postalcode).change().blur();
        };

    if (personal.postalcode) {
      // Listen for custom event in case it hasn't initialized yet.
      $(document).on('google_pac_geocoder:initialized', updateLocationInput);
      // Run it now in case it already initialized.
      updateLocationInput();
    }
  }

}}));
;
/**
 * Personalized data sources for replacements.
 *
 * @see personal.config.js, personal.js, content-mappers.js
 * @see https://github.com/tableau-mkt/www7/wiki/Personalization-Panes
 *
 * @namespace Tabia.personalSources
 */

/* jshint camelcase:false */

var Tabia = window.Tabia || {};
Tabia.personalSources = Tabia.personalSources || {};

(function ($, groucho, module) {

  /**
   * Get user info, grabbed via property or IP-geolocation data.
   *
   * @see findIndustry() or findOrgSize()
   *
   * @todo Use stashed Eloqua API values, or even do a remote lookup if desired.
   *
   * @param {string} name
   *   LocalStorage user property, e.g. state, country, postalcode
   * @param {object} options
   * @param {function} options.dataMapper
   *
   * @returns {$.Deferred}
   *   Resolves with object, eg: {property: "industry", value: 272}
   */
  module.userLookup = function (name, options) {
    var value = groucho.userGet(name),
        overrideParameterValue = Tabia.util.getUrlParameter('p_' + name),
        result = {property: name, value: null},
        deferred = $.Deferred();

    // Allow URL parameter override.
    if (overrideParameterValue) {
      Tabia.debug('User property overridden by query parameter', {type: 'tabPersonal', data: {overrideValue: overrideParameterValue}});
      value = overrideParameterValue;
    }

    if (value) {
      // Already known, skip finding derived value via raw.
      result.value = value;
      return deferred.resolve(result);
    }

    // We depend on the geolocation behavior to exist for AJAX lookup.
    if (!Drupal.behaviors.tableauGeolocation) {
      deferred.reject();
      Tabia.warning('User data lookup failed', {type: 'tabPersonal'});
      return deferred.promise();
    }

    // Find via known geolocation data.
    Drupal.behaviors.tableauGeolocation.fetchData().done(function (data) {
      // Try to get the named property.
      data = data[name];
      if (typeof options === 'object' && typeof options.dataMapper === 'function') {
        result.value = options.dataMapper(data);
        deferred.resolve(result);
      }
      else {
        result.value = data;
        deferred.resolve(result);
      }
    })
    .fail(function () {
      deferred.reject();
      Tabia.warning('User data lookup failed', {type: 'tabPersonal'});
    });

    return deferred.promise();
  };

  /**
   * Determine user zip code from among sources.
   *
   * @return {Promise}
   */
  module.findPostalCode = function () {
    // Check stashed zip, or use Demandbase.
    return module.userLookup('postalcode');
  };


  /**
   * Get user's region tid.
   *
   * @returns {Promise}
   */
  module.findRegion = function () {
    // Check stashed/derived region, or use geolocation-data and map it to a term ID.
    return module.userLookup('region', {dataMapper: Tabia.map.regionTid});
  };


  /**
   * Get user's industry tid (if IP allow via region).
   *
   * @todo A/B groucho.getFavoriteTerms as a source.
   *
   * @returns {Promise}
   */
  module.findIndustry = function () {
    // Check stashed/derived industry, or use geolocation-data and map it to a term ID.
    return module.userLookup('industry', {dataMapper: Tabia.map.industryTid});
  };


  /**
   * User's company size tid.
   *
   * @returns {Promise}
   */
  module.findOrgSize = function () {
    // Check stashed/derived org size, or use geolocation-data and map to a term ID.
    return module.userLookup('org_size', {dataMapper: Tabia.map.orgTid});
  };


  /**
   * User's country code.
   *
   * @returns {Promise}
   */
  module.findCountry = function () {
    return module.userLookup('country', {});
  };

})(jQuery, groucho, Tabia.personalSources);
;
/**
 * Personlized DOM replacements.
 *
 * @todo Multi-segment best possible match. #3242
 * @todo Refactor as jQuery prototype for panes.
 *
 * @see personal.config.js, personal.sources.js
 *
 * @namespace Tabia.personalize
 */

/* jshint camelcase:false */

var Tabia = window.Tabia || {};

(function ($, module) {
  var configs = Tabia.personalConfigs,
      sources = Tabia.personalSources;

  // Reusable.
  configs.allPaneSelectors = '';

  /**
   * Page load.
   */
  $(document).ready(function () {
    var enabledPanes = _.filter(configs.panes, function (pane) {
          return !pane.disabled;
        }),
        enabledPanesSelectors = _.pluck(enabledPanes, 'selector');

    // Handy closure global to act upon, and check for, valid panes.
    configs.allPaneSelectors = enabledPanesSelectors.join(', ');

    // Exit early if no panes exist on page or disabled for A/B testing.
    if (configs.disabled || !$(configs.allPaneSelectors).length) {
      return false;
    }
    // Kick off the process.
    module.personalize();
  });


  /**
   * Personalized pane adjustment object.
   *
   * @param {personalPaneConfig} args
   *
   * @typedef pane
   * @type {object}
   * @property {string} selector
   * @property {object} adjust
   * @property {array} segments
   * @property {boolean} submit
   * @property {object} pieces
   * @property {object} personal
   * @property {object} panePersonal
   *   Final personal values.
   * @property {string} dataPath
   * @property {string} callback
   * @property {string} unique
   * @property {function} prepareUrl
   * @property {function} process
   */
  module.pane = function (args) {
    var segments = args.segments || 'all';

    // Push pane configs into object.
    for (var a in args) {
      if (_.has(args, a)) {
        this[a] = args[a];
      }
    }

    // Desired final values to use, adjusts falsy into "all" for Views contextual filters.
    this.panePersonal = _.mapObject(this.personal, function desiredSegments (val, key) {
      return (val && _.contains(segments, key)) ? val : 'all';
    });

    // Tracking string, only desired and non-falsy values.
    this.unique = JSON.stringify(_.pick(this.personal, function uniqueStr (val, key) {
      return _.contains(segments, key) && _.identity;
    }));

    /**
     * Build data URL for adjustment.
     */
    this.prepareUrl = function (url) {
      var personal = this.panePersonal || {},
          separator = (url.indexOf('?') === -1) ? '?' : '&';
      this.dataPath = url + separator + $.param(personal);
      this.callback = 'personal_' + Tabia.util.base64Encode(this.selector).replace(/=/g, '');
    };

    /**
     * Run personalizations on a configured pane.
     */
    this.process = function () {
      var _this = this,
          $elements = $(this.selector);

      // Leave evidence of personalization details.
      $.each(_this.panePersonal, function markSegment (segment, val) {
        $elements.attr('data-personal-segment-' + segment, val);
      });

      // JSON datasource panes.
      if (_.has(_this.adjust, 'url')) {
        // Build data URL, etc.
        _this.prepareUrl(_this.adjust.url);
        // Leave DOM data source details for admin tools.
        if (!$elements.data('personal-json')) {
          $elements.data('personal-json', []);
        }
        $elements.data('personal-json').push(_this.dataPath);
      }
      // Get adjustable item definition from replacement patterns.
      // NOTE: Some panes are reactive, and do not replace anything.
      if (_.has(_this.adjust, 'item')) {
        _this.pieces = configs.replacements[_this.adjust.item];
      }
      // Fire configured function to adjust pane.
      module[_this.adjust.method](_this);

      // Track pane replacement.
      Tabia.util.trackGA('personalizeLoad', _this.selector, _this.unique, true);
      Tabia.notice('Personalizing pane', {type: 'tabPersonal',
        data: _.extend({}, _this.panePersonal, {selector: _this.selector})
      });
    };
  };


  /**
   * Personalize all configured panes on the page.
   *
   * @todo Avoid numbered segment args, use a library for arrays of Promises.
   * @todo Avoid loading all data early, do it at the pane level.
   * @todo Avoid reusing Promise array for value gathering.
   */
  module.personalize = function () {
    var segmentsList = {
          industry: sources.findIndustry,
          orgSize: sources.findOrgSize,
          postalcode: sources.findPostalCode,
          region: sources.findRegion,
          country: sources.findCountry
        },
        // Allow externally limiting segments. Default is not all.
        segments = configs.segments || ['region', 'country', 'industry', 'org_size', 'postalcode'],
        segmentsDef = [],
        Pane = module.pane;

    // Hide the panes, quick as you can.
    // This duplicates an inline style added in tableau_recommended_preprocess_html().
    $(configs.allPaneSelectors).addClass('fadable fadable--faded-out personal');

    // Use limit to allowed segments, get promises or set "all" flags.
    $.each(segmentsList, function segmentPromises (name, getter) {
      if (segments === 'all' || _.contains(segments, name)) {
        // Use listed function or simple value.
        if (typeof getter === 'function') {
          segmentsDef.push(getter());
          return;
        }
        segmentsList[name] = getter;
        return;
      }
      // Ignore segment with "all" string.
      segmentsList[name] = 'all';
    });

    // Wait for personal data to be ready.
    $.when.apply($, segmentsDef).done(function personalizeData (seg1, seg2, seg3, seg4, seg5) {
      var segments = [seg1, seg2, seg3, seg4, seg5];
      // Re-combine values with "all" flags for unused segments.
      $.each(segmentsList, function (name, value) {
        if (segments !== undefined && value !== 'all') {
          segmentsList[name] = _.findWhere(segments, {property: name}).value;
        }
      });
      // Adjust all configured panes.
      $.each(configs.panes, function attemptPane () {
        var personalized;
        // Avoiding building if nonexistent.
        if (!$(this.selector).length) {
          return true;
        }
        personalized = new Pane(_.extend({}, this, {personal: segmentsList}));
        // Instances of the pane.
        $(this.selector).each(function paneInstance () {
          personalized.process($(this));
        });
      });
      Tabia.debug('Personal data found, processing panes', {
        type: 'tabPersonal', data: _.extend({segments: segments}, segmentsList)
      });
    })
    .fail(function dataFail () {
      module.failReveal(configs.allPaneSelectors);
      Tabia.warning('Segment data lookup failed', {type: 'tabPersonal'});
    });
  };


  /**
   * Discover data and invoke pane replacement.
   *
   * Pane config adjustment method.
   *
   * @todo Include data sources in logging.
   * @todo Allow external data sources, and still handle language internally.
   * @todo Store pane data values as config (when admin/exportable).
   *
   * @param {pane} pane
   */
  module.replaceData = function (pane) {
    var lang_prefix = '',
        segmentValue,
        data;

    // JSON path data source.
    if (pane.dataPath) {
      // Transform pesky language prefix.
      if (Drupal.settings.pathPrefix) {
        lang_prefix = '/' + Drupal.settings.pathPrefix.replace('/', '');
      }

      // Get data and replace values.
      $.ajax({
        timeout: Drupal.settings.tableauRecommended.ajaxTimeout,
        url: lang_prefix + pane.dataPath,
        dataType: 'jsonp',
        // Without these the callback is random with a timestamp param.
        jsonpCallback: pane.callback,
        cache: true
      })
      .done(function personalData (data) {
        Tabia.notice('Personalized content data found, replacing', {type: 'tabPersonal', data: data});
        module.replaceDataPageHandler(pane, data);
      })
      .fail(function dataUnavailable () {
        module.failReveal(pane.selector);
        Tabia.warning('Personalized data load failed', {type: 'tabPersonal'});
      });
    }
    // Window object data source.
    else if (pane.adjust.windowObj) {
      // Discover personalized values.
      data = Tabia.util.strProp(window, pane.adjust.windowObj);
      // Pick correct content via personal segment value (just one allowed).
      segmentValue = pane.personal[pane.segments[0]];
      if (_.has(data, segmentValue)) {
        // Carry on replacing content with value, expected as array.
        module.replaceDataPageHandler(pane, [data[segmentValue]]);
      }
      else {
        module.failReveal(pane.selector);
        Tabia.warning('Data source (or relevant segment) does not exist', {
          type: 'tabPersonal', data: pane
        });
      }
    }
  };


  /**
   * Page implications of pane replace/adjust.
   *
   * Process all instances of the pane in the DOM and wait for all images to
   * load before revealing content.
   *
   * @todo Use timeout in case images don't load and re-reveal pane.
   *
   * @param {object} $element
   * @param {personalPaneConfig} pane
   * @param {object} data
   */
  module.replaceDataPageHandler = function (pane, data) {
    $(pane.selector).each(function paneInstance () {
      var $element = $(this),
          wait = [];

      // Adjust each matching replacement item DOM element, eg: Views rows.
      // Allow for pane to be the item itself (pane of one).
      $element.find(pane.adjust.item).addBack(pane.adjust.item).each(function adjustItems (i) {
        // Confirm enough data results and do replacements.
        if (i >= data.length) {
          return false;
        }
        if (!pane.pieces) {
          Tabia.warning('No replacement exists for configued pane item', {type: 'tabPersonal'});
        }
        // Process replacement, if item is new content.
        if (!module.dupeCheck($element, data[i])) {
          module.replacement($(this), data[i], wait, pane);
        }
      });

      // Delay reveal for all image loading.
      if (wait.length) {
        $.when.apply($, wait).done(function () {
          module.reveal($element);
        });
      }
      else {
        module.reveal($element);
      }
    });
  };


  /**
   * Reject duplicates when adjusting lists of content. Checking happens
   * after previous changes have occured, to produce best results.
   *
   * @param object $element
   * @param object data
   *
   * @return boolean
   */
  module.dupeCheck = function ($element, data) {
    var dupe;
    if (_.has(data, 'url')) {
      $element.find('a').each(function dupeCheckLinks () {
        var href = $(this).attr('href');
        // A link within content matches url in data.
        if ((href.indexOf(data.url) !== -1) || (data.url.indexOf(href) !== -1)) {
          dupe = true;
          return false;
        }
      });
    }
    return dupe;
  };


  /**
   * Run form set elements on a pane (data is segment values).
   *
   * @param {pane} pane
   */
  module.formSetSegments = function (pane) {
    $(pane.selector).each(function paneInstance () {
      var $element = $(this);

      if ($element.is('form')) {
        configs.helpers[pane.adjust.callback]($element, pane.panePersonal);
      }
      if (_.has(pane, 'after')) {
        pane.after();
      }
      // Handle follow up behavior to changes.
      if (pane.submit) {
        $element.submit();
      }
      else {
        module.reveal($element);
      }
    });
  };


  /**
   * Adjust one pane item DOM instance.
   *
   * @param {object} $element
   *   DOM parent element to adjust.
   * @param {object} data
   *   Single row of result data for making replacements.
   * @param {array} wait
   *   List of deferred objects to delay reveal for image loading.
   * @param {pane} pane
   *   Contains replacement settings, item data values, etc.
   */
  module.replacement = function ($element, data, wait, pane) {
    // Adjust each HTML piece of the pane item.
    $.each(pane.pieces, function adjustPieces (selector, properties) {
      // Multiple properties per piece.
      $.each(properties, function adjustProperties () {
        /**
         * @typedef change
         * @type {object}
         *
         * @property {object} element
         * @property {string} string
         * @property {string} val
         */
        var changeSet = {
              element: $($element.find(selector)),
              property: this.property
            };

        // Allow data helper functions in configs (pass full item data).
        changeSet.val = (typeof this.key === 'function') ? this.key(data) :
            Tabia.util.strProp(data, this.key);

        // Change the DOM properties.
        module.replaceProperty(changeSet, wait, pane);

        // Adjust node contextual links if present.
        // @todo Separate from library if abstracted.
        if ('nid' in data) {
          changeSet.element.find('.contextual-links a').each(function () {
            var newUrl = $(this).attr('href').replace(/\/node\/[0-9]+\//, '/node/' + data.nid + '/');
            $(this).attr('href', newUrl);
          });
        }
      });
    });
  };


  /**
   * Adjust one personalized DOM item property.
   *
   * @param {change} changeSet
   *   Includes DOM element, data value, and property name.
   * @param {array} wait
   *   List of deferred objects to delay reveal for image loading.
   * @param {pane} pane
   *   Includes: replacement setings, full item data values, etc.
   */
  module.replaceProperty = function (changeSet, wait, pane) {
    var $elements,
        def;

    // Handle element property adjustments.
    switch (changeSet.property) {
      case 'text':
        changeSet.element.text(changeSet.val);
        break;
      case 'tagName':
      case 'checked':
      case 'disabled':
        changeSet.element.prop(changeSet.property, changeSet.val);
        break;
      case 'val':
        changeSet.element.val(changeSet.val);
        break;
      case 'html':
        changeSet.element.html(changeSet.val);
        break;
      default:
        changeSet.element.attr(changeSet.property, changeSet.val);
        break;
    }
    // Attach click tracking.
    if (changeSet.property === 'href' || changeSet.property === 'html') {
      // Changed link element or links within full HTML overwrites.
      $elements = (changeSet.property === 'href') ? changeSet.element : $(changeSet.element).find('a');
      $elements.on('click', function personalClick () {
        Tabia.util.trackGA('personalizeClick', pane.selector, pane.unique);
        Tabia.notice('Personalized click', {type: 'tabPersonal',
          data: {selector: pane.selector}
        });
      });
    }
    // Wait for image loading with a shared deferred array.
    if (changeSet.property === 'src') {
      def = $.Deferred();
      wait.push(def.promise());
      changeSet.element.on('load', function () {
        def.resolve();
      });
    }
  };


  /**
   * Display pane after complete.
   *
   * @param {object} $element
   * @param {boolean} fail
   */
  module.reveal = function ($element, fail) {
    $element.addClass('fadable--faded-in personal--is-processed')
    .removeClass('fadable--faded-out');
    if (fail) {
      $element.addClass('personal--is-not-personal');
    }
    // Dynamic admin UI.
    if (typeof Tabia.personalize.postProcessAdmin === 'function') {
      Tabia.personalize.postProcessAdmin($element);
    }
    Tabia.debug('Replace personalized complete', {type: 'tabPersonal'});
  };


  /**
   * Reveal pane instances due to data failure.
   *
   * @param {string} selector
   */
  module.failReveal = function (selector) {
    $(selector).each(function paneInstance () {
      module.reveal($(this), true);
    });
  };

  /**
   * Industry specific form adjustment callback.
   * @todo Come up with a better, generic block-replacement method.
   *
   * @param {object} pane
   *   Contains replacement settings, item data values, etc.
   */
  module.industryFormAdjust = function (pane) {
    var $element = $(pane.selector);

    // Education industry?
    if (pane.panePersonal.industry === 283) {
      $element.find('.form-compact')
        .addClass('form-compact--reveal')
        .addClass('margin-vert-one')
        .after('<a class="cta cta--secondary margin-vert-one" href="/' + Drupal.settings.pathPrefix + 'academic">' + Drupal.t('For Students and Instructors') + '</a>');
    }

    module.reveal($element);
  };

})(jQuery, Tabia.personalize = {});
;
