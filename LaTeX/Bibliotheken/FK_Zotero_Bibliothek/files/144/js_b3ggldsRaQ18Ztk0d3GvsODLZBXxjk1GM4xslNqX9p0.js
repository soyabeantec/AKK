/**
 * Global, client-side behaviors for the TabWow theme.
 */

/**
 * Triggers a custom components:reattach event which can be used within Components to
 * re-bind to dynamically added DOM elements, with the given context (Element).
 */
Drupal.behave('tableauComponents', {only: false}).ready(function ($) {
  if (this.context !== document) {
    $(document).trigger('components:reattach', [this.context]);
  }
});


/**
 * Language Dropdown Reminder
 */
Drupal.behave('langDropdownReminder', {only: false}).ready(function ($) {
  if(Drupal.settings && Drupal.settings.lang_dropdown_remind && Drupal.settings.lang_dropdown_remind.prependto) {
    $(Drupal.settings.lang_dropdown_remind.prependto).bind('lang_dropdown_remind_ready', function () {
      var $languageDropdown = $('.global-footer__language'),
          $reminderTrigger = $('#trigger-langdropdown');

      // Navigate to the language dropdown element on the page and highlight it.
      $reminderTrigger.click(function (e) {
        // Smooth scroll to target.
        $('html, body').animate({
          scrollTop: $(document).height()
        }, 1000).promise().done(function(){
          // Highlight the element.
          $languageDropdown.sonarPulse();
        });
      });
    });
  }
});

(function autoPlayVideos () {
  // Wait for Brightcove to be loaded first.
  // Note: normally this would be a DOM-ready callback or Drupal behavior, but this is a
  // special case because Brightcove is asynchronously loaded (for performance).
  var brightcoveLoaded = $.Deferred();
  Components.$events.on('brightcoveLoaded', function () {
    brightcoveLoaded.resolve();
  });

  /**
   * Auto-play first video when hash is #video
   */
  Drupal.behave('autoPlayVideos').ready(function ($) {
    // Brightcove is async -- wait for it.
    brightcoveLoaded.done(function () {
      // Bail if videojs isn't available.
      if (!window.videojs) {
        return;
      }

      // Autoplay if video fragment is available in the url
      if (window.location.hash === '#video') {
        autoPlayVideo();
      }

      // Clicking a link with autoplay-video data attribute plays the first video.
      $('a[data-autoplay-video]').on('click.autoPlayVideo', function () {
        autoPlayVideo();
      });

      /**
       * Automatically start playing the first video on the page.
       */
      function autoPlayVideo() {
        var $video = $('.video-js:not(.reveal__content .video-js):not([autoplay])').first(),
          isGatedVideo = $video.parents('.is-premium-content').length &&
            !$('body').hasClass('has-premium-access'),
          player;

        // Exit if no videos that should be autoplayed are found.
        if (!$video.length || isGatedVideo) {
          return;
        }

        // Get a videojs player from the element.
        player = window.videojs($video[0]);

        // Scroll to and play the first video once it's ready.
        Components.utils.smoothScrollTop($video, 500, 50);
        player.ready(function () {
          // Wait for scroll to finish, then play.
          setTimeout(function () {
            player.play();
          }, 500);
        });
      }
    });
  });

})();

/**
 * Alter the global navigation area.
 */
Drupal.behave('globalMobileTrialSwap').ready(function ($) {
  // Skip the trial page on mobile, go to email reminder.
  if (Tabia.mobileCheck()) {
    $('a[href*="/trial"], a[href*="/products/trial"]')
      .attr('href', '/' + Drupal.settings.pathPrefix + 'products/desktop/download');
  }
});

/**
 * Open the customer menu when the sonar is activated.
 */
Drupal.behave('customerMenuDemo').ready(function ($) {
  var $dropdownNav = $('.global-nav .dropdown-nav'),
      $dropdownNavBody = $dropdownNav.find('.dropdown-nav__body.sonar-pulse'),
      getDropdownNav = $.Deferred();

  // Bail if things don't exist.
  if (!$dropdownNav.length || !$dropdownNavBody.length) {
    return;
  }

  // Listen for sonar activate/deactivate events.
  $dropdownNavBody
  .on('sonar:activate', function () {
    getDropdownNav.then(function (dropdownNav) {
      dropdownNav.open();
    });
  })
  .on('sonar:deactivate', function () {
    getDropdownNav.then(function (dropdownNav) {
      dropdownNav.close();
    });
  });

  // Resolve on custom initialized event.
  $dropdownNav.on('initialized', function () {
    getDropdownNav.resolve(this.DropdownNav);
  });

  // Resolve if DropdownNav object already exists.
  if ($dropdownNav[0].DropdownNav) {
    getDropdownNav.resolve($dropdownNav[0].DropdownNav);
  }
});

/**
 * Initialize thumbnail colors on views load more pager for Resource Library.
 */
Drupal.behave('tableauComponentsThumbnail').ready(function ($) {
  $('.view-resource-library, .view-stories').on('views_load_more.new_content', function () {
    Components.thumbnail.ready($);
  });
});

/**
 * Unveil the lazyload images a little smarter. (e.g. when tab trigger is hovered)
 */
Drupal.behave('lazyLoadUnveil').ready(function ($) {
  $('.tabs__tab-link').on('mouseenter', function (e) {
    var $element = $(e.target),
        $content = $('#' + $element.data('tabContent'));

    $content.find('.lazyload').addClass('lazypreload');
  });
});
;
!function(s){s(document).ready(function(){var o=s(".card-flip__front, .card-flip__back"),a=s(".card-flip__back"),e=s(".card-flip__item");function t(){o.removeAttr("style");var e=o.map(function(){return s(this).height()}).get(),t=o.map(function(){return s(this).outerHeight()}).get(),n=Math.max.apply(null,e),i=Math.max.apply(null,t);o.height(n),a.css({marginTop:-1*i})}e.length&&(e.click(function(){s(this).toggleClass("card-flip__item--not-flipped")}),s(window).on("resize.cardFlip orientationchange.cardFlip",_.debounce(t,100)),t())})}(jQuery),jQuery,function(t){t(".section-multiselect__control").click(function(){var e=t(this).data("topic");t(".section-multiselect__section").each(function(){-1!==t(this).data("topic").split(" ").indexOf(e)?t(this).fadeIn(450):t(this).fadeOut(450)}),t(".section-multiselect__control").removeClass("active"),t(this).addClass("active")})}(jQuery),function(s){s(document).ready(function(){var t=s(".pricing-tabs"),e=t.closest(".tabs__wrapper"),n=e.find(".pricing-tabs__tab"),i=n.filter(".is-active"),o=s(".quote-slideshow");function a(e){t.removeClass(function(e,t){return(t.match(/(^|\s)pricing-tabs--\S+/g)||[]).join(" ")}),t.addClass("pricing-tabs--"+e)}a(i.data("tabContent")),e.on("tabs.showTab",function(){a((i=n.filter(".is-active")).data("tabContent"))}),o.length&&o.slick({autoplay:!0,speed:1e3,easing:"easeInOutQuart",fade:!0,draggable:!1,arrows:!1,slide:".quote-slideshow__item",autoplaySpeed:7e3})})}(jQuery),jQuery(function(s){var r=s(".trends-2019-dynamic-pager");r.each(function(e,t){var n,i,o,a=s(t).data();a.trendsIndex&&(i=(n=r.find(".trends-2019-pager__item").eq(a.trendsIndex)).prev(),o=n.next(),i.addClass("trends-2019-pager__item--prev"),o.addClass("trends-2019-pager__item--next"),1<a.trendsIndex&&i.find(".trends-2019-pager__cta").text(a.trendsPreviousText),a.trendsIndex<11&&o.find(".trends-2019-pager__cta").text(a.trendsNextText),r.addClass("is-initialized").find(".trends-2019-pager__item").not(i).not(o).hide())})}),jQuery(document).ready(function(e){var t=e(".trends-2019-sticky-nav");e(window).on("scroll.trends2019",function(){t.addClass("is-visible"),e(window).off("scroll.trends2019")});var n=e(".trends-2019-dynamic-pager").attr("data-trends-index");e(".trends-2019-sticky-nav__list-item").eq(n).find(".trends-2019-sticky-nav__number").addClass("trends-2019-sticky-nav__number--is-active")}),$(function(){var e,i,o=$(".home-hero-424"),t=$(".product-links-424"),n=setTimeout(d,3e3),a=!1,s=!1;function r(){o.addClass("is-ctas-visible"),t.addClass("is-visible")}function d(){o.addClass("is-video-off"),o.removeClass("is-video-playing"),r()}function c(){var e=$("#dynamic-hero-video-html").html();$("#home-hero-video").html(e),window.bc("home-hero-video-video"),window.videojs("home-hero-video-video").ready(function(){var t,n;(i=this).on("error",r),i.on("loadedmetadata",function(){t=i.textTracks();for(var e=0;e<t.length;e++)if("metadata"===t[e].kind){n=t[e];break}n&&(n.oncuechange=function(){n.activeCues[0]&&"showCtas"===n.activeCues[0].originalCuePoint.name&&(a=!0,r())})}),i.on("loadeddata",function(){-1!==window.location.hash.indexOf("gottagofast")&&i.playbackRate(7),document.getElementById("home-hero-video-video").style.opacity=1,i.play(),setTimeout(l,200),o.on("click.homeHero",r)})})}function l(){i&&0<i.currentTime()&&!i.paused()||a?(clearTimeout(n),o.addClass("is-video-playing"),setTimeout(l,200)):d()}o.length&&Components.utils.breakpoint("desktop")?s||((e=document.createElement("script")).onload=c,e.src="//players.brightcove.net/3798483592001/68382327-2210-45c8-920a-a606cbb6de49_default/index.min.js",document.body.appendChild(e),s=!0):(o.addClass("is-video-off"),r()),$(window).on("resize.homeHero424 orientationchange.homeHero424",_.debounce(function(){Components.utils.breakpoint("desktop")||(o.addClass("is-video-off"),r())},100))}),function(e){Components.utils&&e(".navigation-grid__item a").on("click.trends",function(){Components.utils.smoothScrollTop(e(e(this).attr("href")))})}(jQuery),$(function(){$(".random-single").each(function(){var e=$(this),t=e.find(".random-single__item"),n=Math.floor(Math.random()*t.length);e.prepend(t.eq(n)).addClass("is-initialized")})}),function(t){t(document).ready(function(){var e=t(".hero-laptop");t(".products-hero .reveal__trigger").on("click",function(){e.addClass("is-hidden")}),t(".products-hero .reveal__close").on("click",function(){e.removeClass("is-hidden")}),"#video"===window.location.hash&&e.addClass("is-hidden")})}(jQuery),function(e){e(document).ready(function(){e(".platform-accordion").accordion({itemSelector:".platform-accordion__item",headerSelector:".platform-accordion__title",contentSelector:".platform-accordion__content-wrapper"})})}(jQuery),function(a){a(document).ready(function(){var n=a(".sticky-nav"),i=n.find(".sticky-nav__link"),o=a(".l-region--content .anchor-link");i.length&&o.length&&(o.waypoint({handler:function(e){var t=this.element.id;"down"===e?(i.filter('[href="#'+t+'"]').parent().addClass("is-active").siblings().removeClass("is-active"),o.first().is("#"+t)&&n.addClass("is-visible")):"up"===e&&(i.filter('[href="#'+t+'"]').parent().prev().addClass("is-active").siblings().removeClass("is-active"),o.first().is("#"+t)&&n.removeClass("is-visible"))},offset:"33%",group:"active"}),o.waypoint({handler:function(){var e=this.previous(),t=this.next();o.removeClass("anchor-link--previous anchor-link--current anchor-link--next"),a(this.element).addClass("anchor-link--current"),e&&a(e.element).addClass("anchor-link--previous"),t&&a(t.element).addClass("anchor-link--next")},offset:0,group:"position"}),i.click(function(e){var t=a(this).attr("href"),n=a(t),i=0;"#down"===t?(n=a(".anchor-link--next"),i=-1):"#up"===t&&(n=a(".anchor-link--previous"),i=1),n.length&&Components.utils.smoothScrollTop(n,500,i),-1!==a.inArray(t,["#page","#up","#down"])&&e.preventDefault()}))})}(jQuery),function(e){Components.utils&&e(".trends-grid__item a").on("click.trends",function(){Components.utils.smoothScrollTop(e(e(this).attr("href")))})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4cGVyaW1lbnRzL2NhcmQtZmxpcC9jYXJkLWZsaXAuanMiLCJleHBlcmltZW50cy9leGFtcGxlL2V4YW1wbGUuanMiLCJleHBlcmltZW50cy9tdWx0aXNlbGVjdC9tdWx0aXNlbGVjdC5qcyIsIm9uZS1vZmZzL3ByaWNpbmcvcHJpY2luZy5qcyIsIm9uZS1vZmZzL3RyZW5kcy0yMDE5L3RyZW5kcy0yMDE5LWR5bmFtaWMtcGFnZXIuanMiLCJvbmUtb2Zmcy90cmVuZHMtMjAxOS90cmVuZHMtMjAxOS1zdGlja3ktbmF2LmpzIiwib25lLW9mZnMvNC4yNC9ob21lLWhlcm8vaG9tZS1oZXJvLmpzIiwib25lLW9mZnMvZGF0YS1wcmVwL25hdmlnYXRpb24tZ3JpZC9uYXZpZ2F0aW9uLWdyaWQuanMiLCJvbmUtb2Zmcy9taWQtMjAxOC9yYW5kb20tc2luZ2xlL3JhbmRvbS1zaW5nbGUuanMiLCJvbmUtb2Zmcy9wcm9kdWN0cy9nZW5lcmFsL2dlbmVyYWwuanMiLCJvbmUtb2Zmcy9wcm9kdWN0cy9wbGF0Zm9ybS9wbGF0Zm9ybS5qcyIsIm9uZS1vZmZzL3RyZW5kcy0yMDE4L3N0aWNreS1uYXYvc3RpY2t5LW5hdi5qcyIsIm9uZS1vZmZzL3RyZW5kcy0yMDE4L3RyZW5kcy1ncmlkL3RyZW5kcy1ncmlkLmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiJGNhcmRDb250ZW50IiwiJGNhcmRGbGlwQmFjayIsIiRjYXJkRmxpcEl0ZW0iLCJzZXRDYXJkSGVpZ2h0IiwicmVtb3ZlQXR0ciIsImNvbnRlbnRIZWlnaHRzIiwibWFwIiwidGhpcyIsImhlaWdodCIsImdldCIsImVsZW1lbnRIZWlnaHRzIiwib3V0ZXJIZWlnaHQiLCJtYXhDb250ZW50SGVpZ2h0IiwiTWF0aCIsIm1heCIsImFwcGx5IiwibWF4RWxlbWVudEhlaWdodCIsImNzcyIsIm1hcmdpblRvcCIsImxlbmd0aCIsImNsaWNrIiwidG9nZ2xlQ2xhc3MiLCJ3aW5kb3ciLCJvbiIsIl8iLCJkZWJvdW5jZSIsImpRdWVyeSIsIiRkYXRhX3RvcGljIiwiZGF0YSIsImVhY2giLCJzcGxpdCIsImluZGV4T2YiLCJmYWRlSW4iLCJmYWRlT3V0IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsIiRwcmljaW5nVGFicyIsIiR0YWJzV3JhcHBlciIsImNsb3Nlc3QiLCIkdGFicyIsImZpbmQiLCIkYWN0aXZlVGFiIiwiZmlsdGVyIiwiJHF1b3RlU2xpZGVzaG93Iiwic2V0VGFic0NsYXNzIiwicHJvZHVjdCIsImluZGV4IiwiY2xhc3NOYW1lIiwibWF0Y2giLCJqb2luIiwic2xpY2siLCJhdXRvcGxheSIsInNwZWVkIiwiZWFzaW5nIiwiZmFkZSIsImRyYWdnYWJsZSIsImFycm93cyIsInNsaWRlIiwiYXV0b3BsYXlTcGVlZCIsIiRkeW5hbWljUGFnZXIiLCJlbGVtZW50IiwiJGN1cnJlbnRQYWdlckl0ZW0iLCIkcHJldmlvdXNQYWdlckl0ZW0iLCIkbmV4dFBhZ2VySXRlbSIsInRyZW5kc0luZGV4IiwiZXEiLCJwcmV2IiwibmV4dCIsInRleHQiLCJ0cmVuZHNQcmV2aW91c1RleHQiLCJ0cmVuZHNOZXh0VGV4dCIsIm5vdCIsImhpZGUiLCIkbmF2Iiwib2ZmIiwiYXR0ciIsImJyaWdodGNvdmVTY3JpcHQiLCJwbGF5ZXIiLCIkaG9tZUhlcm8iLCIkaG9tZUhlcm9Qcm9kdWN0TGlua3MiLCJ2aWRlb0luaXRUaW1lb3V0Iiwic2V0VGltZW91dCIsImNhbmNlbFZpZGVvIiwiY3VlcG9pbnRSZWFjaGVkIiwiaXNWaWRlb0Jvb3RlZCIsInNob3dDdGFzIiwidmlkZW9SZWFkeSIsInZpZGVvSHRtbCIsImh0bWwiLCJiYyIsInZpZGVvanMiLCJ0ZXh0VHJhY2tzIiwidGV4dFRyYWNrQ3VlcG9pbnRzIiwiaSIsImtpbmQiLCJvbmN1ZWNoYW5nZSIsImFjdGl2ZUN1ZXMiLCJvcmlnaW5hbEN1ZVBvaW50IiwibmFtZSIsImxvY2F0aW9uIiwiaGFzaCIsInBsYXliYWNrUmF0ZSIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJvcGFjaXR5IiwicGxheSIsInZpZGVvUHVsc2VDaGVjayIsImN1cnJlbnRUaW1lIiwicGF1c2VkIiwiY2xlYXJUaW1lb3V0IiwiQ29tcG9uZW50cyIsInV0aWxzIiwiYnJlYWtwb2ludCIsImNyZWF0ZUVsZW1lbnQiLCJvbmxvYWQiLCJzcmMiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJzbW9vdGhTY3JvbGxUb3AiLCIkcmFuZG9tU2luZ2xlIiwiJGl0ZW1zIiwicmFuZG9tSW5kZXgiLCJmbG9vciIsInJhbmRvbSIsInByZXBlbmQiLCIkbGFwdG9wIiwiYWNjb3JkaW9uIiwiaXRlbVNlbGVjdG9yIiwiaGVhZGVyU2VsZWN0b3IiLCJjb250ZW50U2VsZWN0b3IiLCIkbGlua3MiLCIkYW5jaG9ycyIsIndheXBvaW50IiwiaGFuZGxlciIsImRpcmVjdGlvbiIsImlkIiwicGFyZW50Iiwic2libGluZ3MiLCJmaXJzdCIsImlzIiwib2Zmc2V0IiwiZ3JvdXAiLCJwcmV2aW91cyIsImUiLCJ0YXJnZXQiLCIkZWxlbWVudCIsImluQXJyYXkiLCJwcmV2ZW50RGVmYXVsdCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsR0FDQUEsRUFBQUMsVUFBQUMsTUFBQSxXQUNBLElBQUFDLEVBQUFILEVBQUEsdUNBQ0FJLEVBQUFKLEVBQUEsb0JBQ0FLLEVBQUFMLEVBQUEsb0JBYUEsU0FBQU0sSUFFQUgsRUFBQUksV0FBQSxTQUdBLElBQUFDLEVBQUFMLEVBQUFNLElBQUEsV0FDQSxPQUFBVCxFQUFBVSxNQUFBQyxXQUNBQyxNQUVBQyxFQUFBVixFQUFBTSxJQUFBLFdBQ0EsT0FBQVQsRUFBQVUsTUFBQUksZ0JBQ0FGLE1BSUFHLEVBQUFDLEtBQUFDLElBQUFDLE1BQUEsS0FBQVYsR0FDQVcsRUFBQUgsS0FBQUMsSUFBQUMsTUFBQSxLQUFBTCxHQUdBVixFQUFBUSxPQUFBSSxHQUdBWCxFQUFBZ0IsSUFBQSxDQUFBQyxXQUFBLEVBQUFGLElBSUFkLEVBQUFpQixTQW5DQWpCLEVBQUFrQixNQUFBLFdBQ0F2QixF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WyIoZnVuY3Rpb24gKCQpIHtcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgIHZhciAkY2FyZENvbnRlbnQgPSAkKCcuY2FyZC1mbGlwX19mcm9udCwgLmNhcmQtZmxpcF9fYmFjaycpLFxuICAgICAgJGNhcmRGbGlwQmFjayA9ICQoJy5jYXJkLWZsaXBfX2JhY2snKSxcbiAgICAgICRjYXJkRmxpcEl0ZW0gPSAkKCcuY2FyZC1mbGlwX19pdGVtJyk7XG5cbiAgICBmdW5jdGlvbiBhdHRhY2hFdmVudExpc3RlbmVycygpIHtcbiAgICAgIC8vU3dhcCBjbGFzcyBvbiBjbGljayB0byBhbmltYXRlXG4gICAgICAkY2FyZEZsaXBJdGVtLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcygnY2FyZC1mbGlwX19pdGVtLS1ub3QtZmxpcHBlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEhhbmRsZSByZXNpemVcbiAgICAgICQod2luZG93KS5vbigncmVzaXplLmNhcmRGbGlwIG9yaWVudGF0aW9uY2hhbmdlLmNhcmRGbGlwJywgXy5kZWJvdW5jZShzZXRDYXJkSGVpZ2h0LCAxMDApKTtcbiAgICB9XG5cbiAgICAvLyBTZXRzIHRoZSBoZWlnaHRzIG9mIHRoZSBjYXJkcyB0byBtYXRjaFxuICAgIGZ1bmN0aW9uIHNldENhcmRIZWlnaHQoKSB7XG4gICAgICAvLyBGaXJzdCBsZXRzIG1ha2Ugc3VyZSB0aGVyZSBhcmVuJ3QgYW55IHJlbWFpbmluZyBzdHlsZXNcbiAgICAgICRjYXJkQ29udGVudC5yZW1vdmVBdHRyKFwic3R5bGVcIik7XG5cbiAgICAgIC8vIEdldCBhbiBhcnJheSBvZiBhbGwgZWxlbWVudCBoZWlnaHRzXG4gICAgICB2YXIgY29udGVudEhlaWdodHMgPSAkY2FyZENvbnRlbnQubWFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICQodGhpcykuaGVpZ2h0KCk7XG4gICAgICB9KS5nZXQoKTtcblxuICAgICAgdmFyIGVsZW1lbnRIZWlnaHRzID0gJGNhcmRDb250ZW50Lm1hcChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkKHRoaXMpLm91dGVySGVpZ2h0KCk7XG4gICAgICB9KS5nZXQoKTtcblxuICAgICAgLy8gTWF0aC5tYXggdGFrZXMgYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzXG4gICAgICAvLyBgYXBwbHlgIGlzIGVxdWl2YWxlbnQgdG8gcGFzc2luZyBlYWNoIGhlaWdodCBhcyBhbiBhcmd1bWVudFxuICAgICAgdmFyIG1heENvbnRlbnRIZWlnaHQgPSBNYXRoLm1heC5hcHBseShudWxsLCBjb250ZW50SGVpZ2h0cyk7XG4gICAgICB2YXIgbWF4RWxlbWVudEhlaWdodCA9IE1hdGgubWF4LmFwcGx5KG51bGwsIGVsZW1lbnRIZWlnaHRzKTtcblxuICAgICAgLy8gU2V0IGVhY2ggY2FyZCBmcm9udCBhbmQgYmFjayBoZWlnaHQgdG8gdGhlIG1heCBoZWlnaHRcbiAgICAgICRjYXJkQ29udGVudC5oZWlnaHQobWF4Q29udGVudEhlaWdodCk7XG5cbiAgICAgIC8vIFRoaXMgbW92ZXMgdGhlIGFic29sdXRlIHBvc2l0aW9uIG9mIHRoZSBiYWNrIHBvcnRpb24gb2YgdGhlIGNhcmQgdXAgYmVoaW5kIHRoZSBmcm9udCBzbyB0aGV5IGxpbmUgdXAgY29ycmVjdGx5XG4gICAgICAkY2FyZEZsaXBCYWNrLmNzcyh7bWFyZ2luVG9wOiAobWF4RWxlbWVudEhlaWdodCAqIC0xKX0pO1xuICAgIH1cblxuICAgIC8vIFRoaXMgYXNzdW1lcyB3ZSdyZSBub3QgY2FsbGluZyBjYXJkX2ZsaXAgdmlhIGFqYXggb3Igd2l0aGluIHZ1ZSAvIGZlIGZyYW1ld29ya3NcbiAgICBpZiAoJGNhcmRGbGlwSXRlbS5sZW5ndGgpIHtcbiAgICAgIC8vIEluaXRpYWxpemUgZXZlcnl0aGluZ1xuICAgICAgYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIHNldENhcmRIZWlnaHQoKTtcbiAgICB9XG4gIH0pO1xufSkoalF1ZXJ5KTtcbiIsIihmdW5jdGlvbiAoJCkge1xuICAvLyBUaGluZ3MgZ28gaGVyZSFcbn0pKGpRdWVyeSk7XG4iLCIoZnVuY3Rpb24gKCQpIHtcbiAgLy8gT24gQ2xpY2ssIHNob3cgYWxsIHNlY3Rpb25zIGNvbnRhaW5pbmcgdGhlIHNhbWUgZGF0YS10b3BpYyBhcyB0aGUgY29udHJvbGxlciBjdGEuXG4gICQoJy5zZWN0aW9uLW11bHRpc2VsZWN0X19jb250cm9sJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgIC8vIEdldCB0aGUgZGF0YS10b3BpYyBmcm9tIHRoZSBjbGlja2VkIGJ1dHRvbi5cbiAgICB2YXIgJGRhdGFfdG9waWMgPSAkKHRoaXMpLmRhdGEoJ3RvcGljJyk7XG5cbiAgICAvLyBTaG93IGFsbCBzZWN0aW9ucyB0aGF0IGNvbnRhaW4gdGhlIHRvcGljIGNsaWNrZWQuIFxuICAgICQoJy5zZWN0aW9uLW11bHRpc2VsZWN0X19zZWN0aW9uJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBTcGxpdCBkYXRhLXRvcGljIHN0cmluZyBmb3IgcGFyc2luZy5cbiAgICAgIHZhciB0b3BpY3MgPSAkKHRoaXMpLmRhdGEoJ3RvcGljJykuc3BsaXQoJyAnKTtcbiAgICAgIC8vIFNlYXJjaCBmb3IgdGhlIHNwZWNpZmljIHRvcGljIGluIHRoZSBhcnJheS4gSWYgd2UgZmluZCBpdCwgc2hvdyBpdC5cbiAgICAgIGlmICh0b3BpY3MuaW5kZXhPZigkZGF0YV90b3BpYykgIT09IC0xKSB7XG4gICAgICAgICQodGhpcykuZmFkZUluKDQ1MCk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgJCh0aGlzKS5mYWRlT3V0KDQ1MCk7IC8vSWYgYSBzZWN0aW9uIGlzbid0IGZvdW5kLCBmYWRlIGl0IG91dCBpbnN0ZWFkLlxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ2xlYXIgYnV0dG9uIHN0YXRlcyBhbmQgc2hvdyBjdXJyZW50bHkgc2VsZWN0ZWQgYnV0dG9uLlxuICAgICQoJy5zZWN0aW9uLW11bHRpc2VsZWN0X19jb250cm9sJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICB9KTtcbn0pKGpRdWVyeSk7XG4iLCIoZnVuY3Rpb24oJCl7XG4gICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgcHJpY2luZyB0YWJzXG4gICAgdmFyICRwcmljaW5nVGFicyA9ICQoJy5wcmljaW5nLXRhYnMnKSxcbiAgICAgICAgJHRhYnNXcmFwcGVyID0gJHByaWNpbmdUYWJzLmNsb3Nlc3QoJy50YWJzX193cmFwcGVyJyksXG4gICAgICAgICR0YWJzID0gJHRhYnNXcmFwcGVyLmZpbmQoJy5wcmljaW5nLXRhYnNfX3RhYicpLFxuICAgICAgICAkYWN0aXZlVGFiID0gJHRhYnMuZmlsdGVyKCcuaXMtYWN0aXZlJyksXG4gICAgICAgICRxdW90ZVNsaWRlc2hvdyA9ICQoJy5xdW90ZS1zbGlkZXNob3cnKTtcblxuICAgIC8vIEluaXRhbGx5IHVwZGF0ZSB0YWJzIGNsYXNzIGJhc2VkIG9uIHRoZSBhY3RpdmUgdGFiLlxuICAgIHNldFRhYnNDbGFzcygkYWN0aXZlVGFiLmRhdGEoJ3RhYkNvbnRlbnQnKSk7XG5cbiAgICAvLyBVcGRhdGUgdGFicyBjbGFzcyBvbiBzaG93VGFicyBldmVudCAodGFiIGNoYW5nZSlcbiAgICAkdGFic1dyYXBwZXIub24oJ3RhYnMuc2hvd1RhYicsIGZ1bmN0aW9uKCkge1xuICAgICAgJGFjdGl2ZVRhYiA9ICR0YWJzLmZpbHRlcignLmlzLWFjdGl2ZScpO1xuXG4gICAgICBzZXRUYWJzQ2xhc3MoJGFjdGl2ZVRhYi5kYXRhKCd0YWJDb250ZW50JykpO1xuICAgIH0pO1xuXG4gICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgdGFicyBjbGFzcy5cbiAgICBmdW5jdGlvbiBzZXRUYWJzQ2xhc3MocHJvZHVjdCkge1xuICAgICAgJHByaWNpbmdUYWJzLnJlbW92ZUNsYXNzIChmdW5jdGlvbiAoaW5kZXgsIGNsYXNzTmFtZSkge1xuICAgICAgICByZXR1cm4gKGNsYXNzTmFtZS5tYXRjaCAoLyhefFxccylwcmljaW5nLXRhYnMtLVxcUysvZykgfHwgW10pLmpvaW4oJyAnKTtcbiAgICAgIH0pO1xuXG4gICAgICAkcHJpY2luZ1RhYnMuYWRkQ2xhc3MoJ3ByaWNpbmctdGFicy0tJyArIHByb2R1Y3QpO1xuICAgIH1cblxuICAgIC8vIEluaXRpYWxpemUgcXVvdGUgc2xpZGVzaG93XG4gICAgaWYoJHF1b3RlU2xpZGVzaG93Lmxlbmd0aCkge1xuICAgICAgJHF1b3RlU2xpZGVzaG93LnNsaWNrKHtcbiAgICAgICAgYXV0b3BsYXk6IHRydWUsXG4gICAgICAgIHNwZWVkOiAxMDAwLFxuICAgICAgICBlYXNpbmc6ICdlYXNlSW5PdXRRdWFydCcsXG4gICAgICAgIGZhZGU6IHRydWUsXG4gICAgICAgIGRyYWdnYWJsZTogZmFsc2UsXG4gICAgICAgIGFycm93czogZmFsc2UsXG4gICAgICAgIHNsaWRlOiAnLnF1b3RlLXNsaWRlc2hvd19faXRlbScsXG4gICAgICAgIGF1dG9wbGF5U3BlZWQ6IDcwMDBcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KShqUXVlcnkpO1xuIiwiLyoqXG4gKiBAZmlsZSAyMDE5IFRyZW5kcyBEeW5hbWljIFBhZ2VyXG4gKlxuICogQSBiaXQgb2YgYSBoYWNrIHRvIGF2b2lkIHRoZSBtb3JlIGNvbXBsaWNhdGVkIERydXBhbCB3YXkgb2YgYnVpbGRpbmcgb3V0IGNvbnRlbnQgdHlwZXMsXG4gKiBhbmQgY3JlYXRpbmcgZW50aXR5IHJlZmVyZW5jZXMsIGV0Yy5cbiAqXG4gKiBUaGlzIHNjcmlwdCB3b3JrcyBvbiB0aGUgZnVsbCBwYWdlciBsaXN0LCB3aGljaCBpcyBoYXJkLWNvZGVkIEhUTUwsIGFuZCBpbnRlbGxpZ2VudGx5XG4gKiBzaG93cyBvbmx5IHByZXZpb3VzIGFuZCBuZXh0IHBhZ2VyIGxpbmtzLiBUaGUgcmVzdCBhcmUgaGlkZGVuLlxuICpcbiAqIFdlIGV4cGVjdCB0aGUgcGFnZXIgdG8gaGF2ZSAxMiBpdGVtcywgaW4gdGhlIGZvbGxvd2luZyBvcmRlciwgd2l0aCBhIHplcm8tYmFzZWQgaW5kZXg6XG4gKlxuICogICAgICAwOiBUcmVuZHMgbGFuZGluZyBwYWdlXG4gKiAgIDEtMTA6IFRyZW5kcyBkZXRhaWwgcGFnZVxuICogICAgIDExOiAxMXRoIFRyZW5kXG4gKlxuICogVGhlIGR5bmFtaWMgcGFnZXIgd3JhcHMgYSBwYWdlciBjb21wb25lbnQgYW5kIGRlY2xhcmVzIHRoZSBkYXRhLXRyZW5kcy1pbmRleCBhdHRyaWJ1dGUuXG4gKlxuICogRXhhbXBsZTpcbiAqIDxkaXYgY2xhc3M9XCJ0cmVuZHMtMjAxOS1keW5hbWljLXBhZ2VyXCIgZGF0YS10cmVuZHMtaW5kZXg9XCI0XCIgZGF0YS10cmVuZHMtcHJldmlvdXMtdGV4dD1cIsKrIFByZXZpb3VzIHRyZW5kXCIgZGF0YS10cmVuZHMtbmV4dC10ZXh0PVwiTmV4dCB0cmVuZCDCu1wiPlxuICogICAuLi4gcGFnZXIgLi4uXG4gKiA8L2Rpdj5cbiAqL1xuXG4vLyBGaXJlIG9uIERPTS1yZWFkeS5cbmpRdWVyeShmdW5jdGlvbiAoJCkge1xuICAvLyBTZWxlY3QgYWxsIGR5bmFtaWMgcGFnZXIgY29tcG9uZW50cy5cbiAgdmFyICRkeW5hbWljUGFnZXIgPSAkKCcudHJlbmRzLTIwMTktZHluYW1pYy1wYWdlcicpO1xuXG4gIC8vIEl0ZXJhdGUgb3ZlciBlYWNoLlxuICAkZHluYW1pY1BhZ2VyLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XG4gICAgLy8gR2V0IHRoZSBkYXRhIChkZWZpbmVkIGJ5IGRhdGEtdHJlbmRzLWluZGV4IGF0dHJpYnV0ZS4pXG4gICAgdmFyIGRhdGEgPSAkKGVsZW1lbnQpLmRhdGEoKTtcbiAgICAvLyBWYXJpYWJsZXMgdG8gaG9sZCBqUXVlcnkgc2VsZWN0aW9ucy5cbiAgICB2YXIgJGN1cnJlbnRQYWdlckl0ZW07XG4gICAgdmFyICRwcmV2aW91c1BhZ2VySXRlbTtcbiAgICB2YXIgJG5leHRQYWdlckl0ZW07XG5cbiAgICAvLyBFeGl0IGlmIGluZGV4IG5vdCBmb3VuZC5cbiAgICBpZiAoIWRhdGEudHJlbmRzSW5kZXgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZWxlY3QgdGhlIGN1cnJlbnQgcGFnZXIgaXRlbS5cbiAgICAkY3VycmVudFBhZ2VySXRlbSA9ICRkeW5hbWljUGFnZXIuZmluZCgnLnRyZW5kcy0yMDE5LXBhZ2VyX19pdGVtJykuZXEoZGF0YS50cmVuZHNJbmRleCk7XG5cbiAgICAvLyBTZWxlY3QgdGhlIHByZXZpb3VzL25leHQgcGFnZXIgaXRlbXMgYmFzZWQgb24gdGhlIGN1cnJlbnQgb25lLlxuICAgICRwcmV2aW91c1BhZ2VySXRlbSA9ICRjdXJyZW50UGFnZXJJdGVtLnByZXYoKTtcbiAgICAkbmV4dFBhZ2VySXRlbSA9ICRjdXJyZW50UGFnZXJJdGVtLm5leHQoKTtcblxuICAgIC8vIEFkZCB0aGUgcHJldi9uZXh0IG1vZGlmaWVycy5cbiAgICAkcHJldmlvdXNQYWdlckl0ZW0uYWRkQ2xhc3MoJ3RyZW5kcy0yMDE5LXBhZ2VyX19pdGVtLS1wcmV2Jyk7XG4gICAgJG5leHRQYWdlckl0ZW0uYWRkQ2xhc3MoJ3RyZW5kcy0yMDE5LXBhZ2VyX19pdGVtLS1uZXh0Jyk7XG5cbiAgICAvLyBBZGQgdGhlIENUQSB0ZXh0IGlmIG5lZWRlZC5cbiAgICBpZiAoZGF0YS50cmVuZHNJbmRleCA+IDEpIHtcbiAgICAgICRwcmV2aW91c1BhZ2VySXRlbS5maW5kKCcudHJlbmRzLTIwMTktcGFnZXJfX2N0YScpLnRleHQoZGF0YS50cmVuZHNQcmV2aW91c1RleHQpO1xuICAgIH1cbiAgICBpZiAoZGF0YS50cmVuZHNJbmRleCA8IDExKSB7XG4gICAgICAkbmV4dFBhZ2VySXRlbS5maW5kKCcudHJlbmRzLTIwMTktcGFnZXJfX2N0YScpLnRleHQoZGF0YS50cmVuZHNOZXh0VGV4dCk7XG4gICAgfVxuXG4gICAgJGR5bmFtaWNQYWdlclxuICAgICAgLy8gQWRkIGNsYXNzIHRvIHNob3cgdGhlIGR5bmFtaWMgcGFnZXIuXG4gICAgICAuYWRkQ2xhc3MoJ2lzLWluaXRpYWxpemVkJylcbiAgICAgIC8vIFNob3cgb25seSB0aGUgcHJldmlvdXMgYW5kIG5leHQgcGFnZXIgaXRlbXMuXG4gICAgICAuZmluZCgnLnRyZW5kcy0yMDE5LXBhZ2VyX19pdGVtJylcbiAgICAgIC5ub3QoJHByZXZpb3VzUGFnZXJJdGVtKVxuICAgICAgLm5vdCgkbmV4dFBhZ2VySXRlbSlcbiAgICAgIC5oaWRlKCk7XG4gIH0pO1xufSk7XG4iLCIvKipcbiAqIEBmaWxlIDIwMTkgVHJlbmRzIFN0aWNreSBOYXYgYmVoYXZpb3JzXG4gKi9cblxualF1ZXJ5KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigkKSB7XG4gIHZhciAkbmF2ID0gJCgnLnRyZW5kcy0yMDE5LXN0aWNreS1uYXYnKTtcblxuICAvLyBBbnkgc2Nyb2xsaW5nIHdpbGwgYWN0aXZhdGUgdGhlIHN0aWNreSBuYXZpZ2F0aW9uLCBhbmQgdGhlbiB3ZSB1bmJpbmQgdGhlIHNjcm9sbFxuICAvLyBoYW5kbGVyIGZvciBwZXJmb3JtYW5jZSByZWFzb25zLlxuXG4gICQod2luZG93KS5vbignc2Nyb2xsLnRyZW5kczIwMTknLCBmdW5jdGlvbiAoKSB7XG4gICAgJG5hdi5hZGRDbGFzcygnaXMtdmlzaWJsZScpO1xuICAgICQod2luZG93KS5vZmYoJ3Njcm9sbC50cmVuZHMyMDE5Jyk7XG4gIH0pO1xuXG4gIC8vIEFkZCBpcy1hY3RpdmUgbW9kaWZpZXIgdG8gdGhlIGFjdGl2ZSBzdGlja3kgbmF2IG51bWJlci5cbiAgdmFyIHRyZW5kc0luZGV4ID0gJCgnLnRyZW5kcy0yMDE5LWR5bmFtaWMtcGFnZXInKS5hdHRyKCdkYXRhLXRyZW5kcy1pbmRleCcpO1xuICAkKCcudHJlbmRzLTIwMTktc3RpY2t5LW5hdl9fbGlzdC1pdGVtJylcbiAgICAuZXEodHJlbmRzSW5kZXgpXG4gICAgLmZpbmQoJy50cmVuZHMtMjAxOS1zdGlja3ktbmF2X19udW1iZXInKVxuICAgIC5hZGRDbGFzcygndHJlbmRzLTIwMTktc3RpY2t5LW5hdl9fbnVtYmVyLS1pcy1hY3RpdmUnKTtcblxufSk7XG4iLCIvKipcbiAqIDQuMjQgSG9tZSBIZXJvIFZpZGVvXG4gKiAtIHNob3dDdGFzIGN1ZSBwb2ludCBoYW5kbGluZ1xuICogLSBhdXRvbWF0aWMgcGxheSB3aXRoIGZhZGUtaW4gd2hlbiBsb2FkZWRcbiAqIC0gaGFuZGxlcyB2aWRlbyBzbG93LWluaXQgYW5kIHBsYXliYWNrIGZhaWx1cmVzIHdpdGggc3RhdGljIGJhY2tncm91bmQgYWx0ZXJuYXRpdmVcbiAqL1xuJChmdW5jdGlvbiBpbml0SG9tZUhlcm8oKSB7XG4gIHZhciAkaG9tZUhlcm8gPSAkKCcuaG9tZS1oZXJvLTQyNCcpLFxuICAgICAgJGhvbWVIZXJvUHJvZHVjdExpbmtzID0gJCgnLnByb2R1Y3QtbGlua3MtNDI0JyksXG4gICAgICB2aWRlb0luaXRUaW1lb3V0ID0gc2V0VGltZW91dChjYW5jZWxWaWRlbywgMzAwMCksXG4gICAgICBjdWVwb2ludFJlYWNoZWQgPSBmYWxzZSxcbiAgICAgIGlzVmlkZW9Cb290ZWQgPSBmYWxzZSxcbiAgICAgIGJyaWdodGNvdmVTY3JpcHQsXG4gICAgICBwbGF5ZXI7XG5cbiAgLyoqXG4gICAqIERpc3BsYXlzIHRoZSBwcm9kdWN0IENUQXMuXG4gICAqL1xuICBmdW5jdGlvbiBzaG93Q3RhcygpIHtcbiAgICAkaG9tZUhlcm8uYWRkQ2xhc3MoJ2lzLWN0YXMtdmlzaWJsZScpO1xuICAgICRob21lSGVyb1Byb2R1Y3RMaW5rcy5hZGRDbGFzcygnaXMtdmlzaWJsZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHZpZGVvIGlzIGNhbmNlbGxlZCB0byBhZGp1c3QgQ1NTIGNsYXNzZXMgYW5kIHNob3cgdGhlIENUQXMuXG4gICAqL1xuICBmdW5jdGlvbiBjYW5jZWxWaWRlbygpIHtcbiAgICAkaG9tZUhlcm8uYWRkQ2xhc3MoJ2lzLXZpZGVvLW9mZicpO1xuICAgICRob21lSGVyby5yZW1vdmVDbGFzcygnaXMtdmlkZW8tcGxheWluZycpO1xuICAgIHNob3dDdGFzKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGJhY2sgdG8gZHluYW1pY2FsbHkgaW5qZWN0IHRoZSB2aWRlbyBhbmQgc3RhcnQgcGxheWluZyBpdC5cbiAgICovXG4gIGZ1bmN0aW9uIHZpZGVvUmVhZHkoKSB7XG4gICAgdmFyIHZpZGVvSHRtbCA9ICQoJyNkeW5hbWljLWhlcm8tdmlkZW8taHRtbCcpLmh0bWwoKTtcbiAgICAkKCcjaG9tZS1oZXJvLXZpZGVvJykuaHRtbCh2aWRlb0h0bWwpO1xuICAgIHdpbmRvdy5iYygnaG9tZS1oZXJvLXZpZGVvLXZpZGVvJyk7XG5cbiAgICB3aW5kb3cudmlkZW9qcygnaG9tZS1oZXJvLXZpZGVvLXZpZGVvJykucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHRleHRUcmFja3MsXG4gICAgICAgICAgdGV4dFRyYWNrQ3VlcG9pbnRzO1xuXG4gICAgICBwbGF5ZXIgPSB0aGlzO1xuXG4gICAgICBwbGF5ZXIub24oJ2Vycm9yJywgc2hvd0N0YXMpO1xuXG4gICAgICBwbGF5ZXIub24oJ2xvYWRlZG1ldGFkYXRhJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB0ZXh0VHJhY2tzID0gcGxheWVyLnRleHRUcmFja3MoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0VHJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHRleHRUcmFja3NbaV0ua2luZCA9PT0gJ21ldGFkYXRhJykge1xuICAgICAgICAgICAgdGV4dFRyYWNrQ3VlcG9pbnRzID0gdGV4dFRyYWNrc1tpXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRleHRUcmFja0N1ZXBvaW50cykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0ZXh0VHJhY2tDdWVwb2ludHMub25jdWVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHRleHRUcmFja0N1ZXBvaW50cy5hY3RpdmVDdWVzWzBdKSB7XG4gICAgICAgICAgICBpZiAodGV4dFRyYWNrQ3VlcG9pbnRzLmFjdGl2ZUN1ZXNbMF0ub3JpZ2luYWxDdWVQb2ludC5uYW1lID09PSAnc2hvd0N0YXMnKSB7XG4gICAgICAgICAgICAgIGN1ZXBvaW50UmVhY2hlZCA9IHRydWU7XG4gICAgICAgICAgICAgIHNob3dDdGFzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIHBsYXllci5vbignbG9hZGVkZGF0YScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5oYXNoLmluZGV4T2YoJ2dvdHRhZ29mYXN0JykgIT09IC0xKSB7XG4gICAgICAgICAgcGxheWVyLnBsYXliYWNrUmF0ZSg3KTtcbiAgICAgICAgfVxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaG9tZS1oZXJvLXZpZGVvLXZpZGVvJykuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgIHBsYXllci5wbGF5KCk7XG4gICAgICAgIHNldFRpbWVvdXQodmlkZW9QdWxzZUNoZWNrLCAyMDApO1xuXG4gICAgICAgIC8vIFNob3cgaW1tZWRpYXRlbHkgaWYgd2UgY2xpY2sgb24gdGhlIHZpZGVvIGFmdGVyIGl0J3Mgc3RhcnRlZCBwbGF5aW5nLlxuICAgICAgICAkaG9tZUhlcm8ub24oJ2NsaWNrLmhvbWVIZXJvJywgc2hvd0N0YXMpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgdG8gbWFrZSBzdXJlIHRoZSB2aWRlbyBpcyBzdGlsbCBwbGF5aW5nIG9uIGEgZnJlcXVlbnQgaW50ZXJ2YWwuXG4gICAqIC0gYWRqdXN0cyBDU1MgY2xhc3NlcyBvbiBjb21wb25lbnQgYmFzZWQgb24gcGxheWJhY2sgc3RhdHVzXG4gICAqL1xuICBmdW5jdGlvbiB2aWRlb1B1bHNlQ2hlY2soKSB7XG4gICAgdmFyIGlzUGxheWluZyA9IHBsYXllciAmJiBwbGF5ZXIuY3VycmVudFRpbWUoKSA+IDAgJiYgIXBsYXllci5wYXVzZWQoKTtcblxuICAgIC8vIElmIHBsYXlpbmcgaXNuJ3Qgd29ya2luZyBhcyBleHBlY3RlZCwganVzdCBzaG93IHRoZSBDVEFzLlxuICAgIGlmICghaXNQbGF5aW5nICYmICFjdWVwb2ludFJlYWNoZWQpIHtcbiAgICAgIGNhbmNlbFZpZGVvKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY2xlYXJUaW1lb3V0KHZpZGVvSW5pdFRpbWVvdXQpO1xuICAgICAgJGhvbWVIZXJvLmFkZENsYXNzKCdpcy12aWRlby1wbGF5aW5nJyk7XG4gICAgICAvLyBLZWVwIGNoZWNraW5nIG9uIGEgZnJlcXVlbnQgaW50ZXJ2YWwuXG4gICAgICBzZXRUaW1lb3V0KHZpZGVvUHVsc2VDaGVjaywgMjAwKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRHluYW1pY2FsbHkgYW5kIGFzeW5jaHJvbm91c2x5IGxvYWQgdGhlIGJyaWdodGNvdmUgc2NyaXB0IGZvciB0aGUgaGVybyB2aWRlby5cbiAgICovXG4gIGZ1bmN0aW9uIGJvb3RWaWRlbygpIHtcbiAgICBpZiAoaXNWaWRlb0Jvb3RlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBicmlnaHRjb3ZlU2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgYnJpZ2h0Y292ZVNjcmlwdC5vbmxvYWQgPSB2aWRlb1JlYWR5O1xuICAgIGJyaWdodGNvdmVTY3JpcHQuc3JjID0gJy8vcGxheWVycy5icmlnaHRjb3ZlLm5ldC8zNzk4NDgzNTkyMDAxLzY4MzgyMzI3LTIyMTAtNDVjOC05MjBhLWE2MDZjYmI2ZGU0OV9kZWZhdWx0L2luZGV4Lm1pbi5qcyc7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChicmlnaHRjb3ZlU2NyaXB0KTtcbiAgICBpc1ZpZGVvQm9vdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIHdpbmRvdyByZXNpemUsIGdvaW5nIGZyb20gZGVza3RvcCB0byBzbWFsbGVyLlxuICAgKi9cbiAgZnVuY3Rpb24gaGFuZGxlV2luZG93UmVzaXplKCkge1xuICAgIHZhciBpc0Rlc2t0b3AgPSBDb21wb25lbnRzLnV0aWxzLmJyZWFrcG9pbnQoJ2Rlc2t0b3AnKTtcblxuICAgIGlmICghaXNEZXNrdG9wKSB7XG4gICAgICAkaG9tZUhlcm8uYWRkQ2xhc3MoJ2lzLXZpZGVvLW9mZicpO1xuICAgICAgc2hvd0N0YXMoKTtcbiAgICB9XG4gIH1cblxuICAvLyBPbmx5IGlmIHdlIGZpbmQgdGhlIGNvcnJlY3QgaGVybyBhbmQgb24gZGVza3RvcCBicmVha3BvaW50LlxuICBpZiAoJGhvbWVIZXJvLmxlbmd0aCAmJiBDb21wb25lbnRzLnV0aWxzLmJyZWFrcG9pbnQoJ2Rlc2t0b3AnKSkge1xuICAgIGJvb3RWaWRlbygpO1xuICB9XG4gIGVsc2Uge1xuICAgICRob21lSGVyby5hZGRDbGFzcygnaXMtdmlkZW8tb2ZmJyk7XG4gICAgc2hvd0N0YXMoKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBicmVha3BvaW50IGNoYW5nZXMuXG4gICQod2luZG93KS5vbigncmVzaXplLmhvbWVIZXJvNDI0IG9yaWVudGF0aW9uY2hhbmdlLmhvbWVIZXJvNDI0JywgXy5kZWJvdW5jZShoYW5kbGVXaW5kb3dSZXNpemUsIDEwMCkpO1xufSk7XG4iLCIoZnVuY3Rpb24gKCQpIHtcbiAgaWYoQ29tcG9uZW50cy51dGlscykge1xuICAgIHZhciAkbGlua3MgPSAkKCcubmF2aWdhdGlvbi1ncmlkX19pdGVtIGEnKTtcblxuICAgIC8vIEhhbmRsZSBzbW9vdGggc2Nyb2xsaW5nIGRvd24gdG8gdGhlIHNlY3Rpb24uXG4gICAgJGxpbmtzLm9uKCdjbGljay50cmVuZHMnLCBmdW5jdGlvbigpIHtcbiAgICAgIENvbXBvbmVudHMudXRpbHMuc21vb3RoU2Nyb2xsVG9wKCQoJCh0aGlzKS5hdHRyKCdocmVmJykpKTtcbiAgICB9KTtcbiAgfVxufSkoalF1ZXJ5KTtcbiIsIi8qKlxuICogUmFuZG9tIFNpbmdsZSBKUyAtIFBpY2tzIGEgcmFuZG9tIGVsZW1lbnQg4oCUIGByYW5kb20tc2luZ2xlX19pdGVtYCDigJQgd2l0aGluIHRoZVxuICogYHJhbmRvbS1zaW5nbGVgIGNvbXBvbmVudCB0byBiZSBwcmVwZW5kZWQgYXMgdGhlIGZpcnN0IGNoaWxkLlxuICogVGhlIGFjY29tcGFueWluZyBzdHlsZXMgd291bGQgdGhlbiBlZmZlY3RpdmVseSBzaG93IGEgcmFuZG9tIGl0ZW0uXG4gKi9cblxuJChmdW5jdGlvbiBpbml0UmFuZG9tU2luZ2xlKCkge1xuICAkKCcucmFuZG9tLXNpbmdsZScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgIHZhciAkcmFuZG9tU2luZ2xlID0gJCh0aGlzKTtcbiAgICB2YXIgJGl0ZW1zID0gJHJhbmRvbVNpbmdsZS5maW5kKCcucmFuZG9tLXNpbmdsZV9faXRlbScpO1xuICAgIHZhciByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICRpdGVtcy5sZW5ndGgpO1xuXG4gICAgLy8gTW92ZSBhIGNoaWxkIHJhbmRvbWx5IHRvIHRoZSBmaXJzdCBjaGlsZCBwb3NpdGlvbiBhbmQgYWRkIHRoZSBpcy1pbml0aWFsaXplZCBjbGFzcy5cbiAgICAkcmFuZG9tU2luZ2xlXG4gICAgICAucHJlcGVuZCgkaXRlbXMuZXEocmFuZG9tSW5kZXgpKVxuICAgICAgLmFkZENsYXNzKCdpcy1pbml0aWFsaXplZCcpO1xuICB9KTtcbn0pO1xuIiwiLypcblNwZWNpYWwgaGFuZGxpbmcgb2YgdGhlIGxhcHRvcCBpbWFnZSBvdmVybGFwcGluZyB0aGUgaGVybyB3aGVuIHRoZSBoZXJvIHZpZGVvIGlzXG5yZXZlYWxlZC5cbiovXG5cbihmdW5jdGlvbigkKXtcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgICB2YXIgJGxhcHRvcCA9ICQoJy5oZXJvLWxhcHRvcCcpO1xuXG4gICAgJCgnLnByb2R1Y3RzLWhlcm8gLnJldmVhbF9fdHJpZ2dlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICRsYXB0b3AuYWRkQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgIH0pO1xuXG4gICAgJCgnLnByb2R1Y3RzLWhlcm8gLnJldmVhbF9fY2xvc2UnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICRsYXB0b3AucmVtb3ZlQ2xhc3MoJ2lzLWhpZGRlbicpO1xuICAgIH0pO1xuXG4gICAgLy8gSGlkZSBsYXB0b3AgaW1hZ2UgaWYgdGhlIHBhZ2UgaXMgbG9hZGVkIHdpdGggdGhlIHZpZGVvIHBsYXlpbmcuXG4gICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5oYXNoID09PSAnI3ZpZGVvJykge1xuICAgICAgJGxhcHRvcC5hZGRDbGFzcygnaXMtaGlkZGVuJyk7XG4gICAgfVxuICB9KTtcbn0pKGpRdWVyeSk7XG4iLCIoZnVuY3Rpb24oJCl7XG4gICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG4gICAgJCgnLnBsYXRmb3JtLWFjY29yZGlvbicpLmFjY29yZGlvbih7XG4gICAgICBpdGVtU2VsZWN0b3I6ICcucGxhdGZvcm0tYWNjb3JkaW9uX19pdGVtJyxcbiAgICAgIGhlYWRlclNlbGVjdG9yOiAnLnBsYXRmb3JtLWFjY29yZGlvbl9fdGl0bGUnLFxuICAgICAgY29udGVudFNlbGVjdG9yOiAnLnBsYXRmb3JtLWFjY29yZGlvbl9fY29udGVudC13cmFwcGVyJ1xuICAgIH0pO1xuICB9KTtcbn0pKGpRdWVyeSk7XG4iLCIvKipcbiAqIFN0aWNreSBzaWRlIG5hdiBpbnRlcmFjdGlvbiBpbmNsdWRpbmcgc2Nyb2xsLWF3YXJlIGhpZ2hsaWdodGluZ1xuICovXG5cbihmdW5jdGlvbigkKXtcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgICB2YXIgJG5hdiA9ICQoJy5zdGlja3ktbmF2JyksXG4gICAgICAgICRsaW5rcyA9ICRuYXYuZmluZCgnLnN0aWNreS1uYXZfX2xpbmsnKSxcbiAgICAgICAgJGFuY2hvcnMgPSAkKCcubC1yZWdpb24tLWNvbnRlbnQgLmFuY2hvci1saW5rJyk7XG5cbiAgICBpZiAoJGxpbmtzLmxlbmd0aCAmJiAkYW5jaG9ycy5sZW5ndGgpIHtcbiAgICAgICRhbmNob3JzLndheXBvaW50KHtcbiAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgICAgICAgdmFyIGlkID0gdGhpcy5lbGVtZW50LmlkO1xuXG4gICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG4gICAgICAgICAgICAkbGlua3MuZmlsdGVyKCdbaHJlZj1cIiMnICsgaWQgKyAnXCJdJykucGFyZW50KCkuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgICAgaWYgKCRhbmNob3JzLmZpcnN0KCkuaXMoJyMnICsgaWQpKSB7XG4gICAgICAgICAgICAgICRuYXYuYWRkQ2xhc3MoJ2lzLXZpc2libGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3VwJykge1xuICAgICAgICAgICAgJGxpbmtzLmZpbHRlcignW2hyZWY9XCIjJyArIGlkICsgJ1wiXScpLnBhcmVudCgpLnByZXYoKS5hZGRDbGFzcygnaXMtYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgICAgICAgICBpZiAoJGFuY2hvcnMuZmlyc3QoKS5pcygnIycgKyBpZCkpIHtcbiAgICAgICAgICAgICAgJG5hdi5yZW1vdmVDbGFzcygnaXMtdmlzaWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb2Zmc2V0OiBcIjMzJVwiLFxuICAgICAgICBncm91cDogJ2FjdGl2ZSdcbiAgICAgIH0pO1xuXG4gICAgICAkYW5jaG9ycy53YXlwb2ludCh7XG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBwcmV2aW91cyA9IHRoaXMucHJldmlvdXMoKSxcbiAgICAgICAgICAgICAgbmV4dCA9IHRoaXMubmV4dCgpO1xuXG4gICAgICAgICAgLy8gTWFuYWdlIHByZXZpb3VzL25leHQgY2xhc3NlcyB0byBzdXBwb3J0IHRoZSB1cC9kb3duIGxpbmtzIG9uIG1vYmlsZVxuICAgICAgICAgICRhbmNob3JzLnJlbW92ZUNsYXNzKCdhbmNob3ItbGluay0tcHJldmlvdXMgYW5jaG9yLWxpbmstLWN1cnJlbnQgYW5jaG9yLWxpbmstLW5leHQnKTtcbiAgICAgICAgICAkKHRoaXMuZWxlbWVudCkuYWRkQ2xhc3MoJ2FuY2hvci1saW5rLS1jdXJyZW50Jyk7XG4gICAgICAgICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICAgICAgICAkKHByZXZpb3VzLmVsZW1lbnQpLmFkZENsYXNzKCdhbmNob3ItbGluay0tcHJldmlvdXMnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5leHQpIHtcbiAgICAgICAgICAgICQobmV4dC5lbGVtZW50KS5hZGRDbGFzcygnYW5jaG9yLWxpbmstLW5leHQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgZ3JvdXA6ICdwb3NpdGlvbidcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTbW9vdGggU2Nyb2xsIGZvciBhbmNob3IgbGlua3NcbiAgICAgICRsaW5rcy5jbGljayhmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKSxcbiAgICAgICAgICAgICRlbGVtZW50ID0gJCh0YXJnZXQpLFxuICAgICAgICAgICAgaWdub3JlU3RhdGVzID0gWycjcGFnZScsICcjdXAnLCAnI2Rvd24nXSxcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG5cbiAgICAgICAgLy8gRm9yIG1vYmlsZSB1cC9kb3duIG5hdiwgc2Nyb2xsIHRvIHRoZSBuZXh0IG9yIHByZXZpb3VzIHNlY3Rpb24gd2l0aCBhXG4gICAgICAgIC8vIDFweCBvZmZzZXQgdG8gZW5zdXJlIHRoZSB3YXlwb2ludCBpcyB0cmlnZ2VyZWQuXG4gICAgICAgIGlmICh0YXJnZXQgPT09ICcjZG93bicpIHtcbiAgICAgICAgICAkZWxlbWVudCA9ICQoJy5hbmNob3ItbGluay0tbmV4dCcpO1xuICAgICAgICAgIG9mZnNldCA9IC0xO1xuICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gJyN1cCcpIHtcbiAgICAgICAgICAkZWxlbWVudCA9ICQoJy5hbmNob3ItbGluay0tcHJldmlvdXMnKTtcbiAgICAgICAgICBvZmZzZXQgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRlbGVtZW50Lmxlbmd0aCkge1xuICAgICAgICAgIENvbXBvbmVudHMudXRpbHMuc21vb3RoU2Nyb2xsVG9wKCRlbGVtZW50LCA1MDAsIG9mZnNldCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZ25vcmUgc2V2ZXJhbCBvZiB0aGUgaGFzaGVzIHRoYXQgYXJlbid0IHVzZWZ1bCBpbiB0aGUgVVJMLlxuICAgICAgICBpZiAoJC5pbkFycmF5KHRhcmdldCwgaWdub3JlU3RhdGVzKSAhPT0gLTEpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uICgkKSB7XG4gIGlmKENvbXBvbmVudHMudXRpbHMpIHtcbiAgICB2YXIgJGxpbmtzID0gJCgnLnRyZW5kcy1ncmlkX19pdGVtIGEnKTtcblxuICAgIC8vIEhhbmRsZSBzbW9vdGggc2Nyb2xsaW5nIGRvd24gdG8gdGhlIHNlY3Rpb24uXG4gICAgJGxpbmtzLm9uKCdjbGljay50cmVuZHMnLCBmdW5jdGlvbigpIHtcbiAgICAgIENvbXBvbmVudHMudXRpbHMuc21vb3RoU2Nyb2xsVG9wKCQoJCh0aGlzKS5hdHRyKCdocmVmJykpKTtcbiAgICB9KTtcbiAgfVxufSkoalF1ZXJ5KTtcbiJdfQ==
;
!function(){Drupal.behaviors.tableauBrightcove={};var tableauBrightcove=Drupal.behaviors.tableauBrightcove,brightcoveDeferred=$.Deferred(),asyncBehaviorDeferred=$.Deferred();tableauBrightcove.init=function(){var settings=Drupal.settings.tableauBrightcove,url=settings.asyncScript;url+="?"+Drupal.settings.tableauSite.cssJsQueryString,$.ajax({url:url,dataType:"script",cache:!0}),$(document).one("brightcove:loaded",tableauBrightcove.signalBrightcoveLoaded),window.bc&&window.bc.videojs&&tableauBrightcove.signalBrightcoveLoaded(),$.when(brightcoveDeferred,asyncBehaviorDeferred).done(function(){tableauBrightcove.autocaptionsAsync(),tableauBrightcove.generalHelpersAsync(),tableauBrightcove.errorStringsAsync(),tableauBrightcove.errorHandlingAsync(),tableauBrightcove.premiumAutoplayAsync(),Tabia.debug("Tableau Brightcove behaviors initialized",{type:"tableauBrightcove"})})},tableauBrightcove.attach=function(context,settings){var $videos;if(!(settings=settings.tableauBrightcove))return void Tabia.error("Brightcove settings not found",{type:"tableauBrightcove"});$videos=$(".video-js").once("tableauBrightcove"),"default"!==settings.playerId&&$videos.filter("[data-player]").attr("data-player",settings.playerId),context===document&&tableauBrightcove.init()},tableauBrightcove.signalBrightcoveLoaded=function(){Tabia.debug("Brightcove library loaded",{type:"tableauBrightcove"}),brightcoveDeferred.resolve(),Components.$events.trigger("brightcoveLoaded")},tableauBrightcove.signalAsyncLoaded=function(){Tabia.debug("Tableau Brightcove async loaded",{type:"tableauBrightcove"}),asyncBehaviorDeferred.resolve()}}();;
